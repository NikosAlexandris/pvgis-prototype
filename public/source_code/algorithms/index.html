<!DOCTYPE html><html class=no-js lang=en> <head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Photovoltaic Geographical Information System" name=description><meta content="Nikos Alexandris and the PVGIS team" name=author><link href=http://pvgis-reference.jrc.it/source_code/algorithms/ rel=canonical><link href=../package_init/ rel=prev><link href=../api/ rel=next><link href=../../assets/images/favicon.png rel=icon><meta content="mkdocs-1.6.1, mkdocs-material-9.7.0" name=generator><title>Algorithms - PVGIS</title><link href=../../assets/stylesheets/main.618322db.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.ab4e12ef.min.css rel=stylesheet><style>:root{.md-tag.md-tag--concepts{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M21.809%205.524%2012.806.179l-.013-.007.078-.045h-.166a1.28%201.28%200%200%200-1.196.043l-.699.403-8.604%204.954a1.29%201.29%200%200%200-.644%201.113v10.718c0%20.46.245.884.644%201.113l9.304%205.357c.402.232.898.228%201.297-.009l9.002-5.345c.39-.231.629-.651.629-1.105V6.628c0-.453-.239-.873-.629-1.104m-19.282.559L11.843.719a.64.64%200%200%201%20.636.012l9.002%205.345a.64.64%200%200%201%20.207.203l-4.543%202.555-4.498-2.7a.96.96%200%200%200-.968-.014L6.83%208.848%202.287%206.329a.64.64%200%200%201%20.24-.246m14.13%208.293-4.496-2.492V6.641a.3.3%200%200%201%20.155.045l4.341%202.605zm-4.763-1.906%204.692%202.601-4.431%202.659-4.648-2.615a.3.3%200%200%201-.115-.112zm-.064%2010.802-9.304-5.357a.64.64%200%200%201-.322-.557V7.018L6.7%209.51v5.324c0%20.348.188.669.491.84l4.811%202.706.157.088v4.887a.64.64%200%200%201-.329-.083%22/%3E%3C/svg%3E');}.md-tag.md-tag--chunking{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M192%2032c0-17.7%2014.3-32%2032-32h64c17.7%200%2032%2014.3%2032%2032v64c0%2017.7-14.3%2032-32%2032h-64c-17.7%200-32-14.3-32-32zm32%20352h64c17.7%200%2032%2014.3%2032%2032v64c0%2017.7-14.3%2032-32%2032h-64c-17.7%200-32-14.3-32-32v-64c0-17.7%2014.3-32%2032-32m192%200h64c17.7%200%2032%2014.3%2032%2032v64c0%2017.7-14.3%2032-32%2032h-64c-17.7%200-32-14.3-32-32v-64c0-17.7%2014.3-32%2032-32m-96-192h64c17.7%200%2032%2014.3%2032%2032v64c0%2017.7-14.3%2032-32%2032h-64c-17.7%200-32-14.3-32-32v-64c0-17.7%2014.3-32%2032-32m-182.6-3.9c12.5-12.5%2032.8-12.5%2045.3%200l45.3%2045.3c12.5%2012.5%2012.5%2032.8%200%2045.3L182.7%20324c-12.5%2012.5-32.8%2012.5-45.3%200l-45.3-45.4c-12.5-12.5-12.5-32.8%200-45.3l45.3-45.3zM32%20384h64c17.7%200%2032%2014.3%2032%2032v64c0%2017.7-14.3%2032-32%2032H32c-17.7%200-32-14.3-32-32v-64c0-17.7%2014.3-32%2032-32%22/%3E%3C/svg%3E');}.md-tag.md-tag--cli{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%202.75C0%201.784.784%201%201.75%201h12.5c.966%200%201.75.784%201.75%201.75v10.5A1.75%201.75%200%200%201%2014.25%2015H1.75A1.75%201.75%200%200%201%200%2013.25Zm1.75-.25a.25.25%200%200%200-.25.25v10.5c0%20.138.112.25.25.25h12.5a.25.25%200%200%200%20.25-.25V2.75a.25.25%200%200%200-.25-.25ZM7.25%208a.75.75%200%200%201-.22.53l-2.25%202.25a.749.749%200%200%201-1.275-.326.75.75%200%200%201%20.215-.734L5.44%208%203.72%206.28a.749.749%200%200%201%20.326-1.275.75.75%200%200%201%20.734.215l2.25%202.25c.141.14.22.331.22.53m1.5%201.5h3a.75.75%200%200%201%200%201.5h-3a.75.75%200%200%201%200-1.5%22/%3E%3C/svg%3E');}.md-tag.md-tag--howto{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22m21.71%2020.29-1.42%201.42a1%201%200%200%201-1.41%200L7%209.85A3.8%203.8%200%200%201%206%2010a4%204%200%200%201-3.78-5.3l2.54%202.54.53-.53%201.42-1.42.53-.53L4.7%202.22A4%204%200%200%201%2010%206a3.8%203.8%200%200%201-.15%201l11.86%2011.88a1%201%200%200%201%200%201.41M2.29%2018.88a1%201%200%200%200%200%201.41l1.42%201.42a1%201%200%200%200%201.41%200l5.47-5.46-2.83-2.83M20%202l-4%202v2l-2.17%202.17%202%202L18%208h2l2-4Z%22/%3E%3C/svg%3E');}.md-tag.md-tag--todo{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%202h4a1%201%200%200%201%201%201v4a1%201%200%200%201-1%201H2a1%201%200%200%201-1-1V3a1%201%200%200%201%201-1m4.655%208.595a.75.75%200%200%201%200%201.06L4.03%2014.28a.75.75%200%200%201-1.06%200l-1.5-1.5a.749.749%200%200%201%20.326-1.275.75.75%200%200%201%20.734.215l.97.97%202.095-2.095a.75.75%200%200%201%201.06%200M9.75%202.5h5.5a.75.75%200%200%201%200%201.5h-5.5a.75.75%200%200%201%200-1.5m0%205h5.5a.75.75%200%200%201%200%201.5h-5.5a.75.75%200%200%201%200-1.5m0%205h5.5a.75.75%200%200%201%200%201.5h-5.5a.75.75%200%200%201%200-1.5m-7.25-9v3h3v-3Z%22/%3E%3C/svg%3E');}.md-tag.md-tag--seealso{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M12%209a3%203%200%200%200-3%203%203%203%200%200%200%203%203%203%203%200%200%200%203-3%203%203%200%200%200-3-3m0%208a5%205%200%200%201-5-5%205%205%200%200%201%205-5%205%205%200%200%201%205%205%205%205%200%200%201-5%205m0-12.5C7%204.5%202.73%207.61%201%2012c1.73%204.39%206%207.5%2011%207.5s9.27-3.11%2011-7.5c-1.73-4.39-6-7.5-11-7.5%22/%3E%3C/svg%3E');}}</style><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../assets/_markdown_exec_pyodide.css rel=stylesheet><link href=../../assets/_markdown_exec_ansi.css rel=stylesheet><link href=../../assets/_mkdocstrings.css rel=stylesheet><link href=../../css/timeago.css rel=stylesheet><link href=../../assets/mkdocs_pagetree_plugin.css rel=stylesheet><link href=../../stylesheets/extra.css rel=stylesheet><link href=../../stylesheets/links.css rel=stylesheet><link href=../../stylesheets/code_select.css rel=stylesheet><link href=../../stylesheets/mermaid.css rel=stylesheet><link href=../../css/termynal.css rel=stylesheet><link href=../../css/custom.css rel=stylesheet><link href=../../css/mkdocstrings.css rel=stylesheet><link href=../../assets/stylesheets/badge.css rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body data-md-color-accent=indigo data-md-color-primary=indigo data-md-color-scheme=yellow dir=ltr> <input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox> <input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a class=md-skip href=#pvgisprototype.algorithms> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button aria-label="Don't show this again" class="md-banner__button md-icon"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> <div style="text-align: center; margin: 20px; padding: 10px; background-color: #ffcc00; color: black; border-radius: 5px;"> <strong> Under Continuous Development! </strong> <br> This documentation is auto-generated and regularly updated to reflect the latest development changes. Check out the <a href=../../development style="color:
        darkblue;">Development</a> pages. </div> </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav aria-label=Header class="md-header__inner md-grid"> <a aria-label=PVGIS class="md-header__button md-logo" data-md-component=logo href=../.. title=PVGIS> <img alt=logo src=../../images/pvgis_image_squared.png> </a> <label class="md-header__button md-icon" for=__drawer> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> PVGIS </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Algorithms </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input aria-label="Switch to dark mode" class=md-option data-md-color-accent=indigo data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary=indigo data-md-color-scheme=yellow id=__palette_0 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_1 hidden title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"></path></svg> </label> <input aria-label="Switch to light mode" class=md-option data-md-color-accent=indigo data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary=indigo data-md-color-scheme=blue id=__palette_1 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_0 hidden title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.04 7 9.54s-2.94 8.27-7 9.54c.95.3 1.95.46 3 .46a10 10 0 0 0 10-10A10 10 0 0 0 9 2"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false type=text> <label class="md-search__icon md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav aria-label=Search class=md-search__options> <a aria-label=Share class="md-search__icon md-icon" data-clipboard data-clipboard-text data-md-component=search-share href=javascript:void(0) tabindex=-1 title=Share> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button aria-label=Clear class="md-search__icon md-icon" tabindex=-1 title=Clear type=reset> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix tabindex=0> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a class=md-source data-md-component=source href=https://code.europa.eu/pvgis/pvgis.git title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> pvgis </div> </a> </div> </nav> <nav aria-label=Tabs class=md-tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a class=md-tabs__link href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"></path></svg> Overview </a> </li> <li class=md-tabs__item> <a href=../../install/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> Installation </a> </li> <li class=md-tabs__item> <a href=../../tutorials/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M14.19 14.19 6 18l3.81-8.19L18 6m-6-4A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2m0 8.9a1.1 1.1 0 0 0-1.1 1.1 1.1 1.1 0 0 0 1.1 1.1 1.1 1.1 0 0 0 1.1-1.1 1.1 1.1 0 0 0-1.1-1.1"></path></svg> Tutorials </a> </li> <li class=md-tabs__item> <a href=../../cli/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 19v-3h8v3zm-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5z"></path></svg> CLI </a> </li> <li class=md-tabs__item> <a href=../../web_api/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 .039c-6.627 0-12 5.354-12 11.96-.001 6.606 5.372 11.963 12 11.962S24.001 18.605 24 12 18.627.039 12 .039m-.829 5.415h7.55l-7.58 5.329h5.182L5.28 18.543Q8.226 12 11.171 5.455"></path></svg> Web API </a> </li> <li class=md-tabs__item> <a href=../../api/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"></path></svg> API </a> </li> <li class=md-tabs__item> <a href=../../reference/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13.5 4A1.5 1.5 0 0 0 12 5.5 1.5 1.5 0 0 0 13.5 7 1.5 1.5 0 0 0 15 5.5 1.5 1.5 0 0 0 13.5 4m-.36 4.77c-1.19.1-4.44 2.69-4.44 2.69-.2.15-.14.14.02.42.16.27.14.29.33.16.2-.13.53-.34 1.08-.68 2.12-1.36.34 1.78-.57 7.07-.36 2.62 2 1.27 2.61.87.6-.39 2.21-1.5 2.37-1.61.22-.15.06-.27-.11-.52-.12-.17-.24-.05-.24-.05-.65.43-1.84 1.33-2 .76-.19-.57 1.03-4.48 1.7-7.17.11-.64.41-2.04-.75-1.94"></path></svg> Reference </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15 4v2h3v12h-3v2h5V4M4 4v16h5v-2H6V6h3V4z"></path></svg> Source Code </a> </li> <li class=md-tabs__item> <a href=../../development/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M22 9V7h-2V5a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-2h2v-2h-2v-2h2v-2h-2V9zm-4 10H4V5h14zM6 13h5v4H6zm6-6h4v3h-4zM6 7h5v5H6zm6 4h4v6h-4z"></path></svg> Development </a> </li> <li class=md-tabs__item> <a href=../../includes/tags/ class=md-tabs__link> Tags </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label=Navigation class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level=0> <label class=md-nav__title for=__drawer> <a aria-label=PVGIS class="md-nav__button md-logo" data-md-component=logo href=../.. title=PVGIS> <img alt=logo src=../../images/pvgis_image_squared.png> </a> PVGIS </label> <div class=md-nav__source> <a class=md-source data-md-component=source href=https://code.europa.eu/pvgis/pvgis.git title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> pvgis </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_1 type=checkbox> <div class="md-nav__link md-nav__container"> <a class=md-nav__link href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"></path></svg> <span class=md-ellipsis> Overview <br> <small>Photovoltaic Geographic Information System</small> </span> </a> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_1_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Overview </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../site_tree/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M21 16v-3c0-1.11-.89-2-2-2h-6V8h2V2H9v6h2v3H5c-1.11 0-2 .89-2 2v3H1v6h6v-6H5v-3h6v3H9v6h6v-6h-2v-3h6v3h-2v6h6v-6zM11 4h2v2h-2zM5 20H3v-2h2zm8 0h-2v-2h2zm8 0h-2v-2h2z"></path></svg> <span class=md-ellipsis> Site tree </span> </a> </li> <li class=md-nav__item> <a href=../../license/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9 10a3.04 3.04 0 0 1 3-3 3.04 3.04 0 0 1 3 3 3.04 3.04 0 0 1-3 3 3.04 3.04 0 0 1-3-3m3 9 4 1v-3.08A7.54 7.54 0 0 1 12 18a7.54 7.54 0 0 1-4-1.08V20m4-16a5.78 5.78 0 0 0-4.24 1.74A5.78 5.78 0 0 0 6 10a5.78 5.78 0 0 0 1.76 4.23A5.78 5.78 0 0 0 12 16a5.78 5.78 0 0 0 4.24-1.77A5.78 5.78 0 0 0 18 10a5.78 5.78 0 0 0-1.76-4.26A5.78 5.78 0 0 0 12 4m8 6a8 8 0 0 1-.57 2.8A7.8 7.8 0 0 1 18 15.28V23l-6-2-6 2v-7.72A7.9 7.9 0 0 1 4 10a7.68 7.68 0 0 1 2.33-5.64A7.73 7.73 0 0 1 12 2a7.73 7.73 0 0 1 5.67 2.36A7.68 7.68 0 0 1 20 10"></path></svg> <span class=md-ellipsis> License <br> <small>European Union Public License 1.2</small> </span> </a> </li> <li class=md-nav__item> <a href=../../acknowledgements/ class=md-nav__link> <svg viewbox="0 0 576 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M64 0C28.7 0 0 28.7 0 64v72c0 13.3 10.7 24 24 24s24-10.7 24-24V64c0-8.8 7.2-16 16-16h72c13.3 0 24-10.7 24-24S149.3 0 136 0zm376 0c-13.3 0-24 10.7-24 24s10.7 24 24 24h72c8.8 0 16 7.2 16 16v72c0 13.3 10.7 24 24 24s24-10.7 24-24V64c0-35.3-28.7-64-64-64zM48 376c0-13.3-10.7-24-24-24S0 362.7 0 376v72c0 35.3 28.7 64 64 64h72c13.3 0 24-10.7 24-24s-10.7-24-24-24H64c-8.8 0-16-7.2-16-16zm528 0c0-13.3-10.7-24-24-24s-24 10.7-24 24v72c0 8.8-7.2 16-16 16h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h72c35.3 0 64-28.7 64-64zM288 216a56 56 0 1 0 0-112 56 56 0 1 0 0 112m0 40c-53 0-96 43-96 96v24c0 13.3 10.7 24 24 24h144c13.3 0 24-10.7 24-24v-24c0-53-43-96-96-96m192-64a48 48 0 1 0-96 0 48 48 0 1 0 96 0m-312 80.3c-49.3 4.1-88 45.3-88 95.7v10.7c0 11.8 9.6 21.3 21.3 21.3h46.8c-2.7-7.5-4.1-15.6-4.1-24v-24c0-29.5 8.8-56.9 24-79.7M427.9 400h46.8c11.8 0 21.3-9.6 21.3-21.3V368c0-50.3-38.7-91.6-88-95.7 15.2 22.8 24 50.2 24 79.7v24c0 8.4-1.4 16.5-4.1 24M192 192a48 48 0 1 0-96 0 48 48 0 1 0 96 0"></path></svg> <span class=md-ellipsis> Acknowledgments </span> </a> </li> <li class=md-nav__item> <a href=../../credits/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9 10a3.04 3.04 0 0 1 3-3 3.04 3.04 0 0 1 3 3 3.04 3.04 0 0 1-3 3 3.04 3.04 0 0 1-3-3m3 9 4 1v-3.08A7.54 7.54 0 0 1 12 18a7.54 7.54 0 0 1-4-1.08V20m4-16a5.78 5.78 0 0 0-4.24 1.74A5.78 5.78 0 0 0 6 10a5.78 5.78 0 0 0 1.76 4.23A5.78 5.78 0 0 0 12 16a5.78 5.78 0 0 0 4.24-1.77A5.78 5.78 0 0 0 18 10a5.78 5.78 0 0 0-1.76-4.26A5.78 5.78 0 0 0 12 4m8 6a8 8 0 0 1-.57 2.8A7.8 7.8 0 0 1 18 15.28V23l-6-2-6 2v-7.72A7.9 7.9 0 0 1 4 10a7.68 7.68 0 0 1 2.33-5.64A7.73 7.73 0 0 1 12 2a7.73 7.73 0 0 1 5.67 2.36A7.68 7.68 0 0 1 20 10"></path></svg> <span class=md-ellipsis> Credits </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../install/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Installation </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_3 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../tutorials/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M14.19 14.19 6 18l3.81-8.19L18 6m-6-4A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2m0 8.9a1.1 1.1 0 0 0-1.1 1.1 1.1 1.1 0 0 0 1.1 1.1 1.1 1.1 0 0 0 1.1-1.1 1.1 1.1 0 0 0-1.1-1.1"></path></svg> <span class=md-ellipsis> Tutorials <br> <small>Hands-on walkthroughs</small> </span> </a> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_3_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/introduction/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14 12-4-4v3H2v2h8v3m12-4a10 10 0 0 1-19.54 3h2.13a8 8 0 1 0 0-6H2.46A10 10 0 0 1 22 12"></path></svg> <span class=md-ellipsis> Introduction <br> <small>A gentle introduction to elements of photovoltaic performance using PVGIS</small> </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_3_2 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../tutorials/solar_position/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13.8 5.2C13 5 12.2 5 11.4 5l3.2-2.7 1.4 4c-.7-.5-1.4-.8-2.2-1.1M7 7.1c.6-.6 1.3-1.1 2-1.4l-4.1-.8.7 4.1c.4-.7.8-1.4 1.4-1.9m-1.8 6.7C5 13 5 12.2 5 11.4l-2.7 3.2 4 1.4c-.5-.6-.9-1.4-1.1-2.2M22 19v2H3l5.4-5.5c-1.9-2-1.9-5.1 0-7.1 1.9-1.9 5.1-1.9 7 0l3-3 1.4 1.4L7.7 19z"></path></svg> <span class=md-ellipsis> Solar Position </span> </a> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_3_2_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Solar Position </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../notebooks/solar_position_pvgis_noaa_vs_other_models/ class=md-nav__link> <span class=md-ellipsis> Comparison of Positioning Algorithms </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../notebooks/surface_position_optimization_examples/ class=md-nav__link> <span class=md-ellipsis> Optimization of Surface Position </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/solar_irradiance/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M11 6c2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5 2.24-5 5-5m0-5 2.39 3.42C12.65 4.15 11.84 4 11 4s-1.65.15-2.39.42zM2.34 6l4.16-.35A7.2 7.2 0 0 0 4.94 7.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM19.65 6l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zM23 13h-2c0 2.05-.78 4.1-2.34 5.66A7.96 7.96 0 0 1 13 21v2c2.56 0 5.12-1 7.07-2.93S23 15.56 23 13m-4 0h-2c0 1-.39 2.05-1.17 2.83S14 17 13 17v2a5.989 5.989 0 0 0 6-6"></path></svg> <span class=md-ellipsis> Solar Irradiance </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/photovoltaic_performance/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3.33 16H11v-3H4zM13 16h7.67L20 13h-7zm8.11 2H13v4h9zM2 22h9v-4H2.89zm9-14h2v3h-2zm4.76-.79 1.42-1.42 2.12 2.12-1.41 1.42zm-11.05.7 2.12-2.12 1.41 1.42-2.12 2.12zM3 2h3v2H3zm15 0h3v2h-3zm-6 5c2.76 0 5-2.24 5-5H7c0 2.76 2.24 5 5 5"></path></svg> <span class=md-ellipsis> Photovoltaic Performance </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_4 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../cli/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 19v-3h8v3zm-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5z"></path></svg> <span class=md-ellipsis> CLI <br> <small>Work with PVGIS interactively</small> </span> </a> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_4_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> CLI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/features/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 3v8h8V3zM3 21h8v-8H3zM3 3v8h8V3zm10 13h3v-3h2v3h3v2h-3v3h-2v-3h-3z"></path></svg> <span class=md-ellipsis> Features </span> </a> </li> <li class=md-nav__item> <a href=../../cli/basics/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M6 11a2 2 0 0 1 2 2v4H4a2 2 0 0 1-2-2v-2a2 2 0 0 1 2-2zm-2 2v2h2v-2zm16 0v2h2v2h-2a2 2 0 0 1-2-2v-2a2 2 0 0 1 2-2h2v2zm-8-6v4h2a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-2a2 2 0 0 1-2-2V7zm0 8h2v-2h-2z"></path></svg> <span class=md-ellipsis> Basics <br> <small>Basics of the Command Line Interface</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/verbosity/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 3c5.5 0 10 3.58 10 8s-4.5 8-10 8c-1.24 0-2.43-.18-3.53-.5C5.55 21 2 21 2 21c2.33-2.33 2.7-3.9 2.75-4.5C3.05 15.07 2 13.13 2 11c0-4.42 4.5-8 10-8m5 9v-2h-2v2zm-4 0v-2h-2v2zm-4 0v-2H7v2z"></path></svg> <span class=md-ellipsis> Verbosity <br> <small>Show what's going on</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/symbols/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M2 7v7h2V7zm4 0v2h4v2H8v3h2v-1c1.11 0 2-.89 2-2V9c0-1.11-.89-2-2-2zm9.8 0-.2 2H14v2h1.4l-.2 2H14v2h1l-.2 2h2l.2-2h1.4l-.2 2h2l.2-2H22v-2h-1.4l.2-2H22V9h-1l.2-2h-2L19 9h-1.4l.2-2zm1.6 4h1.4l-.2 2h-1.4zM2 15v2h2v-2zm6 0v2h2v-2z"></path></svg> <span class=md-ellipsis> Symbols </span> </a> </li> <li class=md-nav__item> <a href=../../cli/timestamps/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15 13h1.5v2.82l2.44 1.41-.75 1.3L15 16.69zm4-5H5v11h4.67c-.43-.91-.67-1.93-.67-3a7 7 0 0 1 7-7c1.07 0 2.09.24 3 .67zM5 21a2 2 0 0 1-2-2V5c0-1.11.89-2 2-2h1V1h2v2h8V1h2v2h1a2 2 0 0 1 2 2v6.1c1.24 1.26 2 2.99 2 4.9a7 7 0 0 1-7 7c-1.91 0-3.64-.76-4.9-2zm11-9.85A4.85 4.85 0 0 0 11.15 16c0 2.68 2.17 4.85 4.85 4.85A4.85 4.85 0 0 0 20.85 16c0-2.68-2.17-4.85-4.85-4.85"></path></svg> <span class=md-ellipsis> Timestamps <br> <small>Work with time series</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/precision/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M5 13v3H4l-1-3a1 1 0 0 1 2 0m10 3v-2l-3 3 3 3v-2h6v-2m-9-5a3 3 0 0 1-6 0V8a3 3 0 0 1 6 0m-2 0a1 1 0 0 0-2 0v3a1 1 0 0 0 2 0Z"></path></svg> <span class=md-ellipsis> Precision </span> </a> </li> <li class=md-nav__item> <a href=../../cli/plots/ class=md-nav__link> <svg viewbox="0 0 16 16" xmlns=http://www.w3.org/2000/svg><path d="M1.5 1.75V13.5h13.75a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75V1.75a.75.75 0 0 1 1.5 0m14.28 2.53-5.25 5.25a.75.75 0 0 1-1.06 0L7 7.06 4.28 9.78a.75.75 0 0 1-1.042-.018.75.75 0 0 1-.018-1.042l3.25-3.25a.75.75 0 0 1 1.06 0L10 7.94l4.72-4.72a.75.75 0 0 1 1.042.018.75.75 0 0 1 .018 1.042"></path></svg> <span class=md-ellipsis> Plots <br> <small>Plot time series data</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/fingerprint/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M17.81 4.47c-.08 0-.16-.02-.23-.06C15.66 3.42 14 3 12 3c-1.97 0-3.85.47-5.56 1.41-.24.13-.54.04-.68-.2a.506.506 0 0 1 .2-.68C7.82 2.5 9.86 2 12 2s4 .47 6.04 1.5c.25.15.34.45.21.69a.48.48 0 0 1-.44.28M3.5 9.72c-.1 0-.2-.03-.29-.09a.517.517 0 0 1-.12-.7c.99-1.4 2.25-2.5 3.75-3.27C10 4.04 14 4.03 17.15 5.65c1.5.77 2.76 1.85 3.75 3.25.16.22.1.54-.12.7-.23.16-.54.11-.7-.1a9.26 9.26 0 0 0-3.39-2.96c-2.87-1.47-6.54-1.47-9.4.01-1.36.7-2.5 1.7-3.4 2.95-.08.15-.23.22-.39.22m6.25 12.07c-.13 0-.25-.05-.35-.15-.87-.87-1.34-1.43-2.01-2.64-.69-1.23-1.05-2.73-1.05-4.34 0-2.97 2.54-5.39 5.66-5.39s5.66 2.42 5.66 5.39a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5c0-2.42-2.09-4.39-4.66-4.39s-4.66 1.97-4.66 4.39c0 1.44.32 2.77.93 3.84.64 1.16 1.08 1.65 1.85 2.43.19.2.19.51 0 .71-.12.1-.24.15-.37.15m7.17-1.85c-1.19 0-2.24-.3-3.1-.89-1.49-1.01-2.38-2.65-2.38-4.39a.5.5 0 0 1 .5-.5.5.5 0 0 1 .5.5c0 1.41.72 2.74 1.94 3.56.71.48 1.54.71 2.54.71.24 0 .64-.03 1.04-.1.27-.05.54.13.58.41.05.26-.13.53-.41.58-.57.11-1.07.12-1.21.12M14.91 22h-.13c-1.59-.46-2.63-1.05-3.72-2.12a7.28 7.28 0 0 1-2.17-5.22c0-1.62 1.38-2.94 3.08-2.94s3.08 1.32 3.08 2.94c0 1.07.95 1.94 2.08 1.94 1.15 0 2.08-.87 2.08-1.94 0-3.77-3.25-6.83-7.25-6.83-2.84 0-5.46 1.58-6.61 4.03-.39.81-.59 1.76-.59 2.8 0 .78.07 2.01.67 3.61.1.26-.03.55-.29.64a.504.504 0 0 1-.64-.29c-.5-1.31-.73-2.62-.73-3.96 0-1.2.23-2.29.68-3.24 1.33-2.79 4.28-4.6 7.51-4.6 4.54 0 8.25 3.51 8.25 7.83 0 1.62-1.38 2.94-3.08 2.94s-3.08-1.32-3.08-2.94c0-1.07-.93-1.94-2.08-1.94s-2.08.87-2.08 1.94c0 1.71.66 3.31 1.87 4.51.95.94 1.86 1.46 3.27 1.84.27.08.42.36.35.62-.05.23-.26.38-.47.38"></path></svg> <span class=md-ellipsis> Fingerprint <br> <small>Fingerprint calculation output</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/csv/ class=md-nav__link> <svg viewbox="0 0 576 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M96 0C60.7 0 32 28.7 32 64v384c0 35.3 28.7 64 64 64h80V400c0-35.3 28.7-64 64-64h176V170.5c0-17-6.7-33.3-18.7-45.3L290.7 18.7C278.7 6.7 262.5 0 245.5 0zm261.5 176H264c-13.3 0-24-10.7-24-24V58.5zM264 380c-24.3 0-44 19.7-44 44v80c0 24.3 19.7 44 44 44h16c24.3 0 44-19.7 44-44v-8c0-11-9-20-20-20s-20 9-20 20v8c0 2.2-1.8 4-4 4h-16c-2.2 0-4-1.8-4-4v-80c0-2.2 1.8-4 4-4h16c2.2 0 4 1.8 4 4v8c0 11 9 20 20 20s20-9 20-20v-8c0-24.3-19.7-44-44-44zm136 0c-28.7 0-52 23.3-52 52s23.3 52 52 52c6.6 0 12 5.4 12 12s-5.4 12-12 12h-32c-11 0-20 9-20 20s9 20 20 20h32c28.7 0 52-23.3 52-52s-23.3-52-52-52c-6.6 0-12-5.4-12-12s5.4-12 12-12h24c11 0 20-9 20-20s-9-20-20-20zm96 0c-11 0-20 9-20 20v31.6c0 35.5 10.5 70.3 30.2 99.8l5.1 7.7c3.7 5.6 10 8.9 16.6 8.9s12.9-3.3 16.6-8.9l5.1-7.7c19.7-29.6 30.2-64.3 30.2-99.8V400c0-11-9-20-20-20s-20 9-20 20v31.6c0 19.6-4.1 38.9-12 56.7-7.9-17.8-12-37.1-12-56.7V400c0-11-9-20-20-20z"></path></svg> <span class=md-ellipsis> CSV <br> <small>Export output as CSV</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/qrcode/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M4 4h6v6H4zm16 0v6h-6V4zm-6 11h2v-2h-2v-2h2v2h2v-2h2v2h-2v2h2v3h-2v2h-2v-2h-3v2h-2v-4h3zm2 0v3h2v-3zM4 20v-6h6v6zM6 6v2h2V6zm10 0v2h2V6zM6 16v2h2v-2zm-2-5h2v2H4zm5 0h4v4h-2v-2H9zm2-5h2v4h-2zM2 2v4H0V2a2 2 0 0 1 2-2h4v2zm20-2a2 2 0 0 1 2 2v4h-2V2h-4V0zM2 18v4h4v2H2a2 2 0 0 1-2-2v-4zm20 4v-4h2v4a2 2 0 0 1-2 2h-4v-2z"></path></svg> <span class=md-ellipsis> QR Code <br> <small>Share result via a QR Code</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/metadata/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10 7v2H9v6h1v2H6v-2h1V9H6V7zm6 0a2 2 0 0 1 2 2v6c0 1.11-.89 2-2 2h-4V7m4 2h-2v6h2z"></path></svg> <span class=md-ellipsis> Metadata </span> </a> </li> <li class=md-nav__item> <a href=../../cli/numpy/ class=md-nav__link> <?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg height=19.443359 id=svg1 inkscape:version="1.3.2 (091e20ef0f, 2023-11-25, custom)" role=img sodipodi:docname=data_array.svg version=1.1 viewbox="0 0 18.183593 19.443359" width=18.183594 xmlns=http://www.w3.org/2000/svg xmlns:cc=http://creativecommons.org/ns# xmlns:dc=http://purl.org/dc/elements/1.1/ xmlns:inkscape=http://www.inkscape.org/namespaces/inkscape xmlns:rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# xmlns:sodipodi=http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd xmlns:svg=http://www.w3.org/2000/svg> <defs id=defs1></defs> <sodipodi:namedview bordercolor=#ffffff borderopacity=1 id=namedview1 inkscape:current-layer=svg1 inkscape:cx=18.164856 inkscape:cy=8.2982623 inkscape:deskcolor=#505050 inkscape:pagecheckerboard=1 inkscape:pageopacity=0 inkscape:showpageshadow=0 inkscape:window-height=1080 inkscape:window-maximized=0 inkscape:window-width=1920 inkscape:window-x=0 inkscape:window-y=0 inkscape:zoom=25.185996 pagecolor=#505050 showguides=true> <sodipodi:guide id=guide9 inkscape:locked=false orientation=0,-1 position=8.4117921,14.634449></sodipodi:guide> <sodipodi:guide id=guide10 inkscape:locked=false orientation=1,0 position=9.0775011,15.239638></sodipodi:guide> </sodipodi:namedview> <title id=title1>NumPy</title> <path d="M 9.1028758,1.8471229 6.5795357,3.1064197 9.2072897,4.4321619 11.654692,3.1269862 Z m -3.7509964,1.871543 -2.887207,1.4412304 2.7021094,1.3573828 2.8160156,-1.469707 z m 7.5225586,0.020567 -2.464805,1.2988476 2.763809,1.3953515 2.534414,-1.2735351 z M 9.1898868,5.6550721 6.3801998,7.1263612 9.085473,8.4853257 11.947367,7.0472596 Z m 7.2662702,0.405 -2.640411,1.3130859 0.0016,3.453574 2.638829,-1.3415625 z M 1.7274459,6.0632362 V 9.4883341 L 4.366274,10.829897 4.3678535,7.3763221 Z M 12.741547,7.9063025 9.6597508,9.4392911 v 3.4472459 l 3.0865422,-1.532989 z m -7.3010738,0.00317 -0.00317,3.4472455 3.086543,1.532989 V 9.4424549 Z m 11.0156838,2.7986135 -2.638828,1.330488 0.0031,3.478887 2.635664,-1.314668 z m -14.7287111,0.0016 v 3.496289 l 2.635664,1.314668 0.00158,-3.478887 z M 12.746293,12.56859 9.6597508,14.112652 v 3.482051 l 3.0897072,-1.542481 z m -7.3105658,0.0031 -0.00317,3.483632 3.0912891,1.540899 v -3.480469 z" id=path8 style=stroke-width:0.6561></path> <metadata id=metadata1> <rdf:rdf> <cc:work rdf:about> <dc:title>NumPy</dc:title> </cc:work> </rdf:rdf> </metadata> </svg> <span class=md-ellipsis> Array Computing </span> </a> </li> <li class=md-nav__item> <a href=../../cli/logging/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m19.07 14.88 2.05 2.05L15.06 23H13v-2.06zm1.97-1.75c.14 0 .27.06.38.17l1.28 1.28c.22.21.22.56 0 .77l-1 1-2.05-2.05 1-1c.11-.11.25-.17.39-.17M17 4v6l-2-2-2 2V4H9v16h2v2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7H3V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v6l-2 2V4zM5 5v2h2V5zm0 6v2h2v-2zm0 6v2h2v-2z"></path></svg> <span class=md-ellipsis> Logging <br> <small>Log details of a command execution</small> </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_4_14 type=checkbox> <label class=md-nav__link for=__nav_4_14 id=__nav_4_14_label tabindex=0> <span class=md-ellipsis> Power </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_14_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_14> <span class="md-nav__icon md-icon"></span> Power </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/power/introduction/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14 12-4-4v3H2v2h8v3m12-4a10 10 0 0 1-19.54 3h2.13a8 8 0 1 0 0-6H2.46A10 10 0 0 1 22 12"></path></svg> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../cli/power/tools/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Tools <br> <small>Estimate photovoltaic power</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/power/broadband/ class=md-nav__link> <svg role=img viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><title>Spectrum</title><path d="M0 10.2A1.8 1.8 0 001.8 12h1.8a8.4 8.4 0 018.4 8.4v1.8a1.8 1.8 0 001.8 1.8h8.4a1.8 1.8 0 001.8-1.8v-1.8C24 9.133 14.867 0 3.6 0H1.8A1.8 1.8 0 000 1.8v8.4z"></path></svg> <span class=md-ellipsis> Broadband <br> <small>Estimate photovoltaic performance over a time series based on broadband irradiance</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/power/spectral/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m8.5 4.5-3.1 5 3.1 5.2-3.3 5.8-1.8-.9 2.7-4.9L3 9.5l3.7-5.9zm6.2-.1-3.1 5.1 3.1 5-3.3 5.8-1.8-.9 2.7-4.9-3.1-5 3.7-6zm6.3 0-3.1 5.1 3.1 5-3.3 5.8-1.8-.9 2.7-4.9-3.1-5 3.7-6z"></path></svg> <span class=md-ellipsis> Spectrally Resolved <br> <small>Estimate photovoltaic performance over a time series based on spectrally resolved irradiance</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/power/spectral_effect/ class=md-nav__link> <svg role=img viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><title>Spectrum</title><path d="M0 10.2A1.8 1.8 0 001.8 12h1.8a8.4 8.4 0 018.4 8.4v1.8a1.8 1.8 0 001.8 1.8h8.4a1.8 1.8 0 001.8-1.8v-1.8C24 9.133 14.867 0 3.6 0H1.8A1.8 1.8 0 000 1.8v8.4z"></path></svg> <span class=md-ellipsis> Spectral Effect </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_4_15 type=checkbox> <label class=md-nav__link for=__nav_4_15 id=__nav_4_15_label tabindex=0> <span class=md-ellipsis> Irradiance </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_15_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_15> <span class="md-nav__icon md-icon"></span> Irradiance </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/irradiance/introduction/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14 12-4-4v3H2v2h8v3m12-4a10 10 0 0 1-19.54 3h2.13a8 8 0 1 0 0-6H2.46A10 10 0 0 1 22 12"></path></svg> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../cli/irradiance/tools/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Tools </span> </a> </li> <li class=md-nav__item> <a href=../../cli/irradiance/global/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M11 6c2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5 2.24-5 5-5m0-5 2.39 3.42C12.65 4.15 11.84 4 11 4s-1.65.15-2.39.42zM2.34 6l4.16-.35A7.2 7.2 0 0 0 4.94 7.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM19.65 6l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zM23 13h-2c0 2.05-.78 4.1-2.34 5.66A7.96 7.96 0 0 1 13 21v2c2.56 0 5.12-1 7.07-2.93S23 15.56 23 13m-4 0h-2c0 1-.39 2.05-1.17 2.83S14 17 13 17v2a5.989 5.989 0 0 0 6-6"></path></svg> <span class=md-ellipsis> Global </span> </a> </li> <li class=md-nav__item> <a href=../../cli/irradiance/direct/ class=md-nav__link> <?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg height=24 id=svg1 inkscape:version="1.4.2 (ebf0e940d0, 2025-05-08)" sodipodi:docname=direct-irradiance.svg version=1.1 viewbox="0 0 24 24" width=24 xmlns=http://www.w3.org/2000/svg xmlns:inkscape=http://www.inkscape.org/namespaces/inkscape xmlns:sodipodi=http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd xmlns:svg=http://www.w3.org/2000/svg> <defs id=defs1></defs> <sodipodi:namedview bordercolor=#ffffff borderopacity=1 id=namedview1 inkscape:current-layer=svg1 inkscape:cx=41.11869 inkscape:cy=46.228987 inkscape:deskcolor=#505050 inkscape:pagecheckerboard=1 inkscape:pageopacity=0 inkscape:showpageshadow=0 inkscape:window-height=2128 inkscape:window-maximized=0 inkscape:window-width=3840 inkscape:window-x=0 inkscape:window-y=0 inkscape:zoom=16.926609 pagecolor=#505050></sodipodi:namedview> <path d="M 6.303375,0.956534 4.534384,3.488001 C 5.082122,3.288151 5.681619,3.17701 6.303375,3.17701 c 0.621756,0 1.221619,0.111141 1.769356,0.310991 z m 3.330897,3.434439 c 0.444111,0.377494 0.836496,0.843842 1.147374,1.376775 0.310878,0.540336 0.510673,1.110338 0.614299,1.695085 l 1.310187,-2.80514 z m -6.661429,0.0073 -3.079177,0.259403 1.309821,2.80514 C 1.307113,6.878069 1.49247,6.315469 1.818152,5.767732 2.12903,5.234798 2.528732,4.775768 2.972843,4.398273 Z m 3.330532,0.259403 c -2.042913,0 -3.700794,1.657881 -3.700794,3.700794 0,2.042913 1.657881,3.700794 3.700794,3.700794 2.042913,0 3.701159,-1.657881 3.701159,-3.700794 0,-2.042913 -1.658246,-3.700794 -3.701159,-3.700794 z m 0,1.480318 c 1.221306,0 2.220842,0.999169 2.220842,2.220476 0,1.221306 -0.999536,2.220476 -2.220842,2.220476 -1.221307,0 -2.220477,-0.99917 -2.220477,-2.220476 0,-1.221307 0.99917,-2.220476 2.220477,-2.220476 z m 14.554747,2.830017 -2.706719,2.70672 -1.263356,1.263356 -3.789334,3.879705 -1.263356,1.263355 -4.872316,4.962319 h 17.143293 v -1.80446 H 11.203862 L 22.121476,10.231019 Z M 1.211171,9.268758 -0.091699,12.059263 2.972843,12.3333 C 2.536134,11.955824 2.136347,11.496963 1.825469,10.949225 1.514591,10.416292 1.314796,9.838719 1.211171,9.268776 Z m 9.533522,0.570028 c 0,0.740186 -0.288674,1.517272 -0.866019,2.094616 -0.577344,0.577345 -1.35443,0.866019 -2.094616,0.866019 v 1.480684 c 1.139886,0 2.279749,-0.436853 3.145766,-1.30287 0.858616,-0.858616 1.295187,-1.998562 1.295187,-3.138449 z m 2.960635,0 c 0,1.517382 -0.577348,3.034909 -1.732037,4.189599 -1.162092,1.162092 -2.671852,1.732037 -4.189233,1.732037 v 1.480318 c 1.894876,0 3.789703,-0.74033 5.233065,-2.168889 1.443362,-1.428558 2.168522,-3.338189 2.168522,-5.233065 z" id=path7 style=stroke-width:0.740186></path> </svg> <span class=md-ellipsis> Direct </span> </a> </li> <li class=md-nav__item> <a href=../../cli/irradiance/diffuse/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14.264 2.761-1.23 9.432-1.648 1.882-1.71-11.301h-.002l-.2.042-.066.013-.132.03-.064.016a12 12 0 0 0-1.74.55l-.037.019 3.398 11.263-.158.18-1.598-.703-.105.134L3.445 6.1a11 11 0 0 0-.927 1.047 13 13 0 0 0-.552.76v.006l6.481 7.081-1.021 1.313-7.205-4.15a11.7 11.7 0 0 0-.22 2.31l6.853 2.575-1.576 2.025-4.31.02A12 12 0 0 0 2.18 21.24h.003l1.696-.373h.45l4.863-6.223 1.583.701 3.338-3.812c1.85 3.145 3.844 6.17 5.657 9.337h.453l-.008-.014 1.612.363.016-.018a11 11 0 0 0 .774-1.256 11 11 0 0 0 .353-.726l-3.788-.064-1.333-2.196 6.146-2.241v-.031l.004-.203v-.312l-.004-.064v-.067l-.003-.068-.003-.067-.003-.068-.003-.067-.005-.064-.003-.068-.007-.067-.003-.067-.006-.064-.006-.068-.006-.067-.007-.067-.006-.065a10 10 0 0 0-.113-.796v-.016l-6.506 3.72-1.047-1.725 5.737-6.493a11 11 0 0 0-.888-1.17 12 12 0 0 0-.692-.729l-4.725 7.455-1.372-2.258 2.153-7.754-.055-.021a11.6 11.6 0 0 0-2.006-.595l-.132-.027zm-.159 9.331-3.246 3.721-1.583-.659-4.483 5.708h.496l4.103-5.251 1.574.652 3.084-3.537 4.851 8.152.477-.01zm-.073 1.302-2.912 3.344-1.605-.653-3.746 4.774 12.636.007z"></path></svg> <span class=md-ellipsis> Diffuse <br> <small>Diffuse sky- &amp; ground-reflected irradiance</small> </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_4_16 type=checkbox> <label class=md-nav__link for=__nav_4_16 id=__nav_4_16_label tabindex=0> <span class=md-ellipsis> Meteorology </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_16_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_16> <span class="md-nav__icon md-icon"></span> Meteorology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/meteo/introduction/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14 12-4-4v3H2v2h8v3m12-4a10 10 0 0 1-19.54 3h2.13a8 8 0 1 0 0-6H2.46A10 10 0 0 1 22 12"></path></svg> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../cli/meteo/tools/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Tools </span> </a> </li> <li class=md-nav__item> <a href=../../cli/meteo/tmy/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12.75 4.47c2.35 1.03 3.6 3.56 3.17 5.99A6 6 0 0 1 18 15v.17a3 3 0 0 1 1-.17 3 3 0 0 1 3 3 3 3 0 0 1-3 3h-2s-1 0-1-1 1-1 1-1h2a1 1 0 0 0 1-1 1 1 0 0 0-1-1h-3v-2a4 4 0 0 0-4-4 4 4 0 0 0-4 4H6a2 2 0 0 0-2 2 2 2 0 0 0 2 2h1s1 0 1 1-1 1-1 1H6a4 4 0 0 1-4-4 4 4 0 0 1 4-4h.27C5 11.45 4.6 9.24 5.5 7.25c1.22-2.75 4.47-4.01 7.25-2.78m-.82 1.83c-1.77-.8-3.84.01-4.62 1.77-.46 1.02-.38 2.15.1 3.06A5.99 5.99 0 0 1 12 9c.7 0 1.38.12 2 .34a3.51 3.51 0 0 0-2.07-3.04m1.62-3.67c-.55-.23-1.1-.4-1.67-.51l2.49-1.3.9 2.89c-.51-.42-1.08-.78-1.72-1.08m-7.46.81c-.49.35-.92.75-1.29 1.19l.11-2.81 2.96.68c-.62.21-1.22.53-1.78.94M18 8.71c-.09-.59-.22-1.16-.41-1.71l2.38 1.5-2.05 2.23c.11-.65.13-1.33.08-2.02M3.04 10.3c.07.6.21 1.17.39 1.7l-2.37-1.5L3.1 8.28c-.1.65-.13 1.33-.06 2.02M12 18.91c.59.91 1 1.72 1 2.09a1 1 0 0 1-1 1 1 1 0 0 1-1-1c0-.37.41-1.18 1-2.09m0-3.29S9 19 9 21a3 3 0 0 0 3 3 3 3 0 0 0 3-3c0-2-3-5.38-3-5.38"></path></svg> <span class=md-ellipsis> TMY </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_4_17 type=checkbox> <label class=md-nav__link for=__nav_4_17 id=__nav_4_17_label tabindex=0> <span class=md-ellipsis> Position </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_17_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_17> <span class="md-nav__icon md-icon"></span> Position </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/position/introduction/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14 12-4-4v3H2v2h8v3m12-4a10 10 0 0 1-19.54 3h2.13a8 8 0 1 0 0-6H2.46A10 10 0 0 1 22 12"></path></svg> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../cli/position/tools/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Tools </span> </a> </li> <li class=md-nav__item> <a href=../../cli/position/overview/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13.8 5.2C13 5 12.2 5 11.4 5l3.2-2.7 1.4 4c-.7-.5-1.4-.8-2.2-1.1M7 7.1c.6-.6 1.3-1.1 2-1.4l-4.1-.8.7 4.1c.4-.7.8-1.4 1.4-1.9m-1.8 6.7C5 13 5 12.2 5 11.4l-2.7 3.2 4 1.4c-.5-.6-.9-1.4-1.1-2.2M22 19v2H3l5.4-5.5c-1.9-2-1.9-5.1 0-7.1 1.9-1.9 5.1-1.9 7 0l3-3 1.4 1.4L7.7 19z"></path></svg> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../cli/position/time/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18.1 9.3 19.6 6l-4.1-.4c.6.5 1.1 1.1 1.5 1.9.3.6.5 1.1.7 1.7-.5-.1-1.1-.2-1.7-.2h-.4c-.8-1.8-2.5-3-4.6-3-2.8 0-5 2.2-5 5 0 2.1 1.2 3.8 3 4.6v.4c0 3.9 3.1 7 7 7s7-3.1 7-7c0-3.1-2.1-5.8-4.9-6.7M16 21c-2.8 0-5-2.2-5-5s2.2-5 5-5 5 2.2 5 5-2.2 5-5 5m.5-4.8 2.9 1.7-.8 1.2L15 17v-5h1.5zM11 4c-.8 0-1.6.2-2.4.4L11 1l2.4 3.4c-.8-.2-1.6-.4-2.4-.4M4.9 14.5c.4.7 1 1.4 1.6 1.9L2.4 16l1.8-3.8c.1.8.3 1.6.7 2.3m-.8-4.7L2.3 6l4.2-.3c-.6.5-1.1 1.1-1.6 1.8-.4.7-.7 1.5-.8 2.3"></path></svg> <span class=md-ellipsis> Solar Time <br> <small>All about solar time</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/position/incidence/ class=md-nav__link> <span class=md-ellipsis> Incidence </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_4_18 type=checkbox> <label class=md-nav__link for=__nav_4_18 id=__nav_4_18_label tabindex=0> <span class=md-ellipsis> Solar Surface </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_18_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_18> <span class="md-nav__icon md-icon"></span> Solar Surface </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/surface/introduction/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14 12-4-4v3H2v2h8v3m12-4a10 10 0 0 1-19.54 3h2.13a8 8 0 1 0 0-6H2.46A10 10 0 0 1 22 12"></path></svg> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../cli/surface/tools/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Tools </span> </a> </li> <li class=md-nav__item> <a href=../../cli/surface/optimal_positioning/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 12H4L2 22h20zm-1.64 2 .4 2H13v-2zM11 14v2H5.24l.4-2zm-6.16 4H11v2H4.44zM13 20v-2h6.16l.4 2zM11 8h2v3h-2zm4.76-.79 1.42-1.42 2.12 2.12-1.41 1.42zm-11.05.7 2.12-2.12 1.41 1.42-2.12 2.12zM3 2h3v2H3zm15 0h3v2h-3zm-6 5c2.76 0 5-2.24 5-5h-2c0 1.65-1.35 3-3 3S9 3.65 9 2H7c0 2.76 2.24 5 5 5"></path></svg> <span class=md-ellipsis> Optimal Positioning </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_5 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../web_api/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 .039c-6.627 0-12 5.354-12 11.96-.001 6.606 5.372 11.963 12 11.962S24.001 18.605 24 12 18.627.039 12 .039m-.829 5.415h7.55l-7.58 5.329h5.182L5.28 18.543Q8.226 12 11.171 5.455"></path></svg> <span class=md-ellipsis> Web API </span> </a> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_5_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Web API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../web_api/install/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Install </span> </a> </li> <li class=md-nav__item> <a href=../../web_api/run/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 12v7l-3 1-3-4.67c-.29-.44-1-.19-.92.34L14 23 4 18l.96-5.25C5.56 9.42 8.46 7 11.84 7H13l6-6-2 6h3l-1.58 2.37C19.36 9.88 20 10.86 20 12"></path></svg> <span class=md-ellipsis> Run </span> </a> </li> <li class=md-nav__item> <a href=../../web_api/examples/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 19h1a1 1 0 0 1 1 1h7v2h-7a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1H2v-2h7a1 1 0 0 1 1-1h1v-2H4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1h-7zM4 3h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1m5 4h1V5H9zm0 8h1v-2H9zM5 5v2h2V5zm0 8v2h2v-2z"></path></svg> <span class=md-ellipsis> Examples </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_6 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../api/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"></path></svg> <span class=md-ellipsis> API </span> </a> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_6_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/position/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13.8 5.2C13 5 12.2 5 11.4 5l3.2-2.7 1.4 4c-.7-.5-1.4-.8-2.2-1.1M7 7.1c.6-.6 1.3-1.1 2-1.4l-4.1-.8.7 4.1c.4-.7.8-1.4 1.4-1.9m-1.8 6.7C5 13 5 12.2 5 11.4l-2.7 3.2 4 1.4c-.5-.6-.9-1.4-1.1-2.2M22 19v2H3l5.4-5.5c-1.9-2-1.9-5.1 0-7.1 1.9-1.9 5.1-1.9 7 0l3-3 1.4 1.4L7.7 19z"></path></svg> <span class=md-ellipsis> Solar Position <br> <small>Estimate photovoltaic performance over a time series based on broadband irradiance</small> </span> </a> </li> <li class=md-nav__item> <a href=../../api/power/ class=md-nav__link> <svg role=img viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><title>Spectrum</title><path d="M0 10.2A1.8 1.8 0 001.8 12h1.8a8.4 8.4 0 018.4 8.4v1.8a1.8 1.8 0 001.8 1.8h8.4a1.8 1.8 0 001.8-1.8v-1.8C24 9.133 14.867 0 3.6 0H1.8A1.8 1.8 0 000 1.8v8.4z"></path></svg> <span class=md-ellipsis> Photovoltaic power <br> <small>Estimate photovoltaic performance over a time series based on broadband irradiance</small> </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_7 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../reference/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13.5 4A1.5 1.5 0 0 0 12 5.5 1.5 1.5 0 0 0 13.5 7 1.5 1.5 0 0 0 15 5.5 1.5 1.5 0 0 0 13.5 4m-.36 4.77c-1.19.1-4.44 2.69-4.44 2.69-.2.15-.14.14.02.42.16.27.14.29.33.16.2-.13.53-.34 1.08-.68 2.12-1.36.34 1.78-.57 7.07-.36 2.62 2 1.27 2.61.87.6-.39 2.21-1.5 2.37-1.61.22-.15.06-.27-.11-.52-.12-.17-.24-.05-.24-.05-.65.43-1.84 1.33-2 .76-.19-.57 1.03-4.48 1.7-7.17.11-.64.41-2.04-.75-1.94"></path></svg> <span class=md-ellipsis> Reference </span> </a> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_7_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/conventions/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m23 19-3-3v2h-4v2h4v2zm-9.2 3H6c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h8l6 6v5.1c-.3-.1-.7-.1-1-.1s-.7 0-1 .1V9h-5V4H6v16h7.1c.1.7.4 1.4.7 2M8 12h8v1.8c-.1.1-.2.1-.3.2H8zm0 4h5v2H8z"></path></svg> <span class=md-ellipsis> Conventions </span> </a> </li> <li class=md-nav__item> <a href=../../reference/comparison_pvgis_v6_vs_v52/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9 14H2v2h7v3l4-4-4-4zm6-1v-3h7V8h-7V5l-4 4z"></path></svg> <span class=md-ellipsis> PVGIS 6 vs 5 </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_7_3 type=checkbox> <label class=md-nav__link for=__nav_7_3 id=__nav_7_3_label tabindex=0> <span class=md-ellipsis> Photovoltaic Production </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_7_3_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_7_3> <span class="md-nav__icon md-icon"></span> Photovoltaic Production </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/solar_position/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13.8 5.2C13 5 12.2 5 11.4 5l3.2-2.7 1.4 4c-.7-.5-1.4-.8-2.2-1.1M7 7.1c.6-.6 1.3-1.1 2-1.4l-4.1-.8.7 4.1c.4-.7.8-1.4 1.4-1.9m-1.8 6.7C5 13 5 12.2 5 11.4l-2.7 3.2 4 1.4c-.5-.6-.9-1.4-1.1-2.2M22 19v2H3l5.4-5.5c-1.9-2-1.9-5.1 0-7.1 1.9-1.9 5.1-1.9 7 0l3-3 1.4 1.4L7.7 19z"></path></svg> <span class=md-ellipsis> Solar Position </span> </a> </li> <li class=md-nav__item> <a href=../../reference/solar_irradiance/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M11 6c2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5 2.24-5 5-5m0-5 2.39 3.42C12.65 4.15 11.84 4 11 4s-1.65.15-2.39.42zM2.34 6l4.16-.35A7.2 7.2 0 0 0 4.94 7.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM19.65 6l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zM23 13h-2c0 2.05-.78 4.1-2.34 5.66A7.96 7.96 0 0 1 13 21v2c2.56 0 5.12-1 7.07-2.93S23 15.56 23 13m-4 0h-2c0 1-.39 2.05-1.17 2.83S14 17 13 17v2a5.989 5.989 0 0 0 6-6"></path></svg> <span class=md-ellipsis> Solar Irradiance </span> </a> </li> <li class=md-nav__item> <a href=../../reference/photovoltaic_performance/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3.33 16H11v-3H4zM13 16h7.67L20 13h-7zm8.11 2H13v4h9zM2 22h9v-4H2.89zm9-14h2v3h-2zm4.76-.79 1.42-1.42 2.12 2.12-1.41 1.42zm-11.05.7 2.12-2.12 1.41 1.42-2.12 2.12zM3 2h3v2H3zm15 0h3v2h-3zm-6 5c2.76 0 5-2.24 5-5H7c0 2.76 2.24 5 5 5"></path></svg> <span class=md-ellipsis> Photovoltaic Performance </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_7_4 type=checkbox> <label class=md-nav__link for=__nav_7_4 id=__nav_7_4_label tabindex=0> <span class=md-ellipsis> Resources </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_7_4_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_7_4> <span class="md-nav__icon md-icon"></span> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/external_tools/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Tools </span> </a> </li> <li class=md-nav__item> <a href=../../reference/external_resources/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12.3 7.29c.2-.18.44-.29.7-.29.27 0 .5.11.71.29.19.21.29.45.29.71 0 .27-.1.5-.29.71-.21.19-.44.29-.71.29-.26 0-.5-.1-.7-.29-.19-.21-.3-.44-.3-.71 0-.26.11-.5.3-.71m-2.5 4.68s2.17-1.72 2.96-1.79c.74-.06.59.79.52 1.23l-.01.06c-.14.53-.31 1.17-.48 1.78-.38 1.39-.75 2.75-.66 3 .1.34.72-.09 1.17-.39.06-.04.11-.08.16-.11 0 0 .08-.08.16.03.02.03.04.06.06.08.09.14.14.19.02.27l-.04.02c-.22.15-1.16.81-1.54 1.05-.41.27-1.98 1.17-1.74-.58.21-1.23.49-2.29.71-3.12.41-1.5.59-2.18-.33-1.59-.37.22-.59.36-.72.45-.11.08-.12.08-.19-.05l-.03-.06-.05-.08c-.07-.1-.07-.11.03-.2M22 12c0 5.5-4.5 10-10 10S2 17.5 2 12 6.5 2 12 2s10 4.5 10 10m-2 0c0-4.42-3.58-8-8-8s-8 3.58-8 8 3.58 8 8 8 8-3.58 8-8"></path></svg> <span class=md-ellipsis> External sources </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked class="md-nav__toggle md-toggle" id=__nav_8 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15 4v2h3v12h-3v2h5V4M4 4v16h5v-2H6V6h3V4z"></path></svg> <span class=md-ellipsis> Source Code </span> </a> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=true aria-labelledby=__nav_8_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Source Code </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_8_1 type=checkbox> <label class=md-nav__link for=__nav_8_1 id=__nav_8_1_label tabindex> <span class=md-ellipsis> System Overview </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_8_1_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_8_1> <span class="md-nav__icon md-icon"></span> System Overview </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../architecture/ class=md-nav__link> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M0 80c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v16h128V80c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-96c-26.5 0-48-21.5-48-48v-16H192v16c0 7.3-1.7 14.3-4.6 20.5L256 288h80c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-96c-26.5 0-48-21.5-48-48v-96c0-7.3 1.7-14.3 4.6-20.5L128 224H48c-26.5 0-48-21.5-48-48z"></path></svg> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../dependencies/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.5 17c-.14 0-.26 0-.39.04L17.5 13.8c.45-.45.75-1.09.75-1.8a2.5 2.5 0 0 0-2.5-2.5c-.14 0-.25 0-.4.04L13.74 6.3c.47-.46.76-1.09.76-1.8a2.5 2.5 0 0 0-5 0c0 .7.29 1.34.76 1.79L8.65 9.54c-.15-.04-.26-.04-.4-.04a2.5 2.5 0 0 0-2.5 2.5c0 .71.29 1.34.75 1.79l-1.61 3.25C4.76 17 4.64 17 4.5 17a2.5 2.5 0 0 0 0 5A2.5 2.5 0 0 0 7 19.5c0-.7-.29-1.34-.76-1.79l1.62-3.25c.14.04.26.04.39.04s.25 0 .38-.04l1.63 3.25c-.47.45-.76 1.09-.76 1.79a2.5 2.5 0 0 0 5 0A2.5 2.5 0 0 0 12 17c-.13 0-.26 0-.39.04L10 13.8c.45-.45.75-1.09.75-1.8 0-.7-.29-1.33-.75-1.79l1.61-3.25c.13.04.26.04.39.04s.26 0 .39-.04L14 10.21a2.5 2.5 0 0 0 1.75 4.29c.13 0 .25 0 .38-.04l1.63 3.25c-.47.45-.76 1.09-.76 1.79a2.5 2.5 0 0 0 5 0 2.5 2.5 0 0 0-2.5-2.5m-15 3.5c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m8.5-1c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1M7.25 12c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1M11 4.5c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1m3.75 7.5c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1m4.75 8.5c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"></path></svg> <span class=md-ellipsis> Dependencies </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_8_2 type=checkbox> <label class=md-nav__link for=__nav_8_2 id=__nav_8_2_label tabindex> <span class=md-ellipsis> Infrastructure </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_8_2_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_8_2> <span class="md-nav__icon md-icon"></span> Infrastructure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../core/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"></path></svg> <span class=md-ellipsis> Core <br> <small>Python engineering for PVGIS</small> </span> </a> </li> <li class=md-nav__item> <a href=../logger/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"></path></svg> <span class=md-ellipsis> Logger </span> </a> </li> <li class=md-nav__item> <a href=../duck_arrays/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m10.315 4.876-4.01-2.024-4.401 2.196 4.118 2.068zm1.838.928 4.205 2.122-4.363 2.19L7.87 8.046zm5.615-2.922 4.32 2.166-3.863 1.94-4.213-2.125zM15.91 1.95 12.021 0 8.174 1.92l4.007 2.02zm-3.04 16.744V24l4.711-2.35-.005-5.31zm4.704-4.206-.005-5.253-4.699 2.336v5.254zm5.655-.984v5.327l-4.018 2.005-.002-5.303zm0-1.863v-5.22l-4.025 2.001.003 5.264zm-12.022-.07L8.033 9.976v6.895s-3.88-8.257-4.24-8.998c-.046-.096-.237-.201-.285-.227A358 358 0 0 0 .773 6.25V18.43l2.82 1.508V13.57s3.84 7.378 3.878 7.458c.04.08.425.858.837 1.132.548.363 2.899 1.776 2.899 1.776z"></path></svg> <span class=md-ellipsis> Duck Arrays </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_8_3 type=checkbox> <label class=md-nav__link for=__nav_8_3 id=__nav_8_3_label tabindex> <span class=md-ellipsis> Data Engineering </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_8_3_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_8_3> <span class="md-nav__icon md-icon"></span> Data Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../data_model/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"></path></svg> <span class=md-ellipsis> Data Model <br> <small>Engineering &amp; data model factory</small> </span> </a> </li> <li class=md-nav__item> <a href=../package_init/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M2 10.96a.985.985 0 0 1-.37-1.37L3.13 7c.11-.2.28-.34.47-.42l7.83-4.4c.16-.12.36-.18.57-.18s.41.06.57.18l7.9 4.44c.19.1.35.26.44.46l1.45 2.52c.28.48.11 1.09-.36 1.36l-1 .58v4.96c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18s-.41-.06-.57-.18l-7.9-4.44A.99.99 0 0 1 3 16.5v-5.54c-.3.17-.68.18-1 0m10-6.81v6.7l5.96-3.35zM5 15.91l6 3.38v-6.71L5 9.21zm14 0v-3.22l-5 2.9c-.33.18-.7.17-1 .01v3.69zm-5.15-2.55 6.28-3.63-.58-1.01-6.28 3.63z"></path></svg> <span class=md-ellipsis> Package Init <br> <small>Dynamic Model Registration</small> </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M7 13v-2h14v2zm0 6v-2h14v2zM7 7V5h14v2zM3 8V5H2V4h2v4zm-1 9v-1h3v4H2v-1h2v-.5H3v-1h1V17zm2.25-7a.75.75 0 0 1 .75.75c0 .2-.08.39-.21.52L3.12 13H5v1H2v-.92L4 11H2v-1z"></path></svg> <span class=md-ellipsis> Algorithms <br> <small>Solar Science written in Python</small> </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M7 13v-2h14v2zm0 6v-2h14v2zM7 7V5h14v2zM3 8V5H2V4h2v4zm-1 9v-1h3v4H2v-1h2v-.5H3v-1h1V17zm2.25-7a.75.75 0 0 1 .75.75c0 .2-.08.39-.21.52L3.12 13H5v1H2v-.92L4 11H2v-1z"></path></svg> <span class=md-ellipsis> Algorithms <br> <small>Solar Science written in Python</small> </span> </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>algorithms </span> </a> <nav aria-label=algorithms class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.faiman> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>faiman </span> </a> <nav aria-label=faiman class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.faiman.temperature> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>temperature </span> </a> <nav aria-label=temperature class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.faiman.temperature.calculate_photovoltaic_module_temperature_faiman> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_photovoltaic_module_temperature_faiman </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.finkelstein_schafer> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>finkelstein_schafer </span> </a> <nav aria-label=finkelstein_schafer class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>cumulative_distribution </span> </a> <nav aria-label=cumulative_distribution class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_ecdf> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_ecdf </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_long_term_monthly_ecdfs> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_long_term_monthly_ecdfs </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_yearly_monthly_ecdfs> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_yearly_monthly_ecdfs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.finkelstein_schafer.statistics> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>statistics </span> </a> <nav aria-label=statistics class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.finkelstein_schafer.statistics.align_and_broadcast> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>align_and_broadcast </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.finkelstein_schafer.statistics.calculate_finkelstein_schafer_statistics> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_finkelstein_schafer_statistics </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.finkelstein_schafer.univariate_statistics> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>univariate_statistics </span> </a> <nav aria-label=univariate_statistics class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.finkelstein_schafer.univariate_statistics.calculate_daily_univariate_statistics> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_daily_univariate_statistics </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hargreaves> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>hargreaves </span> </a> <nav aria-label=hargreaves class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hargreaves.solar_declination> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_declination </span> </a> <nav aria-label=solar_declination class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hargreaves.solar_declination.calculate_solar_declination_series_hargreaves> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_declination_series_hargreaves </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>hofierka </span> </a> <nav aria-label=hofierka class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>irradiance </span> </a> <nav aria-label=irradiance class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>diffuse </span> </a> <nav aria-label=diffuse class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>clear_sky </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>altitude </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.ground_reflected> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>ground_reflected </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.horizontal> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>horizontal </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>transmission_function </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.ground_reflected> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>ground_reflected </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.ground_reflected.calculate_ground_reflected_inclined_irradiance_series_pvgis> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_ground_reflected_inclined_irradiance_series_pvgis </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.horizontal> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>horizontal </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.horizontal.calculate_diffuse_horizontal_irradiance_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_diffuse_horizontal_irradiance_hofierka </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.direct> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>direct </span> </a> <nav aria-label=direct class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>clear_sky </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.horizontal> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>horizontal </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.inclined> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>inclined </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.linke_turbidity_factor> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>linke_turbidity_factor </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.normal> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>normal </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.direct.inclined> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>inclined </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.direct.inclined.calculate_direct_inclined_irradiance_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_direct_inclined_irradiance_hofierka </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.direct.normal> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>normal </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.direct.normal.calculate_direct_normal_from_horizontal_irradiance_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_direct_normal_from_horizontal_irradiance_hofierka </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>extraterrestrial </span> </a> <nav aria-label=extraterrestrial class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.horizontal> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>horizontal </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.horizontal.calculate_extraterrestrial_horizontal_irradiance_series_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_extraterrestrial_horizontal_irradiance_series_hofierka </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.normal> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>normal </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.normal.calculate_extraterrestrial_normal_irradiance_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_extraterrestrial_normal_irradiance_hofierka </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>shortwave </span> </a> <nav aria-label=shortwave class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>clear_sky </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky.inclined> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>inclined </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.inclined> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>inclined </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.inclined.calculate_global_inclined_irradiance_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_global_inclined_irradiance_hofierka </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>position </span> </a> <nav aria-label=position class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.event_hour_angle> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>event_hour_angle </span> </a> <nav aria-label=event_hour_angle class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.event_hour_angle.calculate_event_hour_angle_pvis> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_event_hour_angle_pvis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.fractional_year> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>fractional_year </span> </a> <nav aria-label=fractional_year class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.fractional_year.calculate_day_angle_series_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_day_angle_series_hofierka </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.shading> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>shading </span> </a> <nav aria-label=shading class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.shading.calculate_horizon_height_series> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_horizon_height_series </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.shading.calculate_surface_in_shade_series_pvgis> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_surface_in_shade_series_pvgis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.solar_altitude> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_altitude </span> </a> <nav aria-label=solar_altitude class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.solar_altitude.calculate_solar_altitude_series_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_altitude_series_hofierka </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.solar_azimuth> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_azimuth </span> </a> <nav aria-label=solar_azimuth class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.solar_azimuth.calculate_solar_azimuth_series_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_azimuth_series_hofierka </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.solar_declination> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_declination </span> </a> <nav aria-label=solar_declination class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.solar_declination.calculate_solar_declination_series_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_declination_series_hofierka </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.solar_hour_angle> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_hour_angle </span> </a> <nav aria-label=solar_hour_angle class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.solar_hour_angle.calculate_solar_hour_angle_series_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_hour_angle_series_hofierka </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.solar_incidence> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_incidence </span> </a> <nav aria-label=solar_incidence class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.solar_incidence.calculate_relative_longitude> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_relative_longitude </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.position.solar_incidence.calculate_solar_incidence_series_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_incidence_series_hofierka </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.power> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>power </span> </a> <nav aria-label=power class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.power.calculate_spectral_photovoltaic_power_output> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_spectral_photovoltaic_power_output </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.power.calculate_spectrally_resolved_global_inclined_irradiance_series> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_spectrally_resolved_global_inclined_irradiance_series </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.read> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>read </span> </a> <nav aria-label=read class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.read.read_spectral_response> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>read_spectral_response </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.spectrum> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>spectrum </span> </a> <nav aria-label=spectrum class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.spectrum.average_photon_energy> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>average_photon_energy </span> </a> <nav aria-label=average_photon_energy class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.spectrum.average_photon_energy.calculate_average_photon_energy> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_average_photon_energy </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.spectrum.spectral_factor> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>spectral_factor </span> </a> <nav aria-label=spectral_factor class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.spectrum.spectral_factor.calculate_minimum_spectral_mismatch> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_minimum_spectral_mismatch </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka.spectrum.spectral_factor.integrate_spectrum_response> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>integrate_spectrum_response </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.huld> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>huld </span> </a> <nav aria-label=huld class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.huld.efficiency_factor> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>efficiency_factor </span> </a> <nav aria-label=efficiency_factor class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.huld.efficiency_factor.calculate_efficiency_factor_series> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_efficiency_factor_series </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.huld.photovoltaic_module> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>photovoltaic_module </span> </a> <nav aria-label=photovoltaic_module class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.huld.photovoltaic_module.get_coefficients_for_photovoltaic_module> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>get_coefficients_for_photovoltaic_module </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.iqbal> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>iqbal </span> </a> <nav aria-label=iqbal class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.iqbal.solar_incidence> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_incidence </span> </a> <nav aria-label=solar_incidence class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.iqbal.solar_incidence.calculate_solar_incidence_series_iqbal> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_incidence_series_iqbal </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.jenco> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>jenco </span> </a> <nav aria-label=jenco class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.jenco.solar_altitude> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_altitude </span> </a> <nav aria-label=solar_altitude class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.jenco.solar_altitude.calculate_solar_altitude_series_jenco> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_altitude_series_jenco </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.jenco.solar_azimuth> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_azimuth </span> </a> <nav aria-label=solar_azimuth class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.jenco.solar_azimuth.calculate_solar_azimuth_series_jenco> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_azimuth_series_jenco </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.jenco.solar_declination> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_declination </span> </a> <nav aria-label=solar_declination class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.jenco.solar_declination.calculate_solar_declination_series_jenco> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_declination_series_jenco </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.jenco.solar_incidence> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_incidence </span> </a> <nav aria-label=solar_incidence class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.jenco.solar_incidence.calculate_relative_longitude> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_relative_longitude </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.jenco.solar_incidence.calculate_solar_incidence_series_jenco> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_incidence_series_jenco </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.martin_ruiz> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>martin_ruiz </span> </a> <nav aria-label=martin_ruiz class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.martin_ruiz.reflectivity> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>reflectivity </span> </a> <nav aria-label=reflectivity class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_effect> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_reflectivity_effect </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_effect_percentage> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_reflectivity_effect_percentage </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_factor_for_direct_irradiance_series> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_reflectivity_factor_for_direct_irradiance_series </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_factor_for_nondirect_irradiance> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_reflectivity_factor_for_nondirect_irradiance </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.milne1921> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>milne1921 </span> </a> <nav aria-label=milne1921 class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.milne1921.solar_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_time </span> </a> <nav aria-label=solar_time class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.milne1921.solar_time.calculate_apparent_solar_time_milne1921> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_apparent_solar_time_milne1921 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.milne1921.solar_time.calculate_apparent_solar_time_series_milne1921> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_apparent_solar_time_series_milne1921 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>muneer </span> </a> <nav aria-label=muneer class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>irradiance </span> </a> <nav aria-label=irradiance class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>diffuse </span> </a> <nav aria-label=diffuse class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>clear_sky </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky.inclined> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>inclined </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.in_shade> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>in_shade </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.in_shade.calculate_diffuse_inclined_irradiance_in_shade> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_diffuse_inclined_irradiance_in_shade </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.inclined> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>inclined </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.inclined.calculate_diffuse_inclined_irradiance_muneer> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_diffuse_inclined_irradiance_muneer </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.potentially_sunlit> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>potentially_sunlit </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.potentially_sunlit.calculate_diffuse_inclined_irradiance_potentially_sunlit> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_diffuse_inclined_irradiance_potentially_sunlit </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.sky_irradiance> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>sky_irradiance </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.sky_irradiance.calculate_diffuse_sky_irradiance_series_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_diffuse_sky_irradiance_series_hofierka </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.sunlit> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>sunlit </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.sunlit.calculate_diffuse_inclined_irradiance_sunlit> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_diffuse_inclined_irradiance_sunlit </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.term_n> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>term_n </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.term_n.calculate_term_n_series_hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_term_n_series_hofierka </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>noaa </span> </a> <nav aria-label=noaa class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.equation_of_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>equation_of_time </span> </a> <nav aria-label=equation_of_time class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.equation_of_time.calculate_equation_of_time_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_equation_of_time_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.event_hour_angle> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>event_hour_angle </span> </a> <nav aria-label=event_hour_angle class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.event_hour_angle.calculate_event_hour_angle_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_event_hour_angle_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.event_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>event_time </span> </a> <nav aria-label=event_time class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_in_minutes> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_event_time_in_minutes </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_event_time_series_noaa </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.event_time.match_event_times_to_timestamps> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>match_event_times_to_timestamps </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.events> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>events </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.fractional_year> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>fractional_year </span> </a> <nav aria-label=fractional_year class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.fractional_year.calculate_fractional_year_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_fractional_year_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.local_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>local_time </span> </a> <nav aria-label=local_time class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.local_time.calculate_local_solar_time_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_local_solar_time_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.parameter_models> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>parameter_models </span> </a> <nav aria-label=parameter_models class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.parameter_models.AngleInRadiansOutputUnitsModel> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>AngleInRadiansOutputUnitsModel </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_altitude> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_altitude </span> </a> <nav aria-label=solar_altitude class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_altitude.calculate_solar_altitude_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_altitude_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_azimuth> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_azimuth </span> </a> <nav aria-label=solar_azimuth class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_azimuth.calculate_solar_azimuth_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_azimuth_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_declination> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_declination </span> </a> <nav aria-label=solar_declination class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_declination.calculate_solar_declination_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_declination_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_hour_angle> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_hour_angle </span> </a> <nav aria-label=solar_hour_angle class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_hour_angle.calculate_solar_hour_angle_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_hour_angle_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_time </span> </a> <nav aria-label=solar_time class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_time.calculate_true_solar_time_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_true_solar_time_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_zenith> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_zenith </span> </a> <nav aria-label=solar_zenith class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_zenith.adjust_solar_zenith_for_atmospheric_refraction_time_series> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>adjust_solar_zenith_for_atmospheric_refraction_time_series </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_zenith.atmospheric_refraction_adjustment> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>atmospheric_refraction_adjustment </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_zenith.calculate_solar_zenith_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_zenith_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.time_offset> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>time_offset </span> </a> <nav aria-label=time_offset class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.time_offset.calculate_time_offset_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_time_offset_series_noaa </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pelland> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>pelland </span> </a> <nav aria-label=pelland class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pelland.spectral_effect> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>spectral_effect </span> </a> <nav aria-label=spectral_effect class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pelland.spectral_effect.calculate_spectral_factor_pelland> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_spectral_factor_pelland </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>pvlib </span> </a> <nav aria-label=pvlib class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib.solar_altitude> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_altitude </span> </a> <nav aria-label=solar_altitude class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib.solar_altitude.calculate_solar_altitude_series_pvlib> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_altitude_series_pvlib </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib.solar_azimuth> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_azimuth </span> </a> <nav aria-label=solar_azimuth class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib.solar_azimuth.calculate_solar_azimuth_series_pvlib> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_azimuth_series_pvlib </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib.solar_declination> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_declination </span> </a> <nav aria-label=solar_declination class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib.solar_declination.calculate_solar_declination_series_pvlib> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_declination_series_pvlib </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib.solar_hour_angle> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_hour_angle </span> </a> <nav aria-label=solar_hour_angle class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib.solar_hour_angle.calculate_solar_hour_angle_series_pvlib> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_hour_angle_series_pvlib </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib.solar_incidence> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_incidence </span> </a> <nav aria-label=solar_incidence class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib.solar_incidence.calculate_solar_incidence_series_pvlib> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_incidence_series_pvlib </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib.solar_zenith> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_zenith </span> </a> <nav aria-label=solar_zenith class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.pvlib.solar_zenith.calculate_solar_zenith_series_pvlib> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_zenith_series_pvlib </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.skyfield> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>skyfield </span> </a> <nav aria-label=skyfield class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.skyfield.solar_geometry> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_geometry </span> </a> <nav aria-label=solar_geometry class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_altitude_azimuth_skyfield> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_altitude_azimuth_skyfield </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_hour_angle_declination_skyfield> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_hour_angle_declination_skyfield </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_position_skyfield> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_position_skyfield </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.skyfield.solar_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_time </span> </a> <nav aria-label=solar_time class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.skyfield.solar_time.calculate_solar_time_skyfield> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_time_skyfield </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.skyfield.sunrise_and_sunset> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>sunrise_and_sunset </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>usno </span> </a> <nav aria-label=usno class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.local_hour_angle> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>local_hour_angle </span> </a> <nav aria-label=local_hour_angle class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.local_hour_angle.calculate_local_hour_angle> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_local_hour_angle </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.sidereal_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>sidereal_time </span> </a> <nav aria-label=sidereal_time class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_apparent_sidereal_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_apparent_sidereal_time </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_apparent_sidereal_time_time_series> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_apparent_sidereal_time_time_series </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_eqeq> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_eqeq </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_eqeq_time_series> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_eqeq_time_series </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_gast> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_gast </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_gast_time_series> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_gast_time_series </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_gmst> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_gmst </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_gmst_time_series> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_gmst_time_series </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_local_sidereal_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_local_sidereal_time </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_local_sidereal_time_time_series> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_local_sidereal_time_time_series </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.solar_altitude> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_altitude </span> </a> <nav aria-label=solar_altitude class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.solar_altitude.compute_altitude> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>compute_altitude </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.solar_azimuth> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_azimuth </span> </a> <nav aria-label=solar_azimuth class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.usno.solar_azimuth.calculate_azimuth> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_azimuth </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_8_5 type=checkbox> <label class=md-nav__link for=__nav_8_5 id=__nav_8_5_label tabindex> <span class=md-ellipsis> User Interfaces </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_8_5_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_8_5> <span class="md-nav__icon md-icon"></span> User Interfaces </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../api/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"></path></svg> <span class=md-ellipsis> API <br> <small>The Core API</small> </span> </a> </li> <li class=md-nav__item> <a href=../cli/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 19v-3h8v3zm-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5z"></path></svg> <span class=md-ellipsis> CLI <br> <small>Typer-based Command Line Interface</small> </span> </a> </li> <li class=md-nav__item> <a href=../web_api/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 .039c-6.627 0-12 5.354-12 11.96-.001 6.606 5.372 11.963 12 11.962S24.001 18.605 24 12 18.627.039 12 .039m-.829 5.415h7.55l-7.58 5.329h5.182L5.28 18.543Q8.226 12 11.171 5.455"></path></svg> <span class=md-ellipsis> Web API <br> <small>FastAPI-based Web API</small> </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_9 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../development/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M22 9V7h-2V5a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-2h2v-2h-2v-2h2v-2h-2V9zm-4 10H4V5h14zM6 13h5v4H6zm6-6h4v3h-4zM6 7h5v5H6zm6 4h4v6h-4z"></path></svg> <span class=md-ellipsis> Development </span> </a> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_9_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../development/gantt/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M2 5h8V2h2v20h-2v-4H6v-3h4v-2H4v-3h6V8H2zm12 0h3v3h-3zm0 5h5v3h-5zm0 5h8v3h-8z"></path></svg> <span class=md-ellipsis> Gantt </span> </a> </li> <li class=md-nav__item> <a href=../../development/roadmap_and_progress/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M16.5 11 13 7.5l1.4-1.4 2.1 2.1L20.7 4l1.4 1.4zM11 7H2v2h9zm10 6.4L19.6 12 17 14.6 14.4 12 13 13.4l2.6 2.6-2.6 2.6 1.4 1.4 2.6-2.6 2.6 2.6 1.4-1.4-2.6-2.6zM11 15H2v2h9z"></path></svg> <span class=md-ellipsis> Roadmap </span> </a> </li> <li class=md-nav__item> <a href=../../development/conventions/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 0C5.382 0 0 5.382 0 12s5.382 12 12 12 12-5.382 12-12S18.618 0 12 0m0 1.6c5.753 0 10.4 4.647 10.4 10.4S17.753 22.4 12 22.4 1.6 17.753 1.6 12 6.247 1.6 12 1.6"></path></svg> <span class=md-ellipsis> Conventions </span> </a> </li> <li class=md-nav__item> <a href=../../development/optimisation/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m13.13 22.19-1.63-3.83c1.57-.58 3.04-1.36 4.4-2.27zM5.64 12.5l-3.83-1.63 6.1-2.77C7 9.46 6.22 10.93 5.64 12.5M21.61 2.39S16.66.269 11 5.93c-2.19 2.19-3.5 4.6-4.35 6.71-.28.75-.09 1.57.46 2.13l2.13 2.12c.55.56 1.37.74 2.12.46A19.1 19.1 0 0 0 18.07 13c5.66-5.66 3.54-10.61 3.54-10.61m-7.07 7.07c-.78-.78-.78-2.05 0-2.83s2.05-.78 2.83 0c.77.78.78 2.05 0 2.83s-2.05.78-2.83 0m-5.66 7.07-1.41-1.41zM6.24 22l3.64-3.64c-.34-.09-.67-.24-.97-.45L4.83 22zM2 22h1.41l4.77-4.76-1.42-1.41L2 20.59zm0-2.83 4.09-4.08c-.21-.3-.36-.62-.45-.97L2 17.76z"></path></svg> <span class=md-ellipsis> Optimisation </span> </a> </li> <li class=md-nav__item> <a href=../../development/profiling/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M21.7 18.6v-1l1.1-.8c.1-.1.2-.2.1-.3l-1-1.7c0-.1-.2-.1-.3-.1l-1.2.5c-.3-.2-.6-.4-.9-.5l-.2-1.3c0-.1-.1-.2-.2-.2h-2c-.2 0-.3.1-.3.2l-.2 1.3c-.3.2-.5.3-.8.5l-1.2-.5c-.1 0-.2 0-.3.1l-1 1.7c0 .1 0 .2.1.3l1.1.8v1l-1.1.8c-.1.1-.2.2-.1.3l1 1.7c.1.1.2.1.3.1l1.2-.5c.2.2.5.4.8.5l.2 1.3c.1.1.2.2.3.2h2c.1 0 .2-.1.2-.2l.2-1.3c.3-.2.5-.3.8-.5l1.2.4c.1 0 .2 0 .3-.1l1-1.7c.1-.1.1-.2 0-.2zm-3.7.9c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5 1.5.7 1.5 1.5-.7 1.5-1.5 1.5M11 18c0-3.9 3.1-7 7-7 2 0 3.7.8 5 2.1V4c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h9.3c-.8-1.1-1.3-2.5-1.3-4M3 4h18v3H3z"></path></svg> <span class=md-ellipsis> Profiling <br> <small>Profiling of PVGIS</small> </span> </a> </li> <li class=md-nav__item> <a href=../../development/contribution_guidelines/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M17 13h-4v4h-2v-4H7v-2h4V7h2v4h4m2-8H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2"></path></svg> <span class=md-ellipsis> Contribution Guidelines </span> </a> </li> <li class=md-nav__item> <a href=../../development/adding_new_features/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 4c1.11 0 2 .89 2 2v12c0 1.11-.89 2-2 2H4c-1.11 0-2-.89-2-2V6c0-1.11.89-2 2-2zM8.5 15V9H7.25v3.5L4.75 9H3.5v6h1.25v-3.5L7.3 15zm5-4.74V9h-4v6h4v-1.25H11v-1.11h2.5v-1.26H11v-1.12zm7 3.74V9h-1.25v4.5h-1.12V10h-1.25v3.5h-1.13V9H14.5v5a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1"></path></svg> <span class=md-ellipsis> New Feature? </span> </a> </li> <li class=md-nav__item> <a href=../../development/pytest/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M2.615 0v.887h3.84V0zm5.022 0v.887h3.842V0zm4.957 0v.887h3.841V0zm4.935 0v.887h3.842V0zM2.447 1.895a.935.935 0 0 0-.935.935c0 .517.418.938.935.938h19.106c.517 0 .935-.42.935-.938a.935.935 0 0 0-.935-.936zm.168 2.847V24h3.84V4.742zm5.022 0v15.801h3.842v-15.8zm4.957 0v10.549h3.85V4.742zm4.935 0v6.494h3.842V4.742z"></path></svg> <span class=md-ellipsis> Pytest </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../includes/tags/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M5.5 7A1.5 1.5 0 0 1 4 5.5 1.5 1.5 0 0 1 5.5 4 1.5 1.5 0 0 1 7 5.5 1.5 1.5 0 0 1 5.5 7m15.91 4.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.11 0-2 .89-2 2v7c0 .55.22 1.05.59 1.41l8.99 9c.37.36.87.59 1.42.59s1.05-.23 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.56-.23-1.06-.59-1.42"></path></svg> <span class=md-ellipsis> Tags </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <nav class=md-tags> <a class="md-tag md-tag-icon" href=../../includes/tags/#tag:algorithms>Algorithms</a> <a class="md-tag md-tag-icon" href=../../includes/tags/#tag:reference>Reference</a> <a class="md-tag md-tag-icon" href=../../includes/tags/#tag:source-code>Source Code</a> </nav> <a class="md-content__button md-icon" href=https://code.europa.eu/pvgis/pvgis.git/edit/mkdocs/docs/source_code/algorithms.md rel=edit title="Edit this page"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg> </a> <a class="md-content__button md-icon" href=https://code.europa.eu/pvgis/pvgis.git/raw/mkdocs/docs/source_code/algorithms.md title="View source of this page"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg> </a> <div><p>PVGIS features an algorithmic repository, independent from the core API, the <abbr title="Command Line Interface">CLI</abbr> and the Web API components.</p> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">algorithms</span> <a class=headerlink href=#pvgisprototype.algorithms title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.faiman title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">faiman</span> (<code>pvgisprototype.algorithms.faiman</code>)'>faiman</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.finkelstein_schafer title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">finkelstein_schafer</span> (<code>pvgisprototype.algorithms.finkelstein_schafer</code>)'>finkelstein_schafer</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hargreaves title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">hargreaves</span> (<code>pvgisprototype.algorithms.hargreaves</code>)'>hargreaves</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">hofierka</span> (<code>pvgisprototype.algorithms.hofierka</code>)'>hofierka</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.huld title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">huld</span> (<code>pvgisprototype.algorithms.huld</code>)'>huld</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.iqbal title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">iqbal</span> (<code>pvgisprototype.algorithms.iqbal</code>)'>iqbal</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.jenco title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">jenco</span> (<code>pvgisprototype.algorithms.jenco</code>)'>jenco</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.martin_ruiz title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">martin_ruiz</span> (<code>pvgisprototype.algorithms.martin_ruiz</code>)'>martin_ruiz</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.milne1921 title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">milne1921</span> (<code>pvgisprototype.algorithms.milne1921</code>)'>milne1921</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">muneer</span> (<code>pvgisprototype.algorithms.muneer</code>)'>muneer</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">noaa</span> (<code>pvgisprototype.algorithms.noaa</code>)'>noaa</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pelland title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">pelland</span> (<code>pvgisprototype.algorithms.pelland</code>)'>pelland</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">pvlib</span> (<code>pvgisprototype.algorithms.pvlib</code>)'>pvlib</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.skyfield title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">skyfield</span> (<code>pvgisprototype.algorithms.skyfield</code>)'>skyfield</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">usno</span> (<code>pvgisprototype.algorithms.usno</code>)'>usno</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.faiman> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">faiman</span> <a class=headerlink href=#pvgisprototype.algorithms.faiman title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.faiman.temperature title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">temperature</span> (<code>pvgisprototype.algorithms.faiman.temperature</code>)'>temperature</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.faiman.temperature> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">temperature</span> <a class=headerlink href=#pvgisprototype.algorithms.faiman.temperature title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.faiman.temperature.calculate_photovoltaic_module_temperature_faiman title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_photovoltaic_module_temperature_faiman</span> (<code>pvgisprototype.algorithms.faiman.temperature.calculate_photovoltaic_module_temperature_faiman</code>)'>calculate_photovoltaic_module_temperature_faiman</a></code></td> <td> <div class=doc-md-description> <p>Calculate photovoltaic module operating temperature using the Faiman</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.faiman.temperature.calculate_photovoltaic_module_temperature_faiman> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_photovoltaic_module_temperature_faiman</span> <a class=headerlink href=#pvgisprototype.algorithms.faiman.temperature.calculate_photovoltaic_module_temperature_faiman title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_photovoltaic_module_temperature_faiman</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>irradiance_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.InclinedIrradiance>InclinedIrradiance</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>temperature_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.TemperatureSeries>TemperatureSeries</span></span> <span class=o>=</span> <span class=n><span title=average_air_temperature>average_air_temperature</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>wind_speed_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.WindSpeedSeries>WindSpeedSeries</span></span> <span class=o>=</span> <span class=n><span title=numpy.array>array</span></span><span class=p>(</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=n><span title=average_wind_speed>average_wind_speed</span></span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=p>),</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.TemperatureSeries>TemperatureSeries</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate photovoltaic module operating temperature using the Faiman thermal model.</p> <p>The Faiman model calculates photovoltaic module operating temperature based on ambient temperature, incident irradiance, and optionally wind speed. It models the thermal balance between absorbed solar radiation and heat loss through convection and radiation.</p> <p><strong>Equations:</strong></p> <p>With wind speed:</p> <p>.. math:: T_{module} = T_{ambient} + \frac{G}{U_0 + U_1 \cdot v_{wind}}</p> <p>Without wind speed (simplified):</p> <p>.. math:: T_{module} = T_{ambient} + k_7 \cdot G</p> <p>Where:</p> <ul> <li>:math:<code>T_{module}</code> is the module operating temperature (C)</li> <li>:math:<code>T_{ambient}</code> is the ambient air temperature (C)</li> <li>:math:<code>G</code> is the incident irradiance on the module plane (W/m)</li> <li>:math:<code>U_0</code> is the constant heat loss factor (W/mK) [coefficient 7]</li> <li>:math:<code>U_1</code> is the convective heat loss factor (W/mK/s) [coefficient 8]</li> <li>:math:<code>v_{wind}</code> is the wind speed (m/s)</li> <li>:math:<code>k_7</code> is the simplified temperature coefficient (Cm/W) [coefficient 7]</li> </ul> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>irradiance_series</code> </td> <td> <code><span title=pvgisprototype.InclinedIrradiance>InclinedIrradiance</span></code> </td> <td> <div class=doc-md-description> <p>The inclined (or incident) solar irradiance series on the module plane (W/m). This represents the total irradiance (global, direct, or effective) reaching the photovoltaic module surface.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>photovoltaic_module_efficiency_coefficients</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/array.html#module-array>array</a> - <span title=like>like</span></code> </td> <td> <div class=doc-md-description> <p>Array of photovoltaic module performance model coefficients. For the Faiman model, requires at least 8 coefficients (without wind) or 9 coefficients (with wind):</p> <ul> <li>Coefficients [0-6]: Other module performance parameters (e.g., King model)</li> <li>Coefficient [7] (U_0 or k_7): Constant heat loss factor (W/mK) or simplified temperature coefficient (Cm/W)</li> <li>Coefficient [8] (U_1): Convective heat loss coefficient (W/mK/s), only required when <code>wind_speed_series</code> is provided</li> </ul> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>temperature_series</code> </td> <td> <code><span title=pvgisprototype.TemperatureSeries>TemperatureSeries</span></code> </td> <td> <div class=doc-md-description> <p>Ambient air temperature series (C). Default uses the average air temperature from the TemperatureSeries data model.</p> </div> </td> <td> <code><span title=average_air_temperature>average_air_temperature</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>wind_speed_series</code> </td> <td> <code><span title=pvgisprototype.WindSpeedSeries>WindSpeedSeries</span></code> </td> <td> <div class=doc-md-description> <p>Wind speed series (m/s) ideally at module height or reference height. When provided, the model accounts for convective cooling. Default is average wind speed from the WindSpeedSeries data model. Set to None to use the simplified model without wind speed dependency.</p> </div> </td> <td> <code><span title=numpy.array>array</span>(<span title=average_wind_speed>average_wind_speed</span>)</code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Data type for numerical arrays. Default is DATA_TYPE_DEFAULT.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Array computation backend (e.g., 'numpy', 'cupy', 'dask'). Default is ARRAY_BACKEND_DEFAULT.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level for debugging output. Higher values produce more detailed output. Default is VERBOSE_LEVEL_DEFAULT.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Logging level for data fingerprinting and traceability. Default is LOG_LEVEL_DEFAULT.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.TemperatureSeries>TemperatureSeries</span></code> </td> <td> <div class=doc-md-description> <p>Adjusted temperature series representing the estimated photovoltaic module operating temperature (C). This accounts for heating due to absorbed solar irradiance and cooling from convection and radiation.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </td> <td> <div class=doc-md-description> <p>If insufficient number of model coefficients are provided for the selected Faiman model variant (8 without wind, 9 with wind).</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The Faiman model is an empirical steady-state thermal model that assumes:</p> <ol> <li>Uniform module temperature across the surface</li> <li>Steady-state heat transfer (no thermal mass effects)</li> <li>Linear relationship between temperature rise and irradiance</li> <li>Wind speed measured at module height or appropriately scaled</li> </ol> <p>The model is particularly useful for:</p> <ul> <li>Hourly or sub-hourly photovoltaic performance modeling</li> <li>Systems without detailed thermal characterization</li> <li>Comparative studies across different locations</li> </ul> <p><strong>Typical coefficient values</strong> (for crystalline silicon modules):</p> <ul> <li>U_0 (constant loss): 25-35 W/mK</li> <li>U_1 (wind loss): 5-15 W/mK/s</li> </ul> </details> <details class=references open> <summary>References</summary> <p>.. [1] Faiman, D. (2008). "Assessing the outdoor operating temperature of photovoltaic modules." Progress in Photovoltaics: Research and Applications, 16(4), 307-315. DOI: 10.1002/<abbr title="Python Package Manager">pip</abbr>.813</p> <p>.. [2] King, D.L., Boyson, W.E., Kratochvil, J.A. (2004). "Photovoltaic Array Performance Model." Sandia Report SAND2004-3535.</p> </details> <p><span class=doc-section-title>Examples:</span></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype</span><span class=w> </span><span class=kn>import</span> <span class=n>TemperatureSeries</span><span class=p>,</span> <span class=n>WindSpeedSeries</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.algorithms.faiman.temperature</span><span class=w> </span><span class=kn>import</span> <span class=n>calculate_photovoltaic_module_temperature_faiman</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>&gt;&gt;&gt;</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Create sample data with explicit float dtype</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ambient_temperature</span> <span class=o>=</span> <span class=n>TemperatureSeries</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>20.0</span><span class=p>,</span> <span class=mf>22.0</span><span class=p>,</span> <span class=mf>25.0</span><span class=p>,</span> <span class=mf>23.0</span><span class=p>]))</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>irradiance</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>800.0</span><span class=p>,</span> <span class=mf>900.0</span><span class=p>,</span> <span class=mf>1000.0</span><span class=p>,</span> <span class=mf>850.0</span><span class=p>])</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>wind_speed</span> <span class=o>=</span> <span class=n>WindSpeedSeries</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>2.0</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>,</span> <span class=mf>1.5</span><span class=p>,</span> <span class=mf>2.5</span><span class=p>]))</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=gp>&gt;&gt;&gt;</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Faiman coefficients (example for cSi module)</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>coefficients</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mf>29.0</span><span class=p>,</span> <span class=mf>8.0</span><span class=p>]</span>  <span class=c1># U_0=29, U_1=8</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=gp>&gt;&gt;&gt;</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Calculate module temperature with wind</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>module_temp</span> <span class=o>=</span> <span class=n>calculate_photovoltaic_module_temperature_faiman</span><span class=p>(</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a><span class=gp>... </span>    <span class=n>irradiance_series</span><span class=o>=</span><span class=n>irradiance</span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a><span class=gp>... </span>    <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=o>=</span><span class=n>coefficients</span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a><span class=gp>... </span>    <span class=n>temperature_series</span><span class=o>=</span><span class=n>ambient_temperature</span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a><span class=gp>... </span>    <span class=n>wind_speed_series</span><span class=o>=</span><span class=n>wind_speed</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a><span class=gp>&gt;&gt;&gt;</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Module temperatures: </span><span class=si>{</span><span class=n>module_temp</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a><span class=gp>&gt;&gt;&gt;</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Without wind (simplified model)</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a><span class=gp>&gt;&gt;&gt; </span><span class=n>coefficients_simple</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mf>0.035</span><span class=p>]</span>  <span class=c1># k_7 coefficient</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a><span class=gp>&gt;&gt;&gt; </span><span class=n>module_temperature_simple</span> <span class=o>=</span> <span class=n>calculate_photovoltaic_module_temperature_faiman</span><span class=p>(</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a><span class=gp>... </span>    <span class=n>irradiance_series</span><span class=o>=</span><span class=n>irradiance</span><span class=p>,</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a><span class=gp>... </span>    <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=o>=</span><span class=n>coefficients_simple</span><span class=p>,</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a><span class=gp>... </span>    <span class=n>temperature_series</span><span class=o>=</span><span class=n>ambient_temperature</span><span class=p>,</span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a><span class=gp>... </span>    <span class=n>wind_speed_series</span><span class=o>=</span><span class=kc>None</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a><span class=gp>&gt;&gt;&gt;</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Module temperatures (simplified): </span><span class=si>{</span><span class=n>module_temperature_simple</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span></code></pre></div> <details class=see-also open> <summary>See Also</summary> <p>TemperatureSeries : Container for temperature time series data WindSpeedSeries : Container for wind speed time series data InclinedIrradiance : Container for inclined irradiance data</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/faiman/temperature.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_photovoltaic_module_temperature_faiman</span><span class=p>(</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a>    <span class=n>irradiance_series</span><span class=p>:</span> <span class=n>InclinedIrradiance</span><span class=p>,</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a>    <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>,</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>    <span class=n>temperature_series</span><span class=p>:</span> <span class=n>TemperatureSeries</span> <span class=o>=</span> <span class=n>TemperatureSeries</span><span class=p>()</span><span class=o>.</span><span class=n>average_air_temperature</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>    <span class=n>wind_speed_series</span><span class=p>:</span> <span class=n>WindSpeedSeries</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>WindSpeedSeries</span><span class=p>()</span><span class=o>.</span><span class=n>average_wind_speed</span><span class=p>),</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>TemperatureSeries</span><span class=p>:</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=sd>    Calculate photovoltaic module operating temperature using the Faiman</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=sd>    thermal model.</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=sd>    The Faiman model calculates photovoltaic module operating temperature based</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>    on ambient temperature, incident irradiance, and optionally wind speed. It</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>    models the thermal balance between absorbed solar radiation and heat loss</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    through convection and radiation.</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    **Equations:**</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    With wind speed:</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    .. math::</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>        T_{module} = T_{ambient} + \\frac{G}{U_0 + U_1 \\cdot v_{wind}}</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    Without wind speed (simplified):</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    .. math::</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>        T_{module} = T_{ambient} + k_7 \\cdot G</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    Where:</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    - :math:`T_{module}` is the module operating temperature (C)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    - :math:`T_{ambient}` is the ambient air temperature (C)</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    - :math:`G` is the incident irradiance on the module plane (W/m)</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    - :math:`U_0` is the constant heat loss factor (W/mK) [coefficient 7]</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    - :math:`U_1` is the convective heat loss factor (W/mK/s) [coefficient 8]</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    - :math:`v_{wind}` is the wind speed (m/s)</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    - :math:`k_7` is the simplified temperature coefficient (Cm/W) [coefficient 7]</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    irradiance_series : InclinedIrradiance</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>        The inclined (or incident) solar irradiance series on the module plane (W/m).</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>        This represents the total irradiance (global, direct, or effective) reaching </span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>        the photovoltaic module surface.</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    photovoltaic_module_efficiency_coefficients : array-like</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>        Array of photovoltaic module performance model coefficients. For the Faiman </span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>        model, requires at least 8 coefficients (without wind) or 9 coefficients </span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>        (with wind):</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>        - Coefficients [0-6]: Other module performance parameters (e.g., King model)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>        - Coefficient [7] (U_0 or k_7): Constant heat loss factor (W/mK) or </span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>          simplified temperature coefficient (Cm/W)</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>        - Coefficient [8] (U_1): Convective heat loss coefficient (W/mK/s), </span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>          only required when `wind_speed_series` is provided</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    temperature_series : TemperatureSeries, optional</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>        Ambient air temperature series (C). Default uses the average air temperature </span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>        from the TemperatureSeries data model.</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    wind_speed_series : WindSpeedSeries, optional</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        Wind speed series (m/s) ideally at module height or reference height.</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>        When provided, the model accounts for convective cooling. Default is</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>        average wind speed from the WindSpeedSeries data model. Set to None to</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>        use the simplified model without wind speed dependency.</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>        Data type for numerical arrays. Default is DATA_TYPE_DEFAULT.</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>        Array computation backend (e.g., 'numpy', 'cupy', 'dask'). </span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>        Default is ARRAY_BACKEND_DEFAULT.</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>        Verbosity level for debugging output. Higher values produce more detailed </span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>        output. Default is VERBOSE_LEVEL_DEFAULT.</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>        Logging level for data fingerprinting and traceability. </span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>        Default is LOG_LEVEL_DEFAULT.</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    TemperatureSeries</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>        Adjusted temperature series representing the estimated photovoltaic</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>        module operating temperature (C). This accounts for heating due to</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>        absorbed solar irradiance and cooling from convection and radiation.</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>    Raises</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>    ------</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>    ValueError</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>        If insufficient number of model coefficients are provided for the</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>        selected Faiman model variant (8 without wind, 9 with wind).</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>    The Faiman model is an empirical steady-state thermal model that assumes:</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>    1. Uniform module temperature across the surface</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>    2. Steady-state heat transfer (no thermal mass effects)</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>    3. Linear relationship between temperature rise and irradiance</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>    4. Wind speed measured at module height or appropriately scaled</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=sd>    The model is particularly useful for:</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=sd>    - Hourly or sub-hourly photovoltaic performance modeling</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a><span class=sd>    - Systems without detailed thermal characterization</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a><span class=sd>    - Comparative studies across different locations</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a><span class=sd>    **Typical coefficient values** (for crystalline silicon modules):</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a><span class=sd>    - U_0 (constant loss): 25-35 W/mK</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=sd>    - U_1 (wind loss): 5-15 W/mK/s</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>    .. [1] Faiman, D. (2008). "Assessing the outdoor operating temperature of </span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=sd>           photovoltaic modules." Progress in Photovoltaics: Research and </span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>           Applications, 16(4), 307-315. DOI: 10.1002/pip.813</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=sd>    .. [2] King, D.L., Boyson, W.E., Kratochvil, J.A. (2004). "Photovoltaic Array </span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a><span class=sd>           Performance Model." Sandia Report SAND2004-3535.</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=sd>    &gt;&gt;&gt; import numpy as np</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype import TemperatureSeries, WindSpeedSeries</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.algorithms.faiman.temperature import calculate_photovoltaic_module_temperature_faiman</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a><span class=sd>    &gt;&gt;&gt;</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=sd>    &gt;&gt;&gt; # Create sample data with explicit float dtype</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a><span class=sd>    &gt;&gt;&gt; ambient_temperature = TemperatureSeries(value=np.array([20.0, 22.0, 25.0, 23.0]))</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a><span class=sd>    &gt;&gt;&gt; irradiance = np.array([800.0, 900.0, 1000.0, 850.0])</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=sd>    &gt;&gt;&gt; wind_speed = WindSpeedSeries(value=np.array([2.0, 3.0, 1.5, 2.5]))</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a><span class=sd>    &gt;&gt;&gt;</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a><span class=sd>    &gt;&gt;&gt; # Faiman coefficients (example for cSi module)</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a><span class=sd>    &gt;&gt;&gt; coefficients = [0, 0, 0, 0, 0, 0, 0, 29.0, 8.0]  # U_0=29, U_1=8</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a><span class=sd>    &gt;&gt;&gt;</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>    &gt;&gt;&gt; # Calculate module temperature with wind</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>    &gt;&gt;&gt; module_temp = calculate_photovoltaic_module_temperature_faiman(</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=sd>    ...     irradiance_series=irradiance,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a><span class=sd>    ...     photovoltaic_module_efficiency_coefficients=coefficients,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a><span class=sd>    ...     temperature_series=ambient_temperature,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>    ...     wind_speed_series=wind_speed</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=sd>    &gt;&gt;&gt;</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"Module temperatures: {module_temp.value}")</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>    &gt;&gt;&gt;</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=sd>    &gt;&gt;&gt; # Without wind (simplified model)</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>    &gt;&gt;&gt; coefficients_simple = [0, 0, 0, 0, 0, 0, 0, 0.035]  # k_7 coefficient</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>    &gt;&gt;&gt; module_temperature_simple = calculate_photovoltaic_module_temperature_faiman(</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a><span class=sd>    ...     irradiance_series=irradiance,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a><span class=sd>    ...     photovoltaic_module_efficiency_coefficients=coefficients_simple,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=sd>    ...     temperature_series=ambient_temperature,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a><span class=sd>    ...     wind_speed_series=None</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a><span class=sd>    &gt;&gt;&gt;</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"Module temperatures (simplified): {module_temperature_simple.value}")</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>    See Also</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>    TemperatureSeries : Container for temperature time series data</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a><span class=sd>    WindSpeedSeries : Container for wind speed time series data</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a><span class=sd>    InclinedIrradiance : Container for inclined irradiance data</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>    <span class=n>temperature_adjusted_series</span> <span class=o>=</span> <span class=n>deepcopy</span><span class=p>(</span><span class=n>temperature_series</span><span class=p>)</span>  <span class=c1># Safe !</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>    <span class=k>if</span> <span class=n>wind_speed_series</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=n>expected_number_of_coefficients</span> <span class=o>=</span> <span class=mi>9</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>        <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>            <span class=nb>len</span><span class=p>(</span><span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>)</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>            <span class=o>&lt;</span> <span class=n>expected_number_of_coefficients</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>        <span class=p>):</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>            <span class=k>return</span> <span class=s2>"Insufficient number of model constants for Faiman model with wind speed."</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>        <span class=c1># temperature_adjusted_series = ... # safer !</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>        <span class=n>temperature_adjusted_series</span><span class=o>.</span><span class=n>value</span> <span class=o>+=</span> <span class=n>irradiance_series</span> <span class=o>/</span> <span class=p>(</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>            <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>            <span class=o>+</span> <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>            <span class=o>*</span> <span class=n>wind_speed_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>        <span class=n>expected_number_of_coefficients</span> <span class=o>=</span> <span class=mi>8</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>        <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>            <span class=nb>len</span><span class=p>(</span><span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>)</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>            <span class=o>&lt;</span> <span class=n>expected_number_of_coefficients</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>        <span class=p>):</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>            <span class=k>return</span> <span class=s2>"Insufficient number of model constants for Faiman model."</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>        <span class=n>temperature_adjusted_series</span><span class=o>.</span><span class=n>value</span> <span class=o>+=</span> <span class=p>(</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>            <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>*</span> <span class=n>irradiance_series</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>temperature_adjusted_series</span><span class=p>,</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>    <span class=n>temperature_adjusted_series</span><span class=o>.</span><span class=n>data_source</span> <span class=o>=</span> <span class=s1>'Faiman 2008'</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>    <span class=c1># temperature_adjusted_series.photovoltaic_module_operating_temperature = True</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>    <span class=c1># temperature_adjusted_series.air_temperature = False</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>    <span class=k>return</span> <span class=n>temperature_adjusted_series</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.finkelstein_schafer> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">finkelstein_schafer</span> <a class=headerlink href=#pvgisprototype.algorithms.finkelstein_schafer title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">cumulative_distribution</span> (<code>pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution</code>)'>cumulative_distribution</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.finkelstein_schafer.statistics title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">statistics</span> (<code>pvgisprototype.algorithms.finkelstein_schafer.statistics</code>)'>statistics</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.finkelstein_schafer.univariate_statistics title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">univariate_statistics</span> (<code>pvgisprototype.algorithms.finkelstein_schafer.univariate_statistics</code>)'>univariate_statistics</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">cumulative_distribution</span> <a class=headerlink href=#pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_ecdf title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_ecdf</span> (<code>pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_ecdf</code>)'>calculate_ecdf</a></code></td> <td> <div class=doc-md-description> <p>Calculate the empirical cumulative distribution function (CDF) of the data, ensuring unique coordinates.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_long_term_monthly_ecdfs title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_long_term_monthly_ecdfs</span> (<code>pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_long_term_monthly_ecdfs</code>)'>calculate_long_term_monthly_ecdfs</a></code></td> <td> <div class=doc-md-description> <p>Calculate the long-term CDF for each month.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_yearly_monthly_ecdfs title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_yearly_monthly_ecdfs</span> (<code>pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_yearly_monthly_ecdfs</code>)'>calculate_yearly_monthly_ecdfs</a></code></td> <td> <div class=doc-md-description> <p>Calculate monthly CDFs for each variable for each month and year.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_ecdf> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_ecdf</span> <a class=headerlink href=#pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_ecdf title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_ecdf</span><span class=p>(</span><span class=n>sample</span><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the empirical cumulative distribution function (CDF) of the data, ensuring unique coordinates.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/finkelstein_schafer/cumulative_distribution.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_ecdf</span><span class=p>(</span><span class=n>sample</span><span class=p>):</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=sd>"""Calculate the empirical cumulative distribution function (CDF) of the data, ensuring unique coordinates."""</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a>    <span class=kn>from</span><span class=w> </span><span class=nn>scipy.stats</span><span class=w> </span><span class=kn>import</span> <span class=n>ecdf</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>    <span class=n>ecdfs</span> <span class=o>=</span> <span class=n>ecdf</span><span class=p>(</span><span class=n>sample</span><span class=p>)</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>    <span class=k>return</span> <span class=n>DataArray</span><span class=p>(</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a>        <span class=n>ecdfs</span><span class=o>.</span><span class=n>cdf</span><span class=o>.</span><span class=n>probabilities</span><span class=p>,</span> <span class=n>coords</span><span class=o>=</span><span class=p>[</span><span class=n>ecdfs</span><span class=o>.</span><span class=n>cdf</span><span class=o>.</span><span class=n>quantiles</span><span class=p>],</span> <span class=n>dims</span><span class=o>=</span><span class=p>[</span><span class=s2>"quantile"</span><span class=p>]</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_long_term_monthly_ecdfs> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_long_term_monthly_ecdfs</span> <a class=headerlink href=#pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_long_term_monthly_ecdfs title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_long_term_monthly_ecdfs</span><span class=p>(</span><span class=n>dataset</span><span class=p>,</span> <span class=n>variable</span><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the long-term CDF for each month.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/finkelstein_schafer/cumulative_distribution.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_long_term_monthly_ecdfs</span><span class=p>(</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>    <span class=n>dataset</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>    <span class=n>variable</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a><span class=p>):</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=sd>"""Calculate the long-term CDF for each month."""</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>    <span class=k>return</span> <span class=n>dataset</span><span class=p>[</span><span class=n>variable</span><span class=p>]</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s2>"time.month"</span><span class=p>)</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>calculate_ecdf</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_yearly_monthly_ecdfs> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_yearly_monthly_ecdfs</span> <a class=headerlink href=#pvgisprototype.algorithms.finkelstein_schafer.cumulative_distribution.calculate_yearly_monthly_ecdfs title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_yearly_monthly_ecdfs</span><span class=p>(</span><span class=n>dataset</span><span class=p>,</span> <span class=n>variable</span><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate monthly CDFs for each variable for each month and year.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/finkelstein_schafer/cumulative_distribution.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_yearly_monthly_ecdfs</span><span class=p>(</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a>    <span class=n>dataset</span><span class=p>,</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>    <span class=n>variable</span><span class=p>,</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a><span class=p>):</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=sd>"""Calculate monthly CDFs for each variable for each month and year."""</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>    <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>        <span class=n>dataset</span><span class=p>[</span><span class=n>variable</span><span class=p>]</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>        <span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s2>"time.year"</span><span class=p>)</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>        <span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s2>"time.month"</span><span class=p>)</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>y</span><span class=p>:</span> <span class=n>calculate_ecdf</span><span class=p>(</span><span class=n>y</span><span class=p>)))</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.finkelstein_schafer.statistics> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">statistics</span> <a class=headerlink href=#pvgisprototype.algorithms.finkelstein_schafer.statistics title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.finkelstein_schafer.statistics.align_and_broadcast title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">align_and_broadcast</span> (<code>pvgisprototype.algorithms.finkelstein_schafer.statistics.align_and_broadcast</code>)'>align_and_broadcast</a></code></td> <td> <div class=doc-md-description> <p>Expand dimensions and broadcast a data array to match the structure of a</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.finkelstein_schafer.statistics.calculate_finkelstein_schafer_statistics title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_finkelstein_schafer_statistics</span> (<code>pvgisprototype.algorithms.finkelstein_schafer.statistics.calculate_finkelstein_schafer_statistics</code>)'>calculate_finkelstein_schafer_statistics</a></code></td> <td> <div class=doc-md-description> <p>Calculate Finkelstein-Schafer statistics for typical meteorological year</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.finkelstein_schafer.statistics.align_and_broadcast> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">align_and_broadcast</span> <a class=headerlink href=#pvgisprototype.algorithms.finkelstein_schafer.statistics.align_and_broadcast title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>align_and_broadcast</span><span class=p>(</span><span class=n>data_array</span><span class=p>,</span> <span class=n>reference_array</span><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Expand dimensions and broadcast a data array to match the structure of a template array.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data_array</code> </td> <td> </td> <td> <div class=doc-md-description> <p>The data array that needs to be aligned and broadcasted.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>template_array</code> </td> <td> </td> <td> <div class=doc-md-description> <p>The array providing the structure to which data_array should be aligned.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>xarray.DataArray: The broadcasted data array with the same structure as the</code> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td> <code>template_array.</code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/finkelstein_schafer/statistics.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>align_and_broadcast</span><span class=p>(</span><span class=n>data_array</span><span class=p>,</span> <span class=n>reference_array</span><span class=p>):</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=sd>"""Expand dimensions and broadcast a data array to match the structure of a</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a><span class=sd>    template array.</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a><span class=sd>    data_array: xarray.DataArray</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a><span class=sd>        The data array that needs to be aligned and broadcasted.</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a><span class=sd>    template_array: xarray.DataArray</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a><span class=sd>        The array providing the structure to which data_array should be aligned.</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a><span class=sd>    xarray.DataArray: The broadcasted data array with the same structure as the</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a><span class=sd>    template_array.</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>    <span class=k>return</span> <span class=n>data_array</span><span class=o>.</span><span class=n>expand_dims</span><span class=p>(</span><span class=n>year</span><span class=o>=</span><span class=n>reference_array</span><span class=o>.</span><span class=n>year</span><span class=p>)</span><span class=o>.</span><span class=n>broadcast_like</span><span class=p>(</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>        <span class=n>reference_array</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.finkelstein_schafer.statistics.calculate_finkelstein_schafer_statistics> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_finkelstein_schafer_statistics</span> <a class=headerlink href=#pvgisprototype.algorithms.finkelstein_schafer.statistics.calculate_finkelstein_schafer_statistics title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_finkelstein_schafer_statistics</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>location_series_data_array</span><span class=p>:</span> <span class=n><span title=xarray.DataArray>DataArray</span></span> <span class=o>|</span> <span class=n><span title=xarray.Dataset>Dataset</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a></span><span class=p>[</span><span class=n><span title=xarray.DataArray>DataArray</span></span><span class=p>,</span> <span class=n><span title=xarray.Dataset>Dataset</span></span><span class=p>,</span> <span class=n><span title=xarray.DataArray>DataArray</span></span><span class=p>,</span> <span class=n><span title=xarray.DataArray>DataArray</span></span><span class=p>]</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate Finkelstein-Schafer statistics for typical meteorological year selection.</p> <p>The Finkelstein-Schafer (FS) statistic quantifies how well a candidate month represents the long-term climate by comparing its cumulative distribution function (CDF) to the multi-year average CDF. Lower FS values indicate months that are more representative of typical conditions.</p> <p>This implementation follows the ISO 15927-4:2005 standard for determining typical meteorological data and the methodology described in Hall et al. (1978) [1]_.</p> <details class=algorithm open> <summary>Algorithm</summary> <p>The Finkelstein-Schafer statistic is computed through the following steps:</p> <ol> <li> <p><strong>Daily aggregation</strong>: Calculate daily mean values from sub-daily (e.g., hourly) time series data.</p> </li> <li> <p><strong>Long-term CDF</strong>: For each calendar month <em>m</em>, compute the empirical cumulative distribution function :math:<code>\phi(q, m)</code> using daily values aggregated across all years in the dataset.</p> </li> <li> <p><strong>Yearly CDFs</strong>: For each calendar month <em>m</em> and year <em>y</em> for a quantity <em>q</em>, compute the empirical cumulative distribution function :math:<code>F(q, m, y)</code> using only the daily values from that specific month and year.</p> </li> <li> <p><strong>Finkelstein-Schafer statistic</strong>: For each month <em>m</em> and year <em>y</em> for a quantity <em>q</em>, calculate the Finkelstein-Schafer statistic by integrating the absolute difference between the yearly and long-term CDFs:</p> </li> </ol> <p>.. math::</p> <div class=codehilite><pre><span></span><code>   FS(q, m, y) = \sum_{i} |F(q_i, m, y) - \phi(q_i, m)|
</code></pre></div> <p>where the summation is over all quantile values :math:<code>q_i</code> in the distribution.</p> <ol> <li><strong>Ranking</strong>: For each calendar month <em>m</em> for the quantity <em>q</em>, candidate months from different years are ranked by increasing Finkelstein-Schafer statistic FS(q, m, y). Lower values indicate months that better represent typical conditions.</li> </ol> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>location_series_data_array</code> </td> <td> <code><span title=xarray.DataArray>DataArray</span> or <span title=xarray.Dataset>Dataset</span></code> </td> <td> <div class=doc-md-description> <p>Time series meteorological data with a temporal dimension (typically hourly or sub-daily resolution). The data should span multiple years to enable meaningful long-term statistics. Acceptable formats include:</p> <ul> <li><code>xarray.DataArray</code>: Single variable time series</li> <li><code>xarray.Dataset</code>: Multi-variable time series</li> </ul> <p>The time coordinate should be datetime-like and parseable by pandas.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>finkelstein_schafer_statistic</code></td> <td> <code><span title=xarray.DataArray>DataArray</span></code> </td> <td> <div class=doc-md-description> <p>The computed Finkelstein-Schafer statistic with dimensions <code>(month, year)</code>, where:</p> <ul> <li><code>month</code>: Calendar month (1-12)</li> <li><code>year</code>: Individual years in the input dataset</li> </ul> <p>Lower values indicate months that better represent long-term typical conditions.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>daily_statistics</code></td> <td> <code><span title=xarray.Dataset>Dataset</span></code> </td> <td> <div class=doc-md-description> <p>Daily aggregated statistics including mean, min, max, and std computed from the input time series. Contains dimensions <code>(time,)</code> where time represents daily timestamps.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>yearly_monthly_ecdfs</code></td> <td> <code><span title=xarray.DataArray>DataArray</span></code> </td> <td> <div class=doc-md-description> <p>Empirical cumulative distribution functions for each individual month-year combination. Dimensions: <code>(month, year, quantile)</code>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>long_term_monthly_ecdfs</code></td> <td> <code><span title=xarray.DataArray>DataArray</span></code> </td> <td> <div class=doc-md-description> <p>Long-term empirical cumulative distribution functions computed across all years for each calendar month. Dimensions: <code>(month, quantile)</code>.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The Finkelstein-Schafer statistic is a non-parametric measure that:</p> <ul> <li>Does <strong>not</strong> assume any particular distribution shape (e.g., normal, uniform) Accounts for the <strong>entire distribution</strong>, not just central tendency (mean/median)</li> <li>Is robust to outliers and extreme values</li> <li>Enables objective selection of typical months based on distributional similarity</li> </ul> <p><strong>Typical use case</strong>: This function is the core computational step in generating Typical Meteorological Year (TMY) datasets. After computing FS statistics for multiple meteorological variables (temperature, irradiance, humidity, wind speed), a weighted sum across variables is used to select the most representative month for each calendar month position in the TMY.</p> <p><strong>Data requirements</strong>:</p> <ul> <li>Minimum 5-10 years of data recommended for stable statistics</li> <li>Complete or near-complete temporal coverage (missing data impacts CDF accuracy)</li> <li>Sub-daily resolution (hourly preferred) to capture diurnal patterns</li> </ul> </details> <details class=references open> <summary>References</summary> <p>.. [1] Hall, I. J., Prairie, R. R., Anderson, H. E., &amp; Boes, E. C. (1978). "Generation of a Typical Meteorological Year." Proceedings of the 1978 Annual Meeting of the American Section of the International Solar Energy Society (AS/ISES), Denver, CO.</p> <p>.. [2] ISO 15927-4:2005. "Hygrothermal performance of buildings - Calculation and presentation of climatic data - Part 4: Hourly data for assessing the annual energy use for heating and cooling."</p> <p>.. [3] Wilcox, S., &amp; Marion, W. (2008). "Users Manual for TMY3 Data Sets." Technical Report NREL/TP-581-43156, National Renewable Energy Laboratory.</p> </details> <p><span class=doc-section-title>Examples:</span></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>xarray</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>xr</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.algorithms.finkelstein_schafer.statistics</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=gp>... </span>    <span class=n>calculate_finkelstein_schafer_statistics</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=gp>&gt;&gt;&gt; </span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Create sample hourly temperature data for 3 years</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>time</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>'2015-01-01'</span><span class=p>,</span> <span class=s1>'2017-12-31 23:00'</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>'H'</span><span class=p>)</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>temperature</span> <span class=o>=</span> <span class=mi>15</span> <span class=o>+</span> <span class=mi>10</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>time</span><span class=p>))</span> <span class=o>/</span> <span class=p>(</span><span class=mf>365.25</span> <span class=o>*</span> <span class=mi>24</span><span class=p>))</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>temperature</span> <span class=o>+=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>time</span><span class=p>))</span>  <span class=c1># Add noise</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=gp>&gt;&gt;&gt; </span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>xr</span><span class=o>.</span><span class=n>DataArray</span><span class=p>(</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a><span class=gp>... </span>    <span class=n>temperature</span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a><span class=gp>... </span>    <span class=n>coords</span><span class=o>=</span><span class=p>{</span><span class=s1>'time'</span><span class=p>:</span> <span class=n>time</span><span class=p>},</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a><span class=gp>... </span>    <span class=n>dims</span><span class=o>=</span><span class=p>[</span><span class=s1>'time'</span><span class=p>],</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a><span class=gp>... </span>    <span class=n>name</span><span class=o>=</span><span class=s1>'temperature'</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a><span class=gp>&gt;&gt;&gt; </span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Calculate Finkelstein-Schafer statistics</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fs_statistics</span><span class=p>,</span> <span class=n>daily_statistics</span><span class=p>,</span> <span class=n>yearly_ecdfs</span><span class=p>,</span> <span class=n>long_term_ecdfs</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a><span class=gp>... </span>    <span class=n>calculate_finkelstein_schafer_statistics</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a><span class=gp>&gt;&gt;&gt; </span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Find the most representative January across all years</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a><span class=gp>&gt;&gt;&gt; </span><span class=n>january_fs</span> <span class=o>=</span> <span class=n>fs_stat</span><span class=o>.</span><span class=n>sel</span><span class=p>(</span><span class=n>month</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a><span class=gp>&gt;&gt;&gt; </span><span class=n>best_january_year</span> <span class=o>=</span> <span class=n>january_fs</span><span class=o>.</span><span class=n>idxmin</span><span class=p>(</span><span class=n>dim</span><span class=o>=</span><span class=s1>'year'</span><span class=p>)</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Most typical January: </span><span class=si>{</span><span class=n>best_january_year</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"FS statistic: </span><span class=si>{</span><span class=n>january_fs</span><span class=o>.</span><span class=n>min</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span></code></pre></div> <details class=see-also open> <summary>See Also</summary> <ul> <li>calculate_daily_univariate_statistics() : Compute daily statistics from sub-daily data</li> <li>calculate_yearly_monthly_ecdfs() : Compute yearly-monthly empirical CDFs</li> <li>calculate_long_term_monthly_ecdfs() : Compute long-term monthly empirical CDFs</li> <li>align_and_broadcast() : Align arrays for element-wise operations</li> </ul> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/finkelstein_schafer/statistics.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_finkelstein_schafer_statistics</span><span class=p>(</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>location_series_data_array</span><span class=p>:</span> <span class=n>DataArray</span> <span class=o>|</span> <span class=n>Dataset</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>DataArray</span><span class=p>,</span> <span class=n>Dataset</span><span class=p>,</span> <span class=n>DataArray</span><span class=p>,</span> <span class=n>DataArray</span><span class=p>]:</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    Calculate Finkelstein-Schafer statistics for typical meteorological year</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    selection.</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    The Finkelstein-Schafer (FS) statistic quantifies how well a candidate</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    month represents the long-term climate by comparing its cumulative</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    distribution function (CDF) to the multi-year average CDF. Lower FS values</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    indicate months that are more representative of typical conditions.</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    This implementation follows the ISO 15927-4:2005 standard for determining </span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    typical meteorological data and the methodology described in Hall et al.</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    (1978) [1]_.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    Algorithm</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    ---------</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    The Finkelstein-Schafer statistic is computed through the following steps:</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    1. **Daily aggregation**: Calculate daily mean values from sub-daily </span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>       (e.g., hourly) time series data.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    2. **Long-term CDF**: For each calendar month *m*, compute the empirical </span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>       cumulative distribution function :math:`\\phi(q, m)` using daily values </span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>       aggregated across all years in the dataset.</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    3. **Yearly CDFs**: For each calendar month *m* and year *y* for a quantity</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>       *q*, compute the empirical cumulative distribution function</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>       :math:`F(q, m, y)` using only the daily values from that specific month</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>       and year.</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    4. **Finkelstein-Schafer statistic**: For each month *m* and year *y* for a</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>       quantity *q*, calculate the Finkelstein-Schafer statistic by integrating</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>       the absolute difference between the yearly and long-term CDFs:</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>       .. math::</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>           FS(q, m, y) = \\sum_{i} |F(q_i, m, y) - \\phi(q_i, m)|</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>       where the summation is over all quantile values :math:`q_i` in the</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>       distribution.</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    5. **Ranking**: For each calendar month *m* for the quantity *q*, candidate</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>       months from different years are ranked by increasing Finkelstein-Schafer</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>       statistic FS(q, m, y). Lower values indicate months that better</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>       represent typical conditions.</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    location_series_data_array : DataArray or Dataset</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        Time series meteorological data with a temporal dimension (typically</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>        hourly or sub-daily resolution). The data should span multiple years to</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>        enable meaningful long-term statistics. Acceptable formats include:</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>        - ``xarray.DataArray``: Single variable time series</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>        - ``xarray.Dataset``: Multi-variable time series</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>        The time coordinate should be datetime-like and parseable by pandas.</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>    finkelstein_schafer_statistic : xarray.DataArray</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>        The computed Finkelstein-Schafer statistic with dimensions ``(month,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>        year)``, where:</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>        - ``month``: Calendar month (1-12)</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>        - ``year``: Individual years in the input dataset</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>        Lower values indicate months that better represent long-term typical</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>        conditions.</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    daily_statistics : xarray.Dataset</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>        Daily aggregated statistics including mean, min, max, and std computed</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>        from the input time series. Contains dimensions ``(time,)`` where time</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>        represents daily timestamps.</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    yearly_monthly_ecdfs : xarray.DataArray</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>        Empirical cumulative distribution functions for each individual</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>        month-year combination. Dimensions: ``(month, year, quantile)``.</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>    long_term_monthly_ecdfs : xarray.DataArray</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>        Long-term empirical cumulative distribution functions computed across</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>        all years for each calendar month. Dimensions: ``(month, quantile)``.</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>    The Finkelstein-Schafer statistic is a non-parametric measure that:</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>    - Does **not** assume any particular distribution shape (e.g., normal,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>      uniform) Accounts for the **entire distribution**, not just central</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>      tendency (mean/median)</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=sd>    - Is robust to outliers and extreme values</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=sd>    - Enables objective selection of typical months based on distributional</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a><span class=sd>      similarity</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a><span class=sd>    **Typical use case**: This function is the core computational step in</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a><span class=sd>    generating Typical Meteorological Year (TMY) datasets. After computing FS</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a><span class=sd>    statistics for multiple meteorological variables (temperature, irradiance,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a><span class=sd>    humidity, wind speed), a weighted sum across variables is used to select</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=sd>    the most representative month for each calendar month position in the TMY.</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=sd>    **Data requirements**:</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=sd>    - Minimum 5-10 years of data recommended for stable statistics</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=sd>    - Complete or near-complete temporal coverage (missing data impacts CDF</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>      accuracy)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=sd>    - Sub-daily resolution (hourly preferred) to capture diurnal patterns</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a><span class=sd>    .. [1] Hall, I. J., Prairie, R. R., Anderson, H. E., &amp; Boes, E. C. (1978). </span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=sd>           "Generation of a Typical Meteorological Year." Proceedings of the</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a><span class=sd>           1978 Annual Meeting of the American Section of the International</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=sd>           Solar Energy Society (AS/ISES), Denver, CO.</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a><span class=sd>    .. [2] ISO 15927-4:2005. "Hygrothermal performance of buildings -</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a><span class=sd>           Calculation and presentation of climatic data - Part 4: Hourly data</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a><span class=sd>           for assessing the annual energy use for heating and cooling."</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a><span class=sd>    .. [3] Wilcox, S., &amp; Marion, W. (2008). "Users Manual for TMY3 Data Sets." </span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a><span class=sd>           Technical Report NREL/TP-581-43156, National Renewable Energy</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=sd>           Laboratory.</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a><span class=sd>    &gt;&gt;&gt; import xarray as xr</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>    &gt;&gt;&gt; import numpy as np</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>    &gt;&gt;&gt; import pandas as pd</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.algorithms.finkelstein_schafer.statistics import (</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a><span class=sd>    ...     calculate_finkelstein_schafer_statistics</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>    &gt;&gt;&gt; </span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=sd>    &gt;&gt;&gt; # Create sample hourly temperature data for 3 years</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=sd>    &gt;&gt;&gt; time = pd.date_range('2015-01-01', '2017-12-31 23:00', freq='H')</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a><span class=sd>    &gt;&gt;&gt; temperature = 15 + 10 * np.sin(2 * np.pi * np.arange(len(time)) / (365.25 * 24))</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>    &gt;&gt;&gt; temperature += np.random.normal(0, 2, len(time))  # Add noise</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=sd>    &gt;&gt;&gt; </span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>    &gt;&gt;&gt; data = xr.DataArray(</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>    ...     temperature,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a><span class=sd>    ...     coords={'time': time},</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a><span class=sd>    ...     dims=['time'],</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=sd>    ...     name='temperature'</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>    &gt;&gt;&gt; </span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a><span class=sd>    &gt;&gt;&gt; # Calculate Finkelstein-Schafer statistics</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a><span class=sd>    &gt;&gt;&gt; fs_statistics, daily_statistics, yearly_ecdfs, long_term_ecdfs = (</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a><span class=sd>    ...     calculate_finkelstein_schafer_statistics(data)</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a><span class=sd>    &gt;&gt;&gt; </span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>    &gt;&gt;&gt; # Find the most representative January across all years</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a><span class=sd>    &gt;&gt;&gt; january_fs = fs_stat.sel(month=1)</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a><span class=sd>    &gt;&gt;&gt; best_january_year = january_fs.idxmin(dim='year').values</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"Most typical January: {best_january_year}")  # doctest: +SKIP</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"FS statistic: {january_fs.min().values:.3f}")  # doctest: +SKIP</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a><span class=sd>    See Also</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a><span class=sd>    - calculate_daily_univariate_statistics() : Compute daily statistics from sub-daily data</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=sd>    - calculate_yearly_monthly_ecdfs() : Compute yearly-monthly empirical CDFs</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a><span class=sd>    - calculate_long_term_monthly_ecdfs() : Compute long-term monthly empirical CDFs</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=sd>    - align_and_broadcast() : Align arrays for element-wise operations</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>    <span class=c1># 1. Calculate daily means from hourly values</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>    <span class=n>daily_statistics</span> <span class=o>=</span> <span class=n>calculate_daily_univariate_statistics</span><span class=p>(</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>        <span class=n>data_array</span><span class=o>=</span><span class=n>location_series_data_array</span><span class=p>,</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>    <span class=c1># 2. Calculate yearly-monthly ECDFs: F(q, m, y)</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>    <span class=n>yearly_monthly_ecdfs</span> <span class=o>=</span> <span class=n>calculate_yearly_monthly_ecdfs</span><span class=p>(</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>        <span class=n>dataset</span><span class=o>=</span><span class=n>daily_statistics</span><span class=p>,</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>        <span class=n>variable</span><span class=o>=</span><span class=s2>"mean"</span><span class=p>,</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>    <span class=c1># 3. Calculate long-term monthly ECDFs: (q, m)</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>    <span class=n>long_term_monthly_ecdfs</span> <span class=o>=</span> <span class=n>calculate_long_term_monthly_ecdfs</span><span class=p>(</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>        <span class=n>dataset</span><span class=o>=</span><span class=n>daily_statistics</span><span class=p>,</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>        <span class=n>variable</span><span class=o>=</span><span class=s2>"mean"</span><span class=p>,</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>    <span class=c1># 4. Align long-term ECDFs to yearly-monthly structure for subtraction</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>    <span class=n>aligned_long_term_monthly_ecdfs</span> <span class=o>=</span> <span class=n>align_and_broadcast</span><span class=p>(</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>        <span class=n>long_term_monthly_ecdfs</span><span class=p>,</span> <span class=n>yearly_monthly_ecdfs</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>    <span class=c1># 5. Calculate FS statistic: |F(q,m,y) - (q,m)|</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>    <span class=n>finkelstein_schafer_statistic</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>        <span class=n>yearly_monthly_ecdfs</span> <span class=o>-</span> <span class=n>aligned_long_term_monthly_ecdfs</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dim</span><span class=o>=</span><span class=s2>"quantile"</span><span class=p>)</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>    <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>        <span class=n>finkelstein_schafer_statistic</span><span class=p>,</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>        <span class=n>daily_statistics</span><span class=p>,</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>        <span class=n>yearly_monthly_ecdfs</span><span class=p>,</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>        <span class=n>long_term_monthly_ecdfs</span><span class=p>,</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.finkelstein_schafer.univariate_statistics> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">univariate_statistics</span> <a class=headerlink href=#pvgisprototype.algorithms.finkelstein_schafer.univariate_statistics title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.finkelstein_schafer.univariate_statistics.calculate_daily_univariate_statistics title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_daily_univariate_statistics</span> (<code>pvgisprototype.algorithms.finkelstein_schafer.univariate_statistics.calculate_daily_univariate_statistics</code>)'>calculate_daily_univariate_statistics</a></code></td> <td> <div class=doc-md-description> <p>Calculate daily maximum, minimum, and mean for each variable in the dataset using pandas.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.finkelstein_schafer.univariate_statistics.calculate_daily_univariate_statistics> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_daily_univariate_statistics</span> <a class=headerlink href=#pvgisprototype.algorithms.finkelstein_schafer.univariate_statistics.calculate_daily_univariate_statistics title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_daily_univariate_statistics</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>data_array</span><span class=p>:</span> <span class=n><span title=xarray.DataArray>DataArray</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=xarray.Dataset>Dataset</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate daily maximum, minimum, and mean for each variable in the dataset using pandas. Preserves latitude (lat) and longitude (lon) coordinates of the original data.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/finkelstein_schafer/univariate_statistics.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_daily_univariate_statistics</span><span class=p>(</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a>    <span class=n>data_array</span><span class=p>:</span> <span class=n>DataArray</span><span class=p>,</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dataset</span><span class=p>:</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a><span class=sd>    Calculate daily maximum, minimum, and mean for each variable in the dataset using pandas.</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a><span class=sd>    Preserves latitude (lat) and longitude (lon) coordinates of the original data.</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a>    <span class=c1># Convert xarray DataArray to pandas DataFrame and resample to daily frequency and compute statistics</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a>    <span class=n>daily_statistics</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a>        <span class=n>data_array</span><span class=o>.</span><span class=n>to_dataframe</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>"value"</span><span class=p>)</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s2>"1D"</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>([</span><span class=s2>"max"</span><span class=p>,</span> <span class=s2>"min"</span><span class=p>,</span> <span class=s2>"mean"</span><span class=p>])</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a>    <span class=c1># Extract lat/lon from the original data_array</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>    <span class=n>lat</span> <span class=o>=</span> <span class=n>data_array</span><span class=o>.</span><span class=n>coords</span><span class=p>[</span><span class=s2>"lat"</span><span class=p>]</span><span class=o>.</span><span class=n>values</span> <span class=k>if</span> <span class=s2>"lat"</span> <span class=ow>in</span> <span class=n>data_array</span><span class=o>.</span><span class=n>coords</span> <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>    <span class=n>lon</span> <span class=o>=</span> <span class=n>data_array</span><span class=o>.</span><span class=n>coords</span><span class=p>[</span><span class=s2>"lon"</span><span class=p>]</span><span class=o>.</span><span class=n>values</span> <span class=k>if</span> <span class=s2>"lon"</span> <span class=ow>in</span> <span class=n>data_array</span><span class=o>.</span><span class=n>coords</span> <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>    <span class=c1># Convert pandas DataFrame back to xarray Dataset</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>Dataset</span><span class=p>(</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>        <span class=p>{</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>            <span class=s2>"max"</span><span class=p>:</span> <span class=p>([</span><span class=s2>"time"</span><span class=p>],</span> <span class=n>daily_statistics</span><span class=p>[</span><span class=s2>"value"</span><span class=p>][</span><span class=s2>"max"</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>),</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a>            <span class=s2>"min"</span><span class=p>:</span> <span class=p>([</span><span class=s2>"time"</span><span class=p>],</span> <span class=n>daily_statistics</span><span class=p>[</span><span class=s2>"value"</span><span class=p>][</span><span class=s2>"min"</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>),</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>            <span class=s2>"mean"</span><span class=p>:</span> <span class=p>([</span><span class=s2>"time"</span><span class=p>],</span> <span class=n>daily_statistics</span><span class=p>[</span><span class=s2>"value"</span><span class=p>][</span><span class=s2>"mean"</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>),</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>        <span class=p>},</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>        <span class=n>coords</span><span class=o>=</span><span class=p>{</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>            <span class=s2>"lon"</span><span class=p>:</span> <span class=n>lon</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>            <span class=s2>"lat"</span><span class=p>:</span> <span class=n>lat</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>            <span class=s2>"time"</span><span class=p>:</span> <span class=n>daily_statistics</span><span class=o>.</span><span class=n>index</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>        <span class=p>},</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>    <span class=k>return</span> <span class=n>result</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.hargreaves> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">hargreaves</span> <a class=headerlink href=#pvgisprototype.algorithms.hargreaves title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hargreaves.solar_declination title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_declination</span> (<code>pvgisprototype.algorithms.hargreaves.solar_declination</code>)'>solar_declination</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.hargreaves.solar_declination> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_declination</span> <a class=headerlink href=#pvgisprototype.algorithms.hargreaves.solar_declination title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hargreaves.solar_declination.calculate_solar_declination_series_hargreaves title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_declination_series_hargreaves</span> (<code>pvgisprototype.algorithms.hargreaves.solar_declination.calculate_solar_declination_series_hargreaves</code>)'>calculate_solar_declination_series_hargreaves</a></code></td> <td> <div class=doc-md-description> <p>Approximate the solar declination for a series of timestamps </p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hargreaves.solar_declination.calculate_solar_declination_series_hargreaves> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_declination_series_hargreaves</span> <a class=headerlink href=#pvgisprototype.algorithms.hargreaves.solar_declination.calculate_solar_declination_series_hargreaves title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_declination_series_hargreaves</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarDeclination>SolarDeclination</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Approximate the solar declination for a series of timestamps using the Hargreaves formula, with days-in-year from each timestamp's year.</p> <div class=codehilite><pre><span></span><code>              360                       360            
</code></pre></div> <p> = 23.45  sin   284 + n + 0.4  sin   (n - 100) 365  365 </p> <details class=-notes open> <summary>Notes</summary> <ul> <li> <p>365.25: The number 365.25 represents the average number of days in a year. This value is used to scale the orbital position of the Earth.</p> </li> <li> <p>284: The number 284 represents a constant term added to the day of the year. It adjusts the calculation to align with the Earth's position during the winter solstice, which usually occurs around December 21<sup>st</sup> (approximately 284 days into the year).</p> </li> <li> <p>0.4: The number 0.4 is a constant that determines the amplitude of the seasonal variation. It is multiplied by the second sine term to modulate the seasonal change in the solar declination.</p> </li> <li> <p>100: The number 100 represents an offset to the day of the year. It is subtracted from the original day of the year before calculating the second sine term. This offset helps adjust the timing of the seasonal variation and is usually chosen to align with the summer solstice, which typically occurs around June 21<sup>st</sup>.</p> </li> </ul> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hargreaves/solar_declination.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_declination_series_hargreaves</span><span class=p>(</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarDeclination</span><span class=p>:</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=sd>    Approximate the solar declination for a series of timestamps </span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=sd>    using the Hargreaves formula, with days-in-year from each timestamp's year.</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=sd>                      360                       360            </span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=sd>      = 23.45  sin   284 + n + 0.4  sin   (n - 100)</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=sd>                      365                       365            </span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=sd>     Notes</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>     -----</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>     - 365.25: The number 365.25 represents the average number of days in a</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>     year. This value is used to scale the orbital position of the Earth.</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>     - 284: The number 284 represents a constant term added to the day of the</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>     year. It adjusts the calculation to align with the Earth's position</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>     during the winter solstice, which usually occurs around December 21st</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>     (approximately 284 days into the year).</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>     - 0.4: The number 0.4 is a constant that determines the amplitude of the</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>     seasonal variation. It is multiplied by the second sine term to</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>     modulate the seasonal change in the solar declination.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>     - 100: The number 100 represents an offset to the day of the year. It is</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>     subtracted from the original day of the year before calculating the</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>     second sine term. This offset helps adjust the timing of the seasonal</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>     variation and is usually chosen to align with the summer solstice,</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>     which typically occurs around June 21st.</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>timestamps</span><span class=p>,</span> <span class=n>DatetimeIndex</span><span class=p>):</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>"timestamps must be a pandas.DatetimeIndex"</span><span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>    <span class=n>days_in_years</span> <span class=o>=</span> <span class=n>get_days_in_years</span><span class=p>(</span><span class=n>timestamps</span><span class=o>.</span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=n>days_of_year</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>dayofyear</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=n>inner_angle</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=mf>360.0</span> <span class=o>/</span> <span class=n>days_in_years</span> <span class=o>*</span> <span class=p>(</span><span class=n>days_of_year</span> <span class=o>-</span> <span class=mf>100.0</span><span class=p>))</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=n>numpy</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>            <span class=mf>360.0</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>            <span class=o>/</span> <span class=n>days_in_years</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>            <span class=o>*</span> <span class=p>(</span><span class=mf>284.0</span> <span class=o>+</span> <span class=n>days_of_year</span> <span class=o>+</span> <span class=mf>0.4</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>numpy</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>inner_angle</span><span class=p>)))</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range_x</span><span class=p>(</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>SolarDeclination</span><span class=p>(</span><span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>),</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=k>return</span> <span class=n>SolarDeclination</span><span class=p>(</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>algorithm</span><span class=o>=</span><span class=n>SolarDeclinationModel</span><span class=o>.</span><span class=n>hargreaves</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">irradiance</span> (<code>pvgisprototype.algorithms.hofierka.irradiance</code>)'>irradiance</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">position</span> (<code>pvgisprototype.algorithms.hofierka.position</code>)'>position</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.power title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">power</span> (<code>pvgisprototype.algorithms.hofierka.power</code>)'>power</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.read title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">read</span> (<code>pvgisprototype.algorithms.hofierka.read</code>)'>read</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.spectrum title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">spectrum</span> (<code>pvgisprototype.algorithms.hofierka.spectrum</code>)'>spectrum</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">irradiance</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">diffuse</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse</code>)'>diffuse</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">direct</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct</code>)'>direct</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">extraterrestrial</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial</code>)'>extraterrestrial</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">shortwave</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.shortwave</code>)'>shortwave</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">diffuse</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">clear_sky</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky</code>)'>clear_sky</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.ground_reflected title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">ground_reflected</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.ground_reflected</code>)'>ground_reflected</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.horizontal title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">horizontal</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.horizontal</code>)'>horizontal</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">clear_sky</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">altitude</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude</code>)'>altitude</a></code></td> <td> <div class=doc-md-description> <p>Diffuse Solar Altitude Function</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.ground_reflected title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">ground_reflected</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.ground_reflected</code>)'>ground_reflected</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.horizontal title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">horizontal</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.horizontal</code>)'>horizontal</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">transmission_function</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function</code>)'>transmission_function</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">altitude</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude title="Permanent link"></a></h6> <div class="doc doc-contents"> <p>Diffuse Solar Altitude Function</p> <p>This module implements the diffuse solar altitude function and associated coefficients from Hofierka's clear-sky radiation model (2002). These functions characterize how diffuse irradiance varies with solar elevation under cloudless atmospheric conditions.</p> <details class=theoretical-background open> <summary>Theoretical Background</summary> <p>Under cloudless skies, atmospheric turbidity affects the partitioning of solar radiation into direct and diffuse components. As turbidity increases, diffuse irradiance increases while direct irradiance decreases.</p> </details> <details class=see-also open> <summary>See Also</summary> <p>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function Implements T(T_LK) diffuse transmission function pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.horizontal Combines transmission and altitude functions for total diffuse irradiance</p> </details> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude.calculate_diffuse_solar_altitude_coefficients_series_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_diffuse_solar_altitude_coefficients_series_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude.calculate_diffuse_solar_altitude_coefficients_series_hofierka</code>)'>calculate_diffuse_solar_altitude_coefficients_series_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the diffuse solar altitude coefficients.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude.calculate_diffuse_solar_altitude_function_series_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_diffuse_solar_altitude_function_series_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude.calculate_diffuse_solar_altitude_function_series_hofierka</code>)'>calculate_diffuse_solar_altitude_function_series_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the diffuse solar altitude function.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h7 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude.calculate_diffuse_solar_altitude_coefficients_series_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_diffuse_solar_altitude_coefficients_series_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude.calculate_diffuse_solar_altitude_coefficients_series_hofierka title="Permanent link"></a></h7> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_diffuse_solar_altitude_coefficients_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the diffuse solar altitude coefficients.</p> <p>Calculates the diffuse solar altitude coefficients (a1, a2, a3) over a time series required for calculating the diffuse solar altitude function in Hofierka's model.</p> <p>These coefficients are derived from the Linke Turbidity factor and the diffuse transmission function.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>linke_turbidity_factor_series</code> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></code> </td> <td> <div class=doc-md-description> <p>The Linke turbidity factors as a list of LinkeTurbidityFactor objects or a single object.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level for debugging output. When set to <code>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</code>, prints local variables. Default is 0.</p> </div> </td> <td> <code>0</code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Logging level for data fingerprinting. When exceeding <code>HASH_AFTER_THIS_VERBOSITY_LEVEL</code>, logs data hashes for traceability. Default is 0.</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>tuple of numpy.ndarray</code> </td> <td> <div class=doc-md-description> <p>Three arrays containing the coefficient series:</p> <ul> <li>a1_series : First coefficient, bounded by diffuse transmission</li> <li>a2_series : Second coefficient </li> <li>a3_series : Third coefficient</li> </ul> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The coefficients are calculated using empirical formulas from Hofierka's model :</p> <ul> <li>a1 is constrained to ensure <code>a1 * Td &gt;= 0.0022</code> where Td is diffuse transmission</li> <li>a2 and a3 are derived from quadratic functions of the Linke turbidity factor</li> </ul> </details> <details class=see-also open> <summary>See Also</summary> <p>calculate_diffuse_transmission_function_series_hofierka : Computes diffuse transmission calculate_diffuse_solar_altitude_function_series_hofierka : Uses these coefficients</p> </details> <details class=references open> <summary>References</summary> <p>.. [1] Hofierka, J., &amp; ri, M. (2002). The solar radiation model for Open source GIS: implementation and applications. <em>Proceedings of the Open source GIS - GRASS users conference</em>, Trento, Italy.</p> </details> <p><span class=doc-section-title>Examples:</span></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype</span><span class=w> </span><span class=kn>import</span> <span class=n>LinkeTurbidityFactor</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude</span><span class=w> </span><span class=kn>import</span> <span class=n>calculate_diffuse_solar_altitude_function_series_hofierka</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function</span><span class=w> </span><span class=kn>import</span> <span class=n>calculate_diffuse_transmission_function_series_hofierka</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ltf</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>2.0</span><span class=p>,</span> <span class=mf>2.5</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>]))</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>a1</span><span class=p>,</span> <span class=n>a2</span><span class=p>,</span> <span class=n>a3</span> <span class=o>=</span> <span class=n>calculate_diffuse_solar_altitude_coefficients_series_hofierka</span><span class=p>(</span><span class=n>ltf</span><span class=p>)</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>a1</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=go>(3,)</span>
</span></code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/diffuse/clear_sky/altitude.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_diffuse_solar_altitude_coefficients_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=c1># linke_turbidity_factor_series: LinkeTurbidityFactor = LinkeTurbidityFactor(),</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>:</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=w>    </span><span class=sd>"""Calculate the diffuse solar altitude coefficients.</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    Calculates the diffuse solar altitude coefficients (a1, a2, a3) over a time</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    series required for calculating the diffuse solar altitude function in</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    Hofierka's model.</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    These coefficients are derived from the Linke Turbidity factor and the</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    diffuse transmission function.</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    linke_turbidity_factor_series: (List[LinkeTurbidityFactor] or LinkeTurbidityFactor)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>        The Linke turbidity factors as a list of LinkeTurbidityFactor objects</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>        or a single object.</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        Verbosity level for debugging output. When set to </span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        `DEBUG_AFTER_THIS_VERBOSITY_LEVEL`, prints local variables.</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>        Default is 0.</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        Logging level for data fingerprinting. When exceeding </span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>        `HASH_AFTER_THIS_VERBOSITY_LEVEL`, logs data hashes for traceability.</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>        Default is 0.</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    tuple of numpy.ndarray</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>        Three arrays containing the coefficient series:</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>        - a1_series : First coefficient, bounded by diffuse transmission</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>        - a2_series : Second coefficient  </span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>        - a3_series : Third coefficient</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    The coefficients are calculated using empirical formulas from Hofierka's</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    model :</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    - a1 is constrained to ensure `a1 * Td &gt;= 0.0022` where Td is diffuse</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>      transmission</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    - a2 and a3 are derived from quadratic functions of the Linke turbidity</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>      factor</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    See Also</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>    calculate_diffuse_transmission_function_series_hofierka : Computes diffuse</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    transmission</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>    calculate_diffuse_solar_altitude_function_series_hofierka : Uses these</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>    coefficients</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>    .. [1] Hofierka, J., &amp; ri, M. (2002). The solar radiation model for Open</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>           source GIS: implementation and applications. *Proceedings of the</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>           Open source GIS - GRASS users conference*, Trento, Italy.</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype import LinkeTurbidityFactor</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude import calculate_diffuse_solar_altitude_function_series_hofierka</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function import calculate_diffuse_transmission_function_series_hofierka</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>    &gt;&gt;&gt; ltf = LinkeTurbidityFactor(value=np.array([2.0, 2.5, 3.0]))</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>    &gt;&gt;&gt; a1, a2, a3 = calculate_diffuse_solar_altitude_coefficients_series_hofierka(ltf)</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>    &gt;&gt;&gt; print(a1.shape)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    (3,)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>    <span class=n>linke_turbidity_factor_series_squared_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=n>linke_turbidity_factor_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span> <span class=mi>2</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>    <span class=n>diffuse_transmission_series</span> <span class=o>=</span> <span class=n>calculate_diffuse_transmission_function_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>linke_turbidity_factor_series</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>    <span class=n>diffuse_transmission_series_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>diffuse_transmission_series</span><span class=p>)</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>    <span class=n>a1_prime_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=mf>0.26463</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=o>-</span> <span class=mf>0.061581</span> <span class=o>*</span> <span class=n>linke_turbidity_factor_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=o>+</span> <span class=mf>0.0031408</span> <span class=o>*</span> <span class=n>linke_turbidity_factor_series_squared_array</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=n>a1_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>a1_prime_series</span> <span class=o>*</span> <span class=n>diffuse_transmission_series</span> <span class=o>&lt;</span> <span class=mf>0.0022</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=c1># 0.0022 / diffuse_transmission_series_array,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=mf>0.0022</span> <span class=o>/</span> <span class=n>diffuse_transmission_series_array</span><span class=p>,</span> <span class=n>a1_prime_series</span><span class=p>),</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>a1_prime_series</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=n>a2_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=mf>2.04020</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=o>+</span> <span class=mf>0.018945</span> <span class=o>*</span> <span class=n>linke_turbidity_factor_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=o>-</span> <span class=mf>0.011161</span> <span class=o>*</span> <span class=n>linke_turbidity_factor_series_squared_array</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>    <span class=n>a3_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=o>-</span><span class=mf>1.3025</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=o>+</span> <span class=mf>0.039231</span> <span class=o>*</span> <span class=n>linke_turbidity_factor_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=o>+</span> <span class=mf>0.0085079</span> <span class=o>*</span> <span class=n>linke_turbidity_factor_series_squared_array</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=p>(</span><span class=n>a1_series</span><span class=p>,</span> <span class=n>a2_series</span><span class=p>,</span> <span class=n>a3_series</span><span class=p>),</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>    <span class=k>return</span> <span class=n>a1_series</span><span class=p>,</span> <span class=n>a2_series</span><span class=p>,</span> <span class=n>a3_series</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h7 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude.calculate_diffuse_solar_altitude_function_series_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_diffuse_solar_altitude_function_series_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude.calculate_diffuse_solar_altitude_function_series_hofierka title="Permanent link"></a></h7> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_diffuse_solar_altitude_function_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=numpy.ndarray>ndarray</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the diffuse solar altitude function.</p> <p>Calculates the diffuse solar altitude function (Fd) for a time series using Hofierka's empirical model. This function combines solar altitude angles with turbidity-dependent coefficients to estimate diffuse irradiance patterns.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>solar_altitude_series</code> </td> <td> <code><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></code> </td> <td> <div class=doc-md-description> <p>Solar altitude angles for the time series. Must contain <code>radians</code> attribute with angle values in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>linke_turbidity_factor_series</code> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></code> </td> <td> <div class=doc-md-description> <p>Linke turbidity factor values corresponding to the solar altitude time points.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level for debugging output. When set to <code>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</code>, prints local variables. Default is 0.</p> </div> </td> <td> <code>0</code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Logging level for data fingerprinting. When exceeding <code>HASH_AFTER_THIS_VERBOSITY_LEVEL</code>, logs data hashes for traceability. Default is 0.</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>Diffuse solar altitude function values (Fd) for each time point in the series. Array shape matches input series dimensions.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The diffuse solar altitude function F(Solar Altitude) characterizes the angular distribution of diffuse radiation :</p> <p>.. math:: F_d(Solar Altitude) = a_1 + a_2 \sin(Solar Altitude) + a_3 \sin^2(Solar Altitude)</p> <p>where:</p> <ul> <li>:math:<code>a_1, a_2, a_3</code> are coefficients derived from Linke turbidity, the a coefficient is bounded to ensure physical validity when multiplied by the transmission function.</li> </ul> </details> <details class=see-also open> <summary>See Also</summary> <p>calculate_diffuse_solar_altitude_coefficients_series_hofierka : Computes the a1, a2, a3 coefficients SolarAltitude : Solar altitude data model LinkeTurbidityFactor : Linke turbidity factor data model</p> </details> <details class=references open> <summary>References</summary> <p>.. [1] Hofierka, J., &amp; ri, M. (2002). The solar radiation model for Open source GIS: implementation and applications. <em>Proceedings of the Open source GIS - GRASS users conference</em>, Trento, Italy.</p> </details> <p><span class=doc-section-title>Examples:</span></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype</span><span class=w> </span><span class=kn>import</span> <span class=n>SolarAltitude</span><span class=p>,</span> <span class=n>LinkeTurbidityFactor</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>calculate_diffuse_solar_altitude_coefficients_series_hofierka</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>calculate_diffuse_solar_altitude_function_series_hofierka</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>&gt;&gt;&gt; </span><span class=p>)</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function</span><span class=w> </span><span class=kn>import</span> <span class=n>calculate_diffuse_transmission_function_series_hofierka</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>altitude</span> <span class=o>=</span> <span class=n>SolarAltitude</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.8</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>]),</span> <span class=n>unit</span><span class=o>=</span><span class=s1>'radians'</span><span class=p>)</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ltf</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>2.0</span><span class=p>,</span> <span class=mf>2.5</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>]))</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fd</span> <span class=o>=</span> <span class=n>calculate_diffuse_solar_altitude_function_series_hofierka</span><span class=p>(</span><span class=n>altitude</span><span class=p>,</span> <span class=n>ltf</span><span class=p>)</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>fd</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=go>(3,)</span>
</span></code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/diffuse/clear_sky/altitude.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_diffuse_solar_altitude_function_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n>SolarAltitude</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>    <span class=c1># linke_turbidity_factor_series: LinkeTurbidityFactor = LinkeTurbidityFactor(),</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span><span class=p>,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a><span class=w>    </span><span class=sd>"""Calculate the diffuse solar altitude function.</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a><span class=sd>    Calculates the diffuse solar altitude function (Fd) for a time series using</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>    Hofierka's empirical model. This function combines solar altitude angles</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>    with turbidity-dependent coefficients to estimate diffuse irradiance</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=sd>    patterns.</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=sd>    solar_altitude_series : SolarAltitude</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=sd>        Solar altitude angles for the time series. Must contain `radians` attribute</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a><span class=sd>        with angle values in radians.</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>    linke_turbidity_factor_series : LinkeTurbidityFactor</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=sd>        Linke turbidity factor values corresponding to the solar altitude time points.</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>        Verbosity level for debugging output. When set to </span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a><span class=sd>        `DEBUG_AFTER_THIS_VERBOSITY_LEVEL`, prints local variables.</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a><span class=sd>        Default is 0.</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a><span class=sd>        Logging level for data fingerprinting. When exceeding </span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>        `HASH_AFTER_THIS_VERBOSITY_LEVEL`, logs data hashes for traceability.</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a><span class=sd>        Default is 0.</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a><span class=sd>    numpy.ndarray</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>        Diffuse solar altitude function values (Fd) for each time point in the series.</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a><span class=sd>        Array shape matches input series dimensions.</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a><span class=sd>    The diffuse solar altitude function F(Solar Altitude) characterizes the</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a><span class=sd>    angular distribution of diffuse radiation :</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a><span class=sd>    .. math::</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=sd>        F_d(Solar Altitude) = a_1 + a_2 \sin(Solar Altitude) + a_3 \sin^2(Solar Altitude)</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=sd>    where:</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a><span class=sd>    - :math:`a_1, a_2, a_3` are coefficients derived from Linke turbidity, the</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a><span class=sd>      a coefficient is bounded to ensure physical validity when multiplied by</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a><span class=sd>      the transmission function.</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a><span class=sd>    See Also</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a><span class=sd>    calculate_diffuse_solar_altitude_coefficients_series_hofierka : Computes</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a><span class=sd>    the a1, a2, a3 coefficients</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a><span class=sd>    SolarAltitude : Solar altitude data model</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a><span class=sd>    LinkeTurbidityFactor : Linke turbidity factor data model</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a><span class=sd>    .. [1] Hofierka, J., &amp; ri, M. (2002). The solar radiation model for Open</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a><span class=sd>           source GIS: implementation and applications. *Proceedings of the</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a><span class=sd>           Open source GIS - GRASS users conference*, Trento, Italy.</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype import SolarAltitude, LinkeTurbidityFactor</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a><span class=sd>    &gt;&gt;&gt; import numpy as np</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude import (</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a><span class=sd>    &gt;&gt;&gt; calculate_diffuse_solar_altitude_coefficients_series_hofierka,</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a><span class=sd>    &gt;&gt;&gt; calculate_diffuse_solar_altitude_function_series_hofierka,</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a><span class=sd>    &gt;&gt;&gt; )</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function import calculate_diffuse_transmission_function_series_hofierka</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a><span class=sd>    &gt;&gt;&gt; altitude = SolarAltitude(value=np.array([0.5, 0.8, 1.0]), unit='radians')</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a><span class=sd>    &gt;&gt;&gt; ltf = LinkeTurbidityFactor(value=np.array([2.0, 2.5, 3.0]))</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a><span class=sd>    &gt;&gt;&gt; fd = calculate_diffuse_solar_altitude_function_series_hofierka(altitude, ltf)</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a><span class=sd>    &gt;&gt;&gt; print(fd.shape)</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a><span class=sd>    (3,)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>    <span class=n>a1_series</span><span class=p>,</span> <span class=n>a2_series</span><span class=p>,</span> <span class=n>a3_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>        <span class=n>calculate_diffuse_solar_altitude_coefficients_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>            <span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>            <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=p>(</span><span class=n>a1_series</span><span class=p>,</span> <span class=n>a2_series</span><span class=p>,</span> <span class=n>a3_series</span><span class=p>),</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>    <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>        <span class=n>a1_series</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>        <span class=o>+</span> <span class=n>a2_series</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>        <span class=o>+</span> <span class=n>a3_series</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span><span class=p>),</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.ground_reflected> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">ground_reflected</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.ground_reflected title="Permanent link"></a></h6> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.ground_reflected.calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.ground_reflected.calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis</code>)'>calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis</a></code></td> <td> <div class=doc-md-description> <p>Calculate the clear-sky ground-reflected diffuse irradiance on an inclined</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h7 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.ground_reflected.calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.ground_reflected.calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis title="Permanent link"></a></h7> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>elevation</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>=</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>(</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=p>[</span><span class=n><span title=pandas.Timestamp.now>now</span></span><span class=p>(</span><span class=n><span title=pandas.Timestamp.now(tz)>tz</span></span><span class=o>=</span><span class=s2>"UTC"</span><span class=p>)]</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=p>),</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>=</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>),</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>surface_tilt_threshold</span><span class=o>=</span><span class=n><span title=pvgisprototype.constants.SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>(),</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ATMOSPHERIC_REFRACTION_FLAG_DEFAULT>ATMOSPHERIC_REFRACTION_FLAG_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>albedo</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ALBEDO_DEFAULT>ALBEDO_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>solar_position_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarPositionModel>SolarPositionModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SolarPositionModel.noaa>noaa</span></span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>solar_time_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarTimeModel>SolarTimeModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SolarTimeModel.noaa>noaa</span></span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.ClearSkyDiffuseGroundReflectedInclinedIrradiance>ClearSkyDiffuseGroundReflectedInclinedIrradiance</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the clear-sky ground-reflected diffuse irradiance on an inclined surface.</p> <p>Calculates the component of diffuse irradiance that reaches an inclined surface after reflection from the ground under clear-sky conditions. This component is proportional to the global horizontal irradiance [Ghc], the solar surface tilt angle, the mean ground albedo [g] and a fraction of the ground viewed by an inclined surface [rg(N)]. The calculation follows the isotropic sky model where ground-reflected radiation is uniformly distributed.</p> <p>The ground-reflected irradiance is calculated as:</p> <p>.. math:: I_{gr} = I_g \cdot F_{gv} \cdot \rho</p> <p>where:</p> <ul> <li>:math:<code>I_{gr}</code> is the ground-reflected irradiance on the inclined surface</li> <li>:math:<code>I_g</code> is the global horizontal irradiance</li> <li>:math:<code>F_{gv}</code> is the ground view fraction: :math:<code>(1 - \cos(\beta)) / 2</code></li> <li>:math:<code>\beta</code> is the surface tilt angle</li> <li>:math:<code>\rho</code> is the ground albedo</li> </ul> <p>For near-horizontal surfaces (tilt  threshold), ground reflection is negligible and set to zero.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Geographic longitude in decimal degrees. East is positive, west is negative. Valid range: [-180, 180].</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Geographic latitude in decimal degrees. North is positive, south is negative. Valid range: [-90, 90].</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>elevation</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Site elevation above sea level in meters. Used for atmospheric corrections in irradiance calculations.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>Time series index for calculations. Must be timezone-aware for accurate solar position computations.</p> </div> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span>([<span title=pandas.Timestamp.now>now</span>(<span title=pandas.Timestamp.now(tz)>tz</span>='UTC')])</code> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>IANA timezone identifier (e.g., 'UTC', 'Europe/Rome'). Used for local time conversions in solar position algorithms.</p> </div> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a>('UTC')</code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_orientation</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Surface azimuth angle in degrees. 0 = North, 90 = East, 180 = South, 270 = West. Determines horizontal orientation of the inclined surface.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_tilt</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Surface tilt angle from horizontal in degrees. 0 = horizontal, 90 = vertical. Valid range: [0, 90].</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_tilt_threshold</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Minimum tilt angle in degrees below which ground reflection is considered negligible and set to zero. Default is typically a small value (e.g., 1).</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>albedo</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Ground surface albedo (reflectivity), dimensionless. Typical values: 0.2 (grass, soil), 0.3-0.5 (sand, concrete), 0.8 (fresh snow). Valid range: [0, 1]. Default varies by application.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ALBEDO_DEFAULT>ALBEDO_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>linke_turbidity_factor_series</code> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></code> </td> <td> <div class=doc-md-description> <p>Linke turbidity factor values characterizing atmospheric turbidity. Typical range: [1.0, 6.0]. Default is <code>LinkeTurbidityFactor()</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span>()</code> </td> </tr> <tr class=doc-section-item> <td> <code>adjust_for_atmospheric_refraction</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> <p>Whether to apply atmospheric refraction correction to solar angles. Affects accuracy near horizon. Default is True.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ATMOSPHERIC_REFRACTION_FLAG_DEFAULT>ATMOSPHERIC_REFRACTION_FLAG_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>solar_position_model</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Algorithm for solar position calculations (e.g., 'NOAA', 'PSA'). Default is <code>SOLAR_POSITION_MODEL_DEFAULT</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.api.position.models.SolarPositionModel.noaa>noaa</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>solar_time_model</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Solar time calculation method. Default is <code>SOLAR_TIME_MODEL_DEFAULT</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.api.position.models.SolarTimeModel.noaa>noaa</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>solar_constant</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Solar constant in Wm. Default is <code>SOLAR_CONSTANT</code> (~1361 Wm).</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>eccentricity_phase_offset</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Phase offset for Earth's orbital eccentricity correction in radians. Default is <code>ECCENTRICITY_PHASE_OFFSET</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>eccentricity_amplitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Amplitude of orbital eccentricity correction. Default is <code>ECCENTRICITY_CORRECTION_FACTOR</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>NumPy data type for array operations. Default is <code>DATA_TYPE_DEFAULT</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Array backend ('numpy', 'cupy', 'dask'). Default is <code>ARRAY_BACKEND_DEFAULT</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level for debugging output. When exceeding <code>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</code>, prints all local variables using devtools.debug. Default is <code>VERBOSE_LEVEL_DEFAULT</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Logging level for data fingerprinting. When exceeding <code>HASH_AFTER_THIS_VERBOSITY_LEVEL</code>, logs data hashes for reproducibility tracking. Default is <code>LOG_LEVEL_DEFAULT</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.ClearSkyDiffuseGroundReflectedInclinedIrradiance>ClearSkyDiffuseGroundReflectedInclinedIrradiance</span></code> </td> <td> <div class=doc-md-description> <p>Data model containing:</p> <ul> <li><strong>value</strong> : numpy.ndarray Ground-reflected irradiance values in Wm for each timestamp</li> <li><strong>out_of_range</strong> : bool Flag indicating if any values exceed physical bounds</li> <li><strong>out_of_range_index</strong> : numpy.ndarray Indices of out-of-range values</li> <li><strong>ground_view_fraction</strong> : float Fraction of ground visible from tilted surface (0 to 0.5)</li> <li><strong>albedo</strong> : float Ground albedo used in calculation</li> <li><strong>global_horizontal_irradiance</strong> : numpy.ndarray Global horizontal irradiance values used</li> <li><strong>direct_horizontal_irradiance</strong> : array or None Direct component of horizontal irradiance</li> <li><strong>diffuse_horizontal_irradiance</strong> : array or None Diffuse component of horizontal irradiance</li> <li><strong>solar_positioning_algorithm</strong> : str Solar position algorithm used</li> <li><strong>solar_timing_algorithm</strong> : str Solar time algorithm used</li> <li><strong>location</strong> : tuple (longitude, latitude) coordinates</li> <li><strong>elevation</strong> : float Site elevation in meters</li> <li><strong>surface_orientation</strong> : float Surface azimuth in degrees</li> <li><strong>surface_tilt</strong> : float Surface tilt in degrees</li> <li><strong>surface_tilt_threshold</strong> : float Tilt threshold used</li> </ul> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p><strong>Ground View Fraction:</strong></p> <p>The ground view fraction represents the solid angle subtended by the ground as seen from the tilted surface:</p> <ul> <li>Horizontal surface (0): F_gv = 0 (no ground visible)</li> <li>Vertical surface (90): F_gv = 0.5 (half hemisphere is ground)</li> <li>Tilted surface: F_gv = (1 - cos()) / 2</li> </ul> <p><strong>Tilt Threshold Behavior:</strong></p> <p>When <code>surface_tilt &lt;= surface_tilt_threshold</code>, the function:</p> <ol> <li>Sets ground view fraction to 0</li> <li>Creates zero-valued arrays for ground reflection</li> <li>Avoids unnecessary computation for negligible contributions</li> </ol> <p>This optimization is physically justified as near-horizontal surfaces receive minimal ground-reflected radiation.</p> <p><strong>Global Horizontal Irradiance</strong></p> <p>The function internally computes the global horizontal irradiance as:</p> <p>.. math:: I_g = I_{bh} + I_{dh}</p> <p>where I_bh is direct horizontal and I_dh is diffuse horizontal irradiance, both calculated using clear-sky models.</p> <p><strong>Physical Constraints</strong></p> <ul> <li>Ground-reflected irradiance cannot exceed global horizontal irradiance</li> <li>Albedo values outside [0, 1] produce unphysical results</li> <li>Results valid only for clear-sky conditions</li> <li>Model assumes isotropic ground reflection (Lambertian surface)</li> </ul> </details> <details class=see-also open> <summary>See Also</summary> <p>calculate_clear_sky_direct_horizontal_irradiance_series : Computes direct component calculate_clear_sky_diffuse_horizontal_irradiance : Computes diffuse component ClearSkyDiffuseGroundReflectedInclinedIrradiance : Output data model</p> </details> <details class=references open> <summary>References</summary> <p>.. [1] Duffie, J. A., &amp; Beckman, W. A. (2013). <em>Solar Engineering of Thermal Processes</em> (4<sup>th</sup> ed.). Wiley. Chapter 2: Available Solar Radiation. .. [2] Perez, R., et al. (1987). A new simplified version of the Perez diffuse irradiance model for tilted surfaces. <em>Solar Energy</em>, 39(3), 221-231.</p> </details> <p><span class=doc-section-title>Examples:</span></p> <p>Calculate ground reflection for a south-facing tilted surface:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype</span><span class=w> </span><span class=kn>import</span> <span class=n>Longitude</span><span class=p>,</span> <span class=n>Latitude</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.ground_reflected</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=gp>... </span>    <span class=n>calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=gp>&gt;&gt;&gt; </span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Summer day, hourly data</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>timestamps</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>'2024-06-21'</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>24</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>'h'</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s1>'UTC'</span><span class=p>)</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=gp>&gt;&gt;&gt; </span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Location: Rome, Italy</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>longitude</span> <span class=o>=</span> <span class=n>Longitude</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=mf>12.496</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=s1>'degrees'</span><span class=p>)</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>latitude</span> <span class=o>=</span> <span class=n>Latitude</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=mf>41.903</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=s1>'degrees'</span><span class=p>)</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Solar surface position</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a><span class=gp>&gt;&gt;&gt; </span><span class=n>surface_orientation</span> <span class=o>=</span> <span class=n>SurfaceOrientation</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=mi>180</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=s1>'degrees'</span><span class=p>)</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a><span class=gp>&gt;&gt;&gt; </span><span class=n>surface_tilt</span> <span class=o>=</span> <span class=n>SurfaceTilt</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=mi>180</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=s1>'degrees'</span><span class=p>)</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Calculate irradiance</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a><span class=gp>&gt;&gt;&gt; </span><span class=n>result</span> <span class=o>=</span> <span class=n>calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis</span><span class=p>(</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a><span class=gp>... </span>    <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a><span class=gp>... </span>    <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a><span class=gp>... </span>    <span class=n>elevation</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a><span class=gp>... </span>    <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a><span class=gp>... </span>    <span class=n>timezone</span><span class=o>=</span><span class=s1>'Europe/Rome'</span><span class=p>,</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a><span class=gp>... </span>    <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>  <span class=c1># South-facing</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a><span class=gp>... </span>    <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a><span class=gp>... </span>    <span class=n>albedo</span><span class=o>=</span><span class=mf>0.2</span>                <span class=c1># Grass/soil</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a><span class=gp>&gt;&gt;&gt; </span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Ground view fraction: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>ground_view_fraction</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a><span class=go>Ground view fraction: 1.000</span>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Peak ground-reflected irradiance: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> W/m"</span><span class=p>)</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a><span class=go>Peak ground-reflected irradiance: 241.5 W/m</span>
</span><span id=__span-0-33><a href=#__codelineno-0-33 id=__codelineno-0-33 name=__codelineno-0-33></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Daily total: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> Wh/m"</span><span class=p>)</span>
</span><span id=__span-0-34><a href=#__codelineno-0-34 id=__codelineno-0-34 name=__codelineno-0-34></a><span class=go>Daily total: 2221.9 Wh/m</span>
</span></code></pre></div> <p>Compare albedo effects</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Low albedo (dark soil)</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>result_dark</span> <span class=o>=</span> <span class=n>calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis</span><span class=p>(</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>... </span>    <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>... </span>    <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=gp>... </span>    <span class=n>elevation</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>... </span>    <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=gp>... </span>    <span class=n>timezone</span><span class=o>=</span><span class=s1>'Europe/Rome'</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=gp>... </span>    <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=gp>... </span>    <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=gp>... </span>    <span class=n>albedo</span><span class=o>=</span><span class=mf>0.15</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=gp>&gt;&gt;&gt; </span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># High albedo (concrete)</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>result_bright</span> <span class=o>=</span> <span class=n>calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis</span><span class=p>(</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a><span class=gp>... </span>    <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a><span class=gp>... </span>    <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a><span class=gp>... </span>    <span class=n>elevation</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a><span class=gp>... </span>    <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a><span class=gp>... </span>    <span class=n>timezone</span><span class=o>=</span><span class=s1>'Europe/Rome'</span><span class=p>,</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a><span class=gp>... </span>    <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a><span class=gp>... </span>    <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a><span class=gp>... </span>    <span class=n>albedo</span><span class=o>=</span><span class=mf>0.4</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a><span class=gp>&gt;&gt;&gt; </span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a><span class=gp>&gt;&gt;&gt; </span><span class=n>albedo_ratio</span> <span class=o>=</span> <span class=n>result_bright</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>/</span> <span class=n>result_dark</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Bright/dark albedo ratio: </span><span class=si>{</span><span class=n>albedo_ratio</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a><span class=go>Bright/dark albedo ratio: 2.67</span>
</span></code></pre></div> <p>Near-horizontal surface (negligible ground reflection)</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>result_flat</span> <span class=o>=</span> <span class=n>calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>... </span>    <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>... </span>    <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>... </span>    <span class=n>elevation</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=gp>... </span>    <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>... </span>    <span class=n>timezone</span><span class=o>=</span><span class=s1>'Europe/Rome'</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=gp>... </span>    <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>  <span class=c1># South-facing</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=gp>... </span>    <span class=n>surface_tilt</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span>  <span class=c1># Nearly horizontal</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=gp>... </span>    <span class=n>surface_tilt_threshold</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=gp>... </span>    <span class=n>albedo</span><span class=o>=</span><span class=mf>0.2</span>                <span class=c1># Grass/soil</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=gp>&gt;&gt;&gt; </span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Ground view fraction: </span><span class=si>{</span><span class=n>result_flat</span><span class=o>.</span><span class=n>ground_view_fraction</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a><span class=go>0.0  # Threshold triggered, no ground reflection</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"All values zero: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span><span class=n>result_flat</span><span class=o>.</span><span class=n>value</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a><span class=go>True</span>
</span></code></pre></div> <details class=warning open> <summary>Warnings</summary> <ul> <li>Tilt angle must be in degrees, not radians</li> <li>Albedo values should be realistic for the surface type</li> <li>Model assumes isotropic reflection (not accurate for specular surfaces)</li> <li>Clear-sky model; not valid under cloudy conditions</li> <li>Input timestamps must be timezone-aware</li> </ul> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/diffuse/clear_sky/ground_reflected.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis</span><span class=p>(</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=n>elevation</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>=</span> <span class=n>DatetimeIndex</span><span class=p>([</span><span class=n>Timestamp</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>tz</span><span class=o>=</span><span class=s1>'UTC'</span><span class=p>)]),</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>=</span> <span class=n>ZoneInfo</span><span class=p>(</span><span class=s1>'UTC'</span><span class=p>),</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>    <span class=n>surface_tilt_threshold</span> <span class=o>=</span> <span class=n>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(),</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>ATMOSPHERIC_REFRACTION_FLAG_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>    <span class=c1># unrefracted_solar_zenith: UnrefractedSolarZenith | None = UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT,  # radians</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>    <span class=n>albedo</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>ALBEDO_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>    <span class=n>solar_position_model</span><span class=p>:</span> <span class=n>SolarPositionModel</span> <span class=o>=</span> <span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>    <span class=n>solar_time_model</span><span class=p>:</span> <span class=n>SolarTimeModel</span> <span class=o>=</span> <span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SOLAR_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ClearSkyDiffuseGroundReflectedInclinedIrradiance</span><span class=p>:</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    Calculate the clear-sky ground-reflected diffuse irradiance on an inclined</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    surface.</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    Calculates the component of diffuse irradiance that reaches an inclined</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    surface after reflection from the ground under clear-sky conditions. This</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    component is proportional to the global horizontal irradiance [Ghc], the</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    solar surface tilt angle, the mean ground albedo [g] and a fraction of the</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    ground viewed by an inclined surface [rg(N)]. The calculation follows the</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    isotropic sky model where ground-reflected radiation is uniformly</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    distributed.</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    The ground-reflected irradiance is calculated as:</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    .. math::</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>        I_{gr} = I_g \cdot F_{gv} \cdot \\rho</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>    where:</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    - :math:`I_{gr}` is the ground-reflected irradiance on the inclined surface</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    - :math:`I_g` is the global horizontal irradiance</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>    - :math:`F_{gv}` is the ground view fraction: :math:`(1 - \cos(\\beta)) / 2`</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    - :math:`\\beta` is the surface tilt angle</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    - :math:`\\rho` is the ground albedo</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>    For near-horizontal surfaces (tilt  threshold), ground reflection is</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    negligible and set to zero.</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>    longitude : float</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>        Geographic longitude in decimal degrees. East is positive, west is</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>        negative. Valid range: [-180, 180].</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>    latitude : float</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>        Geographic latitude in decimal degrees. North is positive, south is</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>        negative. Valid range: [-90, 90].</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    elevation : float</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>        Site elevation above sea level in meters. Used for atmospheric</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>        corrections in irradiance calculations.</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    timestamps : pandas.DatetimeIndex</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>        Time series index for calculations. Must be timezone-aware for</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>        accurate solar position computations.</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>    timezone : str</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>        IANA timezone identifier (e.g., 'UTC', 'Europe/Rome'). Used for</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>        local time conversions in solar position algorithms.</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    surface_orientation : float</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>        Surface azimuth angle in degrees. 0 = North, 90 = East, 180 = South,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>        270 = West. Determines horizontal orientation of the inclined surface.</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>    surface_tilt : float</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>        Surface tilt angle from horizontal in degrees. 0 = horizontal,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>        90 = vertical. Valid range: [0, 90].</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>    surface_tilt_threshold : float, optional</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>        Minimum tilt angle in degrees below which ground reflection is</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>        considered negligible and set to zero. Default is typically a small</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>        value (e.g., 1).</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>    albedo : float, optional</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>        Ground surface albedo (reflectivity), dimensionless. Typical values:</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>        0.2 (grass, soil), 0.3-0.5 (sand, concrete), 0.8 (fresh snow).</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>        Valid range: [0, 1]. Default varies by application.</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>    linke_turbidity_factor_series : LinkeTurbidityFactor, optional</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>        Linke turbidity factor values characterizing atmospheric turbidity.</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>        Typical range: [1.0, 6.0]. Default is</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>        ``LinkeTurbidityFactor()``.</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>    adjust_for_atmospheric_refraction : bool, optional</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=sd>        Whether to apply atmospheric refraction correction to solar angles.</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=sd>        Affects accuracy near horizon. Default is True.</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a><span class=sd>    solar_position_model : str, optional</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=sd>        Algorithm for solar position calculations (e.g., 'NOAA', 'PSA').</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a><span class=sd>        Default is ``SOLAR_POSITION_MODEL_DEFAULT``.</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a><span class=sd>    solar_time_model : str, optional</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a><span class=sd>        Solar time calculation method. Default is ``SOLAR_TIME_MODEL_DEFAULT``.</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a><span class=sd>    solar_constant : float, optional</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=sd>        Solar constant in Wm. Default is ``SOLAR_CONSTANT`` (~1361 Wm).</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a><span class=sd>    eccentricity_phase_offset : float, optional</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=sd>        Phase offset for Earth's orbital eccentricity correction in radians.</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a><span class=sd>        Default is ``ECCENTRICITY_PHASE_OFFSET``.</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=sd>    eccentricity_amplitude : float, optional</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=sd>        Amplitude of orbital eccentricity correction. Default is</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>        ``ECCENTRICITY_CORRECTION_FACTOR``.</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>        NumPy data type for array operations. Default is ``DATA_TYPE_DEFAULT``.</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=sd>        Array backend ('numpy', 'cupy', 'dask'). Default is</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a><span class=sd>        ``ARRAY_BACKEND_DEFAULT``.</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a><span class=sd>        Verbosity level for debugging output. When exceeding</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=sd>        ``DEBUG_AFTER_THIS_VERBOSITY_LEVEL``, prints all local variables</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=sd>        using devtools.debug. Default is ``VERBOSE_LEVEL_DEFAULT``.</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a><span class=sd>        Logging level for data fingerprinting. When exceeding</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a><span class=sd>        ``HASH_AFTER_THIS_VERBOSITY_LEVEL``, logs data hashes for</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=sd>        reproducibility tracking. Default is ``LOG_LEVEL_DEFAULT``.</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a><span class=sd>    ClearSkyDiffuseGroundReflectedInclinedIrradiance</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a><span class=sd>        Data model containing:</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a><span class=sd>        - **value** : numpy.ndarray</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>            Ground-reflected irradiance values in Wm for each timestamp</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>        - **out_of_range** : bool</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=sd>            Flag indicating if any values exceed physical bounds</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a><span class=sd>        - **out_of_range_index** : numpy.ndarray</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a><span class=sd>            Indices of out-of-range values</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>        - **ground_view_fraction** : float</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=sd>            Fraction of ground visible from tilted surface (0 to 0.5)</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=sd>        - **albedo** : float</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a><span class=sd>            Ground albedo used in calculation</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>        - **global_horizontal_irradiance** : numpy.ndarray</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=sd>            Global horizontal irradiance values used</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>        - **direct_horizontal_irradiance** : array or None</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>            Direct component of horizontal irradiance</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a><span class=sd>        - **diffuse_horizontal_irradiance** : array or None</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a><span class=sd>            Diffuse component of horizontal irradiance</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=sd>        - **solar_positioning_algorithm** : str</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a><span class=sd>            Solar position algorithm used</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>        - **solar_timing_algorithm** : str</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a><span class=sd>            Solar time algorithm used</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a><span class=sd>        - **location** : tuple</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a><span class=sd>            (longitude, latitude) coordinates</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>        - **elevation** : float</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a><span class=sd>            Site elevation in meters</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>        - **surface_orientation** : float</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a><span class=sd>            Surface azimuth in degrees</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a><span class=sd>        - **surface_tilt** : float</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a><span class=sd>            Surface tilt in degrees</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a><span class=sd>        - **surface_tilt_threshold** : float</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a><span class=sd>            Tilt threshold used</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=sd>    **Ground View Fraction:**</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=sd>    The ground view fraction represents the solid angle subtended by the ground</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a><span class=sd>    as seen from the tilted surface:</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a><span class=sd>    - Horizontal surface (0): F_gv = 0 (no ground visible)</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a><span class=sd>    - Vertical surface (90): F_gv = 0.5 (half hemisphere is ground)</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a><span class=sd>    - Tilted surface: F_gv = (1 - cos()) / 2</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a><span class=sd>    **Tilt Threshold Behavior:**</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a><span class=sd>    When ``surface_tilt &lt;= surface_tilt_threshold``, the function:</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a><span class=sd>    1. Sets ground view fraction to 0</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a><span class=sd>    2. Creates zero-valued arrays for ground reflection</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a><span class=sd>    3. Avoids unnecessary computation for negligible contributions</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a><span class=sd>    This optimization is physically justified as near-horizontal surfaces</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a><span class=sd>    receive minimal ground-reflected radiation.</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a><span class=sd>    **Global Horizontal Irradiance**</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a><span class=sd>    The function internally computes the global horizontal irradiance as:</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a><span class=sd>    .. math::</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a><span class=sd>        I_g = I_{bh} + I_{dh}</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a><span class=sd>    where I_bh is direct horizontal and I_dh is diffuse horizontal irradiance,</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a><span class=sd>    both calculated using clear-sky models.</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a><span class=sd>    **Physical Constraints**</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a><span class=sd>    - Ground-reflected irradiance cannot exceed global horizontal irradiance</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a><span class=sd>    - Albedo values outside [0, 1] produce unphysical results</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a><span class=sd>    - Results valid only for clear-sky conditions</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a><span class=sd>    - Model assumes isotropic ground reflection (Lambertian surface)</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a><span class=sd>    See Also</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a><span class=sd>    calculate_clear_sky_direct_horizontal_irradiance_series : Computes direct component</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a><span class=sd>    calculate_clear_sky_diffuse_horizontal_irradiance : Computes diffuse component</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a><span class=sd>    ClearSkyDiffuseGroundReflectedInclinedIrradiance : Output data model</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a><span class=sd>    .. [1] Duffie, J. A., &amp; Beckman, W. A. (2013). *Solar Engineering of Thermal</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a><span class=sd>           Processes* (4th ed.). Wiley. Chapter 2: Available Solar Radiation.</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a><span class=sd>    .. [2] Perez, R., et al. (1987). A new simplified version of the Perez diffuse</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a><span class=sd>           irradiance model for tilted surfaces. *Solar Energy*, 39(3), 221-231.</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a><span class=sd>    Calculate ground reflection for a south-facing tilted surface:</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a><span class=sd>    &gt;&gt;&gt; import pandas as pd</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a><span class=sd>    &gt;&gt;&gt; import numpy as np</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype import Longitude, Latitude</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.ground_reflected import (</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a><span class=sd>    ...     calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a><span class=sd>    &gt;&gt;&gt; </span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a><span class=sd>    &gt;&gt;&gt; # Summer day, hourly data</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a><span class=sd>    &gt;&gt;&gt; timestamps = pd.date_range('2024-06-21', periods=24, freq='h', tz='UTC')</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a><span class=sd>    &gt;&gt;&gt; </span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a><span class=sd>    &gt;&gt;&gt; # Location: Rome, Italy</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a><span class=sd>    &gt;&gt;&gt; longitude = Longitude(value=12.496, unit='degrees')</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a><span class=sd>    &gt;&gt;&gt; latitude = Latitude(value=41.903, unit='degrees')</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a><span class=sd>    &gt;&gt;&gt; # Solar surface position</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a><span class=sd>    &gt;&gt;&gt; surface_orientation = SurfaceOrientation(value=180, unit='degrees')</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a><span class=sd>    &gt;&gt;&gt; surface_tilt = SurfaceTilt(value=180, unit='degrees')</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a><span class=sd>    &gt;&gt;&gt; # Calculate irradiance</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a><span class=sd>    &gt;&gt;&gt; result = calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis(</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a><span class=sd>    ...     longitude=longitude.radians,</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a><span class=sd>    ...     latitude=latitude.radians,</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a><span class=sd>    ...     elevation=20,</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a><span class=sd>    ...     timestamps=timestamps,</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a><span class=sd>    ...     timezone='Europe/Rome',</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a><span class=sd>    ...     surface_orientation=surface_orientation.radians,  # South-facing</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a><span class=sd>    ...     surface_tilt=surface_tilt.radians,</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a><span class=sd>    ...     albedo=0.2                # Grass/soil</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a><span class=sd>    &gt;&gt;&gt; </span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"Ground view fraction: {result.ground_view_fraction:.3f}")</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a><span class=sd>    Ground view fraction: 1.000</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"Peak ground-reflected irradiance: {result.value.max():.1f} W/m")</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a><span class=sd>    Peak ground-reflected irradiance: 241.5 W/m</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"Daily total: {result.value.sum():.1f} Wh/m")</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a><span class=sd>    Daily total: 2221.9 Wh/m</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a><span class=sd>    Compare albedo effects</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a><span class=sd>    &gt;&gt;&gt; # Low albedo (dark soil)</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a><span class=sd>    &gt;&gt;&gt; result_dark = calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis(</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a><span class=sd>    ...     longitude=longitude.radians,</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a><span class=sd>    ...     latitude=latitude.radians,</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a><span class=sd>    ...     elevation=20,</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a><span class=sd>    ...     timestamps=timestamps,</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a><span class=sd>    ...     timezone='Europe/Rome',</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a><span class=sd>    ...     surface_orientation=surface_orientation.radians,</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a><span class=sd>    ...     surface_tilt=surface_tilt.radians,</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a><span class=sd>    ...     albedo=0.15</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a><span class=sd>    &gt;&gt;&gt; </span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a><span class=sd>    &gt;&gt;&gt; # High albedo (concrete)</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a><span class=sd>    &gt;&gt;&gt; result_bright = calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis(</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a><span class=sd>    ...     longitude=longitude.radians,</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a><span class=sd>    ...     latitude=latitude.radians,</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a><span class=sd>    ...     elevation=20,</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a><span class=sd>    ...     timestamps=timestamps,</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a><span class=sd>    ...     timezone='Europe/Rome',</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a><span class=sd>    ...     surface_orientation=surface_orientation.radians,</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a><span class=sd>    ...     surface_tilt=surface_tilt.radians,</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a><span class=sd>    ...     albedo=0.4</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a><span class=sd>    &gt;&gt;&gt; </span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a><span class=sd>    &gt;&gt;&gt; albedo_ratio = result_bright.value.max() / result_dark.value.max()</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><a href=#__codelineno-0-328><span class=linenos data-linenos="328 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"Bright/dark albedo ratio: {albedo_ratio:.2f}")</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a><span class=sd>    Bright/dark albedo ratio: 2.67</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a><span class=sd>    Near-horizontal surface (negligible ground reflection)</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a><span class=sd>    &gt;&gt;&gt; result_flat = calculate_clear_sky_ground_reflected_inclined_irradiance_series_pvgis(</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a><span class=sd>    ...     longitude=longitude.radians,</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a><span class=sd>    ...     latitude=latitude.radians,</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a><span class=sd>    ...     elevation=20,</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a><span class=sd>    ...     timestamps=timestamps,</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><a href=#__codelineno-0-338><span class=linenos data-linenos="338 "></span></a><span class=sd>    ...     timezone='Europe/Rome',</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><a href=#__codelineno-0-339><span class=linenos data-linenos="339 "></span></a><span class=sd>    ...     surface_orientation=surface_orientation.radians,  # South-facing</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><a href=#__codelineno-0-340><span class=linenos data-linenos="340 "></span></a><span class=sd>    ...     surface_tilt=0.1,  # Nearly horizontal</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><a href=#__codelineno-0-341><span class=linenos data-linenos="341 "></span></a><span class=sd>    ...     surface_tilt_threshold=1.0,</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><a href=#__codelineno-0-342><span class=linenos data-linenos="342 "></span></a><span class=sd>    ...     albedo=0.2                # Grass/soil</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><a href=#__codelineno-0-343><span class=linenos data-linenos="343 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><a href=#__codelineno-0-344><span class=linenos data-linenos="344 "></span></a><span class=sd>    &gt;&gt;&gt; </span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><a href=#__codelineno-0-345><span class=linenos data-linenos="345 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"Ground view fraction: {result_flat.ground_view_fraction}")</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><a href=#__codelineno-0-346><span class=linenos data-linenos="346 "></span></a><span class=sd>    0.0  # Threshold triggered, no ground reflection</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><a href=#__codelineno-0-347><span class=linenos data-linenos="347 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"All values zero: {np.all(result_flat.value == 0)}")</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><a href=#__codelineno-0-348><span class=linenos data-linenos="348 "></span></a><span class=sd>    True</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><a href=#__codelineno-0-349><span class=linenos data-linenos="349 "></span></a>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><a href=#__codelineno-0-350><span class=linenos data-linenos="350 "></span></a><span class=sd>    Warnings</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><a href=#__codelineno-0-351><span class=linenos data-linenos="351 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><a href=#__codelineno-0-352><span class=linenos data-linenos="352 "></span></a><span class=sd>    - Tilt angle must be in degrees, not radians</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><a href=#__codelineno-0-353><span class=linenos data-linenos="353 "></span></a><span class=sd>    - Albedo values should be realistic for the surface type</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><a href=#__codelineno-0-354><span class=linenos data-linenos="354 "></span></a><span class=sd>    - Model assumes isotropic reflection (not accurate for specular surfaces)</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><a href=#__codelineno-0-355><span class=linenos data-linenos="355 "></span></a><span class=sd>    - Clear-sky model; not valid under cloudy conditions</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><a href=#__codelineno-0-356><span class=linenos data-linenos="356 "></span></a><span class=sd>    - Input timestamps must be timezone-aware</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><a href=#__codelineno-0-357><span class=linenos data-linenos="357 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><a href=#__codelineno-0-358><span class=linenos data-linenos="358 "></span></a>    <span class=c1># build reusable parameter dictionaries</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><a href=#__codelineno-0-359><span class=linenos data-linenos="359 "></span></a>    <span class=n>coordinates</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><a href=#__codelineno-0-360><span class=linenos data-linenos="360 "></span></a>        <span class=s1>'longitude'</span><span class=p>:</span> <span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><a href=#__codelineno-0-361><span class=linenos data-linenos="361 "></span></a>        <span class=s1>'latitude'</span><span class=p>:</span> <span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><a href=#__codelineno-0-362><span class=linenos data-linenos="362 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><a href=#__codelineno-0-363><span class=linenos data-linenos="363 "></span></a>    <span class=n>time</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a><a href=#__codelineno-0-364><span class=linenos data-linenos="364 "></span></a>        <span class=s1>'timestamps'</span><span class=p>:</span> <span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><a href=#__codelineno-0-365><span class=linenos data-linenos="365 "></span></a>        <span class=s1>'timezone'</span><span class=p>:</span> <span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><a href=#__codelineno-0-366><span class=linenos data-linenos="366 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><a href=#__codelineno-0-367><span class=linenos data-linenos="367 "></span></a>    <span class=n>solar_positioning</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><a href=#__codelineno-0-368><span class=linenos data-linenos="368 "></span></a>        <span class=s1>'solar_position_model'</span><span class=p>:</span> <span class=n>solar_position_model</span><span class=p>,</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><a href=#__codelineno-0-369><span class=linenos data-linenos="369 "></span></a>        <span class=s1>'adjust_for_atmospheric_refraction'</span><span class=p>:</span> <span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><a href=#__codelineno-0-370><span class=linenos data-linenos="370 "></span></a>        <span class=s1>'solar_time_model'</span><span class=p>:</span> <span class=n>solar_time_model</span><span class=p>,</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><a href=#__codelineno-0-371><span class=linenos data-linenos="371 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><a href=#__codelineno-0-372><span class=linenos data-linenos="372 "></span></a>    <span class=n>earth_orbit</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><a href=#__codelineno-0-373><span class=linenos data-linenos="373 "></span></a>        <span class=s1>'eccentricity_phase_offset'</span><span class=p>:</span> <span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><a href=#__codelineno-0-374><span class=linenos data-linenos="374 "></span></a>        <span class=s1>'eccentricity_amplitude'</span><span class=p>:</span> <span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><a href=#__codelineno-0-375><span class=linenos data-linenos="375 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><a href=#__codelineno-0-376><span class=linenos data-linenos="376 "></span></a>    <span class=n>array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><a href=#__codelineno-0-377><span class=linenos data-linenos="377 "></span></a>        <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><a href=#__codelineno-0-378><span class=linenos data-linenos="378 "></span></a>        <span class=s2>"array_backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><a href=#__codelineno-0-379><span class=linenos data-linenos="379 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><a href=#__codelineno-0-380><span class=linenos data-linenos="380 "></span></a>    <span class=n>output_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><a href=#__codelineno-0-381><span class=linenos data-linenos="381 "></span></a>        <span class=s1>'verbose'</span><span class=p>:</span> <span class=n>verbose</span><span class=p>,</span>  <span class=c1># Is this wanted here ? i.e. not setting = 0 ?</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><a href=#__codelineno-0-382><span class=linenos data-linenos="382 "></span></a>        <span class=s1>'log'</span><span class=p>:</span> <span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><a href=#__codelineno-0-383><span class=linenos data-linenos="383 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><a href=#__codelineno-0-384><span class=linenos data-linenos="384 "></span></a>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><a href=#__codelineno-0-385><span class=linenos data-linenos="385 "></span></a>    <span class=k>if</span> <span class=n>surface_tilt</span> <span class=o>&lt;=</span> <span class=n>surface_tilt_threshold</span><span class=p>:</span>  <span class=c1># No ground reflection for a flat or nearly flat surface</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><a href=#__codelineno-0-386><span class=linenos data-linenos="386 "></span></a>        <span class=n>ground_view_fraction</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><a href=#__codelineno-0-387><span class=linenos data-linenos="387 "></span></a>        <span class=c1># in order to avoid 'NameError's</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a><a href=#__codelineno-0-388><span class=linenos data-linenos="388 "></span></a>        <span class=n>flat_surface_array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a><a href=#__codelineno-0-389><span class=linenos data-linenos="389 "></span></a>            <span class=s2>"shape"</span><span class=p>:</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a><a href=#__codelineno-0-390><span class=linenos data-linenos="390 "></span></a>            <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><a href=#__codelineno-0-391><span class=linenos data-linenos="391 "></span></a>            <span class=s2>"init_method"</span><span class=p>:</span> <span class=s2>"zeros"</span><span class=p>,</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a><a href=#__codelineno-0-392><span class=linenos data-linenos="392 "></span></a>            <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><a href=#__codelineno-0-393><span class=linenos data-linenos="393 "></span></a>        <span class=p>}</span>  <span class=c1># Borrow shape from timestamps</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a><a href=#__codelineno-0-394><span class=linenos data-linenos="394 "></span></a>        <span class=n>global_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>flat_surface_array_parameters</span><span class=p>)</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><a href=#__codelineno-0-395><span class=linenos data-linenos="395 "></span></a>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><a href=#__codelineno-0-396><span class=linenos data-linenos="396 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><a href=#__codelineno-0-397><span class=linenos data-linenos="397 "></span></a>        <span class=n>ground_view_fraction</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>cos</span><span class=p>(</span><span class=n>surface_tilt</span><span class=p>))</span> <span class=o>/</span> <span class=mi>2</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><a href=#__codelineno-0-398><span class=linenos data-linenos="398 "></span></a>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><a href=#__codelineno-0-399><span class=linenos data-linenos="399 "></span></a>    <span class=n>direct_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_clear_sky_direct_horizontal_irradiance_series</span><span class=p>(</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><a href=#__codelineno-0-400><span class=linenos data-linenos="400 "></span></a>        <span class=o>**</span><span class=n>coordinates</span><span class=p>,</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><a href=#__codelineno-0-401><span class=linenos data-linenos="401 "></span></a>        <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><a href=#__codelineno-0-402><span class=linenos data-linenos="402 "></span></a>        <span class=o>**</span><span class=n>time</span><span class=p>,</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><a href=#__codelineno-0-403><span class=linenos data-linenos="403 "></span></a>        <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><a href=#__codelineno-0-404><span class=linenos data-linenos="404 "></span></a>        <span class=n>solar_time_model</span><span class=o>=</span><span class=n>solar_time_model</span><span class=p>,</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><a href=#__codelineno-0-405><span class=linenos data-linenos="405 "></span></a>        <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><a href=#__codelineno-0-406><span class=linenos data-linenos="406 "></span></a>        <span class=o>**</span><span class=n>earth_orbit</span><span class=p>,</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><a href=#__codelineno-0-407><span class=linenos data-linenos="407 "></span></a>        <span class=o>**</span><span class=n>array_parameters</span><span class=p>,</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><a href=#__codelineno-0-408><span class=linenos data-linenos="408 "></span></a>        <span class=o>**</span><span class=n>output_parameters</span><span class=p>,</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a><a href=#__codelineno-0-409><span class=linenos data-linenos="409 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><a href=#__codelineno-0-410><span class=linenos data-linenos="410 "></span></a>    <span class=n>diffuse_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_clear_sky_diffuse_horizontal_irradiance</span><span class=p>(</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><a href=#__codelineno-0-411><span class=linenos data-linenos="411 "></span></a>        <span class=o>**</span><span class=n>coordinates</span><span class=p>,</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><a href=#__codelineno-0-412><span class=linenos data-linenos="412 "></span></a>        <span class=o>**</span><span class=n>time</span><span class=p>,</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a><a href=#__codelineno-0-413><span class=linenos data-linenos="413 "></span></a>        <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a><a href=#__codelineno-0-414><span class=linenos data-linenos="414 "></span></a>        <span class=c1># unrefracted_solar_zenith=unrefracted_solar_zenith,</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a><a href=#__codelineno-0-415><span class=linenos data-linenos="415 "></span></a>        <span class=o>**</span><span class=n>solar_positioning</span><span class=p>,</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a><a href=#__codelineno-0-416><span class=linenos data-linenos="416 "></span></a>        <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a><a href=#__codelineno-0-417><span class=linenos data-linenos="417 "></span></a>        <span class=o>**</span><span class=n>earth_orbit</span><span class=p>,</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a><a href=#__codelineno-0-418><span class=linenos data-linenos="418 "></span></a>        <span class=o>**</span><span class=n>array_parameters</span><span class=p>,</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a><a href=#__codelineno-0-419><span class=linenos data-linenos="419 "></span></a>        <span class=o>**</span><span class=n>output_parameters</span><span class=p>,</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a><a href=#__codelineno-0-420><span class=linenos data-linenos="420 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a><a href=#__codelineno-0-421><span class=linenos data-linenos="421 "></span></a>    <span class=n>global_horizontal_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a><a href=#__codelineno-0-422><span class=linenos data-linenos="422 "></span></a>        <span class=n>direct_horizontal_irradiance_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a><a href=#__codelineno-0-423><span class=linenos data-linenos="423 "></span></a>        <span class=o>+</span> <span class=n>diffuse_horizontal_irradiance_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a><a href=#__codelineno-0-424><span class=linenos data-linenos="424 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><a href=#__codelineno-0-425><span class=linenos data-linenos="425 "></span></a>    <span class=c1># --------------------------------------------------------------------</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><a href=#__codelineno-0-426><span class=linenos data-linenos="426 "></span></a>    <span class=c1># At this point, the `global_horizontal_irradiance_series` is either :</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a><a href=#__codelineno-0-427><span class=linenos data-linenos="427 "></span></a>    <span class=c1># _read_ from external time series  Or  simulated </span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a><a href=#__codelineno-0-428><span class=linenos data-linenos="428 "></span></a>    <span class=c1># --------------------------------------------------------------------</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a><a href=#__codelineno-0-429><span class=linenos data-linenos="429 "></span></a>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a><a href=#__codelineno-0-430><span class=linenos data-linenos="430 "></span></a>    <span class=n>ground_reflected_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>asarray</span><span class=p>(</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a><a href=#__codelineno-0-431><span class=linenos data-linenos="431 "></span></a>        <span class=n>global_horizontal_irradiance_series</span> <span class=o>*</span> <span class=n>ground_view_fraction</span> <span class=o>*</span> <span class=n>albedo</span><span class=p>,</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a><a href=#__codelineno-0-432><span class=linenos data-linenos="432 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a><a href=#__codelineno-0-433><span class=linenos data-linenos="433 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><a href=#__codelineno-0-434><span class=linenos data-linenos="434 "></span></a>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a><a href=#__codelineno-0-435><span class=linenos data-linenos="435 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a><a href=#__codelineno-0-436><span class=linenos data-linenos="436 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>ground_reflected_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a><a href=#__codelineno-0-437><span class=linenos data-linenos="437 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a><a href=#__codelineno-0-438><span class=linenos data-linenos="438 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>ClearSkyDiffuseGroundReflectedInclinedIrradiance</span><span class=p>(),</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a><a href=#__codelineno-0-439><span class=linenos data-linenos="439 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a><a href=#__codelineno-0-440><span class=linenos data-linenos="440 "></span></a>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a><a href=#__codelineno-0-441><span class=linenos data-linenos="441 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a><a href=#__codelineno-0-442><span class=linenos data-linenos="442 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a><a href=#__codelineno-0-443><span class=linenos data-linenos="443 "></span></a>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a><a href=#__codelineno-0-444><span class=linenos data-linenos="444 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a><a href=#__codelineno-0-445><span class=linenos data-linenos="445 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>ground_reflected_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a><a href=#__codelineno-0-446><span class=linenos data-linenos="446 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a><a href=#__codelineno-0-447><span class=linenos data-linenos="447 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a><a href=#__codelineno-0-448><span class=linenos data-linenos="448 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a><a href=#__codelineno-0-449><span class=linenos data-linenos="449 "></span></a>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a><a href=#__codelineno-0-450><span class=linenos data-linenos="450 "></span></a>    <span class=c1># Common output structure</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a><a href=#__codelineno-0-451><span class=linenos data-linenos="451 "></span></a>    <span class=n>function_output</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a><a href=#__codelineno-0-452><span class=linenos data-linenos="452 "></span></a>        <span class=s2>"value"</span><span class=p>:</span> <span class=n>ground_reflected_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a><a href=#__codelineno-0-453><span class=linenos data-linenos="453 "></span></a>        <span class=s2>"out_of_range"</span><span class=p>:</span> <span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a><a href=#__codelineno-0-454><span class=linenos data-linenos="454 "></span></a>        <span class=s2>"out_of_range_index"</span><span class=p>:</span> <span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a><a href=#__codelineno-0-455><span class=linenos data-linenos="455 "></span></a>        <span class=s2>"ground_view_fraction"</span><span class=p>:</span> <span class=n>ground_view_fraction</span><span class=p>,</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a><a href=#__codelineno-0-456><span class=linenos data-linenos="456 "></span></a>        <span class=s2>"albedo"</span><span class=p>:</span> <span class=n>albedo</span><span class=p>,</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a><a href=#__codelineno-0-457><span class=linenos data-linenos="457 "></span></a>        <span class=s2>"global_horizontal_irradiance"</span><span class=p>:</span> <span class=n>global_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a><a href=#__codelineno-0-458><span class=linenos data-linenos="458 "></span></a>        <span class=s2>"direct_horizontal_irradiance"</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><a href=#__codelineno-0-459><span class=linenos data-linenos="459 "></span></a>            <span class=n>direct_horizontal_irradiance_series</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><a href=#__codelineno-0-460><span class=linenos data-linenos="460 "></span></a>            <span class=k>if</span> <span class=s2>"direct_horizontal_irradiance_series"</span> <span class=ow>in</span> <span class=nb>locals</span><span class=p>()</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><a href=#__codelineno-0-461><span class=linenos data-linenos="461 "></span></a>            <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><a href=#__codelineno-0-462><span class=linenos data-linenos="462 "></span></a>        <span class=p>),</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a><a href=#__codelineno-0-463><span class=linenos data-linenos="463 "></span></a>        <span class=s2>"diffuse_horizontal_irradiance"</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a><a href=#__codelineno-0-464><span class=linenos data-linenos="464 "></span></a>            <span class=n>diffuse_horizontal_irradiance_series</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a><a href=#__codelineno-0-465><span class=linenos data-linenos="465 "></span></a>            <span class=k>if</span> <span class=s2>"diffuse_horizontal_irradiance_series"</span> <span class=ow>in</span> <span class=nb>locals</span><span class=p>()</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a><a href=#__codelineno-0-466><span class=linenos data-linenos="466 "></span></a>            <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a><a href=#__codelineno-0-467><span class=linenos data-linenos="467 "></span></a>        <span class=p>),</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a><a href=#__codelineno-0-468><span class=linenos data-linenos="468 "></span></a>        <span class=s2>"solar_positioning_algorithm"</span><span class=p>:</span> <span class=nb>getattr</span><span class=p>(</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a><a href=#__codelineno-0-469><span class=linenos data-linenos="469 "></span></a>            <span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a><a href=#__codelineno-0-470><span class=linenos data-linenos="470 "></span></a>            <span class=s2>"solar_positioning_algorithm"</span><span class=p>,</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a><a href=#__codelineno-0-471><span class=linenos data-linenos="471 "></span></a>            <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a><a href=#__codelineno-0-472><span class=linenos data-linenos="472 "></span></a>        <span class=p>),</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a><a href=#__codelineno-0-473><span class=linenos data-linenos="473 "></span></a>        <span class=s2>"solar_timing_algorithm"</span><span class=p>:</span> <span class=nb>getattr</span><span class=p>(</span>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a><a href=#__codelineno-0-474><span class=linenos data-linenos="474 "></span></a>            <span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span> <span class=s2>"solar_timing_algorithm"</span><span class=p>,</span> <span class=kc>None</span>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a><a href=#__codelineno-0-475><span class=linenos data-linenos="475 "></span></a>        <span class=p>),</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a><a href=#__codelineno-0-476><span class=linenos data-linenos="476 "></span></a>        <span class=s2>"location"</span><span class=p>:</span> <span class=p>(</span><span class=n>longitude</span><span class=p>,</span> <span class=n>latitude</span><span class=p>),</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a><a href=#__codelineno-0-477><span class=linenos data-linenos="477 "></span></a>        <span class=s2>"elevation"</span><span class=p>:</span> <span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-478><a id=__codelineno-0-478 name=__codelineno-0-478></a><a href=#__codelineno-0-478><span class=linenos data-linenos="478 "></span></a>        <span class=s2>"surface_orientation"</span><span class=p>:</span> <span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-479><a id=__codelineno-0-479 name=__codelineno-0-479></a><a href=#__codelineno-0-479><span class=linenos data-linenos="479 "></span></a>        <span class=s2>"surface_tilt"</span><span class=p>:</span> <span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-480><a id=__codelineno-0-480 name=__codelineno-0-480></a><a href=#__codelineno-0-480><span class=linenos data-linenos="480 "></span></a>        <span class=s2>"surface_tilt_threshold"</span><span class=p>:</span> <span class=n>surface_tilt_threshold</span><span class=p>,</span>
</span><span id=__span-0-481><a id=__codelineno-0-481 name=__codelineno-0-481></a><a href=#__codelineno-0-481><span class=linenos data-linenos="481 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-482><a id=__codelineno-0-482 name=__codelineno-0-482></a><a href=#__codelineno-0-482><span class=linenos data-linenos="482 "></span></a>    <span class=k>return</span> <span class=n>ClearSkyDiffuseGroundReflectedInclinedIrradiance</span><span class=p>(</span><span class=o>**</span><span class=n>function_output</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.horizontal> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">horizontal</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.horizontal title="Permanent link"></a></h6> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.horizontal.calculate_clear_sky_diffuse_horizontal_irradiance_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_clear_sky_diffuse_horizontal_irradiance_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.horizontal.calculate_clear_sky_diffuse_horizontal_irradiance_hofierka</code>)'>calculate_clear_sky_diffuse_horizontal_irradiance_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate clear-sky diffuse sky-reflected horizontal irradiance using</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h7 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.horizontal.calculate_clear_sky_diffuse_horizontal_irradiance_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_clear_sky_diffuse_horizontal_irradiance_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.horizontal.calculate_clear_sky_diffuse_horizontal_irradiance_hofierka title="Permanent link"></a></h7> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_clear_sky_diffuse_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.DiffuseSkyReflectedHorizontalIrradiance>DiffuseSkyReflectedHorizontalIrradiance</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate clear-sky diffuse sky-reflected horizontal irradiance using Hofierka's model.</p> <p>Calculates the diffuse sky-reflected component of solar irradiance on a horizontal surface under cloudless sky conditions using Hofierka's empirical clear-sky model. This implementation follows the theoretical framework where diffuse irradiance is the product of extraterrestrial irradiance, a diffuse transmission function, and a solar altitude function.</p> <p>The model estimates diffuse horizontal irradiance (Dc) as:</p> <p>.. math:: D_{hc} = G_0 \cdot T_n(T_{LK}) \cdot F_d(h_0)</p> <p>where G is the extraterrestrial normal irradiance, T is the diffuse transmission function dependent on Linke turbidity, and F is the solar altitude function.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>Time series index for which to calculate diffuse irradiance. Must be timezone-aware for accurate solar position calculations.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>linke_turbidity_factor_series</code> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></code> </td> <td> <div class=doc-md-description> <p>Linke turbidity factor values for each timestamp, characterizing atmospheric turbidity. Typical values range from 1.0 (clean) to 6.0 (very turbid). Default is set in <code>LinkeTurbidityFactor()</code>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>solar_altitude_series</code> </td> <td> <code><span title=pvgisprototype.SolarAltitude>SolarAltitude</span> or None</code> </td> <td> <div class=doc-md-description> <p>Pre-calculated solar altitude angles in radians. If None, must be calculated externally before calling this function. Negative values (sun below horizon) are automatically set to NaN. Default is None.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>solar_constant</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Solar constant in Wm. Represents the solar irradiance at mean Earth-Sun distance outside the atmosphere. Default is <code>SOLAR_CONSTANT</code> (typically 1361 Wm).</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>eccentricity_phase_offset</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Phase offset for Earth's orbital eccentricity correction in radians. Accounts for perihelion timing. Default is <code>ECCENTRICITY_PHASE_OFFSET</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>eccentricity_amplitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Amplitude of Earth's orbital eccentricity correction factor. Adjusts for varying Earth-Sun distance throughout the year. Default is <code>ECCENTRICITY_CORRECTION_FACTOR</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>NumPy data type for array operations (e.g., 'float32', 'float64'). Default is <code>DATA_TYPE_DEFAULT</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Array backend to use for computations ('numpy', 'cupy', 'dask'). Default is <code>ARRAY_BACKEND_DEFAULT</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level for debugging output. When exceeding <code>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</code>, prints all local variables. Default is <code>VERBOSE_LEVEL_DEFAULT</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Logging level for data fingerprinting. When exceeding <code>HASH_AFTER_THIS_VERBOSITY_LEVEL</code>, logs data hashes for reproducibility tracking. Default is <code>LOG_LEVEL_DEFAULT</code>.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.DiffuseSkyReflectedHorizontalIrradiance>DiffuseSkyReflectedHorizontalIrradiance</span></code> </td> <td> <div class=doc-md-description> <p>Data model containing:</p> <ul> <li><strong>value</strong> : numpy.ndarray Diffuse horizontal irradiance values in Wm for each timestamp</li> <li><strong>out_of_range</strong> : bool Flag indicating if any values exceed physical bounds</li> <li><strong>out_of_range_index</strong> : numpy.ndarray Indices of out-of-range values</li> <li><strong>extraterrestrial_normal_irradiance</strong> : array Calculated extraterrestrial irradiance values</li> <li><strong>linke_turbidity_factor</strong> : LinkeTurbidityFactor Input turbidity values used in calculation</li> <li><strong>solar_altitude</strong> : SolarAltitude Solar altitude angles used in calculation</li> <li><strong>solar_positioning_algorithm</strong> : str Algorithm used for solar position calculations</li> <li><strong>adjust_for_atmospheric_refraction</strong> : bool Whether atmospheric refraction correction was applied</li> </ul> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p><strong>Implementation Details</strong></p> <ul> <li>Negative solar altitudes (sun below horizon) are automatically set to NaN, then converted to zero irradiance</li> <li>Out-of-range values are identified and flagged based on physical constraints</li> <li>The function is cached for performance optimization</li> <li>All calculations are vectorized for efficiency over time series</li> </ul> <p><strong>Physical Validity</strong></p> <ul> <li>Valid only for cloudless sky conditions</li> <li>Results are physically meaningful only when sun is above horizon</li> <li>Linke turbidity should be within [1.0, 6.0] range</li> <li>Output irradiance cannot exceed extraterrestrial values</li> </ul> <p><strong>Model Limitations</strong></p> <ul> <li>Assumes horizontally homogeneous atmosphere</li> <li>Does not include ground-reflected component</li> <li>Model calibrated for mid-latitude conditions (?)</li> </ul> </details> <details class=see-also open> <summary>See Also</summary> <p>calculate_diffuse_transmission_function_series_hofierka : Calculates T(T_LK) calculate_diffuse_solar_altitude_function_series_hofierka : Calculates F(h) calculate_extraterrestrial_normal_irradiance_series : Calculates G pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude : Altitude function module</p> </details> <details class=references open> <summary>References</summary> <p>.. [1] Hofierka, J., &amp; ri, M. (2002). The solar radiation model for Open source GIS: implementation and applications. <em>Proceedings of the Open source GIS - GRASS users conference</em>, Trento, Italy. .. [2] Rigollier, C., Bauer, O., &amp; Wald, L. (2000). On the clear sky model of the ESRAEuropean Solar Radiation Atlaswith respect to the Heliosat method. <em>Solar Energy</em>, 68(1), 33-48.</p> </details> <p><span class=doc-section-title>Examples:</span></p> <p>Calculate diffuse irradiance for a single day :</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype</span><span class=w> </span><span class=kn>import</span> <span class=n>SolarAltitude</span><span class=p>,</span> <span class=n>LinkeTurbidityFactor</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.horizontal</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=gp>... </span>    <span class=n>calculate_clear_sky_diffuse_horizontal_irradiance_hofierka</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=gp>&gt;&gt;&gt;</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Create hourly timestamps for one day</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>timestamps</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=gp>... </span>    <span class=s1>'2024-06-21'</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>24</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>'h'</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s1>'UTC'</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=gp>&gt;&gt;&gt;</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Calculate solar altitude (normally done via solar position function)</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Here using example values for demonstration</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a><span class=gp>&gt;&gt;&gt; </span><span class=n>altitude_values</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a><span class=gp>... </span>    <span class=o>-</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.4</span><span class=p>,</span> <span class=mf>0.6</span><span class=p>,</span> <span class=mf>0.8</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>1.1</span><span class=p>,</span> <span class=mf>1.2</span><span class=p>,</span> <span class=mf>1.2</span><span class=p>,</span> <span class=mf>1.15</span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a><span class=gp>... </span>    <span class=mf>1.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>0.8</span><span class=p>,</span> <span class=mf>0.6</span><span class=p>,</span> <span class=mf>0.4</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.2</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.4</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.6</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.6</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a><span class=gp>... </span><span class=p>])</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a><span class=gp>&gt;&gt;&gt; </span><span class=n>solar_altitude</span> <span class=o>=</span> <span class=n>SolarAltitude</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=n>altitude_values</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=s1>'radians'</span><span class=p>)</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a><span class=gp>&gt;&gt;&gt;</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Constant moderate turbidity</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a><span class=gp>&gt;&gt;&gt; </span><span class=n>turbidity</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>full</span><span class=p>(</span><span class=mi>24</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>))</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a><span class=gp>&gt;&gt;&gt;</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Calculate diffuse irradiance</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a><span class=gp>&gt;&gt;&gt; </span><span class=n>result</span> <span class=o>=</span> <span class=n>calculate_clear_sky_diffuse_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a><span class=gp>... </span>    <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a><span class=gp>... </span>    <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude</span><span class=p>,</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a><span class=gp>... </span>    <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>turbidity</span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a><span class=gp>&gt;&gt;&gt;</span>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Display results</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Max diffuse irradiance: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> W/m"</span><span class=p>)</span>
</span></code></pre></div> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Daily total: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> Wh/m"</span><span class=p>)</span>
</span></code></pre></div> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt;</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Check for out-of-range values</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=k>if</span> <span class=n>result</span><span class=o>.</span><span class=n>out_of_range</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>... </span>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Warning: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>out_of_range_index</span><span class=p>)</span><span class=si>}</span><span class=s2> values out of range"</span><span class=p>)</span>
</span></code></pre></div> <p>Calculate with time-varying turbidity :</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=c1># Simulate varying atmospheric conditions</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>turbidity_varying</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>... </span>    <span class=n>value</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mf>2.5</span><span class=p>,</span> <span class=mf>3.5</span><span class=p>,</span> <span class=mi>24</span><span class=p>)</span>  <span class=c1># Increasing turbidity</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=gp>&gt;&gt;&gt; </span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>result_varying</span> <span class=o>=</span> <span class=n>calculate_clear_sky_diffuse_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=gp>... </span>    <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=gp>... </span>    <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=gp>... </span>    <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>turbidity_varying</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=gp>&gt;&gt;&gt; </span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Turbidity effect: </span><span class=si>{</span><span class=n>result_varying</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>result</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> W/m"</span><span class=p>)</span>
</span></code></pre></div> <details class=warning open> <summary>Warnings</summary> <ul> <li>Negative solar altitudes are automatically converted to zero irradiance</li> <li>Input arrays (timestamps, turbidity, altitude) must have matching dimensions</li> <li>Very high turbidity values (&gt;6.0) may produce physically unrealistic results (?)</li> </ul> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/diffuse/clear_sky/horizontal.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_clear_sky_diffuse_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=c1># linke_turbidity_factor_series: LinkeTurbidityFactor = LinkeTurbidityFactor(),</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n>SolarAltitude</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SOLAR_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DiffuseSkyReflectedHorizontalIrradiance</span><span class=p>:</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    Calculate clear-sky diffuse sky-reflected horizontal irradiance using</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    Hofierka's model.</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    Calculates the diffuse sky-reflected component of solar irradiance on a</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    horizontal surface under cloudless sky conditions using Hofierka's</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    empirical clear-sky model. This implementation follows the theoretical</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    framework where diffuse irradiance is the product of extraterrestrial</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    irradiance, a diffuse transmission function, and a solar altitude function.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    The model estimates diffuse horizontal irradiance (Dc) as:</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    .. math::</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>        D_{hc} = G_0 \cdot T_n(T_{LK}) \cdot F_d(h_0)</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    where G is the extraterrestrial normal irradiance, T is the diffuse</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    transmission function dependent on Linke turbidity, and F is the solar</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    altitude function.</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    timestamps : pandas.DatetimeIndex</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>        Time series index for which to calculate diffuse irradiance. Must be</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>        timezone-aware for accurate solar position calculations.</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    linke_turbidity_factor_series : LinkeTurbidityFactor, optional</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>        Linke turbidity factor values for each timestamp, characterizing</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>        atmospheric turbidity. Typical values range from 1.0 (clean) to 6.0</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>        (very turbid). Default is set in ``LinkeTurbidityFactor()``.</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    solar_altitude_series : SolarAltitude or None, optional</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>        Pre-calculated solar altitude angles in radians. If None, must be</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>        calculated externally before calling this function. Negative values</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>        (sun below horizon) are automatically set to NaN. Default is None.</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>    solar_constant : float, optional</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>        Solar constant in Wm. Represents the solar irradiance at mean</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>        Earth-Sun distance outside the atmosphere. Default is ``SOLAR_CONSTANT``</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>        (typically 1361 Wm).</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>    eccentricity_phase_offset : float, optional</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>        Phase offset for Earth's orbital eccentricity correction in radians.</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        Accounts for perihelion timing. Default is ``ECCENTRICITY_PHASE_OFFSET``.</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    eccentricity_amplitude : float, optional</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>        Amplitude of Earth's orbital eccentricity correction factor. Adjusts</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>        for varying Earth-Sun distance throughout the year. Default is</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>        ``ECCENTRICITY_CORRECTION_FACTOR``.</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>        NumPy data type for array operations (e.g., 'float32', 'float64').</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>        Default is ``DATA_TYPE_DEFAULT``.</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>        Array backend to use for computations ('numpy', 'cupy', 'dask').</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>        Default is ``ARRAY_BACKEND_DEFAULT``.</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>        Verbosity level for debugging output. When exceeding</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>        ``DEBUG_AFTER_THIS_VERBOSITY_LEVEL``, prints all local variables.</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>        Default is ``VERBOSE_LEVEL_DEFAULT``.</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>        Logging level for data fingerprinting. When exceeding</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>        ``HASH_AFTER_THIS_VERBOSITY_LEVEL``, logs data hashes for</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>        reproducibility tracking. Default is ``LOG_LEVEL_DEFAULT``.</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    DiffuseSkyReflectedHorizontalIrradiance</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>        Data model containing:</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>        - **value** : numpy.ndarray</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>            Diffuse horizontal irradiance values in Wm for each timestamp</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>        - **out_of_range** : bool</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>            Flag indicating if any values exceed physical bounds</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>        - **out_of_range_index** : numpy.ndarray</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>            Indices of out-of-range values</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>        - **extraterrestrial_normal_irradiance** : array</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>            Calculated extraterrestrial irradiance values</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>        - **linke_turbidity_factor** : LinkeTurbidityFactor</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>            Input turbidity values used in calculation</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>        - **solar_altitude** : SolarAltitude</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>            Solar altitude angles used in calculation</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>        - **solar_positioning_algorithm** : str</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>            Algorithm used for solar position calculations</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>        - **adjust_for_atmospheric_refraction** : bool</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>            Whether atmospheric refraction correction was applied</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=sd>    **Implementation Details**</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a><span class=sd>    - Negative solar altitudes (sun below horizon) are automatically set to NaN,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a><span class=sd>      then converted to zero irradiance</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a><span class=sd>    - Out-of-range values are identified and flagged based on physical constraints</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=sd>    - The function is cached for performance optimization</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a><span class=sd>    - All calculations are vectorized for efficiency over time series</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a><span class=sd>    **Physical Validity**</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=sd>    - Valid only for cloudless sky conditions</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>    - Results are physically meaningful only when sun is above horizon</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=sd>    - Linke turbidity should be within [1.0, 6.0] range</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>    - Output irradiance cannot exceed extraterrestrial values</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=sd>    **Model Limitations**</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=sd>    - Assumes horizontally homogeneous atmosphere</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a><span class=sd>    - Does not include ground-reflected component</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=sd>    - Model calibrated for mid-latitude conditions (?)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a><span class=sd>    See Also</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a><span class=sd>    calculate_diffuse_transmission_function_series_hofierka : Calculates T(T_LK)</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=sd>    calculate_diffuse_solar_altitude_function_series_hofierka : Calculates F(h)</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a><span class=sd>    calculate_extraterrestrial_normal_irradiance_series : Calculates G</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a><span class=sd>    pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.altitude : Altitude function module</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a><span class=sd>    .. [1] Hofierka, J., &amp; ri, M. (2002). The solar radiation model for Open</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a><span class=sd>           source GIS: implementation and applications. *Proceedings of the</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>           Open source GIS - GRASS users conference*, Trento, Italy.</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>    .. [2] Rigollier, C., Bauer, O., &amp; Wald, L. (2000). On the clear sky model</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=sd>           of the ESRAEuropean Solar Radiation Atlaswith respect to the</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a><span class=sd>           Heliosat method. *Solar Energy*, 68(1), 33-48.</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=sd>    Calculate diffuse irradiance for a single day :</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>    &gt;&gt;&gt; import pandas as pd</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=sd>    &gt;&gt;&gt; import numpy as np</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype import SolarAltitude, LinkeTurbidityFactor</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.horizontal import (</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a><span class=sd>    ...     calculate_clear_sky_diffuse_horizontal_irradiance_hofierka</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=sd>    &gt;&gt;&gt;</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a><span class=sd>    &gt;&gt;&gt; # Create hourly timestamps for one day</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>    &gt;&gt;&gt; timestamps = pd.date_range(</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a><span class=sd>    ...     '2024-06-21', periods=24, freq='h', tz='UTC'</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a><span class=sd>    &gt;&gt;&gt;</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>    &gt;&gt;&gt; # Calculate solar altitude (normally done via solar position function)</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a><span class=sd>    &gt;&gt;&gt; # Here using example values for demonstration</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>    &gt;&gt;&gt; altitude_values = np.array([</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a><span class=sd>    ...     -0.5, -0.3, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.1, 1.2, 1.2, 1.15,</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a><span class=sd>    ...     1.1, 1.0, 0.8, 0.6, 0.4, 0.2, 0.0, -0.2, -0.4, -0.5, -0.6, -0.6</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a><span class=sd>    ... ])</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a><span class=sd>    &gt;&gt;&gt; solar_altitude = SolarAltitude(value=altitude_values, unit='radians')</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a><span class=sd>    &gt;&gt;&gt;</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a><span class=sd>    &gt;&gt;&gt; # Constant moderate turbidity</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a><span class=sd>    &gt;&gt;&gt; turbidity = LinkeTurbidityFactor(value=np.full(24, 3.0))</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a><span class=sd>    &gt;&gt;&gt;</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=sd>    &gt;&gt;&gt; # Calculate diffuse irradiance</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a><span class=sd>    &gt;&gt;&gt; result = calculate_clear_sky_diffuse_horizontal_irradiance_hofierka(</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=sd>    ...     timestamps=timestamps,</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a><span class=sd>    ...     solar_altitude_series=solar_altitude,</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a><span class=sd>    ...     linke_turbidity_factor_series=turbidity</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a><span class=sd>    &gt;&gt;&gt;</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a><span class=sd>    &gt;&gt;&gt; # Display results</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"Max diffuse irradiance: {result.value.max():.1f} W/m")</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"Daily total: {result.value.sum():.1f} Wh/m")</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a><span class=sd>    &gt;&gt;&gt;</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a><span class=sd>    &gt;&gt;&gt; # Check for out-of-range values</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a><span class=sd>    &gt;&gt;&gt; if result.out_of_range is not None:</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a><span class=sd>    ...     print(f"Warning: {len(result.out_of_range_index)} values out of range")</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a><span class=sd>    Calculate with time-varying turbidity :</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a><span class=sd>    &gt;&gt;&gt; # Simulate varying atmospheric conditions</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a><span class=sd>    &gt;&gt;&gt; turbidity_varying = LinkeTurbidityFactor(</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a><span class=sd>    ...     value=np.linspace(2.5, 3.5, 24)  # Increasing turbidity</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a><span class=sd>    &gt;&gt;&gt; </span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a><span class=sd>    &gt;&gt;&gt; result_varying = calculate_clear_sky_diffuse_horizontal_irradiance_hofierka(</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a><span class=sd>    ...     timestamps=timestamps,</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a><span class=sd>    ...     solar_altitude_series=solar_altitude,</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a><span class=sd>    ...     linke_turbidity_factor_series=turbidity_varying</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a><span class=sd>    &gt;&gt;&gt; </span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a><span class=sd>    &gt;&gt;&gt; print(f"Turbidity effect: {result_varying.value.max() - result.value.max():.1f} W/m")</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a><span class=sd>    Warnings</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a><span class=sd>    - Negative solar altitudes are automatically converted to zero irradiance</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a><span class=sd>    - Input arrays (timestamps, turbidity, altitude) must have matching</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a><span class=sd>      dimensions</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a><span class=sd>    - Very high turbidity values (&gt;6.0) may produce physically unrealistic</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a><span class=sd>      results (?)</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>    <span class=n>extraterrestrial_normal_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>        <span class=n>calculate_extraterrestrial_normal_irradiance_series</span><span class=p>(</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>            <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>            <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>            <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>            <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>            <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>            <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>            <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>            <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>    <span class=c1># Should this maybe happen already outside this function ? ---------------</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>    <span class=c1># Suppress negative solar altitude, else we get high-negative diffuse output</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>    <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>    <span class=c1># ------------------------------------------------------------------------</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>    <span class=n>diffuse_horizontal_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>        <span class=n>extraterrestrial_normal_irradiance_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>        <span class=o>*</span> <span class=n>calculate_diffuse_transmission_function_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>            <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>            <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>        <span class=o>*</span> <span class=n>calculate_diffuse_solar_altitude_function_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>            <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>            <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>            <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>    <span class=c1># ------------------------------------------------------------------------</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>    <span class=n>diffuse_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan_to_num</span><span class=p>(</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>        <span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span> <span class=n>nan</span><span class=o>=</span><span class=mi>0</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>    <span class=p>)</span>  <span class=c1># safer ? -------------------------------------------------------------</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>DiffuseSkyReflectedHorizontalIrradiance</span><span class=p>(),</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a>    <span class=k>return</span> <span class=n>DiffuseSkyReflectedHorizontalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a>        <span class=n>extraterrestrial_normal_irradiance</span><span class=o>=</span><span class=n>extraterrestrial_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a>        <span class=n>linke_turbidity_factor</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a>        <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>        <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>adjusted_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">transmission_function</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function title="Permanent link"></a></h6> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function.calculate_diffuse_transmission_function_series_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_diffuse_transmission_function_series_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function.calculate_diffuse_transmission_function_series_hofierka</code>)'>calculate_diffuse_transmission_function_series_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Diffuse transmission function over a period of time</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h7 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function.calculate_diffuse_transmission_function_series_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_diffuse_transmission_function_series_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.clear_sky.transmission_function.calculate_diffuse_transmission_function_series_hofierka title="Permanent link"></a></h7> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_diffuse_transmission_function_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>(),</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=numpy.ndarray>ndarray</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Diffuse transmission function over a period of time</p> <p>The diffuse transmission function T(T_LK) represents the theoretical diffuse irradiance on a horizontal surface with the sun at zenith, normalized for air mass 2 :</p> <p>.. math:: T_n(T_{LK}) = -0.015843 + 0.030543 T_{LK} + 0.0003797 T_{LK}^2</p> <p>This quadratic relationship captures how atmospheric turbidity modulates the transmission of diffuse radiation.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>linke_turbidity_factor_series</code> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></code> </td> <td> <div class=doc-md-description> <p>linke_turbidity_factor_series</p> </div> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span>()</code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>dtype</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>array_backend</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>verbose</p> </div> </td> <td> <code>0</code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>log</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>From Thomas Huld's custom <code>r.pv</code> source code:</p> <div class=codehilite><pre><span></span><code>tn = -0.015843 + locLinke <span class=gs>* (0.030543 + 0.0003797 *</span> locLinke);
</code></pre></div> <p>From Hofierka (2002) :</p> <div class=codehilite><pre><span></span><code><span class=nv>The</span><span class=w> </span><span class=nv>estimate</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>transmission</span><span class=w> </span><span class=nv>function</span><span class=w> </span><span class=nv>Tn</span><span class=ss>(</span><span class=nv>TLK</span><span class=ss>)</span><span class=w> </span><span class=nv>gives</span><span class=w> </span><span class=nv>a</span><span class=w> </span><span class=nv>theoretical</span>
<span class=nv>diffuse</span><span class=w> </span><span class=nv>irradiance</span><span class=w> </span><span class=nv>on</span><span class=w> </span><span class=nv>a</span><span class=w> </span><span class=nv>horizontal</span><span class=w> </span><span class=nv>surface</span><span class=w> </span><span class=nv>with</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>sun</span><span class=w> </span><span class=nv>vertically</span>
<span class=nv>overhead</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>air</span><span class=w> </span><span class=nv>mass</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=nv>Linke</span><span class=w> </span><span class=nv>turbidity</span><span class=w> </span><span class=nv>factor</span>.<span class=w> </span><span class=nv>The</span><span class=w> </span><span class=nv>following</span>
<span class=nv>second</span><span class=w> </span><span class=nv>order</span><span class=w> </span><span class=nv>polynomial</span><span class=w> </span><span class=nv>expression</span><span class=w> </span><span class=nv>is</span><span class=w> </span><span class=nv>used</span>:

<span class=nv>Tn</span><span class=ss>(</span><span class=nv>TLK</span><span class=ss>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=mi>0</span>.<span class=mi>015843</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>0</span>.<span class=mi>030543</span><span class=w> </span><span class=nv>TLK</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>0</span>.<span class=mi>0003797</span><span class=w> </span><span class=nv>TLK</span><span class=o>^</span><span class=mi>2</span>
</code></pre></div> </details> <details class=references open> <summary>References</summary> <p>.. [1] Hofierka, J., &amp; ri, M. (2002). The solar radiation model for Open source GIS: implementation and applications. <em>Proceedings of the Open source GIS - GRASS users conference</em>, Trento, Italy.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/diffuse/clear_sky/transmission_function.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_diffuse_transmission_function_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(),</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=w>    </span><span class=sd>"""Diffuse transmission function over a period of time</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=sd>    The diffuse transmission function T(T_LK) represents the theoretical</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=sd>    diffuse irradiance on a horizontal surface with the sun at zenith,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=sd>    normalized for air mass 2 :</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=sd>    .. math::</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=sd>        T_n(T_{LK}) = -0.015843 + 0.030543 T_{LK} + 0.0003797 T_{LK}^2</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=sd>    This quadratic relationship captures how atmospheric turbidity modulates the</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=sd>    transmission of diffuse radiation.</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>    linke_turbidity_factor_series :</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>        linke_turbidity_factor_series</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    dtype : str</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>        dtype</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    array_backend : str</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>        array_backend</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    verbose : int</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>        verbose</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    log : int</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>        log</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    ndarray</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    From Thomas Huld's custom `r.pv` source code:</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>        tn = -0.015843 + locLinke * (0.030543 + 0.0003797 * locLinke);</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    From Hofierka (2002) :</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        The estimate of the transmission function Tn(TLK) gives a theoretical</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>        diffuse irradiance on a horizontal surface with the sun vertically</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>        overhead for the air mass 2 Linke turbidity factor. The following</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        second order polynomial expression is used:</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>        Tn(TLK) = -0.015843 + 0.030543 TLK + 0.0003797 TLK^2</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    .. [1] Hofierka, J., &amp; ri, M. (2002). The solar radiation model for Open</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>           source GIS: implementation and applications. *Proceedings of the</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>           Open source GIS - GRASS users conference*, Trento, Italy.</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=n>linke_turbidity_factor_series_squared_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=n>linke_turbidity_factor_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=n>diffuse_transmission_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>        <span class=o>-</span><span class=mf>0.015843</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=o>+</span> <span class=mf>0.030543</span> <span class=o>*</span> <span class=n>linke_turbidity_factor_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=o>+</span> <span class=mf>0.0003797</span> <span class=o>*</span> <span class=n>linke_turbidity_factor_series_squared_array</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>diffuse_transmission_series</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=k>return</span> <span class=n>diffuse_transmission_series</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.ground_reflected> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">ground_reflected</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.ground_reflected title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.ground_reflected.calculate_ground_reflected_inclined_irradiance_series_pvgis title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_ground_reflected_inclined_irradiance_series_pvgis</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.ground_reflected.calculate_ground_reflected_inclined_irradiance_series_pvgis</code>)'>calculate_ground_reflected_inclined_irradiance_series_pvgis</a></code></td> <td> <div class=doc-md-description> <p>Calculate the clear-sky diffuse ground reflected irradiance on an inclined surface (Ri).</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.ground_reflected.calculate_ground_reflected_inclined_irradiance_series_pvgis> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_ground_reflected_inclined_irradiance_series_pvgis</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.ground_reflected.calculate_ground_reflected_inclined_irradiance_series_pvgis title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_ground_reflected_inclined_irradiance_series_pvgis</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>elevation</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>=</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>(</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=p>[</span><span class=n><span title=pandas.Timestamp.now>now</span></span><span class=p>(</span><span class=n><span title=pandas.Timestamp.now(tz)>tz</span></span><span class=o>=</span><span class=s2>"UTC"</span><span class=p>)]</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=p>),</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>surface_tilt_threshold</span><span class=o>=</span><span class=n><span title=pvgisprototype.constants.SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>albedo</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ALBEDO_DEFAULT>ALBEDO_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>global_horizontal_irradiance</span><span class=p>:</span> <span class=n><span title=numpy.ndarray>ndarray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the clear-sky diffuse ground reflected irradiance on an inclined surface (Ri).</p> <p>The calculation assumes isotropy. The ground reflected clear-sky irradiance received on an inclined surface [W.m-2] is proportional to the global horizontal irradiance Ghc, to the mean ground albedo g and a fraction of the ground viewed by an inclined surface rg(N).</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>longitude</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>latitude</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>elevation</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>elevation</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>timestamps</p> </div> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span>([<span title=pandas.Timestamp.now>now</span>(<span title=pandas.Timestamp.now(tz)>tz</span>='UTC')])</code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_orientation</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>surface_orientation</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_tilt</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>surface_tilt</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_tilt_threshold</code> </td> <td> </td> <td> <div class=doc-md-description> <p>surface_tilt_threshold</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>albedo</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a> | None</code> </td> <td> <div class=doc-md-description> <p>albedo</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ALBEDO_DEFAULT>ALBEDO_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>global_horizontal_irradiance</code> </td> <td> <code><span title=numpy.ndarray>ndarray</span> | None</code> </td> <td> <div class=doc-md-description> <p>global_horizontal_irradiance</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>dtype</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>array_backend</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>verbose</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>log</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/diffuse/ground_reflected.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_ground_reflected_inclined_irradiance_series_pvgis</span><span class=p>(</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>elevation</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>=</span> <span class=n>DatetimeIndex</span><span class=p>([</span><span class=n>Timestamp</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>tz</span><span class=o>=</span><span class=s1>'UTC'</span><span class=p>)]),</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>surface_tilt_threshold</span> <span class=o>=</span> <span class=n>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>albedo</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>ALBEDO_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>global_horizontal_irradiance</span><span class=p>:</span> <span class=n>ndarray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=p>):</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=w>    </span><span class=sd>"""Calculate the clear-sky diffuse ground reflected irradiance on an inclined surface (Ri).</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    The calculation assumes isotropy. The ground reflected clear-sky irradiance</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    received on an inclined surface [W.m-2] is proportional to the global</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    horizontal irradiance Ghc, to the mean ground albedo g and a fraction of</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    the ground viewed by an inclined surface rg(N).</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    longitude : float</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>        longitude</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    latitude : float</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>        latitude</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    elevation : float</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>        elevation</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        timestamps</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    surface_orientation : float</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>        surface_orientation</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    surface_tilt : float</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        surface_tilt</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    surface_tilt_threshold :</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>        surface_tilt_threshold</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>    albedo : float | None</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>        albedo</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    global_horizontal_irradiance : ndarray | None</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>        global_horizontal_irradiance</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    dtype : str</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>        dtype</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    array_backend : str</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>        array_backend</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    verbose : int</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>        verbose</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    log : int</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>        log</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=k>if</span> <span class=n>surface_tilt</span> <span class=o>&lt;=</span> <span class=n>surface_tilt_threshold</span><span class=p>:</span>  <span class=c1># No ground reflection for a flat or nearly flat surface</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=n>ground_view_fraction</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>        <span class=c1># in order to avoid 'NameError's</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=n>flat_surface_array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>            <span class=s2>"shape"</span><span class=p>:</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>            <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>            <span class=s2>"init_method"</span><span class=p>:</span> <span class=s2>"zeros"</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>            <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=p>}</span>  <span class=c1># Borrow shape from timestamps</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>global_horizontal_irradiance</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>flat_surface_array_parameters</span><span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=n>ground_view_fraction</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>cos</span><span class=p>(</span><span class=n>surface_tilt</span><span class=p>))</span> <span class=o>/</span> <span class=mi>2</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=n>ground_reflected_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>asarray</span><span class=p>(</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=n>global_horizontal_irradiance</span> <span class=o>*</span> <span class=n>ground_view_fraction</span> <span class=o>*</span> <span class=n>albedo</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>ground_reflected_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>DiffuseGroundReflectedInclinedIrradiance</span><span class=p>(),</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>ground_reflected_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>    <span class=c1># Common output structure</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>    <span class=n>function_output</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=s2>"value"</span><span class=p>:</span> <span class=n>ground_reflected_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=s2>"out_of_range"</span><span class=p>:</span> <span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=s2>"out_of_range_index"</span><span class=p>:</span> <span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=s2>"ground_view_fraction"</span><span class=p>:</span> <span class=n>ground_view_fraction</span><span class=p>,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=s2>"albedo"</span><span class=p>:</span> <span class=n>albedo</span><span class=p>,</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>        <span class=s2>"global_horizontal_irradiance"</span><span class=p>:</span> <span class=n>global_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=s2>"location"</span><span class=p>:</span> <span class=p>(</span><span class=n>longitude</span><span class=p>,</span> <span class=n>latitude</span><span class=p>),</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=s2>"elevation"</span><span class=p>:</span> <span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=s2>"surface_orientation"</span><span class=p>:</span> <span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=s2>"surface_tilt"</span><span class=p>:</span> <span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=s2>"surface_tilt_threshold"</span><span class=p>:</span> <span class=n>surface_tilt_threshold</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=k>return</span> <span class=n>DiffuseGroundReflectedInclinedIrradiance</span><span class=p>(</span><span class=o>**</span><span class=n>function_output</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.horizontal> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">horizontal</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.horizontal title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.horizontal.calculate_diffuse_horizontal_irradiance_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_diffuse_horizontal_irradiance_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.diffuse.horizontal.calculate_diffuse_horizontal_irradiance_hofierka</code>)'>calculate_diffuse_horizontal_irradiance_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the diffuse horizontal irradiance from <abbr title="Surface Solar Radiation Data records  Heliosat">SARAH</abbr> time series.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.diffuse.horizontal.calculate_diffuse_horizontal_irradiance_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_diffuse_horizontal_irradiance_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.diffuse.horizontal.calculate_diffuse_horizontal_irradiance_hofierka title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_diffuse_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>global_horizontal_irradiance_series</span><span class=p>:</span> <span class=n><span title=numpy._core.multiarray.ndarray>ndarray</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>direct_horizontal_irradiance_series</span><span class=p>:</span> <span class=n><span title=numpy._core.multiarray.ndarray>ndarray</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=p>(</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n><span title=pvgisprototype.DiffuseSkyReflectedHorizontalIrradianceFromExternalData>DiffuseSkyReflectedHorizontalIrradianceFromExternalData</span></span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the diffuse horizontal irradiance from <abbr title="Surface Solar Radiation Data records  Heliosat">SARAH</abbr> time series.</p> <p>Calculate the diffuse horizontal irradiance incident on a solar surface from <abbr title="Surface Solar Radiation Data records  Heliosat">SARAH</abbr> time series.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>global_horizontal_irradiance_series</code> </td> <td> <code><span title=numpy._core.multiarray.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>The global horizontal irradiance, also known as surface short-wave solar radiation downwards, is the solar radiation that reaches a horizontal plane at the surface of the Earth. This parameter comprises both direct and diffuse solar radiation.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>direct_horizontal_irradiance_series</code> </td> <td> <code><span title=numpy._core.multiarray.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>direct_horizontal_irradiance_series</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>dtype</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>array_backend</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>verbose</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>log</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.DiffuseSkyReflectedHorizontalIrradianceFromExternalData>DiffuseSkyReflectedHorizontalIrradianceFromExternalData</span></code> </td> <td> <div class=doc-md-description> <p>The diffuse radiant flux incident on a surface per unit area in W/m.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <div class=codehilite><pre><span></span><code><span class=n>The</span><span class=w> </span><span class=n>corresponding</span><span class=w> </span><span class=n>ECMWF</span><span class=w> </span><span class=n>product</span><span class=w> </span><span class=n>variable</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>named</span><span class=w> </span><span class="n n-Quoted">`ssrd`</span><span class=p>.</span>
</code></pre></div> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/diffuse/horizontal.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_diffuse_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a>    <span class=n>global_horizontal_irradiance_series</span><span class=p>:</span> <span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a>    <span class=n>direct_horizontal_irradiance_series</span><span class=p>:</span> <span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>  <span class=c1># Not yet integrated !</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DiffuseSkyReflectedHorizontalIrradianceFromExternalData</span><span class=p>:</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=w>    </span><span class=sd>"""Calculate the diffuse horizontal irradiance from SARAH time series.</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=sd>    Calculate the diffuse horizontal irradiance incident on a solar surface</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=sd>    from SARAH time series.</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=sd>    global_horizontal_irradiance_series : ndarray</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=sd>        The global horizontal irradiance, also known as surface short-wave</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=sd>        solar radiation downwards, is the solar radiation that reaches a</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>        horizontal plane at the surface of the Earth. This parameter comprises</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>        both direct and diffuse solar radiation.</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    direct_horizontal_irradiance_series : ndarray</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>        direct_horizontal_irradiance_series</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    dtype : str</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>        dtype</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    array_backend : str</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>        array_backend</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    verbose : int</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>        verbose</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    log : int</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>        log</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    DiffuseSkyReflectedHorizontalIrradianceFromExternalData</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>        The diffuse radiant flux incident on a surface per unit area in W/m.</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>        The corresponding ECMWF product variable is named `ssrd`.</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>    <span class=n>diffuse_horizontal_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=n>global_horizontal_irradiance_series</span> <span class=o>-</span> <span class=n>direct_horizontal_irradiance_series</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>    <span class=k>if</span> <span class=n>diffuse_horizontal_irradiance_series</span><span class=o>.</span><span class=n>size</span> <span class=o>==</span> <span class=mi>1</span> <span class=ow>and</span> <span class=n>diffuse_horizontal_irradiance_series</span><span class=o>.</span><span class=n>shape</span> <span class=o>==</span> <span class=p>():</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=n>diffuse_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>            <span class=p>[</span><span class=n>diffuse_horizontal_irradiance_series</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=n>single_value</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>diffuse_horizontal_irradiance_series</span><span class=p>)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>warning</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>            <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>exclamation_mark</span><span class=si>}</span><span class=s2> The selected timestamp "</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>            <span class=o>+</span> <span class=s2>" matches the single value "</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>            <span class=o>+</span> <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>single_value</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=n>warning</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>global_horizontal_irradiance_series</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>DiffuseSkyReflectedHorizontalIrradianceFromExternalData</span><span class=p>(),</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=k>return</span> <span class=n>DiffuseSkyReflectedHorizontalIrradianceFromExternalData</span><span class=p>(</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>global_horizontal_irradiance</span><span class=o>=</span><span class=n>global_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=n>direct_horizontal_irradiance</span><span class=o>=</span><span class=n>direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">direct</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">clear_sky</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky</code>)'>clear_sky</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.inclined title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">inclined</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.inclined</code>)'>inclined</a></code></td> <td> <div class=doc-md-description> <p>This Python module is part of PVGIS' API. It implements functions to calculate</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.normal title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">normal</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.normal</code>)'>normal</a></code></td> <td> <div class=doc-md-description> <p>This Python module is part of PVGIS' Algorithms. It implements a function to</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">clear_sky</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.horizontal title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">horizontal</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.horizontal</code>)'>horizontal</a></code></td> <td> <div class=doc-md-description> <p>This Python module is part of PVGIS' Algorithms. It implements functions to calculate</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.inclined title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">inclined</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.inclined</code>)'>inclined</a></code></td> <td> <div class=doc-md-description> <p>This Python module is part of PVGIS' API. It implements functions to calculate</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.linke_turbidity_factor title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">linke_turbidity_factor</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.linke_turbidity_factor</code>)'>linke_turbidity_factor</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.normal title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">normal</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.normal</code>)'>normal</a></code></td> <td> <div class=doc-md-description> <p>This Python module is part of PVGIS' Algorithms. It implements a function to</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.horizontal> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">horizontal</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.horizontal title="Permanent link"></a></h6> <div class="doc doc-contents"> <p>This Python module is part of PVGIS' Algorithms. It implements functions to calculate the direct solar irradiance.</p> <p><em>Direct</em> or <em>beam</em> irradiance is one of the main components of solar irradiance. It comes perpendicular from the Sun and is not scattered before it irradiates a surface.</p> <p>During a cloudy day the sunlight will be partially absorbed and scattered by different air molecules. The latter part is defined as the <em>diffuse</em> irradiance. The remaining part is the <em>direct</em> irradiance.</p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.horizontal.calculate_clear_sky_direct_horizontal_irradiance_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_clear_sky_direct_horizontal_irradiance_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.horizontal.calculate_clear_sky_direct_horizontal_irradiance_hofierka</code>)'>calculate_clear_sky_direct_horizontal_irradiance_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the direct horizontal irradiance</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h7 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.horizontal.calculate_clear_sky_direct_horizontal_irradiance_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_clear_sky_direct_horizontal_irradiance_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.horizontal.calculate_clear_sky_direct_horizontal_irradiance_hofierka title="Permanent link"></a></h7> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_clear_sky_direct_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>elevation</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>=</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>(</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>        <span class=p>[</span><span class=n><span title=pandas.Timestamp.now>now</span></span><span class=p>(</span><span class=n><span title=pandas.Timestamp.now(tz)>tz</span></span><span class=o>=</span><span class=s2>"UTC"</span><span class=p>)]</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=p>),</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LocationShading>LocationShading</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>(),</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.DirectHorizontalIrradiance>DirectHorizontalIrradiance</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the direct horizontal irradiance</p> <p>This function implements the algorithm described by Hofierka [1]_.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>elevation</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>elevation</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>timestamps</p> </div> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span>([<span title=pandas.Timestamp.now>now</span>(<span title=pandas.Timestamp.now(tz)>tz</span>='UTC')])</code> </td> </tr> <tr class=doc-section-item> <td> <code>solar_altitude_series</code> </td> <td> <code><span title=pvgisprototype.SolarAltitude>SolarAltitude</span> | None</code> </td> <td> <div class=doc-md-description> <p>solar_altitude_series</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_in_shade_series</code> </td> <td> <code><span title=pvgisprototype.LocationShading>LocationShading</span> | None</code> </td> <td> <div class=doc-md-description> <p>surface_in_shade_series</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>linke_turbidity_factor_series</code> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></code> </td> <td> <div class=doc-md-description> <p>linke_turbidity_factor_series</p> </div> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span>()</code> </td> </tr> <tr class=doc-section-item> <td> <code>solar_constant</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>solar_constant</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>eccentricity_phase_offset</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>eccentricity_phase_offset</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>eccentricity_amplitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>eccentricity_amplitude</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>dtype</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>array_backend</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>verbose</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>log</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.DirectHorizontalIrradiance>DirectHorizontalIrradiance</span></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>Known also as : <abbr title="Surface Incoming Direct radiation, commonly called direct irradiance">SID</abbr>, units : W*m-2</p> </details> <details class=references open> <summary>References</summary> <p>.. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/direct/clear_sky/horizontal.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_clear_sky_direct_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=n>elevation</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>=</span> <span class=n>DatetimeIndex</span><span class=p>([</span><span class=n>Timestamp</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>tz</span><span class=o>=</span><span class=s1>'UTC'</span><span class=p>)]),</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n>SolarAltitude</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n>LocationShading</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(),</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SOLAR_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DirectHorizontalIrradiance</span><span class=p>:</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=w>    </span><span class=sd>"""Calculate the direct horizontal irradiance</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    This function implements the algorithm described by Hofierka [1]_.</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    elevation : float</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>        elevation</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>        timestamps</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    solar_altitude_series : SolarAltitude | None</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>        solar_altitude_series</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    surface_in_shade_series : LocationShading | None</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>        surface_in_shade_series</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    linke_turbidity_factor_series : LinkeTurbidityFactor</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>        linke_turbidity_factor_series</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    solar_constant : float</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>        solar_constant</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    eccentricity_phase_offset : float</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>        eccentricity_phase_offset</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    eccentricity_amplitude : float</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>        eccentricity_amplitude</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    dtype : str</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>        dtype</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    array_backend : str</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>        array_backend</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    verbose : int</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        verbose</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    log : int</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>        log</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>    DirectHorizontalIrradiance</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>    Known also as : SID, units : W*m-2</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>    .. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=c1># expects solar altitude in degrees! ----------------------------------vvv</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=c1>#</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>    <span class=n>refracted_solar_altitude_series</span> <span class=o>=</span> <span class=n>calculate_refracted_solar_altitude_series</span><span class=p>(</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>  <span class=c1># expects altitude in degrees!</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>    <span class=n>optical_air_mass_series</span> <span class=o>=</span> <span class=n>calculate_optical_air_mass_series</span><span class=p>(</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>refracted_solar_altitude_series</span><span class=o>=</span><span class=n>refracted_solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=c1>#</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=c1># ^^^ ---------------------------------------- expects solar altitude in degrees!</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>    <span class=n>direct_normal_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_direct_normal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>optical_air_mass_series</span><span class=o>=</span><span class=n>optical_air_mass_series</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>    <span class=c1># Mask conditions</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>    <span class=n>mask_solar_altitude_positive</span> <span class=o>=</span> <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>    <span class=n>mask_not_in_shade</span> <span class=o>=</span> <span class=o>~</span><span class=n>surface_in_shade_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=n>mask_sunlit_surface_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>logical_and</span><span class=o>.</span><span class=n>reduce</span><span class=p>((</span><span class=n>mask_solar_altitude_positive</span><span class=p>,</span> <span class=n>mask_not_in_shade</span><span class=p>))</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=c1># Initialize the direct irradiance series to zeros</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>    <span class=n>array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>        <span class=s2>"shape"</span><span class=p>:</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>  <span class=c1># Borrow shape from timestamps</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>        <span class=s2>"init_method"</span><span class=p>:</span> <span class=s2>"zeros"</span><span class=p>,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>        <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>    <span class=n>direct_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>array_parameters</span><span class=p>)</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>    <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mask_sunlit_surface_series</span><span class=p>):</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>        <span class=n>direct_horizontal_irradiance_series</span><span class=p>[</span><span class=n>mask_sunlit_surface_series</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>            <span class=n>direct_normal_irradiance_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>            <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=p>)[</span><span class=n>mask_sunlit_surface_series</span><span class=p>]</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>DirectHorizontalIrradiance</span><span class=p>(),</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=k>return</span> <span class=n>DirectHorizontalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>        <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>        <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=n>refracted_solar_altitude</span><span class=o>=</span><span class=n>refracted_solar_altitude_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=n>optical_air_mass</span><span class=o>=</span><span class=n>optical_air_mass_series</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>        <span class=n>direct_normal_irradiance</span><span class=o>=</span><span class=n>direct_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>        <span class=n>surface_in_shade</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=n>solar_radiation_model</span><span class=o>=</span><span class=n>HOFIERKA_2002</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=n>data_source</span><span class=o>=</span><span class=n>HOFIERKA_2002</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.inclined> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">inclined</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.inclined title="Permanent link"></a></h6> <div class="doc doc-contents"> <p>This Python module is part of PVGIS' API. It implements functions to calculate the direct solar irradiance.</p> <p><em>Direct</em> or <em>beam</em> irradiance is one of the main components of solar irradiance. It comes perpendicular from the Sun and is not scattered before it irradiates a surface.</p> <p>During a cloudy day the sunlight will be partially absorbed and scattered by different air molecules. The latter part is defined as the <em>diffuse</em> irradiance. The remaining part is the <em>direct</em> irradiance.</p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.inclined.calculate_clear_sky_direct_inclined_irradiance_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_clear_sky_direct_inclined_irradiance_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.inclined.calculate_clear_sky_direct_inclined_irradiance_hofierka</code>)'>calculate_clear_sky_direct_inclined_irradiance_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the direct irradiance incident on a tilted surface [W*m-2].</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h7 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.inclined.calculate_clear_sky_direct_inclined_irradiance_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_clear_sky_direct_inclined_irradiance_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.inclined.calculate_clear_sky_direct_inclined_irradiance_hofierka title="Permanent link"></a></h7> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_clear_sky_direct_inclined_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>elevation</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>        <span class=n><span title=pvgisprototype.SurfaceOrientation>SurfaceOrientation</span></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=p>)</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceTilt>SurfaceTilt</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>(</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>        <span class=p>[</span><span class=n><span title=pandas.Timestamp.now>now</span></span><span class=p>(</span><span class=n><span title=pandas.Timestamp.now(tz)>tz</span></span><span class=o>=</span><span class=s2>"UTC"</span><span class=p>)]</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=p>),</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>),</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>direct_horizontal_irradiance</span><span class=p>:</span> <span class=n><span title=numpy.ndarray>ndarray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>(),</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>apply_reflectivity_factor</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarIncidence>SolarIncidence</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LocationShading>LocationShading</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.DirectInclinedIrradiance>DirectInclinedIrradiance</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the direct irradiance incident on a tilted surface [W*m-2].</p> <p>Calculate the direct irradiance on an inclined surface based on the solar radiation model by Hofierka, 2002. [1]_</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>elevation</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>elevation</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>surface_orientation</code> </td> <td> <code><span title=pvgisprototype.SurfaceOrientation>SurfaceOrientation</span> | None</code> </td> <td> <div class=doc-md-description> <p>surface_orientation</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_tilt</code> </td> <td> <code><span title=pvgisprototype.SurfaceTilt>SurfaceTilt</span> | None</code> </td> <td> <div class=doc-md-description> <p>surface_tilt</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span> | None</code> </td> <td> <div class=doc-md-description> <p>timestamps</p> </div> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span>([<span title=pandas.Timestamp.now>now</span>(<span title=pandas.Timestamp.now(tz)>tz</span>='UTC')])</code> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a> | None</code> </td> <td> <div class=doc-md-description> <p>timezone</p> </div> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a>('UTC')</code> </td> </tr> <tr class=doc-section-item> <td> <code>direct_horizontal_irradiance</code> </td> <td> <code><span title=numpy.ndarray>ndarray</span> | None</code> </td> <td> <div class=doc-md-description> <p>direct_horizontal_irradiance</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>linke_turbidity_factor_series</code> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></code> </td> <td> <div class=doc-md-description> <p>linke_turbidity_factor_series</p> </div> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span>()</code> </td> </tr> <tr class=doc-section-item> <td> <code>apply_reflectivity_factor</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> <p>apply_reflectivity_factor</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>solar_incidence_series</code> </td> <td> <code><span title=pvgisprototype.SolarIncidence>SolarIncidence</span> | None</code> </td> <td> <div class=doc-md-description> <p>solar_incidence_series</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>solar_altitude_series</code> </td> <td> <code><span title=pvgisprototype.SolarAltitude>SolarAltitude</span> | None</code> </td> <td> <div class=doc-md-description> <p>solar_altitude_series</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_in_shade_series</code> </td> <td> <code><span title=pvgisprototype.LocationShading>LocationShading</span> | None</code> </td> <td> <div class=doc-md-description> <p>surface_in_shade_series</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>solar_constant</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>solar_constant</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>eccentricity_phase_offset</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>eccentricity_phase_offset</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>eccentricity_amplitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>eccentricity_amplitude</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>dtype</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>array_backend</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>validate_output</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> <p>validate_output</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>verbose</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>log</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.DirectInclinedIrradiance>DirectInclinedIrradiance</span></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>In Hofierka (2002) [1]_, see equation 11 :</p> <div class=codehilite><pre><span></span><code>Bic = B0c sin exp
</code></pre></div> <p>or equation 12 :</p> <div class=codehilite><pre><span></span><code>      B    sin    
       hc        exp          W 
B   =      in  
 ic       sin h               -2
               0             m  
</code></pre></div> <p>where :</p> <ul> <li>exp is the solar incidence angle measured between the sun and an inclined surface defined in equation 16</li> </ul> <p>or else :</p> <div class=codehilite><pre><span></span><code>Direct Inclined = Direct Horizontal * sin( Solar Incidence ) / sin( Solar Altitude )
</code></pre></div> <p>The implementation by Hofierka (2002) uses the solar incidence angle between the sun-vector and the plane of the reference surface (as per Jeno, 1992). This is very important and relates to the hardcoded value <code>True</code> for the <code>complementary_incidence_angle</code> input parameter of the function. We call this angle (definition) the <em>complementary</em> incidence angle.</p> <p>For the losses due to reflectivity, the incidence angle modifier by Martin &amp; Ruiz (2005) expects the incidence angle between the sun-vector and the surface-normal. Hence, the respective call of the function <code>calculate_reflectivity_factor_for_direct_irradiance_series()</code>, expects the complement of the angle defined by Jeno (1992). We call the incidence angle expected by the incidence angle modifier by Martin &amp; Ruiz (2005) the <em>typical</em> incidence angle.</p> <p>See also the documentation of the function <code>calculate_solar_incidence_series_jenco()</code>.</p> </details> <details class=references open> <summary>References</summary> <p>.. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/direct/clear_sky/inclined.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_clear_sky_direct_inclined_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=n>elevation</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n>SurfaceOrientation</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n>SurfaceTilt</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>    <span class=c1>#</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>DatetimeIndex</span><span class=p>([</span><span class=n>Timestamp</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>tz</span><span class=o>=</span><span class=s1>'UTC'</span><span class=p>)]),</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>ZoneInfo</span><span class=p>(</span><span class=s1>'UTC'</span><span class=p>),</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=c1>#</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>    <span class=n>direct_horizontal_irradiance</span><span class=p>:</span> <span class=n>ndarray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(),</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>    <span class=n>apply_reflectivity_factor</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n>SolarIncidence</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n>SolarAltitude</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>    <span class=c1># solar_azimuth_series: SolarAzimuth | None = None,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n>LocationShading</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=c1>#</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SOLAR_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>    <span class=c1>#</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=c1>#</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DirectInclinedIrradiance</span><span class=p>:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=w>    </span><span class=sd>"""Calculate the direct irradiance incident on a tilted surface [W*m-2].</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    Calculate the direct irradiance on an inclined surface based on the</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    solar radiation model by Hofierka, 2002. [1]_</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>    elevation : float</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>        elevation</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>    surface_orientation : SurfaceOrientation | None</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>        surface_orientation</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    surface_tilt : SurfaceTilt | None</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>        surface_tilt</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>    timestamps : DatetimeIndex | None</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>        timestamps</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>    timezone : ZoneInfo | None</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>        timezone</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>    direct_horizontal_irradiance : ndarray | None</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>        direct_horizontal_irradiance</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    linke_turbidity_factor_series : LinkeTurbidityFactor</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>        linke_turbidity_factor_series</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>    apply_reflectivity_factor : bool</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>        apply_reflectivity_factor</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>    solar_incidence_series : SolarIncidence | None</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>        solar_incidence_series</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    solar_altitude_series : SolarAltitude | None</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>        solar_altitude_series</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>    surface_in_shade_series : LocationShading | None</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>        surface_in_shade_series</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    solar_constant : float</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>        solar_constant</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>    eccentricity_phase_offset : float</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>        eccentricity_phase_offset</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>    eccentricity_amplitude : float</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>        eccentricity_amplitude</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>    dtype : str</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>        dtype</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>    array_backend : str</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>        array_backend</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>    validate_output : bool</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>        validate_output</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>    verbose : int</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>        verbose</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>    log : int</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=sd>        log</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a><span class=sd>    DirectInclinedIrradiance</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=sd>    In Hofierka (2002) [1]_, see equation 11 :</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=sd>        Bic = B0c sin exp</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=sd>    or equation 12 :</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>              B    sin    </span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=sd>               hc        exp          W </span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>        B   =      in  </span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a><span class=sd>         ic       sin h               -2</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=sd>                       0             m  </span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=sd>    where :</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=sd>    - exp is the solar incidence angle measured between the sun and an</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=sd>      inclined surface defined in equation 16</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a><span class=sd>    or else :</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=sd>        Direct Inclined = Direct Horizontal * sin( Solar Incidence ) / sin( Solar Altitude )</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a><span class=sd>    The implementation by Hofierka (2002) uses the solar incidence angle</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=sd>    between the sun-vector and the plane of the reference surface (as per Jeno,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a><span class=sd>    1992). This is very important and relates to the hardcoded value `True` for</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a><span class=sd>    the `complementary_incidence_angle` input parameter of the function. We</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a><span class=sd>    call this angle (definition) the _complementary_ incidence angle.</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>    For the losses due to reflectivity, the incidence angle modifier by Martin</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>    &amp; Ruiz (2005) expects the incidence angle between the sun-vector and the</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=sd>    surface-normal. Hence, the respective call of the function</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a><span class=sd>    `calculate_reflectivity_factor_for_direct_irradiance_series()`,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a><span class=sd>    expects the complement of the angle defined by Jeno (1992). We call the</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>    incidence angle expected by the incidence angle modifier by Martin &amp; Ruiz</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=sd>    (2005) the _typical_ incidence angle.</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a><span class=sd>    See also the documentation of the function</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>    `calculate_solar_incidence_series_jenco()`.</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a><span class=sd>    .. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>    <span class=c1># Create a sunlit surface time series mask</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>    <span class=c1># - solar altitude &gt; 0</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>    <span class=c1># - surface not in shade</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>    <span class=c1># - solar incidence &gt; 0</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>    <span class=n>mask_solar_altitude_positive</span> <span class=o>=</span> <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>    <span class=c1># Following, the _complementary_ solar incidence angle is used (Jeno, 1992)!</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>    <span class=n>mask_solar_incidence_positive</span> <span class=o>=</span> <span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>    <span class=n>mask_not_in_shade</span> <span class=o>=</span> <span class=o>~</span><span class=n>surface_in_shade_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>    <span class=n>mask_sunlit_surface_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>logical_and</span><span class=o>.</span><span class=n>reduce</span><span class=p>(</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>        <span class=p>(</span><span class=n>mask_solar_altitude_positive</span><span class=p>,</span> <span class=n>mask_solar_incidence_positive</span><span class=p>,</span> <span class=n>mask_not_in_shade</span><span class=p>)</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>    <span class=c1># Else, the following runs:</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>    <span class=c1># --------------------------------- Review &amp; Add ?</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>    <span class=c1># 1. surface is shaded</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>    <span class=c1># 3. solar incidence = 0</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>    <span class=c1># --------------------------------- Review &amp; Add ?</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>    <span class=c1># ========================================================================</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>    <span class=k>if</span> <span class=n>direct_horizontal_irradiance</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>            <span class=s2>"The `direct_horizontal_irradiance` should be None at this point !"</span><span class=p>,</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>            <span class=n>alt</span> <span class=o>=</span> <span class=s2>":information: [bold red]The [code]direct_horizontal_irradiance[/code] input should be [code]None[/code] at this point ![/bold red]"</span><span class=p>,</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>            <span class=s2>":information: The `direct_horizontal_irradiance` input should be None at this point !"</span><span class=p>,</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>        <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>                <span class=s2>":information: Modelling direct horizontal irradiance..."</span><span class=p>,</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=s2>":information: [bold][magenta]Modelling[/magenta] direct horizontal irradiance[/bold]..."</span><span class=p>,</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>        <span class=n>direct_horizontal_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>            <span class=n>calculate_clear_sky_direct_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>                <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>                <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>                <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>                <span class=n>surface_in_shade_series</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>                <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>                <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>                <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>                <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>                <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>                <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>                <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>        <span class=c1># the number of timestamps should match the number of "x" values</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>        <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>                <span class=s2>"</span><span class=se>\n</span><span class=s2>i Calculating the direct inclined irradiance .."</span><span class=p>,</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=s2>"</span><span class=se>\n</span><span class=s2>i [bold]Calculating[/bold] the [magenta]direct inclined irradiance[/magenta] .."</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>        <span class=n>compare_temporal_resolution</span><span class=p>(</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>            <span class=n>timestamps</span><span class=p>,</span> <span class=n>direct_horizontal_irradiance_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>        <span class=c1># Else, the following runs:</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>        <span class=c1># --------------------------------- Review &amp; Add ?</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>        <span class=c1># 1. surface is shaded</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>        <span class=c1># 3. solar incidence = 0</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>        <span class=c1># --------------------------------- Review &amp; Add ?</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>        <span class=c1># ========================================================================</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>        <span class=c1># Initialize the direct irradiance series to zeros</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>        <span class=c1># array_parameters = {</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>        <span class=c1>#     "shape": timestamps.shape,</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>        <span class=c1>#     "dtype": dtype,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>        <span class=c1>#     "init_method": "zeros",</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>        <span class=c1>#     "backend": array_backend,</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>        <span class=c1># }  # Borrow shape from timestamps</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>        <span class=c1># direct_inclined_irradiance_series = create_array(**array_parameters)</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>        <span class=c1># if mask_sunlit_surface_series.any():</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>        <span class=n>direct_inclined_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>        <span class=n>direct_horizontal_irradiance_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>        <span class=o>*</span> <span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>            <span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>        <span class=p>)</span>  <span class=c1># Should be the _complementary_ incidence angle!</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>        <span class=o>/</span> <span class=n>sin</span><span class=p>(</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>    <span class=k>except</span> <span class=ne>ZeroDivisionError</span><span class=p>:</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>            <span class=s2>"Error: Division by zero in calculating the direct inclined irradiance!"</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>                <span class=s2>"Is the solar altitude angle zero ?"</span><span class=p>,</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=s2>"[bold red]Is the solar altitude angle zero ?"</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>        <span class=c1># should this return something? Like in r.sun's simpler's approach?</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>apply_reflectivity_factor</span><span class=p>:</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>        <span class=n>direct_inclined_irradiance_before_reflectivity_series</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>        <span class=n>direct_inclined_irradiance_reflectivity_factor_series</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>        <span class=c1># Calculate the reflectivity factor</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>        <span class=c1># per Martin &amp; Ruiz 2005 :</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>        <span class=c1># expects the _typical_ sun-vector-to-normal-of-surface incidence angles</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a>        <span class=c1># which is the _complement_ of the incidence angle per Hofierka 2002</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a>        <span class=n>direct_inclined_irradiance_reflectivity_factor_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a>            <span class=n>calculate_reflectivity_factor_for_direct_irradiance_series</span><span class=p>(</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>                <span class=n>solar_incidence_series</span><span class=o>=</span><span class=p>(</span><span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>radians</span><span class=p>),</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a>        <span class=c1># Apply the reflectivity factor</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a>        <span class=n>direct_inclined_irradiance_series</span> <span class=o>*=</span> <span class=p>(</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a>            <span class=n>direct_inclined_irradiance_reflectivity_factor_series</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>        <span class=c1># Avoid copying to save memory and time ... ? ----------------- Is this safe ? -</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>        <span class=k>with</span> <span class=n>errstate</span><span class=p>(</span><span class=n>divide</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>,</span> <span class=n>invalid</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>):</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>            <span class=c1># this quantity is exclusively generated for the output dictionary !</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>            <span class=n>direct_inclined_irradiance_before_reflectivity_series</span> <span class=o>=</span> <span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>                <span class=n>direct_inclined_irradiance_reflectivity_factor_series</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a>                <span class=n>direct_inclined_irradiance_series</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a>                <span class=o>/</span> <span class=n>direct_inclined_irradiance_reflectivity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>                <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a>        <span class=c1># ------------------------------------------------------------------------------</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>DirectInclinedIrradiance</span><span class=p>(),</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>    <span class=k>if</span> <span class=n>numpy</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>direct_inclined_irradiance_series</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>):</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><a href=#__codelineno-0-328><span class=linenos data-linenos="328 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a>            <span class=s2>"</span><span class=se>\n</span><span class=s2>[red]Warning: Negative values found in `direct_inclined_irradiance_series`![/red]"</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><a href=#__codelineno-0-338><span class=linenos data-linenos="338 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><a href=#__codelineno-0-339><span class=linenos data-linenos="339 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><a href=#__codelineno-0-340><span class=linenos data-linenos="340 "></span></a>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><a href=#__codelineno-0-341><span class=linenos data-linenos="341 "></span></a>    <span class=k>return</span> <span class=n>DirectInclinedIrradiance</span><span class=p>(</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><a href=#__codelineno-0-342><span class=linenos data-linenos="342 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><a href=#__codelineno-0-343><span class=linenos data-linenos="343 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><a href=#__codelineno-0-344><span class=linenos data-linenos="344 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><a href=#__codelineno-0-345><span class=linenos data-linenos="345 "></span></a>        <span class=c1>## Irradiance components</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><a href=#__codelineno-0-346><span class=linenos data-linenos="346 "></span></a>        <span class=n>direct_horizontal_irradiance</span><span class=o>=</span><span class=n>direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><a href=#__codelineno-0-347><span class=linenos data-linenos="347 "></span></a>        <span class=n>reflected</span> <span class=o>=</span> <span class=n>calculate_reflectivity_effect</span><span class=p>(</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><a href=#__codelineno-0-348><span class=linenos data-linenos="348 "></span></a>                <span class=n>irradiance</span><span class=o>=</span><span class=n>direct_inclined_irradiance_before_reflectivity_series</span><span class=p>,</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><a href=#__codelineno-0-349><span class=linenos data-linenos="349 "></span></a>                <span class=n>reflectivity_factor</span><span class=o>=</span><span class=n>direct_inclined_irradiance_reflectivity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><a href=#__codelineno-0-350><span class=linenos data-linenos="350 "></span></a>            <span class=p>),</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><a href=#__codelineno-0-351><span class=linenos data-linenos="351 "></span></a>        <span class=n>reflectivity_factor</span><span class=o>=</span><span class=n>direct_inclined_irradiance_reflectivity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><a href=#__codelineno-0-352><span class=linenos data-linenos="352 "></span></a>        <span class=n>value_before_reflectivity</span><span class=o>=</span><span class=n>direct_inclined_irradiance_before_reflectivity_series</span><span class=p>,</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><a href=#__codelineno-0-353><span class=linenos data-linenos="353 "></span></a>        <span class=c1>## Location</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><a href=#__codelineno-0-354><span class=linenos data-linenos="354 "></span></a>        <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><a href=#__codelineno-0-355><span class=linenos data-linenos="355 "></span></a>        <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><a href=#__codelineno-0-356><span class=linenos data-linenos="356 "></span></a>        <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><a href=#__codelineno-0-357><span class=linenos data-linenos="357 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><a href=#__codelineno-0-358><span class=linenos data-linenos="358 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><a href=#__codelineno-0-359><span class=linenos data-linenos="359 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><a href=#__codelineno-0-360><span class=linenos data-linenos="360 "></span></a>        <span class=n>refracted_solar_altitude</span><span class=o>=</span><span class=n>direct_horizontal_irradiance_series</span><span class=o>.</span><span class=n>refracted_solar_altitude</span><span class=p>,</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><a href=#__codelineno-0-361><span class=linenos data-linenos="361 "></span></a>        <span class=n>solar_incidence_model</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>algorithm</span><span class=p>,</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><a href=#__codelineno-0-362><span class=linenos data-linenos="362 "></span></a>        <span class=n>solar_incidence_definition</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>definition</span><span class=p>,</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><a href=#__codelineno-0-363><span class=linenos data-linenos="363 "></span></a>        <span class=n>shading_algorithm</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=o>.</span><span class=n>shading_algorithm</span><span class=p>,</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a><a href=#__codelineno-0-364><span class=linenos data-linenos="364 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><a href=#__codelineno-0-365><span class=linenos data-linenos="365 "></span></a>        <span class=n>surface_in_shade</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><a href=#__codelineno-0-366><span class=linenos data-linenos="366 "></span></a>        <span class=n>solar_incidence</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><a href=#__codelineno-0-367><span class=linenos data-linenos="367 "></span></a>        <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><a href=#__codelineno-0-368><span class=linenos data-linenos="368 "></span></a>        <span class=c1># solar_azimuth=solar_azimuth_series,</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><a href=#__codelineno-0-369><span class=linenos data-linenos="369 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><a href=#__codelineno-0-370><span class=linenos data-linenos="370 "></span></a>        <span class=n>linke_turbidity_factor</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><a href=#__codelineno-0-371><span class=linenos data-linenos="371 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.linke_turbidity_factor> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">linke_turbidity_factor</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.linke_turbidity_factor title="Permanent link"></a></h6> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.linke_turbidity_factor.correct_linke_turbidity_factor_series title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">correct_linke_turbidity_factor_series</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.linke_turbidity_factor.correct_linke_turbidity_factor_series</code>)'>correct_linke_turbidity_factor_series</a></code></td> <td> <div class=doc-md-description> <p>Calculate the air mass 2 Linke turbidity factor.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h7 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.linke_turbidity_factor.correct_linke_turbidity_factor_series> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">correct_linke_turbidity_factor_series</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.linke_turbidity_factor.correct_linke_turbidity_factor_series title="Permanent link"></a></h7> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>correct_linke_turbidity_factor_series</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>(),</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the air mass 2 Linke turbidity factor.</p> <p>Calculate the air mass 2 Linke atmospheric turbidity factor for a time series.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>linke_turbidity_factor_series</code> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></code> </td> <td> <div class=doc-md-description> <p>The Linke turbidity factors as a list of LinkeTurbidityFactor objects or a single object.</p> </div> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span>()</code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>dtype</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>array_backend</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>verbose</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>log</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=List>List</span>[<span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span>] or <span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></code> </td> <td> <div class=doc-md-description> <p>The corrected Linke turbidity factors as a list of LinkeTurbidityFactor objects or a single object.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/direct/clear_sky/linke_turbidity_factor.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>correct_linke_turbidity_factor_series</span><span class=p>(</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(),</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>LinkeTurbidityFactor</span><span class=p>:</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=sd>"""Calculate the air mass 2 Linke turbidity factor.</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a><span class=sd>    Calculate the air mass 2 Linke atmospheric turbidity factor for a time series.</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a><span class=sd>    linke_turbidity_factor_series: List[LinkeTurbidityFactor] | LinkeTurbidityFactor</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a><span class=sd>        The Linke turbidity factors as a list of LinkeTurbidityFactor objects</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a><span class=sd>        or a single object.</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a><span class=sd>    dtype : str</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a><span class=sd>        dtype</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a><span class=sd>    array_backend : str</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a><span class=sd>        array_backend</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a><span class=sd>    verbose : int</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a><span class=sd>        verbose</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a><span class=sd>    log : int</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a><span class=sd>        log</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a><span class=sd>    List[LinkeTurbidityFactor] or LinkeTurbidityFactor</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a><span class=sd>        The corrected Linke turbidity factors as a list of LinkeTurbidityFactor</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a><span class=sd>        objects or a single object.</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>    <span class=n>corrected_linke_turbidity_factors</span> <span class=o>=</span> <span class=o>-</span><span class=mf>0.8662</span> <span class=o>*</span> <span class=n>numpy_array</span><span class=p>(</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>        <span class=n>linke_turbidity_factor_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>corrected_linke_turbidity_factors</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>    <span class=k>return</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>corrected_linke_turbidity_factors</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos="81 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.normal> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">normal</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.normal title="Permanent link"></a></h6> <div class="doc doc-contents"> <p>This Python module is part of PVGIS' Algorithms. It implements a function to calculate the direct normal solar irradiance.</p> <p><em>Direct</em> or <em>beam</em> irradiance is one of the main components of solar irradiance. It comes perpendicular from the Sun and is not scattered before it irradiates a surface.</p> <p>During a cloudy day the sunlight will be partially absorbed and scattered by different air molecules. The latter part is defined as the <em>diffuse</em> irradiance. The remaining part is the <em>direct</em> irradiance.</p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.normal.calculate_direct_normal_irradiance_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_direct_normal_irradiance_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.normal.calculate_direct_normal_irradiance_hofierka</code>)'>calculate_direct_normal_irradiance_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the direct normal irradiance.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h7 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.normal.calculate_direct_normal_irradiance_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_direct_normal_irradiance_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.clear_sky.normal.calculate_direct_normal_irradiance_hofierka title="Permanent link"></a></h7> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_direct_normal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>(),</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>optical_air_mass_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.OpticalAirMass>OpticalAirMass</span></span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>        <span class=n><span title=pvgisprototype.constants.OPTICAL_AIR_MASS_TIME_SERIES_DEFAULT>OPTICAL_AIR_MASS_TIME_SERIES_DEFAULT</span></span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=p>],</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>clip_to_physically_possible_limits</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.DirectNormalIrradiance>DirectNormalIrradiance</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the direct normal irradiance.</p> <p>The direct normal irradiance attenuated by the cloudless atmosphere, represents the amount of solar radiation received per unit area by a surface that is perpendicular (normal) to the rays that come in a straight line from the direction of the sun at its current position in the sky.</p> <p>This function implements the algorithm described by Hofierka, 2002. [1]_</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span> | None</code> </td> <td> <div class=doc-md-description> <p>timestamps</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>linke_turbidity_factor_series</code> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></code> </td> <td> <div class=doc-md-description> <p>linke_turbidity_factor_series</p> </div> </td> <td> <code><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span>()</code> </td> </tr> <tr class=doc-section-item> <td> <code>optical_air_mass_series</code> </td> <td> <code><span title=pvgisprototype.OpticalAirMass>OpticalAirMass</span></code> </td> <td> <div class=doc-md-description> <p>optical_air_mass_series</p> </div> </td> <td> <code>[<span title=pvgisprototype.constants.OPTICAL_AIR_MASS_TIME_SERIES_DEFAULT>OPTICAL_AIR_MASS_TIME_SERIES_DEFAULT</span>]</code> </td> </tr> <tr class=doc-section-item> <td> <code>clip_to_physically_possible_limits</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> <p>clip_to_physically_possible_limits</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>solar_constant</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>solar_constant</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>eccentricity_phase_offset</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>eccentricity_phase_offset</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>eccentricity_amplitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>eccentricity_amplitude</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>dtype</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>array_backend</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>verbose</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>log</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>fingerprint</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> <p>fingerprint</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.DirectNormalIrradiance>DirectNormalIrradiance</span></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>B0c = G0 exp {-0.8662 TLK m R(m)}</p> <p>where : - -0.8662 TLK is the air mass 2 Linke atmospheric turbidity factor [dimensionless] corrected by Kasten [24].</p> <ul> <li>m is the relative optical air mass [-] calculated using the formula:</li> </ul> <p>m = (p/p0)/(sin h0ref + 0.50572 (h0ref + 6.07995)-1.6364)</p> <p>where :</p> <ul> <li>h0ref is the corrected solar altitude h0 in degrees by the atmospheric refraction component h0ref</li> </ul> <p>where : </p> <ul> <li>h0ref = 0.061359 (0.1594+1.123 h0 + 0.065656 h02)/(1 + 28.9344 h0 + 277.3971 h02)</li> <li> <p>h0ref = h0 + h0ref</p> </li> <li> <p>The p/p0 component is correction for given elevation z [m]:</p> <p>p/p0 = exp (-z/8434.5)</p> </li> <li> <p>R(m) is the Rayleigh optical thickness at air mass m and is calculated according to the improved formula by Kasten as follows:</p> </li> <li> <p>for m &lt;= 20:</p> </li> </ul> <p>R(m) = 1/(6.6296 + 1.7513 m - 0.1202 m2 + 0.0065 m3 - 0.00013 m4)</p> <ul> <li>for m &gt; 20</li> </ul> <p>R(m) = 1/(10.4 + 0.718 m)</p> </details> <details class=references open> <summary>References</summary> <p>.. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/direct/clear_sky/normal.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_direct_normal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(),</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>    <span class=n>optical_air_mass_series</span><span class=p>:</span> <span class=n>OpticalAirMass</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>        <span class=n>OPTICAL_AIR_MASS_TIME_SERIES_DEFAULT</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>    <span class=p>],</span>  <span class=c1># REVIEW-ME + ?</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>    <span class=n>clip_to_physically_possible_limits</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SOLAR_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DirectNormalIrradiance</span><span class=p>:</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=w>    </span><span class=sd>"""Calculate the direct normal irradiance.</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    The direct normal irradiance attenuated by the cloudless atmosphere,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    represents the amount of solar radiation received per unit area by a</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    surface that is perpendicular (normal) to the rays that come in a straight</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    line from the direction of the sun at its current position in the sky.</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    This function implements the algorithm described by Hofierka, 2002. [1]_</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    timestamps : DatetimeIndex | None</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>        timestamps</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    linke_turbidity_factor_series : LinkeTurbidityFactor</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>        linke_turbidity_factor_series</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>    optical_air_mass_series : OpticalAirMass</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>        optical_air_mass_series</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    clip_to_physically_possible_limits : bool</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>        clip_to_physically_possible_limits</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>    solar_constant : float</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>        solar_constant</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    eccentricity_phase_offset : float</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>        eccentricity_phase_offset</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>    eccentricity_amplitude : float</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>        eccentricity_amplitude</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>    dtype : str</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>        dtype</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>    array_backend : str</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>        array_backend</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    verbose : int</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>        verbose</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>    log : int</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>        log</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>    fingerprint : bool</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>        fingerprint</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>    DirectNormalIrradiance</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    B0c = G0 exp {-0.8662 TLK m R(m)}</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>    where :</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>    - -0.8662 TLK is the air mass 2 Linke atmospheric turbidity factor [dimensionless] corrected by Kasten [24].</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    - m is the relative optical air mass [-] calculated using the formula:</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>      m = (p/p0)/(sin h0ref + 0.50572 (h0ref + 6.07995)-1.6364)</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>      where :</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>      - h0ref is the corrected solar altitude h0 in degrees by the atmospheric refraction component h0ref</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>      where : </span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>      - h0ref = 0.061359 (0.1594+1.123 h0 + 0.065656 h02)/(1 + 28.9344 h0 + 277.3971 h02)</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>      - h0ref = h0 + h0ref</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>      - The p/p0 component is correction for given elevation z [m]:</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=sd>        p/p0 = exp (-z/8434.5)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a><span class=sd>    - R(m) is the Rayleigh optical thickness at air mass m and is calculated according to the improved formula by Kasten as follows:</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a><span class=sd>    - for m &lt;= 20:</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a><span class=sd>      R(m) = 1/(6.6296 + 1.7513 m - 0.1202 m2 + 0.0065 m3 - 0.00013 m4)</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=sd>    - for m &gt; 20</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=sd>      R(m) = 1/(10.4 + 0.718 m)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>    .. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>    <span class=n>extraterrestrial_normal_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_extraterrestrial_normal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>            <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>            <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>            <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>            <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>            <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>            <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>    <span class=n>corrected_linke_turbidity_factor_series</span> <span class=o>=</span> <span class=n>correct_linke_turbidity_factor_series</span><span class=p>(</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>    <span class=n>rayleigh_optical_thickness_series</span> <span class=o>=</span> <span class=n>calculate_rayleigh_optical_thickness_series</span><span class=p>(</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>optical_air_mass_series</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>    <span class=p>)</span>  <span class=c1># _quite_ high when the sun is below the horizon. Makes sense ?</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>    <span class=c1># Calculate</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>    <span class=k>with</span> <span class=n>np</span><span class=o>.</span><span class=n>errstate</span><span class=p>(</span><span class=n>divide</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>,</span> <span class=n>invalid</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>,</span> <span class=n>over</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>):</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>        <span class=n>exponent</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>            <span class=n>corrected_linke_turbidity_factor_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>            <span class=o>*</span> <span class=n>optical_air_mass_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>            <span class=o>*</span> <span class=n>rayleigh_optical_thickness_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=n>direct_normal_irradiance_series</span> <span class=o>=</span> <span class=n>extraterrestrial_normal_irradiance_series</span><span class=o>.</span><span class=n>value</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>exponent</span><span class=p>)</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>direct_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>DirectNormalIrradiance</span><span class=p>(),</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>        <span class=n>clip_to_physically_possible_limits</span><span class=o>=</span><span class=n>clip_to_physically_possible_limits</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>direct_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>    <span class=k>return</span> <span class=n>DirectNormalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>direct_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=n>extraterrestrial_normal_irradiance</span><span class=o>=</span><span class=n>extraterrestrial_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>        <span class=n>linke_turbidity_factor_adjusted</span><span class=o>=</span><span class=n>corrected_linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=n>linke_turbidity_factor</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=n>rayleigh_optical_thickness</span><span class=o>=</span><span class=n>rayleigh_optical_thickness_series</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>        <span class=n>optical_air_mass</span><span class=o>=</span><span class=n>optical_air_mass_series</span><span class=p>,</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>        <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>        <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>        <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.inclined> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">inclined</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.inclined title="Permanent link"></a></h5> <div class="doc doc-contents"> <p>This Python module is part of PVGIS' API. It implements functions to calculate the direct solar irradiance.</p> <p><em>Direct</em> or <em>beam</em> irradiance is one of the main components of solar irradiance. It comes perpendicular from the Sun and is not scattered before it irradiates a surface.</p> <p>During a cloudy day the sunlight will be partially absorbed and scattered by different air molecules. The latter part is defined as the <em>diffuse</em> irradiance. The remaining part is the <em>direct</em> irradiance.</p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.inclined.calculate_direct_inclined_irradiance_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_direct_inclined_irradiance_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.inclined.calculate_direct_inclined_irradiance_hofierka</code>)'>calculate_direct_inclined_irradiance_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the direct irradiance incident on a tilted surface [W*m-2].</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.inclined.calculate_direct_inclined_irradiance_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_direct_inclined_irradiance_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.inclined.calculate_direct_inclined_irradiance_hofierka title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_direct_inclined_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>(</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>        <span class=p>[</span><span class=n><span title=pandas.Timestamp.now>now</span></span><span class=p>(</span><span class=n><span title=pandas.Timestamp.now(tz)>tz</span></span><span class=o>=</span><span class=s2>"UTC"</span><span class=p>)]</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=p>),</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>),</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>direct_horizontal_irradiance</span><span class=p>:</span> <span class=n><span title=numpy.ndarray>ndarray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>apply_reflectivity_factor</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarIncidence>SolarIncidence</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LocationShading>LocationShading</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.DirectInclinedIrradianceFromExternalData>DirectInclinedIrradianceFromExternalData</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the direct irradiance incident on a tilted surface [W*m-2].</p> <p>Calculate the direct irradiance on an inclined surface based on the solar radiation model by Hofierka, 2002. [1]_</p> <details class=note open> <summary>Notes</summary> <p>Bic = B0c sin exp (equation 11)</p> <p>or</p> <div class=codehilite><pre><span></span><code>  B    sin    
   hc        exp          W 
</code></pre></div> <p>B =  in  ic sin h   -2  0 m </p> <div class=codehilite><pre><span></span><code>(equation 12)
</code></pre></div> <p>where :</p> <ul> <li>exp is the solar incidence angle measured between the sun and an inclined surface defined in equation (16).</li> </ul> <p>or else :</p> <div class=codehilite><pre><span></span><code>Direct Inclined = Direct Horizontal * sin( Solar Incidence ) / sin( Solar Altitude )
</code></pre></div> <p>The implementation by Hofierka (2002) uses the solar incidence angle between the sun-vector and the plane of the reference surface (as per Jeno, 1992). This is very important and relates to the hardcoded value <code>True</code> for the <code>complementary_incidence_angle</code> input parameter of the function. We call this angle (definition) the <em>complementary</em> incidence angle.</p> <p>For the losses due to reflectivity, the incidence angle modifier by Martin &amp; Ruiz (2005) expects the incidence angle between the sun-vector and the surface-normal. Hence, the respective call of the function <code>calculate_reflectivity_factor_for_direct_irradiance_series()</code>, expects the complement of the angle defined by Jeno (1992). We call the incidence angle expected by the incidence angle modifier by Martin &amp; Ruiz (2005) the <em>typical</em> incidence angle.</p> <p>See also the documentation of the function <code>calculate_solar_incidence_series_jenco()</code>.</p> </details> <details class=references open> <summary>References</summary> <p>.. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/direct/inclined.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_direct_inclined_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>DatetimeIndex</span><span class=p>([</span><span class=n>Timestamp</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>tz</span><span class=o>=</span><span class=s1>'UTC'</span><span class=p>)]),</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>ZoneInfo</span><span class=p>(</span><span class=s1>'UTC'</span><span class=p>),</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>    <span class=n>direct_horizontal_irradiance</span><span class=p>:</span> <span class=n>ndarray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>    <span class=n>apply_reflectivity_factor</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n>SolarIncidence</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n>SolarAltitude</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>    <span class=c1># solar_azimuth_series: SolarAzimuth | None = None,</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n>LocationShading</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DirectInclinedIrradianceFromExternalData</span><span class=p>:</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=w>    </span><span class=sd>"""Calculate the direct irradiance incident on a tilted surface [W*m-2].</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    Calculate the direct irradiance on an inclined surface based on the</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>    solar radiation model by Hofierka, 2002. [1]_</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    Bic = B0c sin exp (equation 11)</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    or</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>          B    sin    </span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>           hc        exp          W </span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    B   =      in  </span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>     ic       sin h               -2</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>                   0             m  </span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>        (equation 12)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    where :</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>    - exp is the solar incidence angle measured between the sun and an</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>      inclined surface defined in equation (16).</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    or else :</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>        Direct Inclined = Direct Horizontal * sin( Solar Incidence ) / sin( Solar Altitude )</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>    The implementation by Hofierka (2002) uses the solar incidence angle</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>    between the sun-vector and the plane of the reference surface (as per Jeno,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>    1992). This is very important and relates to the hardcoded value `True` for</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    the `complementary_incidence_angle` input parameter of the function. We</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>    call this angle (definition) the _complementary_ incidence angle.</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>    For the losses due to reflectivity, the incidence angle modifier by Martin</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>    &amp; Ruiz (2005) expects the incidence angle between the sun-vector and the</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    surface-normal. Hence, the respective call of the function</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>    `calculate_reflectivity_factor_for_direct_irradiance_series()`,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    expects the complement of the angle defined by Jeno (1992). We call the</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    incidence angle expected by the incidence angle modifier by Martin &amp; Ruiz</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>    (2005) the _typical_ incidence angle.</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>    See also the documentation of the function</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>    `calculate_solar_incidence_series_jenco()`.</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>    .. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>    <span class=c1># Create a Sunlit surface time series mask :</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>    <span class=c1># - solar altitude &gt; 0</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>    <span class=c1># - surface not in shade</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>    <span class=c1># - solar incidence &gt; 0</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>    <span class=n>mask_solar_altitude_positive</span> <span class=o>=</span> <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>    <span class=c1># Here we use the _complementary_ solar incidence angle,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=c1># sun-to-surface-plane as per Jeno 1992.</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=n>mask_solar_incidence_positive</span> <span class=o>=</span> <span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=n>mask_not_in_shade</span> <span class=o>=</span> <span class=o>~</span><span class=n>surface_in_shade_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>    <span class=n>mask_sunlit_surface_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>logical_and</span><span class=o>.</span><span class=n>reduce</span><span class=p>(</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=p>(</span><span class=n>mask_solar_altitude_positive</span><span class=p>,</span> <span class=n>mask_solar_incidence_positive</span><span class=p>,</span> <span class=n>mask_not_in_shade</span><span class=p>)</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>    <span class=c1># Else, the following runs:</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=c1># --------------------------------- Review &amp; Add ?</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=c1># 1. surface is shaded</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>    <span class=c1># 3. solar incidence = 0</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=c1># --------------------------------- Review &amp; Add ?</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>    <span class=c1># ========================================================================</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>direct_horizontal_irradiance</span><span class=p>,</span> <span class=n>ndarray</span><span class=p>):</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>            <span class=s2>"The `direct_horizontal_irradiance` should be a NumPy array at this point !"</span><span class=p>,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>            <span class=n>alt</span> <span class=o>=</span> <span class=s2>":information: [bold red]The [code]direct_horizontal_irradiance[/code] input should be a [code]NumPy array[/code] at this point ![/bold red]"</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>            <span class=s2>":information: The `direct_horizontal_irradiance` input should be a NumPy array at this point !"</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=c1># However, generate a native data model for it :</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=n>direct_horizontal_irradiance</span> <span class=o>=</span> <span class=n>DirectHorizontalIrradianceFromExternalData</span><span class=p>(</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>direct_horizontal_irradiance</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>        <span class=c1># the number of timestamps should match the number of "x" values</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>        <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>                <span class=s2>"</span><span class=se>\n</span><span class=s2>i [bold]Calculating[/bold] the [magenta]direct inclined irradiance[/magenta] .."</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>        <span class=n>compare_temporal_resolution</span><span class=p>(</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>            <span class=n>timestamps</span><span class=p>,</span> <span class=n>direct_horizontal_irradiance</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=c1># Else, the following runs:</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=c1># --------------------------------- Review &amp; Add ?</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=c1># 1. surface is shaded</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=c1># 3. solar incidence = 0</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=c1># --------------------------------- Review &amp; Add ?</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=c1># ========================================================================</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>        <span class=c1># Initialize the direct irradiance series to zeros</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>        <span class=c1># array_parameters = {</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=c1>#     "shape": timestamps.shape,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>        <span class=c1>#     "dtype": dtype,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>        <span class=c1>#     "init_method": "zeros",</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=c1>#     "backend": array_backend,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=c1># }  # Borrow shape from timestamps</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=c1># direct_inclined_irradiance_series = create_array(**array_parameters)</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=c1># if mask_sunlit_surface_series.any():</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>        <span class=n>direct_inclined_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>        <span class=n>direct_horizontal_irradiance</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=o>*</span> <span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>            <span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>        <span class=p>)</span>  <span class=c1># Should be the _complementary_ incidence angle!</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>        <span class=o>/</span> <span class=n>sin</span><span class=p>(</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>    <span class=k>except</span> <span class=ne>ZeroDivisionError</span><span class=p>:</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>            <span class=s2>"Error: Division by zero in calculating the direct inclined irradiance!"</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>"Is the solar altitude angle zero ?"</span><span class=p>)</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=c1># should this return something? Like in r.sun's simpler's approach?</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>apply_reflectivity_factor</span><span class=p>:</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>        <span class=n>direct_inclined_irradiance_before_reflectivity_series</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>        <span class=n>direct_inclined_irradiance_reflectivity_factor_series</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>        <span class=c1># Calculate the reflectivity factor</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=c1># per Martin &amp; Ruiz 2005 :</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>        <span class=c1># expects the _typical_ sun-vector-to-normal-of-surface incidence angles</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=c1># which is the _complement_ of the incidence angle per Hofierka 2002.</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=c1># Hence, we need to convert !</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>        <span class=n>direct_inclined_irradiance_reflectivity_factor_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>            <span class=n>calculate_reflectivity_factor_for_direct_irradiance_series</span><span class=p>(</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>                <span class=n>solar_incidence_series</span><span class=o>=</span><span class=p>(</span><span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>radians</span><span class=p>),</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>        <span class=c1># Apply the reflectivity factor</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>        <span class=n>direct_inclined_irradiance_series</span> <span class=o>*=</span> <span class=p>(</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>            <span class=n>direct_inclined_irradiance_reflectivity_factor_series</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>        <span class=c1># Avoid copying to save memory and time ... ? ----------------- Is this safe ? -</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>        <span class=k>with</span> <span class=n>errstate</span><span class=p>(</span><span class=n>divide</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>,</span> <span class=n>invalid</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>):</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>            <span class=c1># this quantity is exclusively generated for the output dictionary !</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>            <span class=n>direct_inclined_irradiance_before_reflectivity_series</span> <span class=o>=</span> <span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>                <span class=n>direct_inclined_irradiance_reflectivity_factor_series</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>                <span class=n>direct_inclined_irradiance_series</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>                <span class=o>/</span> <span class=n>direct_inclined_irradiance_reflectivity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>                <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>        <span class=c1># ------------------------------------------------------------------------------</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>DirectInclinedIrradianceFromExternalData</span><span class=p>(),</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>    <span class=k>return</span> <span class=n>DirectInclinedIrradianceFromExternalData</span><span class=p>(</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>        <span class=c1>## Irradiance components</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>        <span class=n>direct_horizontal_irradiance</span><span class=o>=</span><span class=n>direct_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>        <span class=n>reflected</span> <span class=o>=</span> <span class=n>calculate_reflectivity_effect</span><span class=p>(</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>                <span class=n>irradiance</span><span class=o>=</span><span class=n>direct_inclined_irradiance_before_reflectivity_series</span><span class=p>,</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>                <span class=n>reflectivity_factor</span><span class=o>=</span><span class=n>direct_inclined_irradiance_reflectivity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>            <span class=p>),</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>        <span class=n>reflectivity_factor</span><span class=o>=</span><span class=n>direct_inclined_irradiance_reflectivity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>        <span class=n>value_before_reflectivity</span><span class=o>=</span><span class=n>direct_inclined_irradiance_before_reflectivity_series</span><span class=p>,</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>        <span class=c1>## Location</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>        <span class=n>surface_in_shade</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>        <span class=n>solar_incidence</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>        <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.normal> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">normal</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.normal title="Permanent link"></a></h5> <div class="doc doc-contents"> <p>This Python module is part of PVGIS' Algorithms. It implements a function to calculate the direct normal solar irradiance.</p> <p><em>Direct</em> or <em>beam</em> irradiance is one of the main components of solar irradiance. It comes perpendicular from the Sun and is not scattered before it irradiates a surface.</p> <p>During a cloudy day the sunlight will be partially absorbed and scattered by different air molecules. The latter part is defined as the <em>diffuse</em> irradiance. The remaining part is the <em>direct</em> irradiance.</p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.direct.normal.calculate_direct_normal_from_horizontal_irradiance_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_direct_normal_from_horizontal_irradiance_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.direct.normal.calculate_direct_normal_from_horizontal_irradiance_hofierka</code>)'>calculate_direct_normal_from_horizontal_irradiance_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the direct normal from the direct horizontal irradiance.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.direct.normal.calculate_direct_normal_from_horizontal_irradiance_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_direct_normal_from_horizontal_irradiance_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.direct.normal.calculate_direct_normal_from_horizontal_irradiance_hofierka title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_direct_normal_from_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>direct_horizontal_irradiance</span><span class=p>:</span> <span class=n><span title=numpy.ndarray>ndarray</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>fingerprint</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.FINGERPRINT_FLAG_DEFAULT>FINGERPRINT_FLAG_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.DirectNormalFromHorizontalIrradiance>DirectNormalFromHorizontalIrradiance</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the direct normal from the direct horizontal irradiance.</p> <p>The direct normal irradiance represents the amount of solar radiation received per unit area by a surface that is perpendicular (normal) to the rays that come in a straight line from the direction of the sun at its current position in the sky. This function calculates the direct normal irradiance based on the direct horizontal irradiance and the solar altitude.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>direct_horizontal_irradiance</code> </td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>direct_horizontal_irradiance</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>solar_altitude_series</code> </td> <td> <code><span title=pvgisprototype.SolarAltitude>SolarAltitude</span> | None</code> </td> <td> <div class=doc-md-description> <p>solar_altitude_series</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>dtype</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>array_backend</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>verbose</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>log</p> </div> </td> <td> <code>0</code> </td> </tr> <tr class=doc-section-item> <td> <code>fingerprint</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> <p>fingerprint</p> </div> </td> <td> <code><span title=pvgisprototype.constants.FINGERPRINT_FLAG_DEFAULT>FINGERPRINT_FLAG_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.DirectNormalFromHorizontalIrradiance>DirectNormalFromHorizontalIrradiance</span></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> </details> <details class=references open> <summary>References</summary> <p>.. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/direct/normal.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_direct_normal_from_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>direct_horizontal_irradiance</span><span class=p>:</span> <span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n>SolarAltitude</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=n>fingerprint</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>FINGERPRINT_FLAG_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DirectNormalFromHorizontalIrradiance</span><span class=p>:</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=w>    </span><span class=sd>"""Calculate the direct normal from the direct horizontal irradiance.</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    The direct normal irradiance represents the amount of solar radiation</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    received per unit area by a surface that is perpendicular (normal) to the</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    rays that come in a straight line from the direction of the sun at its</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    current position in the sky. This function calculates the direct normal</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    irradiance based on the direct horizontal irradiance and the solar</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    altitude.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    direct_horizontal_irradiance : ndarray</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>        direct_horizontal_irradiance</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    solar_altitude_series : SolarAltitude | None</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        solar_altitude_series</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    dtype : str</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>        dtype</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    array_backend : str</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        array_backend</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    verbose : int</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>        verbose</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>    log : int</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>        log</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    fingerprint : bool</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>        fingerprint</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    DirectNormalFromHorizontalIrradiance</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>    .. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>mask_solar_altitude_positive</span> <span class=o>=</span> <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=n>mask_not_in_shade</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>full_like</span><span class=p>(</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span> <span class=kc>True</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=p>)</span>  <span class=c1># Stub, replace with actual condition</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=n>mask</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>logical_and</span><span class=o>.</span><span class=n>reduce</span><span class=p>((</span><span class=n>mask_solar_altitude_positive</span><span class=p>,</span> <span class=n>mask_not_in_shade</span><span class=p>))</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=n>direct_normal_irradiance_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mask</span><span class=p>):</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=n>direct_normal_irradiance_series</span><span class=p>[</span><span class=n>mask</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>            <span class=n>direct_horizontal_irradiance</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=p>)[</span><span class=n>mask</span><span class=p>]</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>direct_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>DirectNormalFromHorizontalIrradiance</span><span class=p>(),</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>direct_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>    <span class=k>return</span> <span class=n>DirectNormalFromHorizontalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>direct_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>direct_horizontal_irradiance</span><span class=o>=</span><span class=n>direct_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">extraterrestrial</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.horizontal title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">horizontal</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.horizontal</code>)'>horizontal</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.normal title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">normal</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.normal</code>)'>normal</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.horizontal> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">horizontal</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.horizontal title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.horizontal.calculate_extraterrestrial_horizontal_irradiance_series_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_extraterrestrial_horizontal_irradiance_series_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.horizontal.calculate_extraterrestrial_horizontal_irradiance_series_hofierka</code>)'>calculate_extraterrestrial_horizontal_irradiance_series_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the horizontal extraterrestrial irradiance over a period of time.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.horizontal.calculate_extraterrestrial_horizontal_irradiance_series_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_extraterrestrial_horizontal_irradiance_series_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.horizontal.calculate_extraterrestrial_horizontal_irradiance_series_hofierka title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_extraterrestrial_horizontal_irradiance_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>extraterrestrial_normal_irradiance</span><span class=p>:</span> <span class=n><span title=pvgisprototype.ExtraterrestrialNormalIrradiance>ExtraterrestrialNormalIrradiance</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.ExtraterrestrialNormalIrradiance>ExtraterrestrialNormalIrradiance</span></span><span class=p>(),</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span><span class=p>(),</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.ExtraterrestrialHorizontalIrradiance>ExtraterrestrialHorizontalIrradiance</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the horizontal extraterrestrial irradiance over a period of time. This function implements the algorithm described by Hofierka [1]_.</p> <details class=note open> <summary>Notes</summary> <p>In [1]_ : G0h = G0  sin(h0) or else : G0 horizontal = G0 normal  sin(solar altitude)</p> <p>In the context of PVGIS, one question is : does it make sense to have negative extraterrestrial horizontal irradiance for moments in time when the sun is below the horizon (i.e. solar altitude &lt; 0 radians or degrees) ?</p> <p>For PVGIS the answer is no, hence the output horizontal extraterrestrial irradiance is set to 0 for this moments.</p> </details> <details class=references open> <summary>References</summary> <p>.. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/extraterrestrial/horizontal.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_extraterrestrial_horizontal_irradiance_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a>    <span class=n>extraterrestrial_normal_irradiance</span><span class=p>:</span> <span class=n>ExtraterrestrialNormalIrradiance</span> <span class=o>=</span> <span class=n>ExtraterrestrialNormalIrradiance</span><span class=p>(),</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n>SolarAltitude</span> <span class=o>=</span> <span class=n>SolarAltitude</span><span class=p>(),</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ExtraterrestrialHorizontalIrradiance</span><span class=p>:</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=sd>    Calculate the horizontal extraterrestrial irradiance over a period of time.</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=sd>    This function implements the algorithm described by Hofierka [1]_.</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=sd>    In [1]_ : G0h = G0  sin(h0)  or else : G0 horizontal = G0 normal  sin(solar altitude)</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>    In the context of PVGIS, one question is : does it make sense to have negative</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>    extraterrestrial horizontal irradiance for moments in time when the sun is</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    below the horizon (i.e. solar altitude &lt; 0 radians or degrees) ?</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    For PVGIS the answer is no, hence the output horizontal extraterrestrial</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    irradiance is set to 0 for this moments.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    .. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>            <span class=s2>":information: Modelling the horizontal extraterrestrial irradiance"</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>            <span class=n>alt</span><span class=o>=</span><span class=s2>":information: [bold]Modelling[/bold] the horizontal extraterrestrial irradiance"</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>    <span class=n>extraterrestrial_horizontal_irradiance</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>        <span class=n>extraterrestrial_normal_irradiance</span><span class=o>.</span><span class=n>value</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=n>extraterrestrial_horizontal_irradiance</span><span class=p>[</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=mi>0</span>  <span class=c1># In the context of PVGIS, does it make sense to have negative extraterrestrial horizontal irradiance</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>extraterrestrial_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>ExtraterrestrialHorizontalIrradiance</span><span class=p>(),</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>extraterrestrial_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=k>return</span> <span class=n>ExtraterrestrialHorizontalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>extraterrestrial_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>        <span class=n>normal</span><span class=o>=</span><span class=n>extraterrestrial_normal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=n>quality</span><span class=o>=</span><span class=s2>"Not validated!"</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.normal> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">normal</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.normal title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.normal.calculate_extraterrestrial_normal_irradiance_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_extraterrestrial_normal_irradiance_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.normal.calculate_extraterrestrial_normal_irradiance_hofierka</code>)'>calculate_extraterrestrial_normal_irradiance_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the normal extraterrestrial irradiance over a period of time.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.normal.calculate_extraterrestrial_normal_irradiance_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_extraterrestrial_normal_irradiance_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.extraterrestrial.normal.calculate_extraterrestrial_normal_irradiance_hofierka title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_extraterrestrial_normal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.ExtraterrestrialNormalIrradiance>ExtraterrestrialNormalIrradiance</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the normal extraterrestrial irradiance over a period of time. This function implements the algorithm described by Hofierka [1]_.</p> <p>Outside the atmosphere, at the mean solar distance, the direct (beam) irradiance, also known as the solar constant (I0), is 1367 W.m-2. The earths orbit is lightly eccentric and the sun- earth distance varies slightly across the year. Therefore a correction factor , to allow for the varying solar distance, is applied in calculation of the extraterrestrial irradiance <code>G0</code> normal to the solar beam [W.m-2] :</p> <div class=codehilite><pre><span></span><code>G0 = I0   (1)
</code></pre></div> <p>where :</p> <div class=codehilite><pre><span></span><code> = 1 + 0.03344 cos (j - 0.048869) (2)

where the day angle j is in radians :

    j = 2  j/365.25 (3)
</code></pre></div> <p>and <code>j</code> is the day number which varies from 1 on January 1<sup>st</sup> to 365 (366) on December 31<sup>st</sup>.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span> | None</code> </td> <td> <div class=doc-md-description> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>solar_constant</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>eccentricity_phase_offset</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>eccentricity_amplitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.ExtraterrestrialNormalIrradiance>ExtraterrestrialNormalIrradiance</span></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>In [1]_ : G0h = G0 sin(h0) or else : G0 horizontal = G0  sin(solar altitude)</p> </details> <details class=references open> <summary>References</summary> <p>.. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/extraterrestrial/normal.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_extraterrestrial_normal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SOLAR_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ExtraterrestrialNormalIrradiance</span><span class=p>:</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>    Calculate the normal extraterrestrial irradiance over a period of time.</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    This function implements the algorithm described by Hofierka [1]_.</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    Outside the atmosphere, at the mean solar distance, the direct (beam) irradiance, also known as</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    the solar constant (I0), is 1367 W.m-2. The earths orbit is lightly eccentric and the sun-</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    earth distance varies slightly across the year. Therefore a correction factor , to allow for</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    the varying solar distance, is applied in calculation of the</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    extraterrestrial irradiance `G0` normal to the solar beam [W.m-2] :</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>        G0 = I0   (1)</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    where :</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>         = 1 + 0.03344 cos (j - 0.048869) (2)</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        where the day angle j is in radians :</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>            j = 2  j/365.25 (3)</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    and `j` is the day number which varies from 1 on January 1st to 365 (366) on</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    December 31st.</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    timestamps: DatetimeIndex</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    solar_constant: float</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    eccentricity_phase_offset: float</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    eccentricity_amplitude: float</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    dtype:</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    array_backend:</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    verbose: int</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    log: int</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    ExtraterrestrialNormalIrradiance</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    In [1]_ : G0h = G0 sin(h0)  or else : G0 horizontal = G0  sin(solar altitude)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    .. [1] Hofierka, J. (2002). Some title of the paper. Journal Name, vol(issue), pages.</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=n>years_in_timestamps</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>year</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=n>years</span><span class=p>,</span> <span class=n>indices</span> <span class=o>=</span> <span class=n>unique</span><span class=p>(</span><span class=n>years_in_timestamps</span><span class=p>,</span> <span class=n>return_inverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>    <span class=n>days_per_year</span> <span class=o>=</span> <span class=n>get_days_per_year</span><span class=p>(</span><span class=n>years</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=n>days_in_years</span> <span class=o>=</span> <span class=n>days_per_year</span><span class=p>[</span><span class=n>indices</span><span class=p>]</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>day_of_year_series</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>dayofyear</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=c1># day angle == fractional year, hence : use model_fractional_year_series()</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>day_angle_series</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span> <span class=o>*</span> <span class=n>day_of_year_series</span> <span class=o>/</span> <span class=n>days_in_years</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>    <span class=n>distance_correction_factor_series</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>eccentricity_amplitude</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=n>day_angle_series</span> <span class=o>-</span> <span class=n>eccentricity_phase_offset</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=n>extraterrestrial_normal_irradiance</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=n>solar_constant</span> <span class=o>*</span> <span class=n>distance_correction_factor_series</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>extraterrestrial_normal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>ExtraterrestrialNormalIrradiance</span><span class=p>(),</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>extraterrestrial_normal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=k>return</span> <span class=n>ExtraterrestrialNormalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>extraterrestrial_normal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=n>day_of_year</span><span class=o>=</span><span class=n>day_of_year_series</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>day_angle</span><span class=o>=</span><span class=n>day_angle_series</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=n>distance_correction_factor</span><span class=o>=</span><span class=n>distance_correction_factor_series</span><span class=p>,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=n>quality</span><span class=o>=</span><span class=s2>"Not validated!"</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.shortwave> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">shortwave</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">clear_sky</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky</code>)'>clear_sky</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.inclined title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">inclined</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.shortwave.inclined</code>)'>inclined</a></code></td> <td> <div class=doc-md-description> <p>API module to calculate the global (shortwave) irradiance over a</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">clear_sky</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky.inclined title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">inclined</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky.inclined</code>)'>inclined</a></code></td> <td> <div class=doc-md-description> <p>API module to calculate the global (shortwave) irradiance over a</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky.inclined> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">inclined</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky.inclined title="Permanent link"></a></h6> <div class="doc doc-contents"> <p>API module to calculate the global (shortwave) irradiance over a location for a period in time.</p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky.inclined.calculate_clear_sky_global_inclined_irradiance_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_clear_sky_global_inclined_irradiance_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky.inclined.calculate_clear_sky_global_inclined_irradiance_hofierka</code>)'>calculate_clear_sky_global_inclined_irradiance_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the global irradiance on an inclined surface [W.m-2]</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h7 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky.inclined.calculate_clear_sky_global_inclined_irradiance_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_clear_sky_global_inclined_irradiance_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.clear_sky.inclined.calculate_clear_sky_global_inclined_irradiance_hofierka title="Permanent link"></a></h7> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_clear_sky_global_inclined_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>elevation</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n><span title=pvgisprototype.validation.models.SurfaceOrientationModel>SurfaceOrientationModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><span title=pvgisprototype.validation.models.SurfaceTiltModel>SurfaceTiltModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>=</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>(</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>        <span class=p>[</span><span class=n><span title=pandas.Timestamp.now>now</span></span><span class=p>(</span><span class=n><span title=pandas.Timestamp.now(tz)>tz</span></span><span class=o>=</span><span class=s2>"UTC"</span><span class=p>)]</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=p>),</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>global_horizontal_irradiance</span><span class=p>:</span> <span class=n><span title=numpy._core.multiarray.ndarray>ndarray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>direct_horizontal_irradiance</span><span class=p>:</span> <span class=n><span title=numpy._core.multiarray.ndarray>ndarray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>(),</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>albedo</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ALBEDO_DEFAULT>ALBEDO_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>apply_reflectivity_factor</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ANGULAR_LOSS_FACTOR_FLAG_DEFAULT>ANGULAR_LOSS_FACTOR_FLAG_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=n>solar_azimuth_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarIncidence>SolarIncidence</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=n>solar_position_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarPositionModel>SolarPositionModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SolarPositionModel.noaa>noaa</span></span><span class=p>,</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n><span title=pydantic_numpy.NpNDArray>NpNDArray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=n>sun_horizon_position</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.List title="<code>typing.List</code>">List</a></span><span class=p>[</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>        <span class=n><span title=pvgisprototype.api.position.models.SunHorizonPositionModel>SunHorizonPositionModel</span></span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=p>]</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SUN_HORIZON_POSITION_DEFAULT>SUN_HORIZON_POSITION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>shading_states</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.List title="<code>typing.List</code>">List</a></span><span class=p>[</span><span class=n><span title=pvgisprototype.api.position.models.ShadingState>ShadingState</span></span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n><span title=pvgisprototype.api.position.models.ShadingState.all>all</span></span><span class=p>],</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=n>solar_time_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarTimeModel>SolarTimeModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SolarTimeModel.noaa>noaa</span></span><span class=p>,</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></span><span class=p>,</span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-33><a href=#__codelineno-0-33 id=__codelineno-0-33 name=__codelineno-0-33></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-34><a href=#__codelineno-0-34 id=__codelineno-0-34 name=__codelineno-0-34></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-35><a href=#__codelineno-0-35 id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-36><a href=#__codelineno-0-36 id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=n>fingerprint</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.FINGERPRINT_FLAG_DEFAULT>FINGERPRINT_FLAG_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-37><a href=#__codelineno-0-37 id=__codelineno-0-37 name=__codelineno-0-37></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.GlobalInclinedIrradiance>GlobalInclinedIrradiance</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the global irradiance on an inclined surface [W.m-2]</p> <p>Calculate the global irradiance on an inclined surface as the sum of the direct, the diffuse and the ground-reflected radiation components. The radiation, selectively attenuated by the atmosphere, which is not reflected or scattered and reaches the surface directly is the direct radiation. The scattered radiation that reaches the ground is the diffuse radiation. In addition, a smaller part of radiation is reflected from the ground onto the inclined surface. Only small percents of reflected radiation contribute to inclined surfaces, thus it is sometimes ignored. PVGIS, however, inherits the solutions adopted in the r.sun solar radiation model in which both the diffuse and reflected radiation components are considered.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/shortwave/clear_sky/inclined.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_clear_sky_global_inclined_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=n>elevation</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n>SurfaceOrientationModel</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n>SurfaceTiltModel</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>=</span> <span class=n>DatetimeIndex</span><span class=p>([</span><span class=n>Timestamp</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>tz</span><span class=o>=</span><span class=s1>'UTC'</span><span class=p>)]),</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=n>global_horizontal_irradiance</span><span class=p>:</span> <span class=n>ndarray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=n>direct_horizontal_irradiance</span><span class=p>:</span> <span class=n>ndarray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(),</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=c1># unrefracted_solar_zenith: UnrefractedSolarZenith | None = UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT,  # radians</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=n>albedo</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>ALBEDO_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=n>apply_reflectivity_factor</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>ANGULAR_LOSS_FACTOR_FLAG_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n>SolarAltitude</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=n>solar_azimuth_series</span><span class=p>:</span> <span class=n>SolarAzimuth</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n>SolarIncidence</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=n>solar_position_model</span><span class=p>:</span> <span class=n>SolarPositionModel</span> <span class=o>=</span> <span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n>NpNDArray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=n>sun_horizon_position</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>SunHorizonPositionModel</span><span class=p>]</span> <span class=o>=</span> <span class=n>SUN_HORIZON_POSITION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>    <span class=n>shading_states</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ShadingState</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>ShadingState</span><span class=o>.</span><span class=n>all</span><span class=p>],</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=n>solar_time_model</span><span class=p>:</span> <span class=n>SolarTimeModel</span> <span class=o>=</span> <span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SOLAR_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=n>validate_output</span><span class=p>:</span><span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=n>fingerprint</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>FINGERPRINT_FLAG_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GlobalInclinedIrradiance</span><span class=p>:</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=w>    </span><span class=sd>"""Calculate the global irradiance on an inclined surface [W.m-2]</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>    Calculate the global irradiance on an inclined surface as the sum of the</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    direct, the diffuse and the ground-reflected radiation components.</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    The radiation, selectively attenuated by the atmosphere, which is not</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>    reflected or scattered and reaches the surface directly is the direct</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>    radiation. The scattered radiation that reaches the ground is the</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>    diffuse radiation. In addition, a smaller part of radiation is reflected</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    from the ground onto the inclined surface. Only small percents of reflected</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>    radiation contribute to inclined surfaces, thus it is sometimes ignored.</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>    PVGIS, however, inherits the solutions adopted in the r.sun solar radiation</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>    model in which both the diffuse and reflected radiation components are</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>    considered.</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=c1># In order to avoid unbound errors we pre-define `_series` objects</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=n>array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=s2>"shape"</span><span class=p>:</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=s2>"init_method"</span><span class=p>:</span> <span class=s2>"zeros"</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>    <span class=p>}</span>  <span class=c1># Borrow shape from timestamps</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=n>zero_array</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>array_parameters</span><span class=p>)</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>solar_azimuth_series</span><span class=p>:</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>SolarAzimuth</span><span class=p>(</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>zero_array</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>                <span class=n>unit</span><span class=o>=</span><span class=s1>'Unitless'</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>                <span class=n>origin</span><span class=o>=</span><span class=s1>'Not Required!'</span><span class=p>,</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>    <span class=c1># # direct</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>    <span class=c1># # ----------------------------------------------- Important !</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>    <span class=c1># if direct_horizontal_irradiance is None:</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>    <span class=c1>#     direct_horizontal_irradiance = zero_array</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=c1># # Important ! -----------------------------------------------</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=n>direct_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>DirectInclinedIrradiance</span><span class=p>(</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>zero_array</span><span class=p>,</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>    <span class=c1># direct_inclined_irradiance_series.reflectivity = zero_array</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>    <span class=c1># direct_inclined_irradiance_series.value_before_reflectivity = zero_array</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=c1># direct_inclined_irradiance_series.reflectivity_factor = zero_array</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=c1># direct_inclined_irradiance_series.direct_horizontal_irradiance = direct_horizontal_irradiance</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>    <span class=c1># direct_inclined_irradiance_series.solar_incidence_model = solar_incidence_model</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>    <span class=c1># # direct_inclined_irradiance_series.solar_incidence.definition = </span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>    <span class=c1># # extraterrestrial normal to be fed indirectly to diffuse_inclined_irradiance</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>    <span class=c1># extraterrestrial_normal_irradiance = ExtraterrestrialNormalIrradiance(value=zero_array)</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>    <span class=c1># direct_normal_irradiance = DirectNormalIrradiance(</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>    <span class=c1>#     value=zero_array,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>    <span class=c1>#     extraterrestrial_normal_irradiance=extraterrestrial_normal_irradiance,</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>    <span class=c1># direct_horizontal_irradiance = DirectHorizontalIrradiance(</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>    <span class=c1>#     value=direct_horizontal_irradiance, direct_normal_irradiance=direct_normal_irradiance</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>    <span class=c1># diffuse sky-reflected</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>    <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>DiffuseSkyReflectedInclinedIrradiance</span><span class=p>(</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>zero_array</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>        <span class=n>solar_azimuth</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>        <span class=c1># direct_horizontal_irradiance=direct_horizontal_irradiance,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>    <span class=c1># diffuse_inclined_irradiance_series.reflected = zero_array</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>    <span class=c1># diffuse_inclined_irradiance_series.value_before_reflectivity = zero_array</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>    <span class=c1># diffuse_inclined_irradiance_series.reflectivity_factor = zero_array</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>    <span class=c1># diffuse_inclined_irradiance_series.diffuse_horizontal_irradiance = DiffuseSkyReflectedHorizontalIrradiance(value=zero_array)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>    <span class=c1># diffuse ground-reflected</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>    <span class=c1># note : there is no ground-reflected _horizontal_ component as such !</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>    <span class=n>ground_reflected_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>DiffuseGroundReflectedInclinedIrradiance</span><span class=p>(</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>zero_array</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>    <span class=c1># ground_reflected_inclined_irradiance_series.reflectivity = zero_array</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>    <span class=c1># ground_reflected_inclined_irradiance_series.value_before_reflectivity = zero_array</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>    <span class=c1># ground_reflected_inclined_irradiance_series.reflectivity_factor = zero_array</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>    <span class=n>global_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>zero_array</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>    <span class=c1># Select which solar positions related to the horizon to process</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>    <span class=n>sun_horizon_positions</span> <span class=o>=</span> <span class=n>select_models</span><span class=p>(</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>        <span class=n>SunHorizonPositionModel</span><span class=p>,</span> <span class=n>sun_horizon_position</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>    <span class=p>)</span>  <span class=c1># Using a Typer callback fails !</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>    <span class=c1># and keep track of the position of the sun relative to the horizon</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>    <span class=n>sun_horizon_position_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>        <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s2>"object"</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"empty"</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>    <span class=c1># Following, create masks based on the solar altitude series --------</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>    <span class=c1># For sun below the horizon</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>    <span class=k>if</span> <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>below</span> <span class=ow>in</span> <span class=n>sun_horizon_positions</span><span class=p>:</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=n>mask_below_horizon</span> <span class=o>=</span> <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&lt;</span> <span class=mi>0</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>        <span class=n>sun_horizon_position_series</span><span class=p>[</span><span class=n>mask_below_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>below</span><span class=o>.</span><span class=n>value</span><span class=p>]</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>        <span class=k>if</span> <span class=n>numpy</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mask_below_horizon</span><span class=p>):</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>                <span class=sa>f</span><span class=s2>"Positions of the sun below horizon :</span><span class=se>\n</span><span class=si>{</span><span class=n>sun_horizon_position_series</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Positions of the sun [bold gray50]below horizon[/bold gray50] :</span><span class=se>\n</span><span class=si>{</span><span class=n>sun_horizon_position_series</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>            <span class=c1># no incident radiance without direct sunlight !</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>            <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_below_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>            <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_below_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>            <span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_below_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>    <span class=c1># For very low sun angles</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>    <span class=k>if</span> <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>low_angle</span> <span class=ow>in</span> <span class=n>sun_horizon_positions</span><span class=p>:</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>        <span class=n>mask_low_angle</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>logical_and</span><span class=p>(</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>            <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>            <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&lt;</span> <span class=mf>0.04</span><span class=p>,</span>  <span class=c1># FIXME: Is 0.04 in radians or degrees ?</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>            <span class=n>sun_horizon_position_series</span> <span class=o>==</span> <span class=kc>None</span><span class=p>,</span>  <span class=c1># operate only on unset elements</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>        <span class=n>sun_horizon_position_series</span><span class=p>[</span><span class=n>mask_low_angle</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>            <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>low_angle</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>        <span class=p>]</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>        <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_low_angle</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>            <span class=mi>0</span>  <span class=c1># Direct radiation is negligible</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>    <span class=c1># For sun above the horizon</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>    <span class=k>if</span> <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>above</span> <span class=ow>in</span> <span class=n>sun_horizon_positions</span><span class=p>:</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>        <span class=n>mask_above_horizon</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>logical_and</span><span class=p>(</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>            <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>            <span class=n>sun_horizon_position_series</span> <span class=o>==</span> <span class=kc>None</span><span class=p>,</span>  <span class=c1># operate only on unset elements</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>        <span class=n>sun_horizon_position_series</span><span class=p>[</span><span class=n>mask_above_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>            <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>above</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>        <span class=p>]</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>        <span class=c1># For sun above horizon and not in shade</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>        <span class=n>mask_not_in_shade</span> <span class=o>=</span> <span class=o>~</span><span class=n>surface_in_shade_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>        <span class=n>mask_above_horizon_not_in_shade</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>logical_and</span><span class=p>(</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>            <span class=n>mask_above_horizon</span><span class=p>,</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>            <span class=n>mask_not_in_shade</span><span class=p>,</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>            <span class=n>sun_horizon_position_series</span> <span class=o>==</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>        <span class=k>if</span> <span class=n>numpy</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mask_above_horizon_not_in_shade</span><span class=p>):</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>            <span class=c1># sun_horizon_position_series[mask_above_horizon_not_in_shade] = [SunHorizonPositionModel.above.name]</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>                <span class=sa>f</span><span class=s2>"Including positions of the sun above horizon and not in shade :</span><span class=se>\n</span><span class=si>{</span><span class=n>sun_horizon_position_series</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Including positions of the sun [bold yellow]above horizon[/bold yellow] and [bold red]not in shade[/bold red] :</span><span class=se>\n</span><span class=si>{</span><span class=n>sun_horizon_position_series</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>            <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>                <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>                    <span class=s2>"i Calculating the direct inclined irradiance for moments not in shade .."</span><span class=p>,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>                    <span class=n>alt</span><span class=o>=</span><span class=s2>"i [bold]Calculating[/bold] the [magenta]direct inclined irradiance[/magenta] for moments not in shade .."</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>            <span class=c1># if not read from external time series,</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>            <span class=c1># will calculate the clear-sky index !</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>        <span class=n>direct_inclined_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>            <span class=n>calculate_clear_sky_direct_inclined_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>                <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>                <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>                <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>                <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>                <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>                <span class=n>direct_horizontal_irradiance</span><span class=o>=</span><span class=n>direct_horizontal_irradiance</span><span class=p>,</span>  <span class=c1># FixMe</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>                <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>                <span class=n>apply_reflectivity_factor</span><span class=o>=</span><span class=n>apply_reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>                <span class=n>solar_incidence_series</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>                <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>                <span class=c1># solar_azimuth_series=solar_azimuth_series,</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>                <span class=n>surface_in_shade_series</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>                <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>                <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>                <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>                <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>                <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>                <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>                <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>        <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>build_output</span><span class=p>(</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>            <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span> <span class=n>fingerprint</span><span class=o>=</span><span class=n>fingerprint</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a>        <span class=c1># Calculate diffuse and reflected irradiance for sun above horizon</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>numpy</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mask_above_horizon</span><span class=p>):</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>                <span class=s2>"i [yellow bold]Apparently there is no moment of the sun above the horizon in the requested time series![/yellow bold] "</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a>            <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>                <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a>                    <span class=s2>"i [bold]Calculating[/bold] the [magenta]diffuse inclined irradiance[/magenta] for daylight moments .."</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a>            <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>                <span class=n>calculate_clear_sky_diffuse_inclined_irradiance_muneer</span><span class=p>(</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>                    <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>                    <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>                    <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>                    <span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=o>=</span><span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>,</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>                    <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>                    <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a>                    <span class=n>global_horizontal_irradiance_series</span><span class=o>=</span><span class=n>global_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a>                    <span class=n>direct_horizontal_irradiance_series</span><span class=o>=</span><span class=n>direct_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>                    <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a>                    <span class=n>apply_reflectivity_factor</span><span class=o>=</span><span class=n>apply_reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a>                    <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a>                    <span class=n>solar_azimuth_series</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a>                    <span class=n>solar_incidence_series</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a>                    <span class=n>surface_in_shade_series</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>                    <span class=n>shading_states</span><span class=o>=</span><span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a>                    <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a>                    <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a>                    <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>                    <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><a href=#__codelineno-0-328><span class=linenos data-linenos="328 "></span></a>                    <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a>                    <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a>                    <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a>            <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>build_output</span><span class=p>(</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span> <span class=n>fingerprint</span><span class=o>=</span><span class=n>fingerprint</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a>            <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a>                <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><a href=#__codelineno-0-338><span class=linenos data-linenos="338 "></span></a>                    <span class=s2>"i [bold]Calculating[/bold] the [magenta]reflected inclined irradiance[/magenta] for daylight moments .."</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><a href=#__codelineno-0-339><span class=linenos data-linenos="339 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><a href=#__codelineno-0-340><span class=linenos data-linenos="340 "></span></a>            <span class=n>ground_reflected_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_ground_reflected_inclined_irradiance_series</span><span class=p>(</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><a href=#__codelineno-0-341><span class=linenos data-linenos="341 "></span></a>                <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><a href=#__codelineno-0-342><span class=linenos data-linenos="342 "></span></a>                <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><a href=#__codelineno-0-343><span class=linenos data-linenos="343 "></span></a>                <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><a href=#__codelineno-0-344><span class=linenos data-linenos="344 "></span></a>                <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><a href=#__codelineno-0-345><span class=linenos data-linenos="345 "></span></a>                <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><a href=#__codelineno-0-346><span class=linenos data-linenos="346 "></span></a>                <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><a href=#__codelineno-0-347><span class=linenos data-linenos="347 "></span></a>                <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><a href=#__codelineno-0-348><span class=linenos data-linenos="348 "></span></a>                <span class=n>global_horizontal_irradiance</span><span class=o>=</span><span class=n>global_horizontal_irradiance</span><span class=p>,</span>  <span class=c1># time series, optional</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><a href=#__codelineno-0-349><span class=linenos data-linenos="349 "></span></a>                <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><a href=#__codelineno-0-350><span class=linenos data-linenos="350 "></span></a>                <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><a href=#__codelineno-0-351><span class=linenos data-linenos="351 "></span></a>                <span class=c1># unrefracted_solar_zenith=unrefracted_solar_zenith,</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><a href=#__codelineno-0-352><span class=linenos data-linenos="352 "></span></a>                <span class=n>albedo</span><span class=o>=</span><span class=n>albedo</span><span class=p>,</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><a href=#__codelineno-0-353><span class=linenos data-linenos="353 "></span></a>                <span class=n>apply_reflectivity_factor</span><span class=o>=</span><span class=n>apply_reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><a href=#__codelineno-0-354><span class=linenos data-linenos="354 "></span></a>                <span class=n>solar_position_model</span><span class=o>=</span><span class=n>solar_position_model</span><span class=p>,</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><a href=#__codelineno-0-355><span class=linenos data-linenos="355 "></span></a>                <span class=n>solar_time_model</span><span class=o>=</span><span class=n>solar_time_model</span><span class=p>,</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><a href=#__codelineno-0-356><span class=linenos data-linenos="356 "></span></a>                <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><a href=#__codelineno-0-357><span class=linenos data-linenos="357 "></span></a>                <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><a href=#__codelineno-0-358><span class=linenos data-linenos="358 "></span></a>                <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><a href=#__codelineno-0-359><span class=linenos data-linenos="359 "></span></a>                <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><a href=#__codelineno-0-360><span class=linenos data-linenos="360 "></span></a>                <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><a href=#__codelineno-0-361><span class=linenos data-linenos="361 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><a href=#__codelineno-0-362><span class=linenos data-linenos="362 "></span></a>                <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><a href=#__codelineno-0-363><span class=linenos data-linenos="363 "></span></a>                <span class=n>fingerprint</span><span class=o>=</span><span class=n>fingerprint</span><span class=p>,</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a><a href=#__codelineno-0-364><span class=linenos data-linenos="364 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><a href=#__codelineno-0-365><span class=linenos data-linenos="365 "></span></a>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><a href=#__codelineno-0-366><span class=linenos data-linenos="366 "></span></a>    <span class=c1># sum components</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><a href=#__codelineno-0-367><span class=linenos data-linenos="367 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><a href=#__codelineno-0-368><span class=linenos data-linenos="368 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><a href=#__codelineno-0-369><span class=linenos data-linenos="369 "></span></a>            <span class=s2>"</span><span class=se>\n</span><span class=s2>i [bold]Calculating[/bold] the [magenta]global inclined irradiance[/magenta] .."</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><a href=#__codelineno-0-370><span class=linenos data-linenos="370 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><a href=#__codelineno-0-371><span class=linenos data-linenos="371 "></span></a>    <span class=n>global_inclined_irradiance_series</span><span class=p>[</span><span class=n>mask_above_horizon_not_in_shade</span><span class=p>]</span> <span class=o>+=</span> <span class=p>(</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><a href=#__codelineno-0-372><span class=linenos data-linenos="372 "></span></a>        <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_above_horizon_not_in_shade</span><span class=p>]</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><a href=#__codelineno-0-373><span class=linenos data-linenos="373 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><a href=#__codelineno-0-374><span class=linenos data-linenos="374 "></span></a>    <span class=n>global_inclined_irradiance_series</span><span class=p>[</span><span class=n>mask_above_horizon</span><span class=p>]</span> <span class=o>+=</span> <span class=p>(</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><a href=#__codelineno-0-375><span class=linenos data-linenos="375 "></span></a>        <span class=o>+</span> <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_above_horizon</span><span class=p>]</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><a href=#__codelineno-0-376><span class=linenos data-linenos="376 "></span></a>        <span class=o>+</span> <span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_above_horizon</span><span class=p>]</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><a href=#__codelineno-0-377><span class=linenos data-linenos="377 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><a href=#__codelineno-0-378><span class=linenos data-linenos="378 "></span></a>    <span class=n>global_inclined_reflectivity_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><a href=#__codelineno-0-379><span class=linenos data-linenos="379 "></span></a>        <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><a href=#__codelineno-0-380><span class=linenos data-linenos="380 "></span></a>        <span class=o>+</span> <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><a href=#__codelineno-0-381><span class=linenos data-linenos="381 "></span></a>        <span class=o>+</span> <span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><a href=#__codelineno-0-382><span class=linenos data-linenos="382 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><a href=#__codelineno-0-383><span class=linenos data-linenos="383 "></span></a>    <span class=n>global_inclined_irradiance_before_reflectivity_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><a href=#__codelineno-0-384><span class=linenos data-linenos="384 "></span></a>        <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><a href=#__codelineno-0-385><span class=linenos data-linenos="385 "></span></a>        <span class=o>+</span> <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><a href=#__codelineno-0-386><span class=linenos data-linenos="386 "></span></a>        <span class=o>+</span> <span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><a href=#__codelineno-0-387><span class=linenos data-linenos="387 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a><a href=#__codelineno-0-388><span class=linenos data-linenos="388 "></span></a>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a><a href=#__codelineno-0-389><span class=linenos data-linenos="389 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a><a href=#__codelineno-0-390><span class=linenos data-linenos="390 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>global_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><a href=#__codelineno-0-391><span class=linenos data-linenos="391 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a><a href=#__codelineno-0-392><span class=linenos data-linenos="392 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>GlobalInclinedIrradiance</span><span class=p>(),</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><a href=#__codelineno-0-393><span class=linenos data-linenos="393 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a><a href=#__codelineno-0-394><span class=linenos data-linenos="394 "></span></a>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><a href=#__codelineno-0-395><span class=linenos data-linenos="395 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><a href=#__codelineno-0-396><span class=linenos data-linenos="396 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><a href=#__codelineno-0-397><span class=linenos data-linenos="397 "></span></a>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><a href=#__codelineno-0-398><span class=linenos data-linenos="398 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><a href=#__codelineno-0-399><span class=linenos data-linenos="399 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>global_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><a href=#__codelineno-0-400><span class=linenos data-linenos="400 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><a href=#__codelineno-0-401><span class=linenos data-linenos="401 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><a href=#__codelineno-0-402><span class=linenos data-linenos="402 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><a href=#__codelineno-0-403><span class=linenos data-linenos="403 "></span></a>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><a href=#__codelineno-0-404><span class=linenos data-linenos="404 "></span></a>    <span class=k>return</span> <span class=n>GlobalInclinedIrradiance</span><span class=p>(</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><a href=#__codelineno-0-405><span class=linenos data-linenos="405 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>global_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><a href=#__codelineno-0-406><span class=linenos data-linenos="406 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><a href=#__codelineno-0-407><span class=linenos data-linenos="407 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><a href=#__codelineno-0-408><span class=linenos data-linenos="408 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a><a href=#__codelineno-0-409><span class=linenos data-linenos="409 "></span></a>        <span class=c1>## Inclined Irradiance Components</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><a href=#__codelineno-0-410><span class=linenos data-linenos="410 "></span></a>        <span class=n>direct_inclined_irradiance</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><a href=#__codelineno-0-411><span class=linenos data-linenos="411 "></span></a>        <span class=n>diffuse_inclined_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><a href=#__codelineno-0-412><span class=linenos data-linenos="412 "></span></a>        <span class=n>ground_reflected_inclined_irradiance</span><span class=o>=</span><span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a><a href=#__codelineno-0-413><span class=linenos data-linenos="413 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a><a href=#__codelineno-0-414><span class=linenos data-linenos="414 "></span></a>        <span class=c1>## Loss due to Reflectivity</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a><a href=#__codelineno-0-415><span class=linenos data-linenos="415 "></span></a>        <span class=n>reflected</span><span class=o>=</span><span class=n>global_inclined_reflectivity_series</span><span class=p>,</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a><a href=#__codelineno-0-416><span class=linenos data-linenos="416 "></span></a>        <span class=n>direct_inclined_reflected</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span><span class=p>,</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a><a href=#__codelineno-0-417><span class=linenos data-linenos="417 "></span></a>        <span class=n>diffuse_inclined_reflected</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span><span class=p>,</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a><a href=#__codelineno-0-418><span class=linenos data-linenos="418 "></span></a>        <span class=n>ground_reflected_inclined_reflected</span><span class=o>=</span><span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span><span class=p>,</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a><a href=#__codelineno-0-419><span class=linenos data-linenos="419 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a><a href=#__codelineno-0-420><span class=linenos data-linenos="420 "></span></a>        <span class=c1>## Reflectivity Factor for Irradiance Components</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a><a href=#__codelineno-0-421><span class=linenos data-linenos="421 "></span></a>        <span class=n>direct_inclined_reflectivity_factor</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a><a href=#__codelineno-0-422><span class=linenos data-linenos="422 "></span></a>        <span class=n>diffuse_inclined_reflectivity_factor</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a><a href=#__codelineno-0-423><span class=linenos data-linenos="423 "></span></a>        <span class=n>ground_reflected_inclined_reflectivity_factor</span><span class=o>=</span><span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a><a href=#__codelineno-0-424><span class=linenos data-linenos="424 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><a href=#__codelineno-0-425><span class=linenos data-linenos="425 "></span></a>        <span class=c1>## Reflectivity Coefficient which defines the Reflectivity Factor for Irradiance Components</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><a href=#__codelineno-0-426><span class=linenos data-linenos="426 "></span></a>        <span class=c1># direct_inclined_reflectivity_coefficient=direct_inclined_reflectivity_coefficient_series,</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a><a href=#__codelineno-0-427><span class=linenos data-linenos="427 "></span></a>        <span class=n>diffuse_inclined_reflectivity_coefficient</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflectivity_coefficient</span><span class=p>,</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a><a href=#__codelineno-0-428><span class=linenos data-linenos="428 "></span></a>        <span class=c1># ground_reflected_inclined_reflectivity_coefficient=ground_reflected_inclined_reflectivity_coefficient_series,</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a><a href=#__codelineno-0-429><span class=linenos data-linenos="429 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a><a href=#__codelineno-0-430><span class=linenos data-linenos="430 "></span></a>        <span class=c1>## Inclined Irradiance before loss due to Reflectivity</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a><a href=#__codelineno-0-431><span class=linenos data-linenos="431 "></span></a>        <span class=n>value_before_reflectivity</span><span class=o>=</span><span class=n>global_inclined_irradiance_before_reflectivity_series</span><span class=p>,</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a><a href=#__codelineno-0-432><span class=linenos data-linenos="432 "></span></a>        <span class=n>direct_inclined_before_reflectivity</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span><span class=p>,</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a><a href=#__codelineno-0-433><span class=linenos data-linenos="433 "></span></a>        <span class=n>diffuse_inclined_before_reflectivity</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span><span class=p>,</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><a href=#__codelineno-0-434><span class=linenos data-linenos="434 "></span></a>        <span class=n>ground_reflected_inclined_before_reflectivity</span><span class=o>=</span><span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span><span class=p>,</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a><a href=#__codelineno-0-435><span class=linenos data-linenos="435 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a><a href=#__codelineno-0-436><span class=linenos data-linenos="436 "></span></a>        <span class=c1>## Horizontal Irradiance Components</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a><a href=#__codelineno-0-437><span class=linenos data-linenos="437 "></span></a>        <span class=n>global_horizontal_irradiance</span><span class=o>=</span><span class=n>global_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a><a href=#__codelineno-0-438><span class=linenos data-linenos="438 "></span></a>        <span class=n>direct_horizontal_irradiance</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>direct_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a><a href=#__codelineno-0-439><span class=linenos data-linenos="439 "></span></a>        <span class=n>diffuse_horizontal_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>diffuse_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a><a href=#__codelineno-0-440><span class=linenos data-linenos="440 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a><a href=#__codelineno-0-441><span class=linenos data-linenos="441 "></span></a>        <span class=c1>## Components of the diffuse sky-reflected irradiance</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a><a href=#__codelineno-0-442><span class=linenos data-linenos="442 "></span></a>        <span class=n>diffuse_sky_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>diffuse_sky_irradiance</span><span class=p>,</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a><a href=#__codelineno-0-443><span class=linenos data-linenos="443 "></span></a>        <span class=n>term_n</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>term_n</span><span class=p>,</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a><a href=#__codelineno-0-444><span class=linenos data-linenos="444 "></span></a>        <span class=n>kb_ratio</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>kb_ratio</span><span class=p>,</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a><a href=#__codelineno-0-445><span class=linenos data-linenos="445 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a><a href=#__codelineno-0-446><span class=linenos data-linenos="446 "></span></a>        <span class=c1>## Components of the Extraterrestrial irradiance</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a><a href=#__codelineno-0-447><span class=linenos data-linenos="447 "></span></a>        <span class=n>extraterrestrial_horizontal_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>extraterrestrial_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a><a href=#__codelineno-0-448><span class=linenos data-linenos="448 "></span></a>        <span class=n>extraterrestrial_normal_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>extraterrestrial_normal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a><a href=#__codelineno-0-449><span class=linenos data-linenos="449 "></span></a>        <span class=n>linke_turbidity_factor</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a><a href=#__codelineno-0-450><span class=linenos data-linenos="450 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a><a href=#__codelineno-0-451><span class=linenos data-linenos="451 "></span></a>        <span class=c1>## Location and Position</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a><a href=#__codelineno-0-452><span class=linenos data-linenos="452 "></span></a>        <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a><a href=#__codelineno-0-453><span class=linenos data-linenos="453 "></span></a>        <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a><a href=#__codelineno-0-454><span class=linenos data-linenos="454 "></span></a>        <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a><a href=#__codelineno-0-455><span class=linenos data-linenos="455 "></span></a>        <span class=n>sun_horizon_positions</span><span class=o>=</span><span class=n>sun_horizon_positions</span><span class=p>,</span>  <span class=c1># states != sun_horizon_position</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a><a href=#__codelineno-0-456><span class=linenos data-linenos="456 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a><a href=#__codelineno-0-457><span class=linenos data-linenos="457 "></span></a>        <span class=c1>## Solar Position parameters</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a><a href=#__codelineno-0-458><span class=linenos data-linenos="458 "></span></a>        <span class=n>surface_in_shade</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><a href=#__codelineno-0-459><span class=linenos data-linenos="459 "></span></a>        <span class=n>solar_incidence</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>solar_incidence</span><span class=p>,</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><a href=#__codelineno-0-460><span class=linenos data-linenos="460 "></span></a>        <span class=n>shading_state</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>shading_state</span><span class=p>,</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><a href=#__codelineno-0-461><span class=linenos data-linenos="461 "></span></a>        <span class=n>sun_horizon_position</span><span class=o>=</span><span class=n>sun_horizon_position_series</span><span class=p>,</span>  <span class=c1># positions != sun_horizon_positions</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><a href=#__codelineno-0-462><span class=linenos data-linenos="462 "></span></a>        <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a><a href=#__codelineno-0-463><span class=linenos data-linenos="463 "></span></a>        <span class=n>refracted_solar_altitude</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>refracted_solar_altitude</span><span class=p>,</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a><a href=#__codelineno-0-464><span class=linenos data-linenos="464 "></span></a>        <span class=n>solar_azimuth</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>solar_azimuth</span><span class=p>,</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a><a href=#__codelineno-0-465><span class=linenos data-linenos="465 "></span></a>        <span class=c1># azimuth_difference=azimuth_difference_series,</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a><a href=#__codelineno-0-466><span class=linenos data-linenos="466 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a><a href=#__codelineno-0-467><span class=linenos data-linenos="467 "></span></a>        <span class=c1>## Positioning, Timing and Atmospheric algorithms</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a><a href=#__codelineno-0-468><span class=linenos data-linenos="468 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a><a href=#__codelineno-0-469><span class=linenos data-linenos="469 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a><a href=#__codelineno-0-470><span class=linenos data-linenos="470 "></span></a>        <span class=n>adjusted_for_atmospheric_refraction</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>adjusted_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a><a href=#__codelineno-0-471><span class=linenos data-linenos="471 "></span></a>        <span class=n>solar_incidence_model</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>solar_incidence_model</span><span class=p>,</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a><a href=#__codelineno-0-472><span class=linenos data-linenos="472 "></span></a>        <span class=n>solar_incidence_definition</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>solar_incidence</span><span class=o>.</span><span class=n>definition</span><span class=p>,</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a><a href=#__codelineno-0-473><span class=linenos data-linenos="473 "></span></a>        <span class=n>shading_algorithm</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=o>.</span><span class=n>shading_algorithm</span><span class=p>,</span>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a><a href=#__codelineno-0-474><span class=linenos data-linenos="474 "></span></a>        <span class=n>shading_states</span><span class=o>=</span><span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a><a href=#__codelineno-0-475><span class=linenos data-linenos="475 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a><a href=#__codelineno-0-476><span class=linenos data-linenos="476 "></span></a>        <span class=c1>## Sources</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a><a href=#__codelineno-0-477><span class=linenos data-linenos="477 "></span></a>        <span class=n>data_source</span><span class=o>=</span><span class=n>HOFIERKA_2002</span><span class=p>,</span>
</span><span id=__span-0-478><a id=__codelineno-0-478 name=__codelineno-0-478></a><a href=#__codelineno-0-478><span class=linenos data-linenos="478 "></span></a>        <span class=n>solar_radiation_model</span><span class=o>=</span><span class=n>HOFIERKA_2002</span><span class=p>,</span>
</span><span id=__span-0-479><a id=__codelineno-0-479 name=__codelineno-0-479></a><a href=#__codelineno-0-479><span class=linenos data-linenos="479 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.shortwave.inclined> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">inclined</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.inclined title="Permanent link"></a></h5> <div class="doc doc-contents"> <p>API module to calculate the global (shortwave) irradiance over a location for a period in time.</p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.inclined.calculate_global_inclined_irradiance_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_global_inclined_irradiance_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.irradiance.shortwave.inclined.calculate_global_inclined_irradiance_hofierka</code>)'>calculate_global_inclined_irradiance_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the global irradiance on an inclined surface [W.m-2]</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.irradiance.shortwave.inclined.calculate_global_inclined_irradiance_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_global_inclined_irradiance_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.irradiance.shortwave.inclined.calculate_global_inclined_irradiance_hofierka title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_global_inclined_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>elevation</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n><span title=pvgisprototype.validation.models.SurfaceOrientationModel>SurfaceOrientationModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><span title=pvgisprototype.validation.models.SurfaceTiltModel>SurfaceTiltModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>=</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>(</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>        <span class=p>[</span><span class=n><span title=pandas.Timestamp.now>now</span></span><span class=p>(</span><span class=n><span title=pandas.Timestamp.now(tz)>tz</span></span><span class=o>=</span><span class=s2>"UTC"</span><span class=p>)]</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=p>),</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>),</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>global_horizontal_irradiance</span><span class=p>:</span> <span class=n><span title=numpy._core.multiarray.ndarray>ndarray</span></span> <span class=o>=</span> <span class=n><span title=numpy.array>array</span></span><span class=p>(</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>        <span class=p>[],</span> <span class=n><span title=numpy.array(dtype)>dtype</span></span><span class=o>=</span><span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=p>),</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>direct_horizontal_irradiance</span><span class=p>:</span> <span class=n><span title=numpy._core.multiarray.ndarray>ndarray</span></span> <span class=o>=</span> <span class=n><span title=numpy.array>array</span></span><span class=p>(</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>        <span class=p>[],</span> <span class=n><span title=numpy.array(dtype)>dtype</span></span><span class=o>=</span><span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=p>),</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>(),</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=n>albedo</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ALBEDO_DEFAULT>ALBEDO_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=n>apply_reflectivity_factor</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ANGULAR_LOSS_FACTOR_FLAG_DEFAULT>ANGULAR_LOSS_FACTOR_FLAG_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=n>solar_azimuth_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarIncidence>SolarIncidence</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>solar_position_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarPositionModel>SolarPositionModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SolarPositionModel.noaa>noaa</span></span><span class=p>,</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n><span title=pydantic_numpy.NpNDArray>NpNDArray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=n>sun_horizon_position</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.List title="<code>typing.List</code>">List</a></span><span class=p>[</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a>        <span class=n><span title=pvgisprototype.api.position.models.SunHorizonPositionModel>SunHorizonPositionModel</span></span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=p>]</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SUN_HORIZON_POSITION_DEFAULT>SUN_HORIZON_POSITION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=n>shading_states</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.List title="<code>typing.List</code>">List</a></span><span class=p>[</span><span class=n><span title=pvgisprototype.api.position.models.ShadingState>ShadingState</span></span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n><span title=pvgisprototype.api.position.models.ShadingState.all>all</span></span><span class=p>],</span>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a>    <span class=n>solar_time_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarTimeModel>SolarTimeModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SolarTimeModel.noaa>noaa</span></span><span class=p>,</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></span><span class=p>,</span>
</span><span id=__span-0-33><a href=#__codelineno-0-33 id=__codelineno-0-33 name=__codelineno-0-33></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-34><a href=#__codelineno-0-34 id=__codelineno-0-34 name=__codelineno-0-34></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-35><a href=#__codelineno-0-35 id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-36><a href=#__codelineno-0-36 id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-37><a href=#__codelineno-0-37 id=__codelineno-0-37 name=__codelineno-0-37></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-38><a href=#__codelineno-0-38 id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-39><a href=#__codelineno-0-39 id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-40><a href=#__codelineno-0-40 id=__codelineno-0-40 name=__codelineno-0-40></a>    <span class=n>fingerprint</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.FINGERPRINT_FLAG_DEFAULT>FINGERPRINT_FLAG_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-41><a href=#__codelineno-0-41 id=__codelineno-0-41 name=__codelineno-0-41></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the global irradiance on an inclined surface [W.m-2]</p> <p>Calculate the global irradiance on an inclined surface as the sum of the direct, the diffuse and the ground-reflected radiation components. The radiation, selectively attenuated by the atmosphere, which is not reflected or scattered and reaches the surface directly is the direct radiation. The scattered radiation that reaches the ground is the diffuse radiation. In addition, a smaller part of radiation is reflected from the ground onto the inclined surface. Only small percents of reflected radiation contribute to inclined surfaces, thus it is sometimes ignored. PVGIS, however, inherits the solutions adopted in the r.sun solar radiation model in which both the diffuse and reflected radiation components are considered.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/irradiance/shortwave/inclined.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_global_inclined_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>    <span class=n>elevation</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n>SurfaceOrientationModel</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n>SurfaceTiltModel</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>=</span> <span class=n>DatetimeIndex</span><span class=p>([</span><span class=n>Timestamp</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>tz</span><span class=o>=</span><span class=s1>'UTC'</span><span class=p>)]),</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>ZoneInfo</span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>),</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=n>global_horizontal_irradiance</span><span class=p>:</span> <span class=n>ndarray</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>array</span><span class=p>([],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>DATA_TYPE_DEFAULT</span><span class=p>),</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=n>direct_horizontal_irradiance</span><span class=p>:</span> <span class=n>ndarray</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>array</span><span class=p>([],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>DATA_TYPE_DEFAULT</span><span class=p>),</span> 
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(),</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=c1># unrefracted_solar_zenith: UnrefractedSolarZenith | None = UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT,  # radians</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=n>albedo</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>ALBEDO_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=n>apply_reflectivity_factor</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>ANGULAR_LOSS_FACTOR_FLAG_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n>SolarAltitude</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>    <span class=n>solar_azimuth_series</span><span class=p>:</span> <span class=n>SolarAzimuth</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n>SolarIncidence</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>solar_position_model</span><span class=p>:</span> <span class=n>SolarPositionModel</span> <span class=o>=</span> <span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n>NpNDArray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>sun_horizon_position</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>SunHorizonPositionModel</span><span class=p>]</span> <span class=o>=</span> <span class=n>SUN_HORIZON_POSITION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>    <span class=n>shading_states</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ShadingState</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>ShadingState</span><span class=o>.</span><span class=n>all</span><span class=p>],</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=n>solar_time_model</span><span class=p>:</span> <span class=n>SolarTimeModel</span> <span class=o>=</span> <span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SOLAR_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=n>validate_output</span><span class=p>:</span><span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>    <span class=n>fingerprint</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>FINGERPRINT_FLAG_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=p>):</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=w>    </span><span class=sd>"""Calculate the global irradiance on an inclined surface [W.m-2]</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>    Calculate the global irradiance on an inclined surface as the sum of the</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    direct, the diffuse and the ground-reflected radiation components.</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>    The radiation, selectively attenuated by the atmosphere, which is not</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>    reflected or scattered and reaches the surface directly is the direct</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>    radiation. The scattered radiation that reaches the ground is the</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>    diffuse radiation. In addition, a smaller part of radiation is reflected</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>    from the ground onto the inclined surface. Only small percents of reflected</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>    radiation contribute to inclined surfaces, thus it is sometimes ignored.</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>    PVGIS, however, inherits the solutions adopted in the r.sun solar radiation</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>    model in which both the diffuse and reflected radiation components are</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>    considered.</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>    <span class=c1># In order to avoid unbound errors we pre-define `_series` objects</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=n>array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=s2>"shape"</span><span class=p>:</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=s2>"init_method"</span><span class=p>:</span> <span class=s2>"zeros"</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=p>}</span>  <span class=c1># Borrow shape from timestamps</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>    <span class=n>zero_array</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>array_parameters</span><span class=p>)</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=n>extended_array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=s2>"shape"</span><span class=p>:</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>        <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=n>unset_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>extended_array_parameters</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"unset"</span><span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=c1># # direct</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>    <span class=c1># # ----------------------------------------------- Important !</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=c1># if direct_horizontal_irradiance is None:</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>    <span class=c1>#     direct_horizontal_irradiance = zero_array</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>    <span class=c1># # Important ! -----------------------------------------------</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=n>direct_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>DirectInclinedIrradiance</span><span class=p>(</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>zero_array</span><span class=p>,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=n>solar_incidence</span><span class=o>=</span><span class=n>SolarIncidence</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=n>unset_series</span><span class=p>),</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>    <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span> <span class=o>=</span> <span class=n>zero_array</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>    <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span> <span class=o>=</span> <span class=n>zero_array</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>    <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflectivity_factor</span> <span class=o>=</span> <span class=n>zero_array</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>    <span class=n>direct_normal_irradiance</span> <span class=o>=</span> <span class=n>DirectNormalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>zero_array</span><span class=p>,</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=c1># extraterrestrial_normal_irradiance=extraterrestrial_normal_irradiance,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>    <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>direct_horizontal_irradiance</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=n>DirectHorizontalIrradianceFromExternalData</span><span class=p>(</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>            <span class=n>value</span><span class=o>=</span><span class=n>direct_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>            <span class=n>direct_normal_irradiance</span><span class=o>=</span><span class=n>direct_normal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>    <span class=c1># direct_inclined_irradiance_series.solar_incidence_model = solar_incidence_model</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>    <span class=c1># # direct_inclined_irradiance_series.solar_incidence.definition = </span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>    <span class=n>no_earth_orbit</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=s1>'eccentricity_phase_offset'</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=s1>'eccentricity_amplitude'</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=c1># extraterrestrial normal to be fed indirectly to diffuse_inclined_irradiance</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>    <span class=n>extraterrestrial_normal_irradiance_series</span> <span class=o>=</span> <span class=n>ExtraterrestrialNormalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>NOT_AVAILABLE</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>        <span class=n>day_angle</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>        <span class=n>solar_constant</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=o>**</span><span class=n>no_earth_orbit</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=n>distance_correction_factor</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>    <span class=n>extraterrestrial_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>ExtraterrestrialHorizontalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>NOT_AVAILABLE</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>        <span class=n>day_angle</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>        <span class=n>solar_constant</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>        <span class=o>**</span><span class=n>no_earth_orbit</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>        <span class=n>distance_correction_factor</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=c1># diffuse sky-reflected</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>    <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>DiffuseSkyReflectedInclinedIrradiance</span><span class=p>(</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>zero_array</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=n>extraterrestrial_normal_irradiance</span><span class=o>=</span><span class=n>extraterrestrial_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>        <span class=n>extraterrestrial_horizontal_irradiance</span><span class=o>=</span><span class=n>extraterrestrial_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=n>solar_azimuth</span><span class=o>=</span><span class=n>SolarAzimuth</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=n>unset_series</span><span class=p>),</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=c1># direct_horizontal_irradiance=direct_horizontal_irradiance,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>    <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span> <span class=o>=</span> <span class=n>zero_array</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>    <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span> <span class=o>=</span> <span class=n>zero_array</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>    <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflectivity_factor</span> <span class=o>=</span> <span class=n>zero_array</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>    <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>diffuse_horizontal_irradiance</span> <span class=o>=</span> <span class=n>DiffuseSkyReflectedHorizontalIrradianceFromExternalData</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=n>zero_array</span><span class=p>)</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>    <span class=c1># diffuse ground-reflected</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>    <span class=c1># note : there is no ground-reflected _horizontal_ component as such !</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>    <span class=n>ground_reflected_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>DiffuseGroundReflectedInclinedIrradiance</span><span class=p>(</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>zero_array</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>    <span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span> <span class=o>=</span> <span class=n>zero_array</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>    <span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span> <span class=o>=</span> <span class=n>zero_array</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>    <span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflectivity_factor</span> <span class=o>=</span> <span class=n>zero_array</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>    <span class=n>global_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>zero_array</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>    <span class=c1># Select which solar positions related to the horizon to process</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>    <span class=n>sun_horizon_positions</span> <span class=o>=</span> <span class=n>select_models</span><span class=p>(</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>        <span class=n>SunHorizonPositionModel</span><span class=p>,</span> <span class=n>sun_horizon_position</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>    <span class=p>)</span>  <span class=c1># Using a Typer callback fails !</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>    <span class=c1># and keep track of the position of the sun relative to the horizon</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>    <span class=n>sun_horizon_position_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>        <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s2>"object"</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"empty"</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>    <span class=c1># Following, create masks based on the solar altitude series --------</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>    <span class=c1># For sun below the horizon</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>    <span class=k>if</span> <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>below</span> <span class=ow>in</span> <span class=n>sun_horizon_positions</span><span class=p>:</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>        <span class=n>mask_below_horizon</span> <span class=o>=</span> <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&lt;</span> <span class=mi>0</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>        <span class=n>sun_horizon_position_series</span><span class=p>[</span><span class=n>mask_below_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>below</span><span class=o>.</span><span class=n>value</span><span class=p>]</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>        <span class=k>if</span> <span class=n>numpy</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mask_below_horizon</span><span class=p>):</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>                <span class=sa>f</span><span class=s2>"Positions of the sun below horizon :</span><span class=se>\n</span><span class=si>{</span><span class=n>sun_horizon_position_series</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Positions of the sun [bold gray50]below horizon[/bold gray50] :</span><span class=se>\n</span><span class=si>{</span><span class=n>sun_horizon_position_series</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>            <span class=c1># no incident radiance without direct sunlight !</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>            <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_below_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>            <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_below_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>            <span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_below_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>    <span class=c1># For very low sun angles</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>    <span class=k>if</span> <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>low_angle</span> <span class=ow>in</span> <span class=n>sun_horizon_positions</span><span class=p>:</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>        <span class=n>mask_low_angle</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>logical_and</span><span class=p>(</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>            <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>            <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&lt;</span> <span class=mf>0.04</span><span class=p>,</span>  <span class=c1># FIXME: Is 0.04 in radians or degrees ?</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>            <span class=n>sun_horizon_position_series</span> <span class=o>==</span> <span class=kc>None</span><span class=p>,</span>  <span class=c1># operate only on unset elements</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>        <span class=n>sun_horizon_position_series</span><span class=p>[</span><span class=n>mask_low_angle</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>            <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>low_angle</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>        <span class=p>]</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>        <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_low_angle</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>            <span class=mi>0</span>  <span class=c1># Direct radiation is negligible</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>    <span class=c1># For sun above the horizon</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>    <span class=k>if</span> <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>above</span> <span class=ow>in</span> <span class=n>sun_horizon_positions</span><span class=p>:</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>        <span class=n>mask_above_horizon</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>logical_and</span><span class=p>(</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>            <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>            <span class=n>sun_horizon_position_series</span> <span class=o>==</span> <span class=kc>None</span><span class=p>,</span>  <span class=c1># operate only on unset elements</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>        <span class=n>sun_horizon_position_series</span><span class=p>[</span><span class=n>mask_above_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>            <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>above</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>        <span class=p>]</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>        <span class=c1># For sun above horizon and not in shade</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>        <span class=n>mask_not_in_shade</span> <span class=o>=</span> <span class=o>~</span><span class=n>surface_in_shade_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>        <span class=n>mask_above_horizon_not_in_shade</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>logical_and</span><span class=p>(</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>            <span class=n>mask_above_horizon</span><span class=p>,</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>            <span class=n>mask_not_in_shade</span><span class=p>,</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>            <span class=n>sun_horizon_position_series</span> <span class=o>==</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>        <span class=k>if</span> <span class=n>numpy</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mask_above_horizon_not_in_shade</span><span class=p>):</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>            <span class=c1># sun_horizon_position_series[mask_above_horizon_not_in_shade] = [SunHorizonPositionModel.above.name]</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>                <span class=sa>f</span><span class=s2>"Including positions of the sun above horizon and not in shade :</span><span class=se>\n</span><span class=si>{</span><span class=n>sun_horizon_position_series</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Including positions of the sun [bold yellow]above horizon[/bold yellow] and [bold red]not in shade[/bold red] :</span><span class=se>\n</span><span class=si>{</span><span class=n>sun_horizon_position_series</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>            <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>                <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>                    <span class=s2>"i Calculating the direct inclined irradiance for moments not in shade .."</span><span class=p>,</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>                    <span class=n>alt</span><span class=o>=</span><span class=s2>"i [bold]Calculating[/bold] the [magenta]direct inclined irradiance[/magenta] for moments not in shade .."</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>            <span class=c1># if not read from external time series,</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a>            <span class=c1># will calculate the clear-sky index !</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a>            <span class=n>direct_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_direct_inclined_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a>                <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>                <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a>                <span class=n>direct_horizontal_irradiance</span><span class=o>=</span><span class=n>direct_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>                <span class=n>apply_reflectivity_factor</span><span class=o>=</span><span class=n>apply_reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a>                <span class=n>solar_incidence_series</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>                <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a>                <span class=c1># solar_azimuth_series=solar_azimuth_series,</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a>                <span class=n>surface_in_shade_series</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a>                <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>                <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>                <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>                <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>            <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>build_output</span><span class=p>(</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span> <span class=n>fingerprint</span><span class=o>=</span><span class=n>fingerprint</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>        <span class=c1># Calculate diffuse and reflected irradiance for sun above horizon</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>numpy</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mask_above_horizon</span><span class=p>):</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a>                <span class=s2>"i [yellow bold]Apparently there is no moment of the sun above the horizon in the requested time series![/yellow bold] "</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>            <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a>                <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a>                    <span class=s2>"i [bold]Calculating[/bold] the [magenta]diffuse inclined irradiance[/magenta] for daylight moments .."</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>            <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><a href=#__codelineno-0-328><span class=linenos data-linenos="328 "></span></a>                <span class=n>calculate_diffuse_inclined_irradiance_muneer</span><span class=p>(</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a>                    <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a>                    <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a>                    <span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=o>=</span><span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>,</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a>                    <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a>                    <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a>                    <span class=n>global_horizontal_irradiance_series</span><span class=o>=</span><span class=n>global_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a>                    <span class=n>direct_horizontal_irradiance_series</span><span class=o>=</span><span class=n>direct_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a>                    <span class=n>apply_reflectivity_factor</span><span class=o>=</span><span class=n>apply_reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a>                    <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><a href=#__codelineno-0-338><span class=linenos data-linenos="338 "></span></a>                    <span class=n>solar_azimuth_series</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><a href=#__codelineno-0-339><span class=linenos data-linenos="339 "></span></a>                    <span class=n>solar_incidence_series</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><a href=#__codelineno-0-340><span class=linenos data-linenos="340 "></span></a>                    <span class=n>surface_in_shade_series</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><a href=#__codelineno-0-341><span class=linenos data-linenos="341 "></span></a>                    <span class=n>shading_states</span><span class=o>=</span><span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><a href=#__codelineno-0-342><span class=linenos data-linenos="342 "></span></a>                    <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><a href=#__codelineno-0-343><span class=linenos data-linenos="343 "></span></a>                    <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><a href=#__codelineno-0-344><span class=linenos data-linenos="344 "></span></a>                    <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><a href=#__codelineno-0-345><span class=linenos data-linenos="345 "></span></a>                    <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><a href=#__codelineno-0-346><span class=linenos data-linenos="346 "></span></a>                    <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><a href=#__codelineno-0-347><span class=linenos data-linenos="347 "></span></a>                    <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><a href=#__codelineno-0-348><span class=linenos data-linenos="348 "></span></a>                    <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><a href=#__codelineno-0-349><span class=linenos data-linenos="349 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><a href=#__codelineno-0-350><span class=linenos data-linenos="350 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><a href=#__codelineno-0-351><span class=linenos data-linenos="351 "></span></a>            <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><a href=#__codelineno-0-352><span class=linenos data-linenos="352 "></span></a>                <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><a href=#__codelineno-0-353><span class=linenos data-linenos="353 "></span></a>                    <span class=s2>"i [bold]Calculating[/bold] the [magenta]reflected inclined irradiance[/magenta] for daylight moments .."</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><a href=#__codelineno-0-354><span class=linenos data-linenos="354 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><a href=#__codelineno-0-355><span class=linenos data-linenos="355 "></span></a>            <span class=n>ground_reflected_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_ground_reflected_inclined_irradiance_series</span><span class=p>(</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><a href=#__codelineno-0-356><span class=linenos data-linenos="356 "></span></a>                <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><a href=#__codelineno-0-357><span class=linenos data-linenos="357 "></span></a>                <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><a href=#__codelineno-0-358><span class=linenos data-linenos="358 "></span></a>                <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><a href=#__codelineno-0-359><span class=linenos data-linenos="359 "></span></a>                <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><a href=#__codelineno-0-360><span class=linenos data-linenos="360 "></span></a>                <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><a href=#__codelineno-0-361><span class=linenos data-linenos="361 "></span></a>                <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><a href=#__codelineno-0-362><span class=linenos data-linenos="362 "></span></a>                <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><a href=#__codelineno-0-363><span class=linenos data-linenos="363 "></span></a>                <span class=n>global_horizontal_irradiance</span><span class=o>=</span><span class=n>global_horizontal_irradiance</span><span class=p>,</span>  <span class=c1># time series, optional</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a><a href=#__codelineno-0-364><span class=linenos data-linenos="364 "></span></a>                <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><a href=#__codelineno-0-365><span class=linenos data-linenos="365 "></span></a>                <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><a href=#__codelineno-0-366><span class=linenos data-linenos="366 "></span></a>                <span class=c1># unrefracted_solar_zenith=unrefracted_solar_zenith,</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><a href=#__codelineno-0-367><span class=linenos data-linenos="367 "></span></a>                <span class=n>albedo</span><span class=o>=</span><span class=n>albedo</span><span class=p>,</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><a href=#__codelineno-0-368><span class=linenos data-linenos="368 "></span></a>                <span class=n>apply_reflectivity_factor</span><span class=o>=</span><span class=n>apply_reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><a href=#__codelineno-0-369><span class=linenos data-linenos="369 "></span></a>                <span class=n>solar_position_model</span><span class=o>=</span><span class=n>solar_position_model</span><span class=p>,</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><a href=#__codelineno-0-370><span class=linenos data-linenos="370 "></span></a>                <span class=n>solar_time_model</span><span class=o>=</span><span class=n>solar_time_model</span><span class=p>,</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><a href=#__codelineno-0-371><span class=linenos data-linenos="371 "></span></a>                <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><a href=#__codelineno-0-372><span class=linenos data-linenos="372 "></span></a>                <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><a href=#__codelineno-0-373><span class=linenos data-linenos="373 "></span></a>                <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><a href=#__codelineno-0-374><span class=linenos data-linenos="374 "></span></a>                <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><a href=#__codelineno-0-375><span class=linenos data-linenos="375 "></span></a>                <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><a href=#__codelineno-0-376><span class=linenos data-linenos="376 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><a href=#__codelineno-0-377><span class=linenos data-linenos="377 "></span></a>                <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><a href=#__codelineno-0-378><span class=linenos data-linenos="378 "></span></a>                <span class=n>fingerprint</span><span class=o>=</span><span class=n>fingerprint</span><span class=p>,</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><a href=#__codelineno-0-379><span class=linenos data-linenos="379 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><a href=#__codelineno-0-380><span class=linenos data-linenos="380 "></span></a>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><a href=#__codelineno-0-381><span class=linenos data-linenos="381 "></span></a>    <span class=c1># sum components</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><a href=#__codelineno-0-382><span class=linenos data-linenos="382 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><a href=#__codelineno-0-383><span class=linenos data-linenos="383 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><a href=#__codelineno-0-384><span class=linenos data-linenos="384 "></span></a>            <span class=s2>"</span><span class=se>\n</span><span class=s2>i [bold]Calculating[/bold] the [magenta]global inclined irradiance[/magenta] .."</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><a href=#__codelineno-0-385><span class=linenos data-linenos="385 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><a href=#__codelineno-0-386><span class=linenos data-linenos="386 "></span></a>    <span class=n>global_inclined_irradiance_series</span><span class=p>[</span><span class=n>mask_above_horizon_not_in_shade</span><span class=p>]</span> <span class=o>+=</span> <span class=p>(</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><a href=#__codelineno-0-387><span class=linenos data-linenos="387 "></span></a>        <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_above_horizon_not_in_shade</span><span class=p>]</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a><a href=#__codelineno-0-388><span class=linenos data-linenos="388 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a><a href=#__codelineno-0-389><span class=linenos data-linenos="389 "></span></a>    <span class=n>global_inclined_irradiance_series</span><span class=p>[</span><span class=n>mask_above_horizon</span><span class=p>]</span> <span class=o>+=</span> <span class=p>(</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a><a href=#__codelineno-0-390><span class=linenos data-linenos="390 "></span></a>        <span class=o>+</span> <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_above_horizon</span><span class=p>]</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><a href=#__codelineno-0-391><span class=linenos data-linenos="391 "></span></a>        <span class=o>+</span> <span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_above_horizon</span><span class=p>]</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a><a href=#__codelineno-0-392><span class=linenos data-linenos="392 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><a href=#__codelineno-0-393><span class=linenos data-linenos="393 "></span></a>    <span class=n>global_inclined_reflected_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a><a href=#__codelineno-0-394><span class=linenos data-linenos="394 "></span></a>        <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><a href=#__codelineno-0-395><span class=linenos data-linenos="395 "></span></a>        <span class=o>+</span> <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><a href=#__codelineno-0-396><span class=linenos data-linenos="396 "></span></a>        <span class=o>+</span> <span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><a href=#__codelineno-0-397><span class=linenos data-linenos="397 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><a href=#__codelineno-0-398><span class=linenos data-linenos="398 "></span></a>    <span class=n>global_inclined_irradiance_before_reflectivity_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><a href=#__codelineno-0-399><span class=linenos data-linenos="399 "></span></a>        <span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><a href=#__codelineno-0-400><span class=linenos data-linenos="400 "></span></a>        <span class=o>+</span> <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><a href=#__codelineno-0-401><span class=linenos data-linenos="401 "></span></a>        <span class=o>+</span> <span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><a href=#__codelineno-0-402><span class=linenos data-linenos="402 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><a href=#__codelineno-0-403><span class=linenos data-linenos="403 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><a href=#__codelineno-0-404><span class=linenos data-linenos="404 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>global_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><a href=#__codelineno-0-405><span class=linenos data-linenos="405 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><a href=#__codelineno-0-406><span class=linenos data-linenos="406 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>GlobalInclinedIrradianceFromExternalData</span><span class=p>(),</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><a href=#__codelineno-0-407><span class=linenos data-linenos="407 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><a href=#__codelineno-0-408><span class=linenos data-linenos="408 "></span></a>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a><a href=#__codelineno-0-409><span class=linenos data-linenos="409 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><a href=#__codelineno-0-410><span class=linenos data-linenos="410 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><a href=#__codelineno-0-411><span class=linenos data-linenos="411 "></span></a>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><a href=#__codelineno-0-412><span class=linenos data-linenos="412 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a><a href=#__codelineno-0-413><span class=linenos data-linenos="413 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>global_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a><a href=#__codelineno-0-414><span class=linenos data-linenos="414 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a><a href=#__codelineno-0-415><span class=linenos data-linenos="415 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a><a href=#__codelineno-0-416><span class=linenos data-linenos="416 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a><a href=#__codelineno-0-417><span class=linenos data-linenos="417 "></span></a>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a><a href=#__codelineno-0-418><span class=linenos data-linenos="418 "></span></a>    <span class=c1># We need to build this for the returned data model !</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a><a href=#__codelineno-0-419><span class=linenos data-linenos="419 "></span></a>    <span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>build_output</span><span class=p>(</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a><a href=#__codelineno-0-420><span class=linenos data-linenos="420 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span> <span class=n>fingerprint</span><span class=o>=</span><span class=n>fingerprint</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a><a href=#__codelineno-0-421><span class=linenos data-linenos="421 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a><a href=#__codelineno-0-422><span class=linenos data-linenos="422 "></span></a>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a><a href=#__codelineno-0-423><span class=linenos data-linenos="423 "></span></a>    <span class=k>return</span> <span class=n>GlobalInclinedIrradianceFromExternalData</span><span class=p>(</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a><a href=#__codelineno-0-424><span class=linenos data-linenos="424 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>global_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><a href=#__codelineno-0-425><span class=linenos data-linenos="425 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><a href=#__codelineno-0-426><span class=linenos data-linenos="426 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a><a href=#__codelineno-0-427><span class=linenos data-linenos="427 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a><a href=#__codelineno-0-428><span class=linenos data-linenos="428 "></span></a>        <span class=c1>## Inclined Irradiance Components</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a><a href=#__codelineno-0-429><span class=linenos data-linenos="429 "></span></a>        <span class=n>direct_inclined_irradiance</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a><a href=#__codelineno-0-430><span class=linenos data-linenos="430 "></span></a>        <span class=n>diffuse_inclined_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a><a href=#__codelineno-0-431><span class=linenos data-linenos="431 "></span></a>        <span class=n>ground_reflected_inclined_irradiance</span><span class=o>=</span><span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a><a href=#__codelineno-0-432><span class=linenos data-linenos="432 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a><a href=#__codelineno-0-433><span class=linenos data-linenos="433 "></span></a>        <span class=c1>## Loss due to Reflectivity</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><a href=#__codelineno-0-434><span class=linenos data-linenos="434 "></span></a>        <span class=n>reflected</span><span class=o>=</span><span class=n>global_inclined_reflected_series</span><span class=p>,</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a><a href=#__codelineno-0-435><span class=linenos data-linenos="435 "></span></a>        <span class=n>direct_inclined_reflected</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span><span class=p>,</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a><a href=#__codelineno-0-436><span class=linenos data-linenos="436 "></span></a>        <span class=n>diffuse_inclined_reflected</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span><span class=p>,</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a><a href=#__codelineno-0-437><span class=linenos data-linenos="437 "></span></a>        <span class=n>ground_reflected_inclined_reflected</span><span class=o>=</span><span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflected</span><span class=p>,</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a><a href=#__codelineno-0-438><span class=linenos data-linenos="438 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a><a href=#__codelineno-0-439><span class=linenos data-linenos="439 "></span></a>        <span class=c1>## Reflectivity Factor for Irradiance Components</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a><a href=#__codelineno-0-440><span class=linenos data-linenos="440 "></span></a>        <span class=n>direct_inclined_reflectivity_factor</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a><a href=#__codelineno-0-441><span class=linenos data-linenos="441 "></span></a>        <span class=n>diffuse_inclined_reflectivity_factor</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a><a href=#__codelineno-0-442><span class=linenos data-linenos="442 "></span></a>        <span class=n>ground_reflected_inclined_reflectivity_factor</span><span class=o>=</span><span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a><a href=#__codelineno-0-443><span class=linenos data-linenos="443 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a><a href=#__codelineno-0-444><span class=linenos data-linenos="444 "></span></a>        <span class=c1>## Reflectivity Coefficient which defines the Reflectivity Factor for Irradiance Components</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a><a href=#__codelineno-0-445><span class=linenos data-linenos="445 "></span></a>        <span class=c1># direct_inclined_reflectivity_coefficient=direct_inclined_reflectivity_coefficient_series,</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a><a href=#__codelineno-0-446><span class=linenos data-linenos="446 "></span></a>        <span class=n>diffuse_inclined_reflectivity_coefficient</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>reflectivity_coefficient</span><span class=p>,</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a><a href=#__codelineno-0-447><span class=linenos data-linenos="447 "></span></a>        <span class=c1># ground_reflected_inclined_reflectivity_coefficient=ground_reflected_inclined_reflectivity_coefficient_series,</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a><a href=#__codelineno-0-448><span class=linenos data-linenos="448 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a><a href=#__codelineno-0-449><span class=linenos data-linenos="449 "></span></a>        <span class=c1>## Inclined Irradiance before loss due to Reflectivity</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a><a href=#__codelineno-0-450><span class=linenos data-linenos="450 "></span></a>        <span class=n>value_before_reflectivity</span><span class=o>=</span><span class=n>global_inclined_irradiance_before_reflectivity_series</span><span class=p>,</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a><a href=#__codelineno-0-451><span class=linenos data-linenos="451 "></span></a>        <span class=n>direct_inclined_before_reflectivity</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span><span class=p>,</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a><a href=#__codelineno-0-452><span class=linenos data-linenos="452 "></span></a>        <span class=n>diffuse_inclined_before_reflectivity</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span><span class=p>,</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a><a href=#__codelineno-0-453><span class=linenos data-linenos="453 "></span></a>        <span class=n>ground_reflected_inclined_before_reflectivity</span><span class=o>=</span><span class=n>ground_reflected_inclined_irradiance_series</span><span class=o>.</span><span class=n>value_before_reflectivity</span><span class=p>,</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a><a href=#__codelineno-0-454><span class=linenos data-linenos="454 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a><a href=#__codelineno-0-455><span class=linenos data-linenos="455 "></span></a>        <span class=c1>## Horizontal Irradiance Components</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a><a href=#__codelineno-0-456><span class=linenos data-linenos="456 "></span></a>        <span class=n>global_horizontal_irradiance</span><span class=o>=</span><span class=n>global_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a><a href=#__codelineno-0-457><span class=linenos data-linenos="457 "></span></a>        <span class=n>direct_horizontal_irradiance</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>direct_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a><a href=#__codelineno-0-458><span class=linenos data-linenos="458 "></span></a>        <span class=n>diffuse_horizontal_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>diffuse_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><a href=#__codelineno-0-459><span class=linenos data-linenos="459 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><a href=#__codelineno-0-460><span class=linenos data-linenos="460 "></span></a>        <span class=c1>## Components of the diffuse sky-reflected irradiance</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><a href=#__codelineno-0-461><span class=linenos data-linenos="461 "></span></a>        <span class=n>diffuse_sky_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>diffuse_sky_irradiance</span><span class=p>,</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><a href=#__codelineno-0-462><span class=linenos data-linenos="462 "></span></a>        <span class=n>term_n</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>term_n</span><span class=p>,</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a><a href=#__codelineno-0-463><span class=linenos data-linenos="463 "></span></a>        <span class=n>kb_ratio</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>kb_ratio</span><span class=p>,</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a><a href=#__codelineno-0-464><span class=linenos data-linenos="464 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a><a href=#__codelineno-0-465><span class=linenos data-linenos="465 "></span></a>        <span class=c1>## Components of the Extraterrestrial irradiance</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a><a href=#__codelineno-0-466><span class=linenos data-linenos="466 "></span></a>        <span class=n>extraterrestrial_horizontal_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>extraterrestrial_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a><a href=#__codelineno-0-467><span class=linenos data-linenos="467 "></span></a>        <span class=n>extraterrestrial_normal_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>extraterrestrial_normal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a><a href=#__codelineno-0-468><span class=linenos data-linenos="468 "></span></a>        <span class=n>linke_turbidity_factor</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a><a href=#__codelineno-0-469><span class=linenos data-linenos="469 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a><a href=#__codelineno-0-470><span class=linenos data-linenos="470 "></span></a>        <span class=c1>## Location and Position</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a><a href=#__codelineno-0-471><span class=linenos data-linenos="471 "></span></a>        <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a><a href=#__codelineno-0-472><span class=linenos data-linenos="472 "></span></a>        <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a><a href=#__codelineno-0-473><span class=linenos data-linenos="473 "></span></a>        <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a><a href=#__codelineno-0-474><span class=linenos data-linenos="474 "></span></a>        <span class=n>sun_horizon_positions</span><span class=o>=</span><span class=n>sun_horizon_positions</span><span class=p>,</span>  <span class=c1># states != sun_horizon_position</span>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a><a href=#__codelineno-0-475><span class=linenos data-linenos="475 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a><a href=#__codelineno-0-476><span class=linenos data-linenos="476 "></span></a>        <span class=c1>## Solar Position parameters</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a><a href=#__codelineno-0-477><span class=linenos data-linenos="477 "></span></a>        <span class=n>surface_in_shade</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-478><a id=__codelineno-0-478 name=__codelineno-0-478></a><a href=#__codelineno-0-478><span class=linenos data-linenos="478 "></span></a>        <span class=n>solar_incidence</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>solar_incidence</span><span class=p>,</span>
</span><span id=__span-0-479><a id=__codelineno-0-479 name=__codelineno-0-479></a><a href=#__codelineno-0-479><span class=linenos data-linenos="479 "></span></a>        <span class=n>shading_state</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>shading_state</span><span class=p>,</span>
</span><span id=__span-0-480><a id=__codelineno-0-480 name=__codelineno-0-480></a><a href=#__codelineno-0-480><span class=linenos data-linenos="480 "></span></a>        <span class=n>sun_horizon_position</span><span class=o>=</span><span class=n>sun_horizon_position_series</span><span class=p>,</span>  <span class=c1># positions != sun_horizon_positions</span>
</span><span id=__span-0-481><a id=__codelineno-0-481 name=__codelineno-0-481></a><a href=#__codelineno-0-481><span class=linenos data-linenos="481 "></span></a>        <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-482><a id=__codelineno-0-482 name=__codelineno-0-482></a><a href=#__codelineno-0-482><span class=linenos data-linenos="482 "></span></a>        <span class=n>refracted_solar_altitude</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>refracted_solar_altitude</span><span class=p>,</span>
</span><span id=__span-0-483><a id=__codelineno-0-483 name=__codelineno-0-483></a><a href=#__codelineno-0-483><span class=linenos data-linenos="483 "></span></a>        <span class=n>solar_azimuth</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=o>.</span><span class=n>solar_azimuth</span><span class=p>,</span>
</span><span id=__span-0-484><a id=__codelineno-0-484 name=__codelineno-0-484></a><a href=#__codelineno-0-484><span class=linenos data-linenos="484 "></span></a>        <span class=c1># azimuth_difference=azimuth_difference_series,</span>
</span><span id=__span-0-485><a id=__codelineno-0-485 name=__codelineno-0-485></a><a href=#__codelineno-0-485><span class=linenos data-linenos="485 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-486><a id=__codelineno-0-486 name=__codelineno-0-486></a><a href=#__codelineno-0-486><span class=linenos data-linenos="486 "></span></a>        <span class=c1>## Positioning, Timing and Atmospheric algorithms</span>
</span><span id=__span-0-487><a id=__codelineno-0-487 name=__codelineno-0-487></a><a href=#__codelineno-0-487><span class=linenos data-linenos="487 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-488><a id=__codelineno-0-488 name=__codelineno-0-488></a><a href=#__codelineno-0-488><span class=linenos data-linenos="488 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-489><a id=__codelineno-0-489 name=__codelineno-0-489></a><a href=#__codelineno-0-489><span class=linenos data-linenos="489 "></span></a>        <span class=n>adjusted_for_atmospheric_refraction</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>adjusted_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-490><a id=__codelineno-0-490 name=__codelineno-0-490></a><a href=#__codelineno-0-490><span class=linenos data-linenos="490 "></span></a>        <span class=n>solar_incidence_model</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>solar_incidence_model</span><span class=p>,</span>
</span><span id=__span-0-491><a id=__codelineno-0-491 name=__codelineno-0-491></a><a href=#__codelineno-0-491><span class=linenos data-linenos="491 "></span></a>        <span class=n>solar_incidence_definition</span><span class=o>=</span><span class=n>direct_inclined_irradiance_series</span><span class=o>.</span><span class=n>solar_incidence</span><span class=o>.</span><span class=n>definition</span><span class=p>,</span>
</span><span id=__span-0-492><a id=__codelineno-0-492 name=__codelineno-0-492></a><a href=#__codelineno-0-492><span class=linenos data-linenos="492 "></span></a>        <span class=n>shading_algorithm</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=o>.</span><span class=n>shading_algorithm</span><span class=p>,</span>
</span><span id=__span-0-493><a id=__codelineno-0-493 name=__codelineno-0-493></a><a href=#__codelineno-0-493><span class=linenos data-linenos="493 "></span></a>        <span class=n>shading_states</span><span class=o>=</span><span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-494><a id=__codelineno-0-494 name=__codelineno-0-494></a><a href=#__codelineno-0-494><span class=linenos data-linenos="494 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-495><a id=__codelineno-0-495 name=__codelineno-0-495></a><a href=#__codelineno-0-495><span class=linenos data-linenos="495 "></span></a>        <span class=c1>## Sources</span>
</span><span id=__span-0-496><a id=__codelineno-0-496 name=__codelineno-0-496></a><a href=#__codelineno-0-496><span class=linenos data-linenos="496 "></span></a>        <span class=n>data_source</span><span class=o>=</span><span class=n>HOFIERKA_2002</span><span class=p>,</span>
</span><span id=__span-0-497><a id=__codelineno-0-497 name=__codelineno-0-497></a><a href=#__codelineno-0-497><span class=linenos data-linenos="497 "></span></a>        <span class=n>solar_radiation_model</span><span class=o>=</span><span class=n>HOFIERKA_2002</span><span class=p>,</span>
</span><span id=__span-0-498><a id=__codelineno-0-498 name=__codelineno-0-498></a><a href=#__codelineno-0-498><span class=linenos data-linenos="498 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">position</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.event_hour_angle title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">event_hour_angle</span> (<code>pvgisprototype.algorithms.hofierka.position.event_hour_angle</code>)'>event_hour_angle</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.fractional_year title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">fractional_year</span> (<code>pvgisprototype.algorithms.hofierka.position.fractional_year</code>)'>fractional_year</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.shading title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">shading</span> (<code>pvgisprototype.algorithms.hofierka.position.shading</code>)'>shading</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.solar_altitude title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_altitude</span> (<code>pvgisprototype.algorithms.hofierka.position.solar_altitude</code>)'>solar_altitude</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.solar_azimuth title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_azimuth</span> (<code>pvgisprototype.algorithms.hofierka.position.solar_azimuth</code>)'>solar_azimuth</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.solar_declination title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_declination</span> (<code>pvgisprototype.algorithms.hofierka.position.solar_declination</code>)'>solar_declination</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.solar_hour_angle title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_hour_angle</span> (<code>pvgisprototype.algorithms.hofierka.position.solar_hour_angle</code>)'>solar_hour_angle</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.solar_incidence title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_incidence</span> (<code>pvgisprototype.algorithms.hofierka.position.solar_incidence</code>)'>solar_incidence</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.event_hour_angle> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">event_hour_angle</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.event_hour_angle title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.event_hour_angle.calculate_event_hour_angle_pvis title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_event_hour_angle_pvis</span> (<code>pvgisprototype.algorithms.hofierka.position.event_hour_angle.calculate_event_hour_angle_pvis</code>)'>calculate_event_hour_angle_pvis</a></code></td> <td> <div class=doc-md-description> <p>Calculate the hour angle () at sunrise and sunset</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.event_hour_angle.calculate_event_hour_angle_pvis> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_event_hour_angle_pvis</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.event_hour_angle.calculate_event_hour_angle_pvis title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_event_hour_angle_pvis</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>solar_declination</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.EventHourAngle>EventHourAngle</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the hour angle () at sunrise and sunset</p> <p>Hour angle = acos(-tan(Latitude Angle-Tilt Angle)*tan(Declination Angle))</p> <p>The hour angle () at sunrise and sunset measures the angular distance between the sun at the local solar time and the sun at solar noon.</p> <p> = acos(-tan(-)*tan())</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><span title=pvgisprototype.Latitude>Latitude</span></code> </td> <td> <div class=doc-md-description> <p>Latitude () is the angle between the sun's rays and its projection on the horizontal surface measured in radians</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>surface_tilt</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Surface tilt (or slope) () is the angle between the inclined surface (slope) and the horizontal plane.</p> </div> </td> <td> <code>0</code> </td> </tr> <tr class=doc-section-item> <td> <code>solar_declination</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Solar declination () is the angle between the equator and a line drawn from the centre of the Earth to the centre of the sun measured in radians.</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>hour_angle_sunrise</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Hour angle () is the angle at any instant through which the earth has to turn to bring the meridian of the observer directly in line with the sun's rays measured in radian.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/position/event_hour_angle.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_event_hour_angle_pvis</span><span class=p>(</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a>    <span class=n>solar_declination</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>EventHourAngle</span><span class=p>:</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a><span class=w>    </span><span class=sd>"""Calculate the hour angle () at sunrise and sunset</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a><span class=sd>    Hour angle = acos(-tan(Latitude Angle-Tilt Angle)*tan(Declination Angle))</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a><span class=sd>    The hour angle () at sunrise and sunset measures the angular distance</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a><span class=sd>    between the sun at the local solar time and the sun at solar noon.</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a><span class=sd>     = acos(-tan(-)*tan())</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a><span class=sd>    latitude: float</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a><span class=sd>        Latitude () is the angle between the sun's rays and its projection on the</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a><span class=sd>        horizontal surface measured in radians</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a><span class=sd>    surface_tilt: float</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a><span class=sd>        Surface tilt (or slope) () is the angle between the inclined surface</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a><span class=sd>        (slope) and the horizontal plane.</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a><span class=sd>    solar_declination: float</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a><span class=sd>        Solar declination () is the angle between the equator and a line drawn</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a><span class=sd>        from the centre of the Earth to the centre of the sun measured in</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a><span class=sd>        radians.</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a><span class=sd>    hour_angle_sunrise: float</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a><span class=sd>        Hour angle () is the angle at any instant through which the earth has</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a><span class=sd>        to turn to bring the meridian of the observer directly in line with the</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a><span class=sd>        sun's rays measured in radian.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>    <span class=n>hour_angle_sunrise_value</span> <span class=o>=</span> <span class=n>arccos</span><span class=p>(</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>        <span class=o>-</span><span class=n>arctan</span><span class=p>(</span><span class=n>latitude</span> <span class=o>-</span> <span class=n>surface_tilt</span><span class=p>)</span> <span class=o>*</span> <span class=n>arctan</span><span class=p>(</span><span class=n>solar_declination</span><span class=p>)</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>    <span class=k>return</span> <span class=n>EventHourAngle</span><span class=p>(</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>hour_angle_sunrise_value</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.fractional_year> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">fractional_year</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.fractional_year title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.fractional_year.calculate_day_angle_series_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_day_angle_series_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.position.fractional_year.calculate_day_angle_series_hofierka</code>)'>calculate_day_angle_series_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the day angle for a time series.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.fractional_year.calculate_day_angle_series_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_day_angle_series_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.fractional_year.calculate_day_angle_series_hofierka title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_day_angle_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.FractionalYear>FractionalYear</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the day angle for a time series.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>A Pandas DatetimeIndex representing the timestamps.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The data type for the calculations (the default is 'float32').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The backend used for calculations (the default is 'NUMPY').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.FractionalYear>FractionalYear</span></code> </td> <td> <div class=doc-md-description> <p>A FractionalYear object containing the calculated fractional year series.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The day angle [0]_ is the same quantity called Fractional Year in NOAA's solar geometry equations, i.e. the function calculate_fractional_year_time_series_noaa().</p> <p>In PVGIS' C source code, this is called <code>day_angle</code></p> <p>NOAA's corresponding equation:</p> <div class=codehilite><pre><span></span><code>fractional_year = (
    2
    <span class=k>*</span> pi
    / 365
    <span class=k>*</span> (timestamp.timetuple().tm_yday - 1 + float(timestamp.hour - 12) / 24)
)
</code></pre></div> </details> <details class=references open> <summary>References</summary> <p>.. [0] Hofierka, 2002</p> <p>NOAA's corresponding equation:</p> <div class=codehilite><pre><span></span><code>day_angle = (
    2
    <span class=k>*</span> pi
    / 365
    <span class=k>*</span> (timestamp.timetuple().tm_yday - 1 + float(timestamp.hour - 12) / 24)
)
</code></pre></div> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/position/fractional_year.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_day_angle_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>FractionalYear</span><span class=p>:</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=w>    </span><span class=sd>"""Calculate the day angle for a time series.</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>        A Pandas DatetimeIndex representing the timestamps.</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>        The data type for the calculations (the default is 'float32').</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>        The backend used for calculations (the default is 'NUMPY').</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    verbose: int</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>        Verbosity level</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    log: int</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>        Log level</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    FractionalYear</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>        A FractionalYear object containing the calculated fractional year</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>        series.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    The day angle [0]_ is the same quantity called Fractional Year in NOAA's</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    solar geometry equations, i.e. the function</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    calculate_fractional_year_time_series_noaa().</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    In PVGIS' C source code, this is called `day_angle`</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>    NOAA's corresponding equation:</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>        fractional_year = (</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>            2</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>            * pi</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>            / 365</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>            * (timestamp.timetuple().tm_yday - 1 + float(timestamp.hour - 12) / 24)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>        )</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    .. [0] Hofierka, 2002</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    NOAA's corresponding equation:</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>        day_angle = (</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>            2</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>            * pi</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>            / 365</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>            * (timestamp.timetuple().tm_yday - 1 + float(timestamp.hour - 12) / 24)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        )</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=n>days_of_year</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>dayofyear</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=n>days_in_years</span> <span class=o>=</span> <span class=n>get_days_in_years</span><span class=p>(</span><span class=n>timestamps</span><span class=o>.</span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=n>array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=s2>"shape"</span><span class=p>:</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=s2>"init_method"</span><span class=p>:</span> <span class=s2>"zeros"</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=p>}</span>  <span class=c1># Borrow shape from timestamps</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>day_angle_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>array_parameters</span><span class=p>)</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>    <span class=n>day_angle_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span> <span class=o>*</span> <span class=n>days_of_year</span> <span class=o>/</span> <span class=n>days_in_years</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>numpy</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=p>(</span><span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span> <span class=o>&lt;=</span> <span class=n>day_angle_series</span><span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=o>&amp;</span> <span class=p>(</span><span class=n>day_angle_series</span> <span class=o>&lt;=</span> <span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=n>index_of_out_of_range_values</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>            <span class=p>(</span><span class=n>day_angle_series</span> <span class=o>&lt;</span> <span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>            <span class=o>|</span> <span class=p>(</span><span class=n>day_angle_series</span> <span class=o>&gt;</span> <span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>day_angle_series</span><span class=p>[</span><span class=n>index_of_out_of_range_values</span><span class=p>]</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=c1># Report values in "human readable" degrees</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>            <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>            <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=si>}</span><span class=s2>] radians"</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>            <span class=sa>f</span><span class=s2>" in [code]day_angle_series[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>day_angle_series</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=k>return</span> <span class=n>FractionalYear</span><span class=p>(</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>day_angle_series</span><span class=p>,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>hofierka</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.shading> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">shading</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.shading title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.shading.calculate_horizon_height_series title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_horizon_height_series</span> (<code>pvgisprototype.algorithms.hofierka.position.shading.calculate_horizon_height_series</code>)'>calculate_horizon_height_series</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.shading.calculate_surface_in_shade_series_pvgis title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_surface_in_shade_series_pvgis</span> (<code>pvgisprototype.algorithms.hofierka.position.shading.calculate_surface_in_shade_series_pvgis</code>)'>calculate_surface_in_shade_series_pvgis</a></code></td> <td> <div class=doc-md-description> <p>Determine a time series for when a location of observation (or else in</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.shading.calculate_horizon_height_series> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_horizon_height_series</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.shading.calculate_horizon_height_series title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_horizon_height_series</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>solar_azimuth_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>horizon_profile</span><span class=p>:</span> <span class=n><span title=xarray.DataArray>DataArray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.HorizonHeight>HorizonHeight</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/position/shading.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateHorizonHeightSeriesInputModel</span><span class=p>)</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_horizon_height_series</span><span class=p>(</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>    <span class=n>solar_azimuth_series</span><span class=p>:</span> <span class=n>SolarAzimuth</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=n>horizon_profile</span><span class=p>:</span> <span class=n>DataArray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>HorizonHeight</span><span class=p>:</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=w>    </span><span class=sd>""" """</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=c1># Ensure _all_ azimuth values are measured in radians !</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=c1># Tolerance for matching azimuths (set this based on acceptable precision)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=c1># tolerance = finfo(float).eps  # Machine epsilon for floating point comparison</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=c1># or :</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=c1># tolerance = 0.001  # or a smaller value, depending on your precision needs</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=c1># ?</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>    <span class=c1># select closest azimuth values using Xarray's `sel` with `method="nearest"`</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=c1># closest_horizon_heights = horizon_profile.sel(azimuth=solar_azimuth_series.radians, method="nearest", tolerance=tolerance)</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>    <span class=c1># # Identify where the tolerance is exceeded (i.e., where interpolation is needed)</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>    <span class=c1># azimuth_difference = abs(closest_horizon_heights.azimuth - solar_azimuth_series.radians)</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>    <span class=c1># needs_interpolation = azimuth_difference &gt; tolerance</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>    <span class=c1># We need the index of the selected values !</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>    <span class=c1># # Assign exact or almost exact matches from the horizon profile</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>    <span class=c1># close_enough = ~needs_interpolation</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>    <span class=c1># horizon_height_series[close_enough] = horizon_profile.sel(azimuth=solar_azimuth_series.radians[close_enough])</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=c1># # Interpolate values not close enough</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>    <span class=c1># import numpy</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>    <span class=c1># if numpy.any(needs_interpolation):</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>    <span class=c1>#     horizon_height_series[needs_interpolation] = horizon_profile.interp(</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=c1>#         azimuth=solar_azimuth_series.radians[needs_interpolation]</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=c1>#     )</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>horizon_profile</span><span class=p>,</span> <span class=n>DataArray</span><span class=p>):</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=k>if</span> <span class=p>(</span><span class=n>horizon_profile</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>():</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>            <span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.core.arrays</span><span class=w> </span><span class=kn>import</span> <span class=n>create_array</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>            <span class=c1># If all values are zero, assume flat terrain</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>            <span class=n>array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>                <span class=s2>"shape"</span><span class=p>:</span> <span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>                <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>                <span class=s2>"init_method"</span><span class=p>:</span> <span class=s2>"zeros"</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>                <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>            <span class=p>}</span>  <span class=c1># Borrow shape from solar_azimuth_series</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>            <span class=n>horizon_height_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>array_parameters</span><span class=p>)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>            <span class=n>max_horizon_azimuth</span> <span class=o>=</span> <span class=n>horizon_profile</span><span class=o>.</span><span class=n>values</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>            <span class=n>max_solar_azimuth</span> <span class=o>=</span> <span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>            <span class=k>if</span> <span class=n>max_solar_azimuth</span> <span class=o>&gt;</span> <span class=n>max_horizon_azimuth</span><span class=p>:</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>                <span class=c1># Before interpollate, append one more pair of solar azimuth at 360 degrees (or 2*pi) and</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>                <span class=c1># repeat the 0 degrees solar azimuth value at the 360 degrees solar azimuth</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>                <span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.constants</span><span class=w> </span><span class=kn>import</span> <span class=n>pi</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>                <span class=kn>import</span><span class=w> </span><span class=nn>xarray</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>xr</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>                <span class=n>new_max_horizon_azimuth</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>                <span class=n>last_horizon_height_value</span> <span class=o>=</span> <span class=n>horizon_profile</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>                <span class=n>new_point</span> <span class=o>=</span> <span class=n>xr</span><span class=o>.</span><span class=n>DataArray</span><span class=p>(</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>                    <span class=p>[</span><span class=n>last_horizon_height_value</span><span class=p>],</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>                    <span class=n>dims</span><span class=o>=</span><span class=s2>"azimuth"</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>                    <span class=n>coords</span><span class=o>=</span><span class=p>{</span><span class=s2>"azimuth"</span><span class=p>:</span> <span class=p>[</span><span class=n>new_max_horizon_azimuth</span><span class=p>]},</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>                <span class=n>horizon_profile</span> <span class=o>=</span> <span class=n>xr</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>horizon_profile</span><span class=p>,</span> <span class=n>new_point</span><span class=p>],</span> <span class=n>dim</span><span class=o>=</span><span class=s2>"azimuth"</span><span class=p>)</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>            <span class=n>horizon_height_series</span> <span class=o>=</span> <span class=n>horizon_profile</span><span class=o>.</span><span class=n>interp</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>                <span class=n>azimuth</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>            <span class=p>)</span><span class=o>.</span><span class=n>values</span>  <span class=c1># retrieve the NumPy array of values here !</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=k>else</span><span class=p>:</span>  <span class=c1># we assume a flat terrain</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.core.arrays</span><span class=w> </span><span class=kn>import</span> <span class=n>create_array</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=n>array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>            <span class=s2>"shape"</span><span class=p>:</span> <span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>            <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>            <span class=s2>"init_method"</span><span class=p>:</span> <span class=s2>"zeros"</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>            <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>        <span class=p>}</span>  <span class=c1># Borrow shape from solar_azimuth_series</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>horizon_height_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>array_parameters</span><span class=p>)</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>    <span class=k>return</span> <span class=n>HorizonHeight</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=n>horizon_height_series</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.shading.calculate_surface_in_shade_series_pvgis> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_surface_in_shade_series_pvgis</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.shading.calculate_surface_in_shade_series_pvgis title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_surface_in_shade_series_pvgis</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>solar_azimuth_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>horizon_profile</span><span class=p>:</span> <span class=n><span title=xarray.DataArray>DataArray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.LocationShading>LocationShading</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Determine a time series for when a location of observation (or else in the context of photovoltaic analysis a solar surface) is in shade.</p> <p>The function compares time series of solar altitude and horizon height, the latter measured at directions corresponding to the solar azimuth series. The comparison derives a qualitative series of the sun being visible from the location of observation or indeed behind the horizon.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>solar_altitude_series_array</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Array of solar altitude angles for each timestamp.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>NumPy array: Boolean array indicating whether the surface is in shade at</code> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td> <code>each timestamp.</code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/position/shading.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSurfaceInShadePVGISInputModel</span><span class=p>)</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_surface_in_shade_series_pvgis</span><span class=p>(</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n>SolarAltitude</span><span class=p>,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=n>solar_azimuth_series</span><span class=p>:</span> <span class=n>SolarAzimuth</span><span class=p>,</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=n>horizon_profile</span><span class=p>:</span> <span class=n>DataArray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>LocationShading</span><span class=p>:</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=w>    </span><span class=sd>"""Determine a time series for when a location of observation (or else in</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=sd>    the context of photovoltaic analysis a solar surface) is in shade.</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=sd>    The function compares time series of solar altitude and horizon height, the</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a><span class=sd>    latter measured at directions corresponding to the solar azimuth series.</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a><span class=sd>    The comparison derives a qualitative series of the sun being visible from</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a><span class=sd>    the location of observation or indeed behind the horizon.</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=sd>    solar_altitude_series_array: numpy array</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a><span class=sd>        Array of solar altitude angles for each timestamp.</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=sd>    NumPy array: Boolean array indicating whether the surface is in shade at</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>    each timestamp.</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=n>horizon_height_series</span> <span class=o>=</span> <span class=n>calculate_horizon_height_series</span><span class=p>(</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=n>solar_azimuth_series</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=n>horizon_profile</span><span class=o>=</span><span class=n>horizon_profile</span><span class=p>,</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>    <span class=n>horizon_height_series</span><span class=o>.</span><span class=n>build_output</span><span class=p>(</span><span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span> <span class=n>fingerprint</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>    <span class=n>surface_in_shade_series</span> <span class=o>=</span> <span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&lt;</span> <span class=n>horizon_height_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=kc>False</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>"In shade : </span><span class=si>{</span><span class=n>surface_in_shade_series</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=k>return</span> <span class=n>LocationShading</span><span class=p>(</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>UNITLESS</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>        <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>        <span class=n>solar_azimuth</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>        <span class=n>horizon_height</span><span class=o>=</span><span class=n>horizon_height_series</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=n>visible</span><span class=o>=~</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=n>shading_algorithm</span><span class=o>=</span><span class=s2>"PVGIS"</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.solar_altitude> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_altitude</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.solar_altitude title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.solar_altitude.calculate_solar_altitude_series_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_altitude_series_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.position.solar_altitude.calculate_solar_altitude_series_hofierka</code>)'>calculate_solar_altitude_series_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar altitude angle.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.solar_altitude.calculate_solar_altitude_series_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_altitude_series_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.solar_altitude.calculate_solar_altitude_series_hofierka title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_altitude_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar altitude angle.</p> <p>Calculate the solar altitude angle based on the equation</p> <p>sine_solar_altitude = ( sin(latitude.radians) * np.sin(solar_declination_series.radians) + cos(latitude.radians) * np.cos(solar_declination_series.radians) * np.cos(solar_hour_angle_series.radians)</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The longitude in degrees. This value will be converted to radians. It should be in the range [-180, 180].</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The latitude in degrees. This value will be converted to radians. It should be in the range [-90, 90].</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamp</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/datetime.html#module-datetime>datetime</a></code> </td> <td> <div class=doc-md-description> <p>The timestamp for which to calculate the solar altitude. If not provided, the current UTC time will be used.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The timezone to use for the calculation. If not provided, the system's local timezone will be used.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The calculated solar altitude.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>NOAA's equation is practically the same, though it targets the cosine function of the solar zenith angle which it the complementary of the solar altitude angle.</p> <p>cosine_solar_zenith = ( sin(latitude.radians) * np.sin(solar_declination_series.radians) + cos(latitude.radians) * np.cos(solar_declination_series.radians) * np.cos(solar_hour_angle_series.radians)</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/position/solar_altitude.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=c1># @validate_with_pydantic(CalculateSolarAltitudePVISInputModel)</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_altitude_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=c1># solar_time_model: SolarTimeModel,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarAltitude</span><span class=p>:</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar altitude angle.</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    Calculate the solar altitude angle based on the equation</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    sine_solar_altitude = (</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>        sin(latitude.radians)</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>        * np.sin(solar_declination_series.radians)</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>        + cos(latitude.radians)</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        * np.cos(solar_declination_series.radians)</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>        * np.cos(solar_hour_angle_series.radians)</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    longitude : float</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>        The longitude in degrees. This value will be converted to radians.</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        It should be in the range [-180, 180].</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    latitude : float</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>        The latitude in degrees. This value will be converted to radians.</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        It should be in the range [-90, 90].</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    timestamp : datetime, optional</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>        The timestamp for which to calculate the solar altitude.</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>        If not provided, the current UTC time will be used.</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    timezone : str, optional</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>        The timezone to use for the calculation.</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>        If not provided, the system's local timezone will be used.</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    float</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>        The calculated solar altitude.</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    NOAA's equation is practically the same, though it targets the cosine</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    function of the solar zenith angle which it the complementary of the solar</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    altitude angle.</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    cosine_solar_zenith = (</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        sin(latitude.radians)</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>        * np.sin(solar_declination_series.radians)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>        + cos(latitude.radians)</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>        * np.cos(solar_declination_series.radians)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>        * np.cos(solar_hour_angle_series.radians)</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>calculate_solar_declination_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=c1># Idea for alternative solar time modelling, i.e. Milne 1921 -------------</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=c1># solar_time = model_solar_time(</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>    <span class=c1>#     longitude=longitude,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>    <span class=c1>#     latitude=latitude,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>    <span class=c1>#     timestamp=timestamp,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>    <span class=c1>#     timezone=timezone,</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>    <span class=c1>#     solar_time_model=solar_time_model,  # returns datetime.time object</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>    <span class=c1>#     eccentricity_phase_offset=eccentricity_phase_offset,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>    <span class=c1>#     eccentricity_amplitude=eccentricity_amplitude,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>    <span class=c1># hour_angle = calculate_solar_hour_angle_pvis(</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>    <span class=c1>#         solar_time=solar_time,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>    <span class=c1># ------------------------------------------------------------------------</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=n>calculate_solar_hour_angle_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=n>C31</span> <span class=o>=</span> <span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>    <span class=n>C33</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=n>sine_solar_altitude_series</span> <span class=o>=</span> <span class=n>C31</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>+</span> <span class=n>C33</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>    <span class=n>solar_altitude_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>arcsin</span><span class=p>(</span><span class=n>sine_solar_altitude_series</span><span class=p>)</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>    <span class=c1># mask_positive_C31 = C31 &gt; 1e-7</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=c1># solar_altitude_series[mask_positive_C31] = numpy.where(</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>    <span class=c1>#     sine_solar_altitude_series &lt; 0,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>    <span class=c1>#     NO_SOLAR_INCIDENCE,</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>    <span class=c1>#     solar_altitude_series,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=c1># The hour angle of the time of sunrise/sunset over a horizontal surface</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=c1># Thr,s can be calculated then as:</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>    <span class=c1># cos(event_hour_angle_horizontal) = -C33 / C31</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>        <span class=p>(</span><span class=n>solar_altitude_series</span> <span class=o>&lt;</span> <span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>        <span class=o>|</span> <span class=p>(</span><span class=n>solar_altitude_series</span> <span class=o>&gt;</span> <span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>any</span><span class=p>():</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>solar_altitude_series</span><span class=p>[</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>            <span class=p>(</span><span class=n>solar_altitude_series</span> <span class=o>&lt;</span> <span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>            <span class=o>|</span> <span class=p>(</span><span class=n>solar_altitude_series</span> <span class=o>&gt;</span> <span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>        <span class=p>]</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=c1># raise ValueError(# ?</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>            <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_NEGATIVE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>            <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=si>}</span><span class=s2>] radians"</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>            <span class=sa>f</span><span class=s2>" in [code]solar_altitude_series[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>    <span class=k>return</span> <span class=n>SolarAltitude</span><span class=p>(</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>hofierka</span><span class=p>,</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.solar_azimuth> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_azimuth</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.solar_azimuth title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.solar_azimuth.calculate_solar_azimuth_series_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_azimuth_series_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.position.solar_azimuth.calculate_solar_azimuth_series_hofierka</code>)'>calculate_solar_azimuth_series_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar azimuth angle</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.solar_azimuth.calculate_solar_azimuth_series_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_azimuth_series_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.solar_azimuth.calculate_solar_azimuth_series_hofierka title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_azimuth_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar azimuth angle</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>solar_azimuth</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>solar_azimuth</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>According to Hofierka! solar azimuth is measured from East! Conflict with Jenvco 1992?</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/position/solar_azimuth.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=c1># @validate_with_pydantic(CalculateSolarAzimuthPVISInputModel)</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_azimuth_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarAzimuth</span><span class=p>:</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar azimuth angle</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    solar_azimuth: float</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    solar_azimuth: float</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    According to Hofierka! solar azimuth is measured from East!</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    Conflict with Jenvco 1992?</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>calculate_solar_declination_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=c1># Idea for alternative solar time modelling, i.e. Milne 1921 -------------</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>    <span class=c1># solar_time = model_solar_time(</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=c1>#     longitude=longitude,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=c1>#     latitude=latitude,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>    <span class=c1>#     timestamp=timestamp,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=c1>#     timezone=timezone,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=c1>#     solar_time_model=solar_time_model,  # returns datetime.time object</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>    <span class=c1>#     eccentricity_phase_offset=eccentricity_phase_offset,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=c1>#     eccentricity_amplitude=eccentricity_amplitude,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=c1># hour_angle = calculate_solar_hour_angle_pvis(</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=c1>#         solar_time=solar_time,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=c1># ------------------------------------------------------------------------</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=n>calculate_solar_hour_angle_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>C11</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=n>C13</span> <span class=o>=</span> <span class=o>-</span><span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>    <span class=p>)</span>  <span class=c1># Attention to the - sign</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=n>C22</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=n>x_solar_vector_component</span> <span class=o>=</span> <span class=o>-</span><span class=n>C22</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=n>y_solar_vector_component</span> <span class=o>=</span> <span class=n>C11</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>+</span> <span class=n>C13</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=c1># numerator = y_solar_vector_component</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=n>denominator_a</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=n>x_solar_vector_component</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=n>denominator_b</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=n>y_solar_vector_component</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>    <span class=n>event_hour_angle_inclined</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=n>denominator_a</span> <span class=o>+</span> <span class=n>denominator_b</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>)</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>    <span class=c1># mask_positive_event_hour_angle_inclined = event_hour_angle_inclined &gt; 1e-7</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>    <span class=n>mask_negative_event_hour_angle_inclined</span> <span class=o>=</span> <span class=n>event_hour_angle_inclined</span> <span class=o>&lt;</span> <span class=mf>1e-7</span>  <span class=c1># ?</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>    <span class=n>azimuth_origin</span> <span class=o>=</span> <span class=s2>"East"</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>    <span class=n>cosine_solar_azimuth_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=n>y_solar_vector_component</span> <span class=o>/</span> <span class=n>event_hour_angle_inclined</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>arccos</span><span class=p>(</span><span class=n>cosine_solar_azimuth_series</span><span class=p>)</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=n>x_solar_vector_component</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=n>numpy</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>-</span> <span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>mask_negative_event_hour_angle_inclined</span><span class=p>,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>NO_SOLAR_INCIDENCE</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=kn>from</span><span class=w> </span><span class=nn>math</span><span class=w> </span><span class=kn>import</span> <span class=n>pi</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=n>solar_azimuth_series</span> <span class=o>&lt;</span> <span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=mi>5</span> <span class=o>*</span> <span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=n>solar_azimuth_series</span> <span class=o>&gt;=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=n>solar_azimuth_series</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>,</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>        <span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=c1># -------------------------- convert east to north zero degrees convention</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=c1># PVGIS' follows Hofierka (2002) who states : azimuth is measured from East</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>    <span class=c1># solar_azimuth_series = convert_east_to_north_radians_convention(solar_azimuth_series)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=c1># convert east to north zero degrees convention --------------------------</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>    <span class=c1># if (</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>    <span class=c1>#     not isfinite(solar_azimuth.degrees)</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=c1>#     or not solar_azimuth.min_degrees &lt;= solar_azimuth.degrees &lt;= solar_azimuth.max_degrees</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=c1># ):</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>    <span class=c1>#     raise ValueError(</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>    <span class=c1>#         f"The calculated solar azimuth angle {solar_azimuth.degrees} is out of the expected range\</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>    <span class=c1>#         [{solar_azimuth.min_degrees}, {solar_azimuth.max_degrees}] degrees"</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>    <span class=c1>#     )</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&lt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=o>|</span> <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&gt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>any</span><span class=p>():</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>solar_azimuth_series</span><span class=p>[</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>            <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&lt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>            <span class=o>|</span> <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&gt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=p>]</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>        <span class=c1># raise ValueError(# ?</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>            <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_NEGATIVE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>            <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=si>}</span><span class=s2>] radians"</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>            <span class=sa>f</span><span class=s2>" in [code]solar_azimuth_series[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>    <span class=k>return</span> <span class=n>SolarAzimuth</span><span class=p>(</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>hofierka</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>pvgis</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>        <span class=n>origin</span><span class=o>=</span><span class=n>azimuth_origin</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=c1># definition=incidence_angle_definition,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=c1># description=incidence_angle_description,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>    <span class=p>)</span>  <span class=c1># zero_direction='East'</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.solar_declination> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_declination</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.solar_declination title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.solar_declination.calculate_solar_declination_series_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_declination_series_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.position.solar_declination.calculate_solar_declination_series_hofierka</code>)'>calculate_solar_declination_series_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Approximate the sun's declination for a given day of the year.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.solar_declination.calculate_solar_declination_series_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_declination_series_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.solar_declination.calculate_solar_declination_series_hofierka title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_declination_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarDeclination>SolarDeclination</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Approximate the sun's declination for a given day of the year.</p> <p>The solar declination is the angle between the Sun's rays and the equatorial plane of Earth. It varies throughout the year due to the tilt of the Earth's axis and is an important parameter in determining the seasons and the amount of solar radiation received at different latitudes.</p> <p>The function calculates the <code>proportion</code> of the way through the year (in radians), which is given by <code>(2 * pi * day_of_year) / 365.25</code>. The <code>0.3978</code>, <code>1.4</code>, and <code>0.0355</code> are constants in the approximation formula, with the <code>0.0489</code> being an adjustment factor for the slight eccentricity of Earth's orbit.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>day_of_year</code> </td> <td> </td> <td> <div class=doc-md-description> <p>The day of the year (ranging from 1 to 365 or 366 in a leap year).</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>solar_declination</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The solar declination in radians for the given day of the year.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The equation used here is a simple approximation and bases upon a direct translation from PVGIS' rsun3 source code:</p> <ul> <li>from file: rsun_base.cpp</li> <li>function: com_declin(no_of_day)</li> </ul> <p>For more accurate calculations of solar position, comprehensive models like the Solar Position Algorithm (SPA) are typically used.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/position/solar_declination.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_declination_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarDeclination</span><span class=p>:</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=w>    </span><span class=sd>"""Approximate the sun's declination for a given day of the year.</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>    The solar declination is the angle between the Sun's rays and the</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    equatorial plane of Earth. It varies throughout the year due to the tilt of</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    the Earth's axis and is an important parameter in determining the seasons</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    and the amount of solar radiation received at different latitudes.</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    The function calculates the `proportion` of the way through the year (in</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    radians), which is given by `(2 * pi * day_of_year) / 365.25`.</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    The `0.3978`, `1.4`, and `0.0355` are constants in the approximation</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    formula, with the `0.0489` being an adjustment factor for the slight</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    eccentricity of Earth's orbit.</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    day_of_year: int</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        The day of the year (ranging from 1 to 365 or 366 in a leap year).</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    solar_declination: float</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>        The solar declination in radians for the given day of the year.</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    The equation used here is a simple approximation and bases upon a direct</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    translation from PVGIS' rsun3 source code:</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>      - from file: rsun_base.cpp</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>      - function: com_declin(no_of_day)</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    For more accurate calculations of solar position, comprehensive models like</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    the Solar Position Algorithm (SPA) are typically used.</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=n>day_angle_series</span> <span class=o>=</span> <span class=n>calculate_day_angle_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>    <span class=c1># Note the - sign for the output solar declination, as is in PVGIS v5.2</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=c1># see : com_declin() in rsun_base.c</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>arcsin</span><span class=p>(</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=mf>0.3978</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>        <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>            <span class=n>day_angle_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>            <span class=o>-</span> <span class=mf>1.4</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>            <span class=o>+</span> <span class=n>eccentricity_amplitude</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>            <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>day_angle_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>-</span> <span class=n>eccentricity_phase_offset</span><span class=p>)</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range_x</span><span class=p>(</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>SolarDeclination</span><span class=p>(),</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=k>return</span> <span class=n>SolarDeclination</span><span class=p>(</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>day_angle_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>  <span class=c1># ?</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.solar_hour_angle> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_hour_angle</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.solar_hour_angle title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.solar_hour_angle.calculate_solar_hour_angle_series_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_hour_angle_series_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.position.solar_hour_angle.calculate_solar_hour_angle_series_hofierka</code>)'>calculate_solar_hour_angle_series_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the hour angle '</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.solar_hour_angle.calculate_solar_hour_angle_series_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_hour_angle_series_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.solar_hour_angle.calculate_solar_hour_angle_series_hofierka title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_hour_angle_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarHourAngle>SolarHourAngle</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the hour angle '</p> <p> = (ST / 3600 - 12) * 15 * pi / 180</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>solar_time</code> </td> <td> </td> <td> <div class=doc-md-description> <p>The solar time (ST) is a calculation of the passage of time based on the position of the Sun in the sky. It is expected to be decimal hours in a 24 hour format and measured internally in seconds.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>hour_angle</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The solar hour angle () is the angle at any instant through which the earth has to turn to bring the meridian of the observer directly in line with the sun's rays measured in radian.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>If not mistaken, in PVGIS' C source code, the conversion function is:</p> <div class=codehilite><pre><span></span><code>hour_angle = (solar_time / 3600 - 12) <span class=gs>* 15 *</span> 0.0175

where the solar time was given in seconds.
</code></pre></div> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/position/solar_hour_angle.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_hour_angle_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarHourAngle</span><span class=p>:</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=w>    </span><span class=sd>"""Calculate the hour angle '</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>     = (ST / 3600 - 12) * 15 * pi / 180</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    solar_time: float</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>        The solar time (ST) is a calculation of the passage of time based on the</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>        position of the Sun in the sky. It is expected to be decimal hours in a</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>        24 hour format and measured internally in seconds.</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    hour_angle: float</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>        The solar hour angle () is the angle at any instant through which the</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        earth has to turn to bring the meridian of the observer directly in</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>        line with the sun's rays measured in radian.</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    If not mistaken, in PVGIS' C source code, the conversion function is:</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        hour_angle = (solar_time / 3600 - 12) * 15 * 0.0175</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>        where the solar time was given in seconds.</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>    <span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.algorithms.noaa.solar_time</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=n>calculate_true_solar_time_series_noaa</span><span class=p>,</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>    <span class=n>true_solar_time_series</span> <span class=o>=</span> <span class=n>calculate_true_solar_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=p>(</span><span class=n>true_solar_time_series</span><span class=o>.</span><span class=n>minutes</span> <span class=o>-</span> <span class=mf>720.0</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=n>numpy</span><span class=o>.</span><span class=n>pi</span> <span class=o>/</span> <span class=mf>720.0</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=c1># if (</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=c1>#     not isfinite(hour_angle.degrees)</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=c1>#     or not hour_angle.min_degrees &lt;= hour_angle.degrees &lt;= hour_angle.max_degrees</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=c1># ):</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=c1>#     raise ValueError(</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=c1>#         f"The calculated solar hour angle {hour_angle.degrees} is out of the expected range\</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=c1>#         [{hour_angle.min_degrees}, {hour_angle.max_degrees}] degrees"</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=c1>#     )</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=k>return</span> <span class=n>SolarHourAngle</span><span class=p>(</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>hofierka</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"Hofierka"</span><span class=p>,</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.solar_incidence> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_incidence</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.solar_incidence title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.solar_incidence.calculate_relative_longitude title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_relative_longitude</span> (<code>pvgisprototype.algorithms.hofierka.position.solar_incidence.calculate_relative_longitude</code>)'>calculate_relative_longitude</a></code></td> <td> <div class=doc-md-description> <p>Notes</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.position.solar_incidence.calculate_solar_incidence_series_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_incidence_series_hofierka</span> (<code>pvgisprototype.algorithms.hofierka.position.solar_incidence.calculate_solar_incidence_series_hofierka</code>)'>calculate_solar_incidence_series_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the angle of incidence () between the direction of the sun</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.solar_incidence.calculate_relative_longitude> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_relative_longitude</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.solar_incidence.calculate_relative_longitude title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_relative_longitude</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceOrientation>SurfaceOrientation</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceTilt>SurfaceTilt</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.RelativeLongitude>RelativeLongitude</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <details class=note open> <summary>Notes</summary> <p>Hofierka (2002) uses equations presented by Jeno (1992) :</p> <div class=codehilite><pre><span></span><code>tangent_relative_longitude =
    (
        <span class=k>-</span> sin(surface_tilt)
        <span class=k>*</span> sin(surface_orientation)
    ) / (
        sin(latitude)
        <span class=k>*</span> sin(surface_tilt)
        <span class=k>*</span> cos(surface_orientation)
        + cos(latitude)
        <span class=k>*</span> cos(surface_tilt)
    )
</code></pre></div> <p>In PVGIS' C source code, there is an error of one negative sign in either of the expressions! That is so because : cos(pi/2 + x) = -sin(x). As a consequence, the numerator becomes a positive number.</p> <div class=codehilite><pre><span></span><code>Source code :

/* These calculations depend on slope and aspect. Constant for the day if not tracking <span class=gs>*/</span>
<span class=gs>sin_phi_l = -gridGeom-&gt;coslat *</span> cos_u <span class=gs>* sin_v + gridGeom-&gt;sinlat *</span> sin_u;
latid_l = asin(sin_phi_l);
cos_latid_l = cos(latid_l);
q1 = gridGeom-&gt;sinlat <span class=gs>* cos_u *</span> sin_v + gridGeom-&gt;coslat <span class=gs>* sin_u;</span>
<span class=gs>tan_lam_l = - cos_u *</span> cos_v / q1;
longit_l = atan (tan_lam_l);
if((aspect&lt;M_PI)&amp;&amp;(longit_l&lt;0.))
{
    longit_l += M_PI;
}
else if((aspect&gt;M_PI)&amp;&amp;(longit_l&gt;0.))
{
    longit_l -= M_PI;
}


Translation in to Python / pseudocode :

tangent_relative_longitude =
    (
      <span class=k>-</span> cos(half_pi - surface_tilt)         # cos(pi/2 - x) = sin(x)
      <span class=k>*</span> cos(half_pi + surface_orientation)  # cos(pi/2 + x) = -sin(x) #
    ) / (
      sin(latitude)
      <span class=k>*</span> cos(half_pi - surface_tilt)
      <span class=k>*</span> sin(half_pi + surface_orientation)  # sin(pi/2 + x) = cos(x)
      + cos(latitude)
      <span class=k>*</span> sin(half_pi - surface_tilt)         # sin(pi/2 - x) = cos(x)
    )
</code></pre></div> <p>As a consequence, PVGIS is like (note the positive numerator!) :</p> <div class=codehilite><pre><span></span><code>tangent_relative_longitude =
    (
        sin(surface_tilt)
        <span class=k>*</span> sin(surface_orientation)
    ) / (
        sin(latitude)
        <span class=k>*</span> sin(surface_tilt)
        <span class=k>*</span> cos(surface_orientation)
        + cos(latitude)
        <span class=k>*</span> cos(surface_tilt)
    )
</code></pre></div> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/position/solar_incidence.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=c1># @validate_with_pydantic(CalculateRelativeLongitudeInputModel)</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_relative_longitude</span><span class=p>(</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n>SurfaceOrientation</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n>SurfaceTilt</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>RelativeLongitude</span><span class=p>:</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    Hofierka (2002) uses equations presented by Jeno (1992) :</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>        tangent_relative_longitude =</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>            (</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>                - sin(surface_tilt)</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>                * sin(surface_orientation)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>            ) / (</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>                sin(latitude)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>                * sin(surface_tilt)</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>                * cos(surface_orientation)</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>                + cos(latitude)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>                * cos(surface_tilt)</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>            )</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    In PVGIS' C source code, there is an error of one negative sign in either</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    of the expressions! That is so because : cos(pi/2 + x) = -sin(x).</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    As a consequence, the numerator becomes a positive number.</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>        Source code :</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>        /* These calculations depend on slope and aspect. Constant for the day if not tracking */</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>        sin_phi_l = -gridGeom-&gt;coslat * cos_u * sin_v + gridGeom-&gt;sinlat * sin_u;</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>        latid_l = asin(sin_phi_l);</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>        cos_latid_l = cos(latid_l);</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        q1 = gridGeom-&gt;sinlat * cos_u * sin_v + gridGeom-&gt;coslat * sin_u;</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>        tan_lam_l = - cos_u * cos_v / q1;</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>        longit_l = atan (tan_lam_l);</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>        if((aspect&lt;M_PI)&amp;&amp;(longit_l&lt;0.))</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>        {</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>            longit_l += M_PI;</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>        }</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>        else if((aspect&gt;M_PI)&amp;&amp;(longit_l&gt;0.))</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>        {</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>            longit_l -= M_PI;</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>        }</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>        Translation in to Python / pseudocode :</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>        tangent_relative_longitude =</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>            (</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>              - cos(half_pi - surface_tilt)         # cos(pi/2 - x) = sin(x)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>              * cos(half_pi + surface_orientation)  # cos(pi/2 + x) = -sin(x) #</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>            ) / (</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>              sin(latitude)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>              * cos(half_pi - surface_tilt)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>              * sin(half_pi + surface_orientation)  # sin(pi/2 + x) = cos(x)</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>              + cos(latitude)</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>              * sin(half_pi - surface_tilt)         # sin(pi/2 - x) = cos(x)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>            )</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>    As a consequence, PVGIS is like (note the positive numerator!) :</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>        tangent_relative_longitude =</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>            (</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>                sin(surface_tilt)</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>                * sin(surface_orientation)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>            ) / (</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>                sin(latitude)</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>                * sin(surface_tilt)</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>                * cos(surface_orientation)</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>                + cos(latitude)</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>                * cos(surface_tilt)</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>            )</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=c1># -----------------------------------------------------------------------</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>    <span class=c1># in PVGIS an extra minus sign results to an all positive numerator!</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=c1># tangent_relative_longitude_numerator = sin(surface_tilt.radians) * sin(</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>    <span class=c1>#     surface_orientation.radians</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>    <span class=c1># -----------------------------------------------------------------------</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=n>tangent_relative_longitude_numerator</span> <span class=o>=</span> <span class=o>-</span><span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>    <span class=p>)</span> <span class=o>*</span> <span class=o>-</span><span class=n>sin</span><span class=p>(</span>  <span class=c1># cos(pi/2 - surface_tilt.radians)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>        <span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>    <span class=p>)</span>  <span class=c1># cos(pi/2 + surface_orientation.radians)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=n>tangent_relative_longitude_denominator</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>        <span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=p>)</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span>  <span class=c1># cos(pi/2 - surface_tilt.radians)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>        <span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=p>)</span> <span class=o>+</span> <span class=n>cos</span><span class=p>(</span>  <span class=c1># sin(pi/2 + surface_orientation.radians)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>latitude</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>    <span class=p>)</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>        <span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=p>)</span>  <span class=c1># sin(pi/2 - surface_tilt.radians)</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>    <span class=c1># force dtype !</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>    <span class=n>relative_longitude</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>        <span class=p>[</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>            <span class=n>numpy</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>                <span class=n>tangent_relative_longitude_numerator</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>                <span class=o>/</span> <span class=n>tangent_relative_longitude_denominator</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=p>],</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>    <span class=k>if</span> <span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span> <span class=o>&lt;</span> <span class=n>pi</span> <span class=ow>and</span> <span class=n>relative_longitude</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>        <span class=n>relative_longitude</span> <span class=o>+=</span> <span class=n>pi</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>    <span class=k>if</span> <span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;</span> <span class=n>pi</span> <span class=ow>and</span> <span class=n>relative_longitude</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=n>relative_longitude</span> <span class=o>-=</span> <span class=n>pi</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>relative_longitude</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=k>return</span> <span class=n>RelativeLongitude</span><span class=p>(</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>relative_longitude</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.position.solar_incidence.calculate_solar_incidence_series_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_incidence_series_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.position.solar_incidence.calculate_solar_incidence_series_hofierka title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_incidence_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceOrientation>SurfaceOrientation</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceTilt>SurfaceTilt</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>=</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span><span class=p>(</span><span class=n><a class="autorefs autorefs-internal" href=../api/#pvgisprototype.api.datetime.now.now_utc_datetimezone title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">now_utc_datetimezone</span> (<code>pvgisprototype.api.datetime.now.now_utc_datetimezone</code>)'>now_utc_datetimezone</a></span><span class=p>()),</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ATMOSPHERIC_REFRACTION_FLAG_DEFAULT>ATMOSPHERIC_REFRACTION_FLAG_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>complementary_incidence_angle</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT>COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>zero_negative_solar_incidence_angle</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT>ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>solar_time_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarTimeModel>SolarTimeModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SolarTimeModel.milne>milne</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarIncidence>SolarIncidence</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the angle of incidence () between the direction of the sun ray and the line normal to the surface measured in radian.</p> <p> = acos( sin() * ( sin() * cos() + cos() * cos() * cos() * sin() ) + cos() * (cos() * cos() * cos() - sin() * cos() * sin()) + cos() * sin() * sin() * sin() )</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><span title=pvgisprototype.Latitude>Latitude</span></code> </td> <td> <div class=doc-md-description> <p>Latitude is the angle () between the sun's rays and its projection on the horizontal surface measured in radian.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>surface_tilt</code> </td> <td> <code><span title=pvgisprototype.SurfaceTilt>SurfaceTilt</span></code> </td> <td> <div class=doc-md-description> <p>Surface tilt or slope is the angle () between the inclined slope and the horizontal plane measured in radian.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_orientiation</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Surface orientation or azimuth is the angle () in the horizontal plane between the line due south and the horizontal projection of the normal to the inclined plane surface measured in radian.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>solar_incidence</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The angle of incidence () is the angle between the direction of the sun ray and the line normal to the surface measured in radian.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/position/solar_incidence.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=c1># @validate_with_pydantic(CalculateSolarIncidenceTimeSeriesPVISInputModel)</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_incidence_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n>SurfaceOrientation</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n>SurfaceTilt</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>now_utc_datetimezone</span><span class=p>()),</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>ATMOSPHERIC_REFRACTION_FLAG_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>    <span class=n>complementary_incidence_angle</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>    <span class=n>zero_negative_solar_incidence_angle</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=n>solar_time_model</span><span class=p>:</span> <span class=n>SolarTimeModel</span> <span class=o>=</span> <span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>milne</span><span class=p>,</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarIncidence</span><span class=p>:</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=w>    </span><span class=sd>"""Calculate the angle of incidence () between the direction of the sun</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a><span class=sd>    ray and the line normal to the surface measured in radian.</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a><span class=sd>     =</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a><span class=sd>    acos(</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a><span class=sd>         sin()</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a><span class=sd>         * (</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a><span class=sd>           sin() * cos() + cos() * cos() * cos() * sin()</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a><span class=sd>           )</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a><span class=sd>         + cos() * (cos() * cos() * cos() - sin() * cos() * sin())</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a><span class=sd>         + cos()</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a><span class=sd>         * sin()</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a><span class=sd>         * sin()</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a><span class=sd>         * sin()</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a><span class=sd>        )</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a><span class=sd>    latitude: float</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a><span class=sd>        Latitude is the angle () between the sun's rays and its projection on</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a><span class=sd>        the horizontal surface measured in radian.</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a><span class=sd>    surface_tilt: float</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a><span class=sd>        Surface tilt or slope is the angle () between the inclined slope and</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a><span class=sd>        the horizontal plane measured in radian.</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a><span class=sd>    surface_orientiation: float</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a><span class=sd>        Surface orientation or azimuth is the angle () in the horizontal plane</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a><span class=sd>        between the line due south and the horizontal projection of the normal</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a><span class=sd>        to the inclined plane surface measured in radian.</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a><span class=sd>    solar_incidence: float</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a><span class=sd>        The angle of incidence () is the angle between the direction of the</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a><span class=sd>        sun ray and the line normal to the surface measured in radian.</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>calculate_solar_declination_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>        <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>        <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=n>calculate_solar_hour_angle_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>    <span class=n>solar_altitude_series</span> <span class=o>=</span> <span class=n>calculate_solar_altitude_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>        <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>        <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>    <span class=n>sine_relative_inclined_latitude</span> <span class=o>=</span> <span class=o>-</span><span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>        <span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>    <span class=p>)</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span>  <span class=c1># cos(pi/2 - surface_tilt.radians)</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>        <span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>    <span class=p>)</span> <span class=o>+</span> <span class=n>sin</span><span class=p>(</span>  <span class=c1># sin(pi/2 + surface_orientation.radians)</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>        <span class=n>latitude</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>    <span class=p>)</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>        <span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>    <span class=p>)</span>  <span class=c1># sin(pi/2 - surface_tilt.radians)</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>    <span class=n>relative_inclined_latitude</span> <span class=o>=</span> <span class=n>asin</span><span class=p>(</span><span class=n>sine_relative_inclined_latitude</span><span class=p>)</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>    <span class=n>c_inclined_31_series</span> <span class=o>=</span> <span class=n>cos</span><span class=p>(</span><span class=n>relative_inclined_latitude</span><span class=p>)</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>        <span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>    <span class=n>c_inclined_33_series</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>relative_inclined_latitude</span><span class=p>)</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>        <span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>    <span class=n>relative_longitude</span> <span class=o>=</span> <span class=n>calculate_relative_longitude</span><span class=p>(</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>        <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>        <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>    <span class=n>sine_solar_incidence_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>        <span class=n>c_inclined_31_series</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a>        <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=o>-</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>-</span> <span class=n>relative_longitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a>        <span class=o>+</span> <span class=n>c_inclined_33_series</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>    <span class=n>solar_incidence_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>arcsin</span><span class=p>(</span><span class=n>sine_solar_incidence_series</span><span class=p>)</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>    <span class=n>incidence_angle_definition</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>definition_complementary</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a>    <span class=n>incidence_angle_description</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>description_complementary</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>complementary_incidence_angle</span><span class=p>:</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a>            <span class=sa>f</span><span class=s2>":information: Converting solar incidence angle to </span><span class=si>{</span><span class=n>COMPLEMENTARY_INCIDENCE_ANGLE_DEFINITION</span><span class=si>}</span><span class=s2>..."</span><span class=p>,</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a>            <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>":information: [bold][magenta]Converting[/magenta] solar incidence angle to </span><span class=si>{</span><span class=n>COMPLEMENTARY_INCIDENCE_ANGLE_DEFINITION</span><span class=si>}</span><span class=s2>[/bold]..."</span><span class=p>,</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>        <span class=n>solar_incidence_series</span> <span class=o>=</span> <span class=p>(</span><span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span> <span class=o>-</span> <span class=n>solar_incidence_series</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>        <span class=n>incidence_angle_definition</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>definition</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>        <span class=n>incidence_angle_description</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>description</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>    <span class=c1># set negative or below horizon angles to 0 !</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>    <span class=k>if</span> <span class=n>zero_negative_solar_incidence_angle</span><span class=p>:</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a>        <span class=n>solar_incidence_series</span><span class=p>[</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a>            <span class=p>(</span><span class=n>solar_incidence_series</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>        <span class=p>]</span> <span class=o>=</span> <span class=n>NO_SOLAR_INCIDENCE</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><a href=#__codelineno-0-328><span class=linenos data-linenos="328 "></span></a>    <span class=k>return</span> <span class=n>SolarIncidence</span><span class=p>(</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>  <span class=c1>#</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>  <span class=c1>#</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a>        <span class=n>incidence_algorithm</span><span class=o>=</span><span class=n>SolarIncidenceModel</span><span class=o>.</span><span class=n>hofierka</span><span class=p>,</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a>        <span class=n>definition</span><span class=o>=</span><span class=n>incidence_angle_definition</span><span class=p>,</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a>        <span class=n>description</span><span class=o>=</span><span class=n>incidence_angle_description</span><span class=p>,</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a>        <span class=c1># azimuth_origin=solar_azimuth_series.origin,</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.power> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">power</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.power title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.power.calculate_spectral_photovoltaic_power_output title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_spectral_photovoltaic_power_output</span> (<code>pvgisprototype.algorithms.hofierka.power.calculate_spectral_photovoltaic_power_output</code>)'>calculate_spectral_photovoltaic_power_output</a></code></td> <td> <div class=doc-md-description> <p>Calculate the photovoltaic power output over a location (latitude), surface</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.power.calculate_spectrally_resolved_global_inclined_irradiance_series title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_spectrally_resolved_global_inclined_irradiance_series</span> (<code>pvgisprototype.algorithms.hofierka.power.calculate_spectrally_resolved_global_inclined_irradiance_series</code>)'>calculate_spectrally_resolved_global_inclined_irradiance_series</a></code></td> <td> <div class=doc-md-description> <p>Calculate the photovoltaic power output over a location (latitude), surface</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.power.calculate_spectral_photovoltaic_power_output> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_spectral_photovoltaic_power_output</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.power.calculate_spectral_photovoltaic_power_output title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_spectral_photovoltaic_power_output</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>elevation</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/datetime.html#datetime.datetime title="<code>datetime.datetime</code>">datetime</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>spectrally_resolved_global_horizontal_irradiance_series</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>        <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/pathlib.html#pathlib.Path title="<code>pathlib.Path</code>">Path</a></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=p>)</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>spectrally_resolved_direct_horizontal_irradiance_series</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/pathlib.html#pathlib.Path title="<code>pathlib.Path</code>">Path</a></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=p>)</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>number_of_junctions</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>spectral_response_data</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/pathlib.html#pathlib.Path title="<code>pathlib.Path</code>">Path</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>standard_conditions_response</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/pathlib.html#pathlib.Path title="<code>pathlib.Path</code>">Path</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>temperature_series</span><span class=p>:</span> <span class=n><span title=numpy.ndarray>ndarray</span></span> <span class=o>=</span> <span class=n><span title=numpy.array>array</span></span><span class=p>(</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>        <span class=n><span title=average_air_temperature>average_air_temperature</span></span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=p>),</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=n>wind_speed_series</span><span class=p>:</span> <span class=n><span title=numpy.ndarray>ndarray</span></span> <span class=o>=</span> <span class=n><span title=numpy.array>array</span></span><span class=p>(</span><span class=n><span title=pvgisprototype.constants.WIND_SPEED_DEFAULT>WIND_SPEED_DEFAULT</span></span><span class=p>),</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=n>mask_and_scale</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=n>neighbor_lookup</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.irradiance.models.MethodForInexactMatches>MethodForInexactMatches</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>tolerance</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.TOLERANCE_DEFAULT>TOLERANCE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=n>in_memory</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a>        <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=p>)</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>(),</span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=n>albedo</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ALBEDO_DEFAULT>ALBEDO_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a>    <span class=n>apply_angular_loss_factor</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=n>solar_position_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarPositionModel>SolarPositionModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SOLAR_POSITION_ALGORITHM_DEFAULT>SOLAR_POSITION_ALGORITHM_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-33><a href=#__codelineno-0-33 id=__codelineno-0-33 name=__codelineno-0-33></a>    <span class=n>solar_incidence_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarIncidenceModel>SolarIncidenceModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SolarIncidenceModel.jenco>jenco</span></span><span class=p>,</span>
</span><span id=__span-0-34><a href=#__codelineno-0-34 id=__codelineno-0-34 name=__codelineno-0-34></a>    <span class=n>solar_time_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarTimeModel>SolarTimeModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SOLAR_TIME_ALGORITHM_DEFAULT>SOLAR_TIME_ALGORITHM_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-35><a href=#__codelineno-0-35 id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></span><span class=p>,</span>
</span><span id=__span-0-36><a href=#__codelineno-0-36 id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-37><a href=#__codelineno-0-37 id=__codelineno-0-37 name=__codelineno-0-37></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-38><a href=#__codelineno-0-38 id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=n>time_output_units</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.MINUTES>MINUTES</span></span><span class=p>,</span>
</span><span id=__span-0-39><a href=#__codelineno-0-39 id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=n>angle_units</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.RADIANS>RADIANS</span></span><span class=p>,</span>
</span><span id=__span-0-40><a href=#__codelineno-0-40 id=__codelineno-0-40 name=__codelineno-0-40></a>    <span class=n>angle_output_units</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.RADIANS>RADIANS</span></span><span class=p>,</span>
</span><span id=__span-0-41><a href=#__codelineno-0-41 id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=n>system_efficiency</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-42><a href=#__codelineno-0-42 id=__codelineno-0-42 name=__codelineno-0-42></a>        <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-43><a href=#__codelineno-0-43 id=__codelineno-0-43 name=__codelineno-0-43></a>    <span class=p>)</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SYSTEM_EFFICIENCY_DEFAULT>SYSTEM_EFFICIENCY_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-44><a href=#__codelineno-0-44 id=__codelineno-0-44 name=__codelineno-0-44></a>    <span class=n>power_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.algorithms.huld.models.PhotovoltaicModulePerformanceModel>PhotovoltaicModulePerformanceModel</span></span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-45><a href=#__codelineno-0-45 id=__codelineno-0-45 name=__codelineno-0-45></a>    <span class=n>temperature_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.irradiance.models.ModuleTemperatureAlgorithm>ModuleTemperatureAlgorithm</span></span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-46><a href=#__codelineno-0-46 id=__codelineno-0-46 name=__codelineno-0-46></a>    <span class=n>efficiency</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-47><a href=#__codelineno-0-47 id=__codelineno-0-47 name=__codelineno-0-47></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-48><a href=#__codelineno-0-48 id=__codelineno-0-48 name=__codelineno-0-48></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the photovoltaic power output over a location (latitude), surface and atmospheric conditions, and an arbitrary period of time based on spectrally resolved direct (beam), diffuse, reflected solar irradiation and ambient temperature to account for the varying effects of the solar spectrum. Considering shadowing effects of the local topography are optionally incorporated. The solar geometry relevant parameters (e.g.sunrise and sunset, declination, extraterrestrial irradiance, daylight length) can be optionally saved in a file.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/power.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_spectral_photovoltaic_power_output</span><span class=p>(</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>    <span class=n>elevation</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>datetime</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>    <span class=n>spectrally_resolved_global_horizontal_irradiance_series</span><span class=p>:</span> <span class=n>Path</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>  <span class=c1># global_spectral_radiation,  # g_rad_spec</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>    <span class=n>spectrally_resolved_direct_horizontal_irradiance_series</span><span class=p>:</span> <span class=n>Path</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>  <span class=c1># direct_spectral_radiation,  # d_rad_spec,</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>    <span class=n>number_of_junctions</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a>    <span class=n>spectral_response_data</span><span class=p>:</span> <span class=n>Path</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a>    <span class=n>standard_conditions_response</span><span class=p>:</span> <span class=n>Path</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>  <span class=c1>#: float = 1,  # STCresponse : read from external data</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>    <span class=c1># extraterrestrial_normal_irradiance_series,  # spectral_ext,</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a>    <span class=n>temperature_series</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>TemperatureSeries</span><span class=p>()</span><span class=o>.</span><span class=n>average_air_temperature</span><span class=p>),</span>  <span class=c1># pres_temperature ?</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a>    <span class=n>wind_speed_series</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>WIND_SPEED_DEFAULT</span><span class=p>),</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a>    <span class=n>mask_and_scale</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a>    <span class=n>neighbor_lookup</span><span class=p>:</span> <span class=n>MethodForInexactMatches</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a>    <span class=n>tolerance</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>TOLERANCE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>    <span class=n>in_memory</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(),</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><a href=#__codelineno-0-328><span class=linenos data-linenos="328 "></span></a>    <span class=c1># unrefracted_solar_zenith: UnrefractedSolarZenith | None = UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT,</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a>    <span class=n>albedo</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>ALBEDO_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a>    <span class=n>apply_angular_loss_factor</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a>    <span class=n>solar_position_model</span><span class=p>:</span> <span class=n>SolarPositionModel</span> <span class=o>=</span> <span class=n>SOLAR_POSITION_ALGORITHM_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a>    <span class=n>solar_incidence_model</span><span class=p>:</span> <span class=n>SolarIncidenceModel</span> <span class=o>=</span> <span class=n>SolarIncidenceModel</span><span class=o>.</span><span class=n>jenco</span><span class=p>,</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a>    <span class=n>solar_time_model</span><span class=p>:</span> <span class=n>SolarTimeModel</span> <span class=o>=</span> <span class=n>SOLAR_TIME_ALGORITHM_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SOLAR_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a>    <span class=c1># module_temperature,</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><a href=#__codelineno-0-338><span class=linenos data-linenos="338 "></span></a>    <span class=c1># horizonpointer,</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><a href=#__codelineno-0-339><span class=linenos data-linenos="339 "></span></a>    <span class=n>time_output_units</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>MINUTES</span><span class=p>,</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><a href=#__codelineno-0-340><span class=linenos data-linenos="340 "></span></a>    <span class=n>angle_units</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><a href=#__codelineno-0-341><span class=linenos data-linenos="341 "></span></a>    <span class=n>angle_output_units</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><a href=#__codelineno-0-342><span class=linenos data-linenos="342 "></span></a>    <span class=n>system_efficiency</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>SYSTEM_EFFICIENCY_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><a href=#__codelineno-0-343><span class=linenos data-linenos="343 "></span></a>    <span class=n>power_model</span><span class=p>:</span> <span class=n>PhotovoltaicModulePerformanceModel</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><a href=#__codelineno-0-344><span class=linenos data-linenos="344 "></span></a>    <span class=n>temperature_model</span><span class=p>:</span> <span class=n>ModuleTemperatureAlgorithm</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><a href=#__codelineno-0-345><span class=linenos data-linenos="345 "></span></a>    <span class=n>efficiency</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><a href=#__codelineno-0-346><span class=linenos data-linenos="346 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><a href=#__codelineno-0-347><span class=linenos data-linenos="347 "></span></a><span class=p>):</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><a href=#__codelineno-0-348><span class=linenos data-linenos="348 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><a href=#__codelineno-0-349><span class=linenos data-linenos="349 "></span></a><span class=sd>    Calculate the photovoltaic power output over a location (latitude), surface</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><a href=#__codelineno-0-350><span class=linenos data-linenos="350 "></span></a><span class=sd>    and atmospheric conditions, and an arbitrary period of time based on</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><a href=#__codelineno-0-351><span class=linenos data-linenos="351 "></span></a><span class=sd>    spectrally resolved direct (beam), diffuse, reflected solar irradiation and</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><a href=#__codelineno-0-352><span class=linenos data-linenos="352 "></span></a><span class=sd>    ambient temperature to account for the varying effects of the solar</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><a href=#__codelineno-0-353><span class=linenos data-linenos="353 "></span></a><span class=sd>    spectrum. Considering shadowing effects of the local topography are</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><a href=#__codelineno-0-354><span class=linenos data-linenos="354 "></span></a><span class=sd>    optionally incorporated. The solar geometry relevant parameters</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><a href=#__codelineno-0-355><span class=linenos data-linenos="355 "></span></a><span class=sd>    (e.g.sunrise and sunset, declination, extraterrestrial irradiance, daylight</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><a href=#__codelineno-0-356><span class=linenos data-linenos="356 "></span></a><span class=sd>    length) can be optionally saved in a file.</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><a href=#__codelineno-0-357><span class=linenos data-linenos="357 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><a href=#__codelineno-0-358><span class=linenos data-linenos="358 "></span></a>    <span class=n>spectrally_resolved_global_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_spectrally_resolved_global_inclined_irradiance_series</span><span class=p>(</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><a href=#__codelineno-0-359><span class=linenos data-linenos="359 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><a href=#__codelineno-0-360><span class=linenos data-linenos="360 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><a href=#__codelineno-0-361><span class=linenos data-linenos="361 "></span></a>        <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><a href=#__codelineno-0-362><span class=linenos data-linenos="362 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><a href=#__codelineno-0-363><span class=linenos data-linenos="363 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a><a href=#__codelineno-0-364><span class=linenos data-linenos="364 "></span></a>        <span class=n>spectrally_resolved_global_horizontal_irradiance_series</span><span class=o>=</span><span class=n>spectrally_resolved_global_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><a href=#__codelineno-0-365><span class=linenos data-linenos="365 "></span></a>        <span class=n>spectrally_resolved_direct_horizontal_irradiance_series</span><span class=o>=</span><span class=n>spectrally_resolved_direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><a href=#__codelineno-0-366><span class=linenos data-linenos="366 "></span></a>        <span class=n>mask_and_scale</span><span class=o>=</span><span class=n>mask_and_scale</span><span class=p>,</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><a href=#__codelineno-0-367><span class=linenos data-linenos="367 "></span></a>        <span class=n>neighbor_lookup</span><span class=o>=</span><span class=n>neighbor_lookup</span><span class=p>,</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><a href=#__codelineno-0-368><span class=linenos data-linenos="368 "></span></a>        <span class=n>tolerance</span><span class=o>=</span><span class=n>tolerance</span><span class=p>,</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><a href=#__codelineno-0-369><span class=linenos data-linenos="369 "></span></a>        <span class=n>in_memory</span><span class=o>=</span><span class=n>in_memory</span><span class=p>,</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><a href=#__codelineno-0-370><span class=linenos data-linenos="370 "></span></a>        <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><a href=#__codelineno-0-371><span class=linenos data-linenos="371 "></span></a>        <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><a href=#__codelineno-0-372><span class=linenos data-linenos="372 "></span></a>        <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><a href=#__codelineno-0-373><span class=linenos data-linenos="373 "></span></a>        <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><a href=#__codelineno-0-374><span class=linenos data-linenos="374 "></span></a>        <span class=c1># unrefracted_solar_zenith=unrefracted_solar_zenith,</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><a href=#__codelineno-0-375><span class=linenos data-linenos="375 "></span></a>        <span class=n>albedo</span><span class=o>=</span><span class=n>albedo</span><span class=p>,</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><a href=#__codelineno-0-376><span class=linenos data-linenos="376 "></span></a>        <span class=n>apply_angular_loss_factor</span><span class=o>=</span><span class=n>apply_angular_loss_factor</span><span class=p>,</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><a href=#__codelineno-0-377><span class=linenos data-linenos="377 "></span></a>        <span class=n>solar_position_model</span><span class=o>=</span><span class=n>solar_position_model</span><span class=p>,</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><a href=#__codelineno-0-378><span class=linenos data-linenos="378 "></span></a>        <span class=n>solar_incidence_model</span><span class=o>=</span><span class=n>solar_incidence_model</span><span class=p>,</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><a href=#__codelineno-0-379><span class=linenos data-linenos="379 "></span></a>        <span class=n>solar_time_model</span><span class=o>=</span><span class=n>solar_time_model</span><span class=p>,</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><a href=#__codelineno-0-380><span class=linenos data-linenos="380 "></span></a>        <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><a href=#__codelineno-0-381><span class=linenos data-linenos="381 "></span></a>        <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><a href=#__codelineno-0-382><span class=linenos data-linenos="382 "></span></a>        <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><a href=#__codelineno-0-383><span class=linenos data-linenos="383 "></span></a>        <span class=n>time_output_units</span><span class=o>=</span><span class=n>time_output_units</span><span class=p>,</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><a href=#__codelineno-0-384><span class=linenos data-linenos="384 "></span></a>        <span class=n>angle_units</span><span class=o>=</span><span class=n>angle_units</span><span class=p>,</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><a href=#__codelineno-0-385><span class=linenos data-linenos="385 "></span></a>        <span class=n>angle_output_units</span><span class=o>=</span><span class=n>angle_output_units</span><span class=p>,</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><a href=#__codelineno-0-386><span class=linenos data-linenos="386 "></span></a>        <span class=n>system_efficiency</span><span class=o>=</span><span class=n>system_efficiency</span><span class=p>,</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><a href=#__codelineno-0-387><span class=linenos data-linenos="387 "></span></a>        <span class=n>power_model</span><span class=o>=</span><span class=n>power_model</span><span class=p>,</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a><a href=#__codelineno-0-388><span class=linenos data-linenos="388 "></span></a>        <span class=n>temperature_model</span><span class=o>=</span><span class=n>temperature_model</span><span class=p>,</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a><a href=#__codelineno-0-389><span class=linenos data-linenos="389 "></span></a>        <span class=n>efficiency</span><span class=o>=</span><span class=n>efficiency</span><span class=p>,</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a><a href=#__codelineno-0-390><span class=linenos data-linenos="390 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><a href=#__codelineno-0-391><span class=linenos data-linenos="391 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a><a href=#__codelineno-0-392><span class=linenos data-linenos="392 "></span></a>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><a href=#__codelineno-0-393><span class=linenos data-linenos="393 "></span></a>    <span class=c1># In PVGIS' source code :</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a><a href=#__codelineno-0-394><span class=linenos data-linenos="394 "></span></a>    <span class=c1># if spectral_band_number &lt; 19:</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><a href=#__codelineno-0-395><span class=linenos data-linenos="395 "></span></a>    <span class=c1># global_power_1050 += global_spectral_power[spectral_band_number]</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><a href=#__codelineno-0-396><span class=linenos data-linenos="396 "></span></a>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><a href=#__codelineno-0-397><span class=linenos data-linenos="397 "></span></a>    <span class=n>index_1050</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>BAND_LIMITS</span> <span class=o>&lt;</span> <span class=mi>1050</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><a href=#__codelineno-0-398><span class=linenos data-linenos="398 "></span></a>    <span class=n>global_irradiance_series_up_to_1050</span> <span class=o>=</span> <span class=n>spectrally_resolved_global_irradiance_series</span><span class=p>[</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><a href=#__codelineno-0-399><span class=linenos data-linenos="399 "></span></a>        <span class=p>:,</span> <span class=n>index_1050</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><a href=#__codelineno-0-400><span class=linenos data-linenos="400 "></span></a>    <span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><a href=#__codelineno-0-401><span class=linenos data-linenos="401 "></span></a>    <span class=n>bandwidths</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>diff</span><span class=p>(</span><span class=n>BAND_LIMITS</span><span class=p>)</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><a href=#__codelineno-0-402><span class=linenos data-linenos="402 "></span></a>    <span class=n>spectral_power_density_up_to_1050</span> <span class=o>=</span> <span class=n>global_irradiance_series_up_to_1050</span> <span class=o>/</span> <span class=n>bandwidths</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><a href=#__codelineno-0-403><span class=linenos data-linenos="403 "></span></a>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><a href=#__codelineno-0-404><span class=linenos data-linenos="404 "></span></a>    <span class=n>spectral_response_data</span> <span class=o>=</span> <span class=n>read_spectral_response</span><span class=p>(</span><span class=n>spectral_response_data</span><span class=p>)</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><a href=#__codelineno-0-405><span class=linenos data-linenos="405 "></span></a>    <span class=n>spectral_response_wavelengths</span> <span class=o>=</span> <span class=n>spectral_response_data</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># response_wavelengths,</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><a href=#__codelineno-0-406><span class=linenos data-linenos="406 "></span></a>    <span class=n>spectral_response</span> <span class=o>=</span> <span class=n>spectral_response_data</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><a href=#__codelineno-0-407><span class=linenos data-linenos="407 "></span></a>    <span class=n>standard_conditions_response</span> <span class=o>=</span> <span class=n>spectral_response_data</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>  <span class=c1># STCresponse</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><a href=#__codelineno-0-408><span class=linenos data-linenos="408 "></span></a>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a><a href=#__codelineno-0-409><span class=linenos data-linenos="409 "></span></a>    <span class=n>spectral_factor</span> <span class=o>=</span> <span class=n>calculate_spectral_factor</span><span class=p>(</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><a href=#__codelineno-0-410><span class=linenos data-linenos="410 "></span></a>        <span class=n>global_total_power</span><span class=o>=</span><span class=n>spectrally_resolved_global_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><a href=#__codelineno-0-411><span class=linenos data-linenos="411 "></span></a>        <span class=n>spectral_power_density</span><span class=o>=</span><span class=n>spectral_power_density_up_to_1050</span><span class=p>,</span>  <span class=c1># !</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><a href=#__codelineno-0-412><span class=linenos data-linenos="412 "></span></a>        <span class=n>number_of_junctions</span><span class=o>=</span><span class=n>number_of_junctions</span><span class=p>,</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a><a href=#__codelineno-0-413><span class=linenos data-linenos="413 "></span></a>        <span class=n>response_wavelengths</span><span class=o>=</span><span class=n>spectral_response_wavelengths</span><span class=p>,</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a><a href=#__codelineno-0-414><span class=linenos data-linenos="414 "></span></a>        <span class=n>spectral_response</span><span class=o>=</span><span class=n>spectral_response</span><span class=p>,</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a><a href=#__codelineno-0-415><span class=linenos data-linenos="415 "></span></a>        <span class=n>standard_conditions_response</span><span class=o>=</span><span class=n>standard_conditions_response</span><span class=p>,</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a><a href=#__codelineno-0-416><span class=linenos data-linenos="416 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a><a href=#__codelineno-0-417><span class=linenos data-linenos="417 "></span></a>    <span class=n>spectrally_resolved_photovoltaic_power</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a><a href=#__codelineno-0-418><span class=linenos data-linenos="418 "></span></a>        <span class=n>spectrally_resolved_global_irradiance_series</span> <span class=o>*</span> <span class=n>spectral_factor</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a><a href=#__codelineno-0-419><span class=linenos data-linenos="419 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a><a href=#__codelineno-0-420><span class=linenos data-linenos="420 "></span></a>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a><a href=#__codelineno-0-421><span class=linenos data-linenos="421 "></span></a>    <span class=k>if</span> <span class=n>efficiency</span><span class=p>:</span>  <span class=c1># user-set</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a><a href=#__codelineno-0-422><span class=linenos data-linenos="422 "></span></a>        <span class=n>efficiency_coefficient_series</span> <span class=o>=</span> <span class=n>calculate_photovoltaic_efficiency_series</span><span class=p>(</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a><a href=#__codelineno-0-423><span class=linenos data-linenos="423 "></span></a>            <span class=n>irradiance_series</span><span class=o>=</span><span class=n>spectrally_resolved_global_irradiance_series</span><span class=p>,</span>  <span class=c1># global_total_power,</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a><a href=#__codelineno-0-424><span class=linenos data-linenos="424 "></span></a>            <span class=n>spectrally_factor</span><span class=o>=</span><span class=n>spectral_factor</span><span class=p>,</span>  <span class=c1># internally will do *= global_total_power</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><a href=#__codelineno-0-425><span class=linenos data-linenos="425 "></span></a>            <span class=n>temperature_series</span><span class=o>=</span><span class=n>temperature_series</span><span class=p>,</span>  <span class=c1># pres_temperature,</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><a href=#__codelineno-0-426><span class=linenos data-linenos="426 "></span></a>            <span class=n>model_constants</span><span class=o>=</span><span class=n>EFFICIENCY_MODEL_COEFFICIENTS_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a><a href=#__codelineno-0-427><span class=linenos data-linenos="427 "></span></a>            <span class=n>standard_test_temperature</span><span class=o>=</span><span class=n>TemperatureSeries</span><span class=p>()</span><span class=o>.</span><span class=n>average_air_temperature</span><span class=p>,</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a><a href=#__codelineno-0-428><span class=linenos data-linenos="428 "></span></a>            <span class=n>wind_speed_series</span><span class=o>=</span><span class=n>wind_speed_series</span><span class=p>,</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a><a href=#__codelineno-0-429><span class=linenos data-linenos="429 "></span></a>            <span class=n>power_model</span><span class=o>=</span><span class=n>power_model</span><span class=p>,</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a><a href=#__codelineno-0-430><span class=linenos data-linenos="430 "></span></a>            <span class=n>temperature_model</span><span class=o>=</span><span class=n>temperature_model</span><span class=p>,</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a><a href=#__codelineno-0-431><span class=linenos data-linenos="431 "></span></a>            <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>  <span class=c1># no verbosity here by choice!</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a><a href=#__codelineno-0-432><span class=linenos data-linenos="432 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a><a href=#__codelineno-0-433><span class=linenos data-linenos="433 "></span></a>        <span class=n>spectrally_resolved_photovoltaic_power</span> <span class=o>*=</span> <span class=n>efficiency_coefficient_series</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><a href=#__codelineno-0-434><span class=linenos data-linenos="434 "></span></a>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a><a href=#__codelineno-0-435><span class=linenos data-linenos="435 "></span></a>    <span class=k>return</span> <span class=n>spectrally_resolved_photovoltaic_power</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.power.calculate_spectrally_resolved_global_inclined_irradiance_series> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_spectrally_resolved_global_inclined_irradiance_series</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.power.calculate_spectrally_resolved_global_inclined_irradiance_series title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_spectrally_resolved_global_inclined_irradiance_series</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>elevation</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/datetime.html#datetime.datetime title="<code>datetime.datetime</code>">datetime</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>spectrally_resolved_global_horizontal_irradiance_series</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>        <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/pathlib.html#pathlib.Path title="<code>pathlib.Path</code>">Path</a></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=p>)</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>spectrally_resolved_direct_horizontal_irradiance_series</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/pathlib.html#pathlib.Path title="<code>pathlib.Path</code>">Path</a></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=p>)</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>mask_and_scale</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>neighbor_lookup</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.irradiance.models.MethodForInexactMatches>MethodForInexactMatches</span></span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>tolerance</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.TOLERANCE_DEFAULT>TOLERANCE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>in_memory</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>        <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=p>)</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>(),</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=n>albedo</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ALBEDO_DEFAULT>ALBEDO_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>apply_angular_loss_factor</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>solar_position_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarPositionModel>SolarPositionModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SOLAR_POSITION_ALGORITHM_DEFAULT>SOLAR_POSITION_ALGORITHM_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>solar_incidence_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarIncidenceModel>SolarIncidenceModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SolarIncidenceModel.jenco>jenco</span></span><span class=p>,</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=n>solar_time_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarTimeModel>SolarTimeModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SOLAR_TIME_ALGORITHM_DEFAULT>SOLAR_TIME_ALGORITHM_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></span><span class=p>,</span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a>    <span class=n>time_output_units</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.MINUTES>MINUTES</span></span><span class=p>,</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=n>angle_units</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.RADIANS>RADIANS</span></span><span class=p>,</span>
</span><span id=__span-0-33><a href=#__codelineno-0-33 id=__codelineno-0-33 name=__codelineno-0-33></a>    <span class=n>angle_output_units</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.RADIANS>RADIANS</span></span><span class=p>,</span>
</span><span id=__span-0-34><a href=#__codelineno-0-34 id=__codelineno-0-34 name=__codelineno-0-34></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-35><a href=#__codelineno-0-35 id=__codelineno-0-35 name=__codelineno-0-35></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the photovoltaic power output over a location (latitude), surface and atmospheric conditions, and an arbitrary period of time based on spectrally resolved direct (beam), diffuse, reflected solar irradiation and ambient temperature to account for the varying effects of the solar spectrum. Considering shadowing effects of the local topography are optionally incorporated. The solar geometry relevant parameters (e.g.sunrise and sunset, declination, extraterrestrial irradiance, daylight length) can be optionally saved in a file.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/power.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_spectrally_resolved_global_inclined_irradiance_series</span><span class=p>(</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>    <span class=n>elevation</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>datetime</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>    <span class=n>spectrally_resolved_global_horizontal_irradiance_series</span><span class=p>:</span> <span class=n>Path</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>  <span class=c1># global_spectral_radiation,  # g_rad_spec</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>    <span class=n>spectrally_resolved_direct_horizontal_irradiance_series</span><span class=p>:</span> <span class=n>Path</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>  <span class=c1># direct_spectral_radiation,  # d_rad_spec,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=n>mask_and_scale</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=n>neighbor_lookup</span><span class=p>:</span> <span class=n>MethodForInexactMatches</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=n>tolerance</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>TOLERANCE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>    <span class=n>in_memory</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(),</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>    <span class=c1># unrefracted_solar_zenith: UnrefractedSolarZenith | None = UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>    <span class=n>albedo</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>ALBEDO_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=n>apply_angular_loss_factor</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>    <span class=n>solar_position_model</span><span class=p>:</span> <span class=n>SolarPositionModel</span> <span class=o>=</span> <span class=n>SOLAR_POSITION_ALGORITHM_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=n>solar_incidence_model</span><span class=p>:</span> <span class=n>SolarIncidenceModel</span> <span class=o>=</span> <span class=n>SolarIncidenceModel</span><span class=o>.</span><span class=n>jenco</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=n>solar_time_model</span><span class=p>:</span> <span class=n>SolarTimeModel</span> <span class=o>=</span> <span class=n>SOLAR_TIME_ALGORITHM_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SOLAR_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>    <span class=c1># module_temperature,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=c1># horizonpointer,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=n>time_output_units</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>MINUTES</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=n>angle_units</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=n>angle_output_units</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=p>):</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    Calculate the photovoltaic power output over a location (latitude), surface</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    and atmospheric conditions, and an arbitrary period of time based on</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>    spectrally resolved direct (beam), diffuse, reflected solar irradiation and</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    ambient temperature to account for the varying effects of the solar</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>    spectrum. Considering shadowing effects of the local topography are</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>    optionally incorporated. The solar geometry relevant parameters</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>    (e.g.sunrise and sunset, declination, extraterrestrial irradiance, daylight</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>    length) can be optionally saved in a file.</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=c1># Initialize arrays ?</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>spectrally_resolved_direct_irradiance_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=n>spectrally_resolved_global_horizontal_irradiance_series</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=n>spectrally_resolved_diffuse_irradiance_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=n>spectrally_resolved_global_horizontal_irradiance_series</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=n>spectrally_resolved_reflected_irradiance_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=n>spectrally_resolved_global_horizontal_irradiance_series</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>    <span class=c1># In r.pv_spec : s0 = lumcline2()</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>    <span class=n>solar_incidence_series</span> <span class=o>=</span> <span class=n>model_solar_incidence_series</span><span class=p>(</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=n>solar_incidence_model</span><span class=o>=</span><span class=n>solar_incidence_model</span><span class=p>,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=n>time_output_units</span><span class=o>=</span><span class=n>time_output_units</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=n>angle_units</span><span class=o>=</span><span class=n>angle_units</span><span class=p>,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=n>solar_altitude_series</span> <span class=o>=</span> <span class=n>model_solar_altitude_series</span><span class=p>(</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>solar_position_model</span><span class=o>=</span><span class=n>solar_position_model</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=c1># unrefracted_solar_zenith=unrefracted_solar_zenith,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=n>solar_time_model</span><span class=o>=</span><span class=n>solar_time_model</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=n>time_output_units</span><span class=o>=</span><span class=n>time_output_units</span><span class=p>,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=n>angle_units</span><span class=o>=</span><span class=n>angle_units</span><span class=p>,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>    <span class=n>sun_above_horizon</span> <span class=o>=</span> <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&gt;</span> <span class=mi>0</span>  <span class=c1># or : .radians ?</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>    <span class=n>positive_solar_incidence</span> <span class=o>=</span> <span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=n>surface_in_shade</span> <span class=o>=</span> <span class=n>is_surface_in_shade_series</span><span class=p>(</span><span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=n>surface_not_in_shade</span> <span class=o>=</span> <span class=o>~</span><span class=n>surface_in_shade</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=n>positive_solar_incidence_and_surface_not_in_shade</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>logical_and</span><span class=p>(</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>        <span class=n>positive_solar_incidence</span><span class=p>,</span> <span class=n>surface_not_in_shade</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>sun_above_horizon</span><span class=p>):</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>        <span class=n>spectrally_resolved_global_irradiance_series</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>    <span class=k>else</span><span class=p>:</span>  <span class=c1># if np.any(positive_solar_altitude)</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=c1># We don't need a for loop! ==========================================</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>        <span class=c1># for spectral_band_number in range(1, number_of_spectral_bands + 1):</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>        <span class=c1># We don't need a for loop! ==========================================</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=c1># The following stems from PVGIS' C/C++ source code ==================</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=c1># Is it necessary ?</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=c1># Is it possible for the direct component to be greater than the global one ?</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=c1># Does it imply issues in the input data ?</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=n>spectrally_resolved_global_horizontal_irradiance_series</span><span class=p>[</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>            <span class=n>spectrally_resolved_global_horizontal_irradiance_series</span> <span class=o>&lt;</span> <span class=mi>0</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>        <span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=n>spectrally_resolved_direct_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>minimum</span><span class=p>(</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>            <span class=n>spectrally_resolved_global_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>            <span class=n>spectrally_resolved_direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=c1># Above stems from PVGIS' C/C++ source code =========================</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>            <span class=n>positive_solar_incidence_and_surface_not_in_shade</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>        <span class=p>):</span>  <span class=c1># get the direct irradiance</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>            <span class=n>spectrally_resolved_direct_irradiance_series</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>            <span class=n>spectrally_resolved_direct_horizontal_irradiance_series</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>            <span class=c1># sunRadVar["cbh"] = global_spectral_radiation[spectral_band_number]</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>            <span class=c1># sunRadVar["cdh"] = direct_spectral_radiation[spectral_band_number]</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>            <span class=c1># extraterrestrial_normal_irradiance_series = EXTRATERRESTRIAL_NORMAL_IRRADIANCE[spectral_band_number]</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>            <span class=c1># extraterrestrial_normal_irradiance_series = (</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>            <span class=c1>#     calculate_extraterrestrial_normal_irradiance_series(</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>            <span class=c1>#         timestamps=timestamps,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>            <span class=c1>#         solar_constant=solar_constant,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>            <span class=c1>#         eccentricity_phase_offset=eccentricity_phase_offset,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>            <span class=c1>#         eccentricity_amplitude=eccentricity_amplitude,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>            <span class=c1>#     )</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>            <span class=c1># )</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>            <span class=c1># following is in r.pv_spec : `ra`</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>            <span class=n>spectrally_resolved_direct_irradiance_series</span><span class=p>[</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>                <span class=n>positive_solar_incidence_and_surface_not_in_shade</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>            <span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>                <span class=n>calculate_direct_inclined_irradiance</span><span class=p>(</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>                    <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>                    <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>                    <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>                    <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>                    <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>                    <span class=n>direct_horizontal_component</span><span class=o>=</span><span class=n>spectrally_resolved_direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>                    <span class=n>mask_and_scale</span><span class=o>=</span><span class=n>mask_and_scale</span><span class=p>,</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>                    <span class=n>neighbor_lookup</span><span class=o>=</span><span class=n>neighbor_lookup</span><span class=p>,</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>                    <span class=n>tolerance</span><span class=o>=</span><span class=n>tolerance</span><span class=p>,</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>                    <span class=n>in_memory</span><span class=o>=</span><span class=n>in_memory</span><span class=p>,</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>                    <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>                    <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>                    <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>                    <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>                    <span class=c1># unrefracted_solar_zenith=unrefracted_solar_zenith,</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>                    <span class=n>apply_angular_loss_factor</span><span class=o>=</span><span class=n>apply_angular_loss_factor</span><span class=p>,</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>                    <span class=n>solar_position_model</span><span class=o>=</span><span class=n>solar_position_model</span><span class=p>,</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>                    <span class=n>solar_incidence_model</span><span class=o>=</span><span class=n>solar_incidence_model</span><span class=p>,</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>                    <span class=n>solar_time_model</span><span class=o>=</span><span class=n>solar_time_model</span><span class=p>,</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>                    <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>                    <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>                    <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>                    <span class=n>time_output_units</span><span class=o>=</span><span class=n>time_output_units</span><span class=p>,</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>                    <span class=n>angle_units</span><span class=o>=</span><span class=n>angle_units</span><span class=p>,</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>                    <span class=n>angle_output_units</span><span class=o>=</span><span class=n>angle_output_units</span><span class=p>,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>                    <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>  <span class=c1># no verbosity here by choice!</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>            <span class=p>)[</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>                <span class=n>positive_solar_incidence_and_surface_not_in_shade</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>            <span class=p>]</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>        <span class=c1># Calculate diffuse and reflected irradiance for sun above horizon</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>        <span class=n>spectrally_resolved_diffuse_irradiance_series</span><span class=p>[</span><span class=n>sun_above_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>            <span class=n>calculate_diffuse_inclined_irradiance</span><span class=p>(</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>                <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>                <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>                <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>                <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>                <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>                <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>                <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>                <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>                <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>                <span class=c1># unrefracted_solar_zenith=unrefracted_solar_zenith,</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>                <span class=n>global_horizontal_component</span><span class=o>=</span><span class=n>spectrally_resolved_global_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>                <span class=n>direct_horizontal_component</span><span class=o>=</span><span class=n>spectrally_resolved_direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>                <span class=n>apply_angular_loss_factor</span><span class=o>=</span><span class=n>apply_angular_loss_factor</span><span class=p>,</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>                <span class=n>solar_position_model</span><span class=o>=</span><span class=n>solar_position_model</span><span class=p>,</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>                <span class=n>solar_time_model</span><span class=o>=</span><span class=n>solar_time_model</span><span class=p>,</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>                <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>                <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>                <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>                <span class=n>time_output_units</span><span class=o>=</span><span class=n>time_output_units</span><span class=p>,</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>                <span class=n>angle_units</span><span class=o>=</span><span class=n>angle_units</span><span class=p>,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>                <span class=n>angle_output_units</span><span class=o>=</span><span class=n>angle_output_units</span><span class=p>,</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>                <span class=n>neighbor_lookup</span><span class=o>=</span><span class=n>neighbor_lookup</span><span class=p>,</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>  <span class=c1># no verbosity here by choice!</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>            <span class=p>)[</span><span class=n>sun_above_horizon</span><span class=p>]</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>        <span class=n>spectrally_resolved_reflected_irradiance_series</span><span class=p>[</span><span class=n>sun_above_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>            <span class=n>calculate_ground_reflected_inclined_irradiance_series</span><span class=p>(</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>                <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>                <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>                <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>                <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>                <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>                <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>                <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>                <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>                <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>                <span class=c1># unrefracted_solar_zenith=unrefracted_solar_zenith,</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>                <span class=n>albedo</span><span class=o>=</span><span class=n>albedo</span><span class=p>,</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>                <span class=n>direct_horizontal_component</span><span class=o>=</span><span class=n>spectrally_resolved_direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>                <span class=n>apply_angular_loss_factor</span><span class=o>=</span><span class=n>apply_angular_loss_factor</span><span class=p>,</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>                <span class=n>solar_position_model</span><span class=o>=</span><span class=n>solar_position_model</span><span class=p>,</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>                <span class=n>solar_time_model</span><span class=o>=</span><span class=n>solar_time_model</span><span class=p>,</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>                <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>                <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>                <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>                <span class=n>time_output_units</span><span class=o>=</span><span class=n>time_output_units</span><span class=p>,</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>                <span class=n>angle_units</span><span class=o>=</span><span class=n>angle_units</span><span class=p>,</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>  <span class=c1># no verbosity here by choice!</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>            <span class=p>)[</span><span class=n>sun_above_horizon</span><span class=p>]</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a>        <span class=n>spectrally_resolved_global_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a>            <span class=n>spectrally_resolved_direct_irradiance_series</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a>            <span class=o>+</span> <span class=n>spectrally_resolved_diffuse_irradiance_series</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>            <span class=o>+</span> <span class=n>spectrally_resolved_reflected_irradiance_series</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a>    <span class=k>return</span> <span class=n>spectrally_resolved_global_irradiance_series</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.read> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">read</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.read title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.read.read_spectral_response title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">read_spectral_response</span> (<code>pvgisprototype.algorithms.hofierka.read.read_spectral_response</code>)'>read_spectral_response</a></code></td> <td> <div class=doc-md-description> <p>Read spectral response data from a file.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.read.read_spectral_response> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">read_spectral_response</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.read.read_spectral_response title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>read_spectral_response</span><span class=p>(</span><span class=n>filename</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Read spectral response data from a file.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>filename</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Path to the file containing spectral response data.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#tuple>tuple</a></code> </td> <td> <div class=doc-md-description> <p>A tuple containing: - wavelengths: 1D NumPy array of wavelengths. - response: 2D NumPy array of spectral response values. - STCresponse: Float value of Standard Test Condition response.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#IOError>IOError</a></code> </td> <td> <div class=doc-md-description> <p>If the file cannot be opened or read correctly.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/read.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>read_spectral_response</span><span class=p>(</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a>    <span class=n>filename</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>:</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a><span class=sd>    Read spectral response data from a file.</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a><span class=sd>    filename : str</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a><span class=sd>        Path to the file containing spectral response data.</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a><span class=sd>    tuple</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a><span class=sd>        A tuple containing:</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a><span class=sd>        - wavelengths: 1D NumPy array of wavelengths.</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a><span class=sd>        - response: 2D NumPy array of spectral response values.</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a><span class=sd>        - STCresponse: Float value of Standard Test Condition response.</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a><span class=sd>    Raises</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a><span class=sd>    ------</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a><span class=sd>    IOError</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a><span class=sd>        If the file cannot be opened or read correctly.</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=s2>"r"</span><span class=p>)</span> <span class=k>as</span> <span class=n>fp</span><span class=p>:</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>            <span class=n>STCresponse</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>fp</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>            <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>loadtxt</span><span class=p>(</span><span class=n>fp</span><span class=p>,</span> <span class=n>delimiter</span><span class=o>=</span><span class=s2>","</span><span class=p>,</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>    <span class=k>except</span> <span class=ne>IOError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>        <span class=k>raise</span> <span class=ne>IOError</span><span class=p>(</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>            <span class=sa>f</span><span class=s2>"Could not open or read spectral response file: </span><span class=si>{</span><span class=n>filename</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>        <span class=p>)</span> <span class=kn>from</span><span class=w> </span><span class=nn>e</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>    <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>size</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([]),</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([]),</span> <span class=n>STCresponse</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>    <span class=n>wavelengths</span> <span class=o>=</span> <span class=n>data</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>data</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span><span class=o>.</span><span class=n>T</span>  <span class=c1># Transposing to rearrange spectral responses</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>    <span class=k>return</span> <span class=n>wavelengths</span><span class=p>,</span> <span class=n>response</span><span class=p>,</span> <span class=n>STCresponse</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.spectrum> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">spectrum</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.spectrum title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.spectrum.average_photon_energy title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">average_photon_energy</span> (<code>pvgisprototype.algorithms.hofierka.spectrum.average_photon_energy</code>)'>average_photon_energy</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.spectrum.spectral_factor title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">spectral_factor</span> (<code>pvgisprototype.algorithms.hofierka.spectrum.spectral_factor</code>)'>spectral_factor</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.spectrum.average_photon_energy> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">average_photon_energy</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.spectrum.average_photon_energy title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.spectrum.average_photon_energy.calculate_average_photon_energy title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_average_photon_energy</span> (<code>pvgisprototype.algorithms.hofierka.spectrum.average_photon_energy.calculate_average_photon_energy</code>)'>calculate_average_photon_energy</a></code></td> <td> <div class=doc-md-description> <p>The Average Photon Energy (APE) characterises the energetic distribution</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.spectrum.average_photon_energy.calculate_average_photon_energy> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_average_photon_energy</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.spectrum.average_photon_energy.calculate_average_photon_energy title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_average_photon_energy</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>spectrally_resolved_global_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>global_irradiance_series_up_to_1050</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>photon_flux_density</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>electron_charge</span><span class=o>=</span><span class=n><span title=pvgisprototype.algorithms.hofierka.constants.ELECTRON_CHARGE>ELECTRON_CHARGE</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>The Average Photon Energy (APE) characterises the energetic distribution in an irradiance spectrum. It is calculated by dividing the irradiance [W/m or eV/m/sec] by the photon flux density [number of photons/m/sec].</p> <details class=note open> <summary>Notes</summary> <p>From [1]_ :</p> <div class=codehilite><pre><span></span><code><span class=s2>"The average photon energy is a useful parameter for examining spectral</span>
<span class=n>effects</span><span class=w> </span><span class=n>on</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>performance</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>amorphous</span><span class=w> </span><span class=n>silicon</span><span class=w> </span><span class=n>cells</span><span class=o>.</span><span class=w> </span><span class=n>It</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>strongly</span>
<span class=n>correlated</span><span class=w> </span><span class=n>with</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>useful</span><span class=w> </span><span class=n>fraction</span><span class=p>,</span><span class=w> </span><span class=n>but</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>device</span><span class=w> </span><span class=n>independent</span>
<span class=n>parameter</span><span class=w> </span><span class=n>that</span><span class=w> </span><span class=n>does</span><span class=w> </span><span class=ow>not</span><span class=w> </span><span class=n>require</span><span class=w> </span><span class=n>knowledge</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>absorption</span><span class=w> </span><span class=n>profile</span><span class=w> </span><span class=n>of</span>
<span class=n>a</span><span class=w> </span><span class=n>given</span><span class=w> </span><span class=n>device</span><span class=o>.</span>

<span class=n>It</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>possible</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>examine</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>purely</span><span class=w> </span><span class=n>spectral</span><span class=w> </span><span class=n>performance</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>amorphous</span>
<span class=n>silicon</span><span class=w> </span><span class=n>devices</span><span class=w> </span><span class=n>after</span><span class=w> </span><span class=n>removing</span><span class=w> </span><span class=n>temperature</span><span class=w> </span><span class=n>effects</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>data</span><span class=o>.</span>
<span class=n>Single</span><span class=w> </span><span class=n>junction</span><span class=w> </span><span class=n>devices</span><span class=w> </span><span class=n>show</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>linear</span><span class=w> </span><span class=n>increase</span><span class=w> </span><span class=ow>in</span><span class=w> </span><span class=n>corrected</span><span class=w> </span><span class=n>ISC</span><span class=o>/</span><span class=n>Gtotal</span>
<span class=k>as</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>received</span><span class=w> </span><span class=n>radiation</span><span class=w> </span><span class=n>becomes</span><span class=w> </span><span class=n>more</span><span class=w> </span><span class=n>blue</span><span class=w> </span><span class=n>shifted</span><span class=p>,</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>greater</span>
<span class=n>proportion</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>insolation</span><span class=w> </span><span class=n>lies</span><span class=w> </span><span class=n>within</span><span class=w> </span><span class=n>its</span><span class=w> </span><span class=n>absorption</span><span class=w> </span><span class=n>window</span><span class=o>.</span>

<span class=n>Double</span><span class=w> </span><span class=ow>and</span><span class=w> </span><span class=n>triple</span><span class=w> </span><span class=n>junction</span><span class=w> </span><span class=n>devices</span><span class=w> </span><span class=n>do</span><span class=w> </span><span class=ow>not</span><span class=w> </span><span class=n>vary</span><span class=w> </span><span class=n>linearly</span><span class=o>.</span><span class=w> </span><span class=n>The</span><span class=w> </span><span class=n>devices</span>
<span class=n>investigated</span><span class=w> </span><span class=n>here</span><span class=w> </span><span class=n>reach</span><span class=w> </span><span class=n>maxima</span><span class=w> </span><span class=n>at</span><span class=w> </span><span class=mf>1.72</span><span class=w> </span><span class=ow>and</span><span class=w> </span><span class=mf>1.7</span><span class=w> </span><span class=n>eV</span><span class=p>,</span><span class=w> </span><span class=n>respectively</span><span class=o>.</span><span class=w> </span><span class=n>As</span><span class=w> </span><span class=n>the</span>
<span class=n>received</span><span class=w> </span><span class=n>spectrum</span><span class=w> </span><span class=n>becomes</span><span class=w> </span><span class=n>either</span><span class=w> </span><span class=n>red</span><span class=w> </span><span class=ow>or</span><span class=w> </span><span class=n>blue</span><span class=w> </span><span class=n>shifted</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=n>this</span><span class=w> </span><span class=n>ideal</span><span class=p>,</span>
<span class=n>performance</span><span class=w> </span><span class=n>drops</span><span class=w> </span><span class=n>off</span><span class=w> </span><span class=n>due</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>mismatch</span><span class=w> </span><span class=n>between</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>absorption</span><span class=w> </span><span class=n>profile</span>
<span class=ow>and</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>received</span><span class=w> </span><span class=n>spectrum</span><span class=o>.</span><span class=w> </span><span class=n>The</span><span class=w> </span><span class=n>output</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>multijunction</span><span class=w> </span><span class=n>devices</span><span class=w> </span><span class=k>is</span>
<span class=n>essentially</span><span class=w> </span><span class=n>limited</span><span class=w> </span><span class=n>by</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>layer</span><span class=w> </span><span class=n>generating</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>least</span><span class=w> </span><span class=n>current</span><span class=o>.</span><span class=w> </span><span class=n>The</span>
<span class=n>performance</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>triple</span><span class=w> </span><span class=n>junction</span><span class=w> </span><span class=n>cells</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>more</span><span class=w> </span><span class=n>susceptible</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>changes</span><span class=w> </span><span class=ow>in</span>
<span class=n>the</span><span class=w> </span><span class=n>incident</span><span class=w> </span><span class=n>spectrum</span><span class=w> </span><span class=n>than</span><span class=w> </span><span class=n>double</span><span class=w> </span><span class=n>junction</span><span class=w> </span><span class=n>cells</span><span class=p>,</span><span class=w> </span><span class=n>although</span><span class=w> </span><span class=n>this</span><span class=w> </span><span class=n>will</span><span class=w> </span><span class=n>be</span>
<span class=n>countermanded</span><span class=w> </span><span class=n>with</span><span class=w> </span><span class=n>lower</span><span class=w> </span><span class=n>degradation</span><span class=w> </span><span class=ow>in</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>case</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>a</span><span class=o>-</span><span class=n>Si</span><span class=w> </span><span class=n>devices</span><span class=o>.</span>

<span class=n>The</span><span class=w> </span><span class=n>maximum</span><span class=w> </span><span class=n>spectral</span><span class=w> </span><span class=n>performance</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>multijunction</span><span class=w> </span><span class=n>devices</span><span class=w> </span><span class=n>occurs</span><span class=w> </span><span class=n>at</span>
<span class=n>APEs</span><span class=w> </span><span class=n>higher</span><span class=w> </span><span class=n>than</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>APE</span><span class=w> </span><span class=n>where</span><span class=w> </span><span class=n>most</span><span class=w> </span><span class=n>energy</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>received</span><span class=o>.</span><span class=w> </span><span class=n>There</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>an</span>
<span class=n>opportunity</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>improve</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>spectral</span><span class=w> </span><span class=n>performance</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>multijunction</span>
<span class=n>devices</span><span class=w> </span><span class=n>such</span><span class=w> </span><span class=n>that</span><span class=w> </span><span class=n>they</span><span class=w> </span><span class=n>are</span><span class=w> </span><span class=n>most</span><span class=w> </span><span class=n>efficient</span><span class=w> </span><span class=n>at</span><span class=w> </span><span class=n>APEs</span><span class=w> </span><span class=n>where</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>majority</span><span class=w> </span><span class=n>of</span>
<span class=n>the</span><span class=w> </span><span class=n>energy</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>delivered</span><span class=o>.</span>
</code></pre></div> </details> <details class=references open> <summary>References</summary> <p>.. [1] Jardine, C.N. &amp; Gottschalg, Ralph &amp; Betts, Thomas &amp; Infield, David. (2002). Influence of Spectral Effects on the Performance of Multijunction Amorphous Silicon Cells. to be published.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/spectrum/average_photon_energy.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_average_photon_energy</span><span class=p>(</span>  <span class=c1># series ?</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a>    <span class=n>spectrally_resolved_global_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>    <span class=n>global_irradiance_series_up_to_1050</span><span class=p>,</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>    <span class=n>photon_flux_density</span><span class=p>,</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a>    <span class=n>electron_charge</span><span class=o>=</span><span class=n>ELECTRON_CHARGE</span><span class=p>,</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a><span class=p>):</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a><span class=sd>    The Average Photon Energy (APE) characterises the energetic distribution</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a><span class=sd>    in an irradiance spectrum. It is calculated by dividing the irradiance</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a><span class=sd>    [W/m or eV/m/sec] by the photon flux density [number of photons/m/sec].</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a><span class=sd>    From [1]_ :</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a><span class=sd>        "The average photon energy is a useful parameter for examining spectral</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a><span class=sd>        effects on the performance of amorphous silicon cells. It is strongly</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a><span class=sd>        correlated with the useful fraction, but is a device independent</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a><span class=sd>        parameter that does not require knowledge of the absorption profile of</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a><span class=sd>        a given device.</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a><span class=sd>        It is possible to examine the purely spectral performance of amorphous</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a><span class=sd>        silicon devices after removing temperature effects from the data.</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a><span class=sd>        Single junction devices show a linear increase in corrected ISC/Gtotal</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a><span class=sd>        as the received radiation becomes more blue shifted, as a greater</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a><span class=sd>        proportion of the insolation lies within its absorption window.</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a><span class=sd>        Double and triple junction devices do not vary linearly. The devices</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a><span class=sd>        investigated here reach maxima at 1.72 and 1.7 eV, respectively. As the</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a><span class=sd>        received spectrum becomes either red or blue shifted from this ideal,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a><span class=sd>        performance drops off due to mismatch between the absorption profile</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a><span class=sd>        and the received spectrum. The output of multijunction devices is</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a><span class=sd>        essentially limited by the layer generating the least current. The</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a><span class=sd>        performance of triple junction cells is more susceptible to changes in</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a><span class=sd>        the incident spectrum than double junction cells, although this will be</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a><span class=sd>        countermanded with lower degradation in the case of a-Si devices.</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a><span class=sd>        The maximum spectral performance of multijunction devices occurs at</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a><span class=sd>        APEs higher than the APE where most energy is received. There is an</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a><span class=sd>        opportunity to improve the spectral performance of multijunction</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a><span class=sd>        devices such that they are most efficient at APEs where the majority of</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a><span class=sd>        the energy is delivered.</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a><span class=sd>    .. [1] Jardine, C.N. &amp; Gottschalg, Ralph &amp; Betts, Thomas &amp; Infield, David.</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a><span class=sd>      (2002). Influence of Spectral Effects on the Performance of Multijunction</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a><span class=sd>      Amorphous Silicon Cells. to be published.</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>    <span class=c1># name it series ?</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>    <span class=c1># In PVGIS' source code :</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>    <span class=c1># if spectral_band_number &lt; 19:</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>    <span class=c1># number_of_photons += (</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>    <span class=c1>#     global_spectral_power[spectral_band_number]</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>    <span class=c1>#     / photon_energies[spectral_band_number]</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>    <span class=n>index_1050</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>BAND_LIMITS</span> <span class=o>&lt;</span> <span class=mi>1050</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos="81 "></span></a>    <span class=c1># photon_energies_up_to_1050 = PHOTON_ENERGIES[index_1050]</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos="82 "></span></a>    <span class=n>global_irradiance_series_up_to_1050</span> <span class=o>=</span> <span class=n>spectrally_resolved_global_irradiance_series</span><span class=p>[</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos="83 "></span></a>        <span class=p>:,</span> <span class=n>index_1050</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos="84 "></span></a>    <span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos="85 "></span></a>    <span class=c1># ? ----------------------------------------------------------------------</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos="86 "></span></a>    <span class=c1># number_of_photons_up_to_1050 = (</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos="87 "></span></a>    <span class=c1>#     spectrally_resolved_global_irradiance_series[:, index_1050]</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos="88 "></span></a>    <span class=c1>#     / photon_energies_up_to_1050</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos="89 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos="90 "></span></a>    <span class=c1># ------------------------------------------------------------------------</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos="91 "></span></a>    <span class=n>average_photon_energy</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos="92 "></span></a>        <span class=n>global_irradiance_series_up_to_1050</span> <span class=o>/</span> <span class=n>photon_flux_density</span> <span class=o>*</span> <span class=n>electron_charge</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos="93 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos="94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos="95 "></span></a>    <span class=k>return</span> <span class=n>average_photon_energy</span>  <span class=c1># series</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.spectrum.spectral_factor> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">spectral_factor</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.spectrum.spectral_factor title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.spectrum.spectral_factor.calculate_minimum_spectral_mismatch title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_minimum_spectral_mismatch</span> (<code>pvgisprototype.algorithms.hofierka.spectrum.spectral_factor.calculate_minimum_spectral_mismatch</code>)'>calculate_minimum_spectral_mismatch</a></code></td> <td> <div class=doc-md-description> <p>Returns</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka.spectrum.spectral_factor.integrate_spectrum_response title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">integrate_spectrum_response</span> (<code>pvgisprototype.algorithms.hofierka.spectrum.spectral_factor.integrate_spectrum_response</code>)'>integrate_spectrum_response</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.spectrum.spectral_factor.calculate_minimum_spectral_mismatch> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_minimum_spectral_mismatch</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.spectrum.spectral_factor.calculate_minimum_spectral_mismatch title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_minimum_spectral_mismatch</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>response_wavelengths</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>spectral_response</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>number_of_junctions</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>spectral_power_density</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>minimum_spectral_mismatch</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code>minimum_junction</code></td> <td> </td> <td> <div class=doc-md-description> <p>By Kirchoffs Law the overall current produced by the device is only equal to the smallest current produced by an individual junction. This means that the least productive layer in a multi-junction device limits the performance of a multijunction cell [1]_</p> </div> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <p>.. [1] Jardine, C.N. &amp; Gottschalg, Ralph &amp; Betts, Thomas &amp; Infield, David. (2002). Influence of Spectral Effects on the Performance of Multijunction Amorphous Silicon Cells. to be published.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/spectrum/spectral_factor.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_minimum_spectral_mismatch</span><span class=p>(</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>    <span class=n>response_wavelengths</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=n>spectral_response</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=n>number_of_junctions</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=n>spectral_power_density</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=p>):</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    minimum_spectral_mismatch: float</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    minimum_junction:</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>        By Kirchoffs Law the overall current produced by the device is only</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>        equal to the smallest current produced by an individual junction. This</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>        means that the least productive layer in a multi-junction device limits</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>        the performance of a multijunction cell [1]_</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    .. [1] Jardine, C.N. &amp; Gottschalg, Ralph &amp; Betts, Thomas &amp; Infield, David.</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>      (2002). Influence of Spectral Effects on the Performance of Multijunction</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>      Amorphous Silicon Cells. to be published.</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>minimum_spectral_mismatch</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># FixMe</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=n>minimum_junction</span> <span class=o>=</span> <span class=mi>1</span>  <span class=c1># FixMe</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=k>for</span> <span class=n>junction</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>number_of_junctions</span><span class=p>):</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>spectral_mismatch</span> <span class=o>=</span> <span class=n>integrate_spectrum_response</span><span class=p>(</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>            <span class=n>spectral_response_frequencies</span><span class=o>=</span><span class=n>response_wavelengths</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>            <span class=n>spectral_response</span><span class=o>=</span><span class=n>spectral_response</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>            <span class=n>kato_limits</span><span class=o>=</span><span class=n>junction</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>            <span class=n>spectral_power_density</span><span class=o>=</span><span class=n>spectral_power_density</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=k>if</span> <span class=n>spectral_mismatch</span> <span class=o>&lt;</span> <span class=n>minimum_spectral_mismatch</span><span class=p>:</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>            <span class=n>minimum_spectral_mismatch</span> <span class=o>=</span> <span class=n>spectral_mismatch</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>            <span class=n>minimum_junction</span> <span class=o>=</span> <span class=n>junction</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=k>return</span> <span class=n>minimum_spectral_mismatch</span><span class=p>,</span> <span class=n>minimum_junction</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka.spectrum.spectral_factor.integrate_spectrum_response> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">integrate_spectrum_response</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka.spectrum.spectral_factor.integrate_spectrum_response title="Permanent link"></a></h5> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>integrate_spectrum_response</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>spectral_response_frequencies</span><span class=p>:</span> <span class=n><span title=numpy.typing.NDArray>NDArray</span></span><span class=p>[</span><span class=n><span title=numpy.float32>float32</span></span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>spectral_response</span><span class=p>:</span> <span class=n><span title=numpy.typing.NDArray>NDArray</span></span><span class=p>[</span><span class=n><span title=numpy.float32>float32</span></span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>kato_limits</span><span class=p>:</span> <span class=n><span title=numpy.typing.NDArray>NDArray</span></span><span class=p>[</span><span class=n><span title=numpy.float32>float32</span></span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>spectral_power_density</span><span class=p>:</span> <span class=n><span title=numpy.typing.NDArray>NDArray</span></span><span class=p>[</span><span class=n><span title=numpy.float32>float32</span></span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span>
</span></code></pre></div> <div class="doc doc-contents"> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/hofierka/spectrum/spectral_factor.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>integrate_spectrum_response</span><span class=p>(</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>    <span class=n>spectral_response_frequencies</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>    <span class=n>spectral_response</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a>    <span class=n>kato_limits</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a>    <span class=n>spectral_power_density</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=sd>""" """</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a>    <span class=n>m</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>    <span class=n>n</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a>    <span class=c1># nu_high = float()</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>    <span class=c1># response_low = float()</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>    <span class=c1># response_high = float()</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>    <span class=n>photovoltaic_power</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>    <span class=n>response_low</span> <span class=o>=</span> <span class=n>spectral_response</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>    <span class=c1># nu_low = float()</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>    <span class=n>nu_low</span> <span class=o>=</span> <span class=n>spectral_response_frequencies</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a>    <span class=n>number_of_response_values</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>spectral_response_frequencies</span><span class=p>)</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>    <span class=c1># number_of_kato_limits = len(kato_limits)</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>    <span class=k>while</span> <span class=n>n</span> <span class=o>&lt;</span> <span class=n>number_of_response_values</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>        <span class=k>if</span> <span class=n>spectral_response_frequencies</span><span class=p>[</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>kato_limits</span><span class=p>[</span><span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]:</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>            <span class=n>nu_high</span> <span class=o>=</span> <span class=n>spectral_response_frequencies</span><span class=p>[</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>            <span class=n>response_high</span> <span class=o>=</span> <span class=n>spectral_response</span><span class=p>[</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>            <span class=n>nu_high</span> <span class=o>=</span> <span class=n>kato_limits</span><span class=p>[</span><span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>            <span class=n>response_high</span> <span class=o>=</span> <span class=n>spectral_response</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>+</span> <span class=p>(</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>                <span class=n>nu_high</span> <span class=o>-</span> <span class=n>spectral_response_frequencies</span><span class=p>[</span><span class=n>n</span><span class=p>]</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>            <span class=p>)</span> <span class=o>/</span> <span class=p>(</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>                <span class=n>spectral_response_frequencies</span><span class=p>[</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>spectral_response_frequencies</span><span class=p>[</span><span class=n>n</span><span class=p>]</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>            <span class=p>)</span> <span class=o>*</span> <span class=p>(</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>                <span class=n>spectral_response</span><span class=p>[</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>spectral_response</span><span class=p>[</span><span class=n>n</span><span class=p>]</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>        <span class=n>photovoltaic_power</span> <span class=o>+=</span> <span class=p>(</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>            <span class=n>spectral_power_density</span><span class=p>[</span><span class=n>m</span><span class=p>]</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>            <span class=o>*</span> <span class=mf>0.5</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>            <span class=o>*</span> <span class=p>(</span><span class=n>response_high</span> <span class=o>+</span> <span class=n>response_low</span><span class=p>)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>            <span class=o>*</span> <span class=p>(</span><span class=n>nu_high</span> <span class=o>-</span> <span class=n>nu_low</span><span class=p>)</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>        <span class=k>if</span> <span class=n>spectral_response_frequencies</span><span class=p>[</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>kato_limits</span><span class=p>[</span><span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]:</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>            <span class=n>n</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>            <span class=n>m</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>        <span class=n>nu_low</span> <span class=o>=</span> <span class=n>nu_high</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>        <span class=n>response_low</span> <span class=o>=</span> <span class=n>response_high</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>    <span class=k>return</span> <span class=n>photovoltaic_power</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.huld> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">huld</span> <a class=headerlink href=#pvgisprototype.algorithms.huld title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.huld.efficiency_factor title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">efficiency_factor</span> (<code>pvgisprototype.algorithms.huld.efficiency_factor</code>)'>efficiency_factor</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.huld.photovoltaic_module title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">photovoltaic_module</span> (<code>pvgisprototype.algorithms.huld.photovoltaic_module</code>)'>photovoltaic_module</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.huld.efficiency_factor> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">efficiency_factor</span> <a class=headerlink href=#pvgisprototype.algorithms.huld.efficiency_factor title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.huld.efficiency_factor.calculate_efficiency_factor_series title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_efficiency_factor_series</span> (<code>pvgisprototype.algorithms.huld.efficiency_factor.calculate_efficiency_factor_series</code>)'>calculate_efficiency_factor_series</a></code></td> <td> <div class=doc-md-description> <p>Calculate the efficiency factor series specific to the photovoltaic</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.huld.efficiency_factor.calculate_efficiency_factor_series> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_efficiency_factor_series</span> <a class=headerlink href=#pvgisprototype.algorithms.huld.efficiency_factor.calculate_efficiency_factor_series title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_efficiency_factor_series</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>effective_irradiance_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.EffectiveIrradiance>EffectiveIrradiance</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>radiation_cutoff_threshold</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.RADIATION_CUTOFF_THRESHHOLD>RADIATION_CUTOFF_THRESHHOLD</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>photovoltaic_module</span><span class=p>:</span> <span class=n><span title=pvgisprototype.algorithms.huld.photovoltaic_module.PhotovoltaicModuleModel>PhotovoltaicModuleModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.algorithms.huld.photovoltaic_module.PhotovoltaicModuleModel.CSI_FREE_STANDING>CSI_FREE_STANDING</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>power_model</span><span class=p>:</span> <span class=n><span title=pvgisprototype.algorithms.huld.models.PhotovoltaicModulePerformanceModel>PhotovoltaicModulePerformanceModel</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.algorithms.huld.models.PhotovoltaicModulePerformanceModel.king>king</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>temperature_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.TemperatureSeries>TemperatureSeries</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.TemperatureSeries>TemperatureSeries</span></span><span class=p>(</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>        <span class=n><span title=pvgisprototype.TemperatureSeries(value)>value</span></span><span class=o>=</span><span class=n><span title=average_air_temperature>average_air_temperature</span></span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=p>),</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>standard_test_temperature</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=standard_test_temperature>standard_test_temperature</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.PhotovoltaicEfficiencyFactor>PhotovoltaicEfficiencyFactor</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the efficiency factor series specific to the photovoltaic module technology.</p> <p>Calculate the photovoltaic efficiency factor series for a solar irradiance component specific to the photovoltaic module technology, the photovoltaic power rating model and the (adjusted) temperature series. The implemented power rating model [0] is a variant of King's model [1, 2].</p> <details class=references open> <summary>References</summary> <p>[0] Thomas Huld, Gabi Friesen, Artur Skoczek, Robert P. Kenny, Tony Sample, Michael Field, Ewan D. Dunlop, A power-rating model for crystalline silicon PV modules, Solar Energy Materials and Solar Cells, Volume 95, Issue 12, 2011, Pages 3359-3369, ISSN 0927-0248, <a href=https://doi.org/10.1016/j.solmat.2011.07.026>https://doi.org/10.1016/j.solmat.2011.07.026</a>.</p> <p>[1] D.L. King, J.A. Kratochvil, W.E. Boyson, W.I. Bower, Field experience with a new performance characterization procedure for photovoltaic arrays, in: Proceedings of the second World Conference and Exhibition on Photovoltaic Solar Energy Conversion, Vienna, 1998, pp. 19471952.</p> <p>[2] D.L. King, W.E. Boyson, J.A. Kratochvil, Photovoltaic Array Performance Model, SAND2004-3535, Sandia National Laboratories, 2004.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/huld/efficiency_factor.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_efficiency_factor_series</span><span class=p>(</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>effective_irradiance_series</span><span class=p>:</span> <span class=n>EffectiveIrradiance</span><span class=p>,</span>  <span class=c1># effective irradiance</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>radiation_cutoff_threshold</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>RADIATION_CUTOFF_THRESHHOLD</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>photovoltaic_module</span><span class=p>:</span> <span class=n>PhotovoltaicModuleModel</span> <span class=o>=</span> <span class=n>PhotovoltaicModuleModel</span><span class=o>.</span><span class=n>CSI_FREE_STANDING</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>power_model</span><span class=p>:</span> <span class=n>PhotovoltaicModulePerformanceModel</span> <span class=o>=</span> <span class=n>PhotovoltaicModulePerformanceModel</span><span class=o>.</span><span class=n>king</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>temperature_series</span><span class=p>:</span> <span class=n>TemperatureSeries</span> <span class=o>=</span> <span class=n>TemperatureSeries</span><span class=p>(</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>TemperatureSeries</span><span class=p>()</span><span class=o>.</span><span class=n>average_air_temperature</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=p>),</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>standard_test_temperature</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>TemperatureSeries</span><span class=p>()</span><span class=o>.</span><span class=n>standard_test_temperature</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PhotovoltaicEfficiencyFactor</span><span class=p>:</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=w>    </span><span class=sd>"""Calculate the efficiency factor series specific to the photovoltaic</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    module technology.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    Calculate the photovoltaic efficiency factor series for a solar irradiance</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    component specific to the photovoltaic module technology, the photovoltaic</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    power rating model and the (adjusted) temperature series. The implemented</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    power rating model [0] is a variant of King's model [1, 2].</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    [0] Thomas Huld, Gabi Friesen, Artur Skoczek, Robert P. Kenny, Tony Sample,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    Michael Field, Ewan D. Dunlop, A power-rating model for crystalline silicon</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    PV modules, Solar Energy Materials and Solar Cells, Volume 95, Issue 12,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    2011, Pages 3359-3369, ISSN 0927-0248,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    https://doi.org/10.1016/j.solmat.2011.07.026.</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    [1] D.L. King, J.A. Kratochvil, W.E. Boyson, W.I. Bower, Field experience</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>    with a new performance characterization procedure for photovoltaic arrays,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    in: Proceedings of the second World Conference and Exhibition on</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    Photovoltaic Solar Energy Conversion, Vienna, 1998, pp. 19471952.</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    [2] D.L. King, W.E. Boyson, J.A. Kratochvil, Photovoltaic Array</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    Performance Model, SAND2004-3535, Sandia National Laboratories, 2004.</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=n>array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=s2>"shape"</span><span class=p>:</span> <span class=n>effective_irradiance_series</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>        <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>        <span class=s2>"init_method"</span><span class=p>:</span> <span class=s2>"ones"</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=n>efficiency_factor_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>array_parameters</span><span class=p>)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=c1># Radiation cutoff handling</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>relative_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>        <span class=mf>0.001</span> <span class=o>*</span> <span class=n>effective_irradiance_series</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=p>)</span>  <span class=c1># Conversion to Unit PV Power ?</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=n>efficiency_factor_series</span> <span class=o>=</span> <span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>        <span class=n>relative_irradiance_series</span> <span class=o>&lt;=</span> <span class=n>radiation_cutoff_threshold</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>efficiency_factor_series</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=n>radiation_cutoff_loss_series</span> <span class=o>=</span> <span class=n>efficiency_factor_series</span> <span class=o>-</span> <span class=mi>1</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>    <span class=n>radiation_cutoff_loss_percentage_series</span> <span class=o>=</span> <span class=mi>100</span> <span class=o>*</span> <span class=n>radiation_cutoff_loss_series</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=c1># low_irradiance_series = ((irradiance_series * efficiency_factor_series) - irradiance_series)</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=c1># low_irradiance_percentage_series = 100 * where(</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=c1>#         irradiance_series != 0,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>    <span class=c1>#     ((irradiance_series * efficiency_factor_series) - irradiance_series) / irradiance_series,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=c1>#     0</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=n>photovoltaic_module_efficiency_coefficients</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=n>get_coefficients_for_photovoltaic_module</span><span class=p>(</span><span class=n>photovoltaic_module</span><span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=c1># --------------------------------------------------- Is this safe ? -</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>    <span class=k>with</span> <span class=n>np</span><span class=o>.</span><span class=n>errstate</span><span class=p>(</span><span class=n>divide</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>,</span> <span class=n>invalid</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>):</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=n>log_relative_irradiance_series</span> <span class=o>=</span> <span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>            <span class=n>relative_irradiance_series</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>            <span class=n>numpy_log</span><span class=p>(</span><span class=n>relative_irradiance_series</span><span class=p>),</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>            <span class=mi>0</span><span class=p>,</span>  <span class=c1># -numpy_inf,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>    <span class=n>temperature_deviation_series</span> <span class=o>=</span> <span class=n>temperature_series</span><span class=o>.</span><span class=n>value</span> <span class=o>-</span> <span class=n>standard_test_temperature</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>    <span class=c1># power output fom King (using PV eff coeffs for a specific tech) -  ... ?</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>    <span class=c1># difference between real conditions and stadard conditions -- should be close to zero</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>    <span class=k>if</span> <span class=n>power_model</span><span class=o>.</span><span class=n>value</span> <span class=o>==</span> <span class=n>PhotovoltaicModulePerformanceModel</span><span class=o>.</span><span class=n>king</span><span class=p>:</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=n>efficiency_factor_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>            <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>            <span class=o>+</span> <span class=n>log_relative_irradiance_series</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>            <span class=o>*</span> <span class=p>(</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>                <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>                <span class=o>+</span> <span class=n>log_relative_irradiance_series</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>                <span class=o>*</span> <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>            <span class=o>+</span> <span class=n>temperature_deviation_series</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>            <span class=o>*</span> <span class=p>(</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>                <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>                <span class=o>+</span> <span class=n>log_relative_irradiance_series</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>                <span class=o>*</span> <span class=p>(</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>                    <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>                    <span class=o>+</span> <span class=n>log_relative_irradiance_series</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>                    <span class=o>*</span> <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>                <span class=o>+</span> <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>                <span class=o>*</span> <span class=n>temperature_deviation_series</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>        <span class=n>efficiency_factor_series</span> <span class=o>/=</span> <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>        <span class=n>power_model</span><span class=o>.</span><span class=n>value</span> <span class=o>==</span> <span class=n>PhotovoltaicModulePerformanceModel</span><span class=o>.</span><span class=n>iv</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>    <span class=p>):</span>  <span class=c1># 'IV' Model ( Name ? )</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>        <span class=n>current_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>            <span class=n>CURRENT_AT_STANDARD_TEST_CONDITIONS</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>            <span class=o>+</span> <span class=n>CURRENT_AT_STANDARD_TEST_CONDITIONS_TEMPERATURE_COEFFICIENT</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>            <span class=o>*</span> <span class=n>temperature_deviation_series</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>        <span class=n>voltage_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>            <span class=n>VOLTAGE_AT_STANDARD_TEST_CONDITIONS</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>            <span class=o>+</span> <span class=n>VOLTAGE_AT_STANDARD_TEST_CONDITIONS_COEFFICIENT_1</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>            <span class=o>*</span> <span class=n>log_relative_irradiance_series</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>            <span class=o>+</span> <span class=n>VOLTAGE_AT_STANDARD_TEST_CONDITIONS_COEFFICIENT_2</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>            <span class=o>*</span> <span class=n>log_relative_irradiance_series</span><span class=o>**</span><span class=mi>2</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>            <span class=o>+</span> <span class=n>VOLTAGE_AT_STANDARD_TEST_CONDITIONS_TEMPERATURE_COEFFICIENT</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>            <span class=o>*</span> <span class=n>temperature_deviation_series</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=n>efficiency_factor_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>            <span class=n>current_series</span> <span class=o>*</span> <span class=n>voltage_series</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>        <span class=p>)</span> <span class=o>/</span> <span class=n>POWER_AT_STANDARD_TEST_CONDITIONS</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>    <span class=c1># # Mask where efficiency is out of range [0, 1]</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>    <span class=c1># mask_invalid_efficiency = (efficiency_series &lt; 0) | (efficiency_series &gt; 1)</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>    <span class=c1># if np.any(mask_invalid_efficiency):</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>    <span class=c1>#     return "Some calculated efficiencies are out of the expected range [0, 1]!"</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>efficiency_factor_series</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>    <span class=k>return</span> <span class=n>PhotovoltaicEfficiencyFactor</span><span class=p>(</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>efficiency_factor_series</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>        <span class=n>effective_irradiance</span><span class=o>=</span><span class=n>effective_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>        <span class=n>log_relative_irradiance</span><span class=o>=</span><span class=n>log_relative_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=n>relative_irradiance</span><span class=o>=</span><span class=n>relative_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=n>low_irradiance</span><span class=o>=</span><span class=n>relative_irradiance_series</span> <span class=o>&lt;=</span> <span class=n>radiation_cutoff_threshold</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>        <span class=n>photovoltaic_module</span><span class=o>=</span><span class=n>photovoltaic_module</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>        <span class=n>photovoltaic_module_efficiency_coefficients</span><span class=o>=</span><span class=n>photovoltaic_module_efficiency_coefficients</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>        <span class=n>power_model</span><span class=o>=</span><span class=n>power_model</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>        <span class=n>radiation_cutoff_threshold</span><span class=o>=</span><span class=n>radiation_cutoff_threshold</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>        <span class=n>radiation_cutoff_loss_percentage</span><span class=o>=</span><span class=n>radiation_cutoff_loss_percentage_series</span><span class=p>,</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>        <span class=n>temperature_deviation</span><span class=o>=</span><span class=n>temperature_deviation_series</span><span class=p>,</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.huld.photovoltaic_module> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">photovoltaic_module</span> <a class=headerlink href=#pvgisprototype.algorithms.huld.photovoltaic_module title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.huld.photovoltaic_module.get_coefficients_for_photovoltaic_module title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_coefficients_for_photovoltaic_module</span> (<code>pvgisprototype.algorithms.huld.photovoltaic_module.get_coefficients_for_photovoltaic_module</code>)'>get_coefficients_for_photovoltaic_module</a></code></td> <td> <div class=doc-md-description> <p>Retrieve model coefficients based on the selected PhotovoltaicModuleModel Enum.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.huld.photovoltaic_module.get_coefficients_for_photovoltaic_module> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">get_coefficients_for_photovoltaic_module</span> <a class=headerlink href=#pvgisprototype.algorithms.huld.photovoltaic_module.get_coefficients_for_photovoltaic_module title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>get_coefficients_for_photovoltaic_module</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>photovoltaic_module</span><span class=p>:</span> <span class=n><span title=pvgisprototype.algorithms.huld.photovoltaic_module.PhotovoltaicModuleModel>PhotovoltaicModuleModel</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.List title="<code>typing.List</code>">List</a></span><span class=p>[</span><span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>]</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Retrieve model coefficients based on the selected PhotovoltaicModuleModel Enum.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/huld/photovoltaic_module.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>get_coefficients_for_photovoltaic_module</span><span class=p>(</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>    <span class=n>photovoltaic_module</span><span class=p>:</span> <span class=n>PhotovoltaicModuleModel</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a><span class=w>    </span><span class=sd>"""Retrieve model coefficients based on the selected PhotovoltaicModuleModel Enum."""</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>    <span class=n>coefficients</span> <span class=o>=</span> <span class=n>PHOTOVOLTAIC_MODULE_COEFFICIENTS_MAP</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>photovoltaic_module</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>coefficients</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>7</span><span class=p>:</span>  <span class=c1># should be at least</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>"Insufficient number of model constants!"</span><span class=p>)</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>    <span class=k>return</span> <span class=n>coefficients</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.iqbal> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">iqbal</span> <a class=headerlink href=#pvgisprototype.algorithms.iqbal title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.iqbal.solar_incidence title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_incidence</span> (<code>pvgisprototype.algorithms.iqbal.solar_incidence</code>)'>solar_incidence</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar incidence angle for a surface that is tilted to any</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.iqbal.solar_incidence> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_incidence</span> <a class=headerlink href=#pvgisprototype.algorithms.iqbal.solar_incidence title="Permanent link"></a></h3> <div class="doc doc-contents"> <p>Calculate the solar incidence angle for a surface that is tilted to any horizontal and vertical angle, as described by Iqbal [0].</p> <p>[0] Iqbal, M. An Introduction to Solar Radiation. New York: 1983; pp. 23-25.</p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.iqbal.solar_incidence.calculate_solar_incidence_series_iqbal title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_incidence_series_iqbal</span> (<code>pvgisprototype.algorithms.iqbal.solar_incidence.calculate_solar_incidence_series_iqbal</code>)'>calculate_solar_incidence_series_iqbal</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar incidence angle for a surface oriented in any</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.iqbal.solar_incidence.calculate_solar_incidence_series_iqbal> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_incidence_series_iqbal</span> <a class=headerlink href=#pvgisprototype.algorithms.iqbal.solar_incidence.calculate_solar_incidence_series_iqbal title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_incidence_series_iqbal</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceOrientation>SurfaceOrientation</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceTilt>SurfaceTilt</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>=</span> <span class=n><a class="autorefs autorefs-internal" href=../api/#pvgisprototype.api.datetime.now.now_utc_datetimezone title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">now_utc_datetimezone</span> (<code>pvgisprototype.api.datetime.now.now_utc_datetimezone</code>)'>now_utc_datetimezone</a></span><span class=p>(),</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ATMOSPHERIC_REFRACTION_FLAG_DEFAULT>ATMOSPHERIC_REFRACTION_FLAG_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>sun_horizon_position</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.List title="<code>typing.List</code>">List</a></span><span class=p>[</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=n><span title=pvgisprototype.api.position.models.SunHorizonPositionModel>SunHorizonPositionModel</span></span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=p>]</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SUN_HORIZON_POSITION_DEFAULT>SUN_HORIZON_POSITION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n><span title=pydantic_numpy.NpNDArray>NpNDArray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>complementary_incidence_angle</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT>COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>zero_negative_solar_incidence_angle</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT>ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarIncidence>SolarIncidence</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar incidence angle for a surface oriented in any direction.</p> <p>Calculate the solar incidence angle between the sun position unit vector and the surface normal unit vector for a surface oriented in any direction; in other words, the cosine of the angle of incidence. Optionally, the output may be the complementary incidence angle between the sun-to-surface vector and the surface plane.</p> <details class=note open> <summary>Notes</summary> <p>The equation for the incidence angle <code>I</code> by Iqbal (1983) [0]_ [1]_</p> <div class=codehilite><pre><span></span><code>I = Arc cos( cos() <span class=gs>* cos() + sin() *</span> sin() * ( - ) )
</code></pre></div> <p>where :</p> <ul> <li> is the solar zenith angle</li> <li> is the surface tilt angle</li> <li> is the astronomers topocentric azimuth angle</li> <li> is the navigators topocentric azimuth angle</li> </ul> <p>Important observations are :</p> <ul> <li> <p>The topocentric astronomers azimuth angle <code></code> which is measured <em>westward from south</em>.</p> </li> <li> <p>The surface orientation angle <code></code> (also referred to as surface azimuth rotation angle) is measured from south to the projection of the surface normal on the horizontal plane, positive or negative if oriented west or east from south, respectively.</p> </li> <li> <p>The topocentric azimuth angle <code></code> for navigators and solar radiation users (equation 46, p. 588) is measured <em>eastward from north</em> and thus equals the astronomers one plus  or else 180 degrees :</p> </li> </ul> <p> =  + 180</p> <p>and thus</p> <p> =  - 180 [*]</p> <p>In equation I, the surface orientation angle <code></code> measured from south, is subtracted from the astronomers topocentric azimuth angle which is likewise measured from south. Given that most applications measure azimuthal angles from North, care must be taken to feed the correct "version" of these angles in this function.</p> <p>PVGIS measures the user-requested azimuthal angles Solar Azimuth (follownig denoted also with ) and the "solar radiation"-relevant Surface Orientation from North (follownig denoted as <code></code>). Equation I based on [*] becomes relevant for PVGIS in the following form :</p> <div class=codehilite><pre><span></span><code>I = Arc cos( cos() <span class=gs>* cos() + sin() *</span> sin() <span class=gs>* ( - 180 - N - 180) )</span>

<span class=gs>or else</span>

<span class=gs>cosine_solar_incidence_series = (</span>
<span class=gs>    numpy.cos(solar_zenith_series.radians)</span>
<span class=gs>    *</span> cos(surface_tilt.radians)
    + sin(surface_tilt.radians)
    <span class=k>*</span> numpy.sin(solar_zenith_series.radians)
    <span class=k>*</span> numpy.cos(solar_azimuth_series.radians -
    surface_orientation.radians - 2 * pi)
)
</code></pre></div> <p>Nonetheless, and for the sake of consistency with the author's original definition, such conversion are preferrable to be performed in advance and outside the scope of the current function, for both the solar azimuth and the surface orientation angles. Therefore the internal form of the equation uses as per its definition the astronomers topocentric solar azimuth angle and the surface azimuth rotation angle measured from south -- see also source code of this function.</p> </details> <details class=references open> <summary>References</summary> <p>.. [0] Iqbal, 1983</p> <p>.. [1] Equation 47, p. 588),</p> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><span title=pvgisprototype.Longitude>Longitude</span></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><span title=pvgisprototype.Latitude>Latitude</span></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><a class="autorefs autorefs-internal" href=../api/#pvgisprototype.api.datetime.now.now_utc_datetimezone title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">now_utc_datetimezone</span> (<code>pvgisprototype.api.datetime.now.now_utc_datetimezone</code>)'>now_utc_datetimezone</a>()</code> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_orientation</code> </td> <td> <code><span title=pvgisprototype.SurfaceOrientation>SurfaceOrientation</span></code> </td> <td> <div class=doc-md-description> <p>Panel azimuth from north.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_tilt</code> </td> <td> <code><span title=pvgisprototype.SurfaceTilt>SurfaceTilt</span></code> </td> <td> <div class=doc-md-description> <p>Panel tilt from horizontal.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>adjust_for_atmospheric_refraction</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.ATMOSPHERIC_REFRACTION_FLAG_DEFAULT>ATMOSPHERIC_REFRACTION_FLAG_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>complementary_incidence_angle</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT>COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>zero_negative_solar_incidence_angle</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT>ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>solar_incidence_series</code></td> <td> <code><span title=pvgisprototype.SolarIncidence>SolarIncidence</span></code> </td> <td> <div class=doc-md-description> <p>A times series of solar incidence angles between the sun position vector and the surface normal (or plane)</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>Notes from the original pvlib function :</p> <ul> <li> <p>Usage note: When the sun is behind the surface the value returned is negative. For many uses negative values must be set to zero.</p> </li> <li> <p>Input all angles in degrees.</p> </li> </ul> </details> <details class=references open> <summary>References</summary> <p>.. [0] Iqbal, M. An Introduction to Solar Radiation. New York: 1983; pp. 23-25.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/iqbal/solar_incidence.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_incidence_series_iqbal</span><span class=p>(</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n>SurfaceOrientation</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n>SurfaceTilt</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>=</span> <span class=n>now_utc_datetimezone</span><span class=p>(),</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>ATMOSPHERIC_REFRACTION_FLAG_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>    <span class=n>sun_horizon_position</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>SunHorizonPositionModel</span><span class=p>]</span> <span class=o>=</span> <span class=n>SUN_HORIZON_POSITION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n>NpNDArray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>    <span class=n>complementary_incidence_angle</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=n>zero_negative_solar_incidence_angle</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarIncidence</span><span class=p>:</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar incidence angle for a surface oriented in any</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    direction.</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    Calculate the solar incidence angle between the sun position unit vector</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    and the surface normal unit vector for a surface oriented in any direction;</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    in other words, the cosine of the angle of incidence. Optionally, the</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>    output may be the complementary incidence angle between the sun-to-surface</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    vector and the surface plane.</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>    The equation for the incidence angle `I` by Iqbal (1983) [0]_ [1]_</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>        I = Arc cos( cos() * cos() + sin() * sin() * ( - ) )</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    where :</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>    -  is the solar zenith angle</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>    -  is the surface tilt angle</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>    -  is the astronomers topocentric azimuth angle</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    -  is the navigators topocentric azimuth angle</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    Important observations are :</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>    - The topocentric astronomers azimuth angle `` which is measured _westward</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>      from south_.</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>    - The surface orientation angle `` (also referred to as surface azimuth</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>      rotation angle) is measured from south to the projection of the surface</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>      normal on the horizontal plane, positive or negative if oriented west or</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>      east from south, respectively.</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>    - The topocentric azimuth angle `` for navigators and solar radiation</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>      users (equation 46, p. 588) is measured _eastward from north_ and thus</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>      equals the astronomers one plus  or else 180 degrees :</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>        =  + 180</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>       and thus</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>        =  - 180    [*]</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>    In equation I, the surface orientation angle `` measured from south, is</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>    subtracted from the astronomers topocentric azimuth angle which is likewise</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>    measured from south. Given that most applications measure azimuthal angles</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>    from North, care must be taken to feed the correct "version" of these</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>    angles in this function.</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=sd>    PVGIS measures the user-requested azimuthal angles Solar Azimuth (follownig</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=sd>    denoted also with ) and the "solar radiation"-relevant Surface Orientation</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a><span class=sd>    from North (follownig denoted as ``). Equation I based on [*] becomes</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=sd>    relevant for PVGIS in the following form :</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a><span class=sd>        I = Arc cos( cos() * cos() + sin() * sin() * ( - 180 - N - 180) )</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a><span class=sd>        or else</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a><span class=sd>        cosine_solar_incidence_series = (</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=sd>            numpy.cos(solar_zenith_series.radians)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a><span class=sd>            * cos(surface_tilt.radians)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=sd>            + sin(surface_tilt.radians)</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=sd>            * numpy.sin(solar_zenith_series.radians)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>            * numpy.cos(solar_azimuth_series.radians -</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=sd>            surface_orientation.radians - 2 * pi)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>        )</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=sd>    Nonetheless, and for the sake of consistency with the author's original</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a><span class=sd>    definition, such conversion are preferrable to be performed in advance and</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=sd>    outside the scope of the current function, for both the solar azimuth and</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a><span class=sd>    the surface orientation angles. Therefore the internal form of the equation</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=sd>    uses as per its definition the astronomers topocentric solar azimuth angle</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=sd>    and the surface azimuth rotation angle measured from south -- see also</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a><span class=sd>    source code of this function.</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a><span class=sd>    .. [0] Iqbal, 1983</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=sd>    .. [1] Equation 47, p. 588),</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a><span class=sd>    longitude : Longitude</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>    latitude : Latitude</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=sd>    timezone : ZoneInfo</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a><span class=sd>    surface_orientation : SurfaceOrientation</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a><span class=sd>        Panel azimuth from north.</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>    surface_tilt : SurfaceTilt</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=sd>        Panel tilt from horizontal.</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=sd>    adjust_for_atmospheric_refraction : bool</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a><span class=sd>    complementary_incidence_angle : bool</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>    zero_negative_solar_incidence_angle : bool</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=sd>    dtype : str</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>    array_backend : str</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>    verbose : int</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a><span class=sd>    log : int</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>    solar_incidence_series : SolarIncidence</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a><span class=sd>        A times series of solar incidence angles between the sun position</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a><span class=sd>        vector and the surface normal (or plane)</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>    Notes from the original pvlib function :</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a><span class=sd>    - Usage note: When the sun is behind the surface the value returned is</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a><span class=sd>      negative.  For many uses negative values must be set to zero.</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a><span class=sd>    - Input all angles in degrees.</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=sd>    .. [0] Iqbal, M. An Introduction to Solar Radiation. New York: 1983; pp. 23-25.</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>    <span class=n>solar_zenith_series</span> <span class=o>=</span> <span class=n>calculate_solar_zenith_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>        <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>    <span class=n>solar_azimuth_series_north_based</span> <span class=o>=</span> <span class=n>calculate_solar_azimuth_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>        <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>    <span class=p>)</span>  <span class=c1># North = 0 according to NOAA's solar geometry equations</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>    <span class=c1># array_parameters = {</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>    <span class=c1>#     "shape": timestamps.shape,</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>    <span class=c1>#     "dtype": dtype,</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>    <span class=c1>#     "init_method": "empty",</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>    <span class=c1>#     "backend": array_backend,</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>    <span class=c1># }  # Borrow shape from timestamps</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>    <span class=c1># solar_incidence_series = create_array(**array_parameters)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>    <span class=c1># Convert to south-based</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>SolarAzimuth</span><span class=p>(</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=p>(</span><span class=n>solar_azimuth_series_north_based</span><span class=o>.</span><span class=n>radians</span> <span class=o>-</span> <span class=n>pi</span><span class=p>),</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>    <span class=c1># imit  to the range from 0 to 360.</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>    <span class=c1># Divide  by 360, record the decimal fraction of the division as F.</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>    <span class=c1># Divide phi by 360 and get the remainder and the fractional part</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>    <span class=n>fraction_series</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>modf</span><span class=p>(</span><span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>))</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>    <span class=c1># If  is positive, then the limited  = 360 * F .</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>    <span class=c1># If  is negative, then the limited  = 360 - 360 *F.</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>    <span class=c1># Remember all of the metadata ! Review-Me &amp; Abstract-Me !</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>SolarAzimuth</span><span class=p>(</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>numpy</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>            <span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>            <span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span> <span class=o>*</span> <span class=n>fraction_series</span><span class=p>,</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>            <span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span> <span class=o>-</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>fraction_series</span><span class=p>)),</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>        <span class=p>),</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_azimuth_series_north_based</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_azimuth_series_north_based</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>        <span class=n>origin</span><span class=o>=</span><span class=n>solar_azimuth_series_north_based</span><span class=o>.</span><span class=n>origin</span><span class=p>,</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>    <span class=c1># named 'projection' in pvlib</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>    <span class=n>cosine_solar_incidence_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>        <span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>    <span class=p>)</span> <span class=o>+</span> <span class=n>sin</span><span class=p>(</span><span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>        <span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>-</span> <span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>    <span class=p>)</span>  <span class=c1># where :</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>    <span class=c1># solar_azimuth_series : is the astronomers topocentric solar azimuth measured from south</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>    <span class=c1># surface_orientation : is the surface rotation azimuth angle measured from south</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>    <span class=c1># GH 1185 : This is a note from pvlib ?</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>    <span class=c1># projection = numpy.clip(projection, -1, 1)</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>    <span class=n>cosine_solar_incidence_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>cosine_solar_incidence_series</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>    <span class=n>solar_incidence_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>arccos</span><span class=p>(</span><span class=n>cosine_solar_incidence_series</span><span class=p>)</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>    <span class=n>incidence_angle_definition</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>definition_typical</span>  <span class=c1># This is the "standard"</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>    <span class=n>incidence_angle_description</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>description_typical</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>    <span class=k>if</span> <span class=n>complementary_incidence_angle</span><span class=p>:</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>            <span class=sa>f</span><span class=s2>":information: Converting solar incidence angle to </span><span class=si>{</span><span class=n>COMPLEMENTARY_INCIDENCE_ANGLE_DEFINITION</span><span class=si>}</span><span class=s2>..."</span><span class=p>,</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>            <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>":information: [bold][magenta]Converting[/magenta] solar incidence angle to </span><span class=si>{</span><span class=n>COMPLEMENTARY_INCIDENCE_ANGLE_DEFINITION</span><span class=si>}</span><span class=s2>[/bold]..."</span><span class=p>,</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>        <span class=n>solar_incidence_series</span> <span class=o>=</span> <span class=p>(</span><span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span> <span class=o>-</span> <span class=n>solar_incidence_series</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>        <span class=n>incidence_angle_definition</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>definition_complementary</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>        <span class=n>incidence_angle_description</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>description_complementary</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a>    <span class=c1># set negative or below horizon angles ( == solar zenith &gt; 90 ) to 0 !</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>    <span class=c1># Select which solar positions related to the horizon to process</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a>    <span class=n>sun_horizon_positions</span> <span class=o>=</span> <span class=n>select_models</span><span class=p>(</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>        <span class=n>SunHorizonPositionModel</span><span class=p>,</span> <span class=n>sun_horizon_position</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a>    <span class=p>)</span>  <span class=c1># Using a callback fails!</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>    <span class=c1># and keep track of the position of the sun relative to the horizon</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a>    <span class=n>sun_horizon_position_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a>        <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s2>"object"</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"empty"</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>    <span class=n>mask_below_horizon</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>        <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s2>"bool"</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"empty"</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>    <span class=n>mask_low_angle</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>        <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s2>"bool"</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"empty"</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>    <span class=n>mask_above_horizon</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a>        <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s2>"bool"</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"empty"</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a>    <span class=c1># For sun below the horizon</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a>    <span class=k>if</span> <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>below</span> <span class=ow>in</span> <span class=n>sun_horizon_positions</span><span class=p>:</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a>        <span class=n>mask_below_horizon</span> <span class=o>=</span> <span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&gt;</span> <span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a>        <span class=n>sun_horizon_position_series</span><span class=p>[</span><span class=n>mask_below_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a>            <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>below</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>        <span class=p>]</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a>    <span class=c1># For very low sun angles</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a>    <span class=k>if</span> <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>low_angle</span> <span class=ow>in</span> <span class=n>sun_horizon_positions</span><span class=p>:</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>        <span class=n>mask_low_angle</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><a href=#__codelineno-0-328><span class=linenos data-linenos="328 "></span></a>            <span class=p>(</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&lt;=</span> <span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a>                <span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&gt;</span> <span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=mf>0.04</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a>            <span class=p>)</span>  <span class=c1># FIXME: Ensure 0.04 is in radians</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>sun_horizon_position_series</span> <span class=o>==</span> <span class=kc>None</span><span class=p>)</span>  <span class=c1># Operate only on unset elements</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a>        <span class=n>sun_horizon_position_series</span><span class=p>[</span><span class=n>mask_low_angle</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a>            <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>low_angle</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><a href=#__codelineno-0-338><span class=linenos data-linenos="338 "></span></a>    <span class=k>if</span> <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>above</span> <span class=ow>in</span> <span class=n>sun_horizon_positions</span><span class=p>:</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><a href=#__codelineno-0-339><span class=linenos data-linenos="339 "></span></a>        <span class=n>mask_above_horizon</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>logical_and</span><span class=p>(</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><a href=#__codelineno-0-340><span class=linenos data-linenos="340 "></span></a>            <span class=p>(</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>value</span> <span class=o>&lt;</span> <span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span><span class=p>),</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><a href=#__codelineno-0-341><span class=linenos data-linenos="341 "></span></a>            <span class=n>sun_horizon_position_series</span> <span class=o>==</span> <span class=kc>None</span><span class=p>,</span>  <span class=c1># operate only on unset elements</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><a href=#__codelineno-0-342><span class=linenos data-linenos="342 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><a href=#__codelineno-0-343><span class=linenos data-linenos="343 "></span></a>        <span class=n>sun_horizon_position_series</span><span class=p>[</span><span class=n>mask_above_horizon</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><a href=#__codelineno-0-344><span class=linenos data-linenos="344 "></span></a>            <span class=n>SunHorizonPositionModel</span><span class=o>.</span><span class=n>above</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><a href=#__codelineno-0-345><span class=linenos data-linenos="345 "></span></a>        <span class=p>]</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><a href=#__codelineno-0-346><span class=linenos data-linenos="346 "></span></a>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><a href=#__codelineno-0-347><span class=linenos data-linenos="347 "></span></a>    <span class=c1># Combine relevant conditions for no solar incidence</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><a href=#__codelineno-0-348><span class=linenos data-linenos="348 "></span></a>    <span class=n>mask_no_solar_incidence_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>logical_or</span><span class=p>(</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><a href=#__codelineno-0-349><span class=linenos data-linenos="349 "></span></a>        <span class=p>(</span><span class=n>solar_incidence_series</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><a href=#__codelineno-0-350><span class=linenos data-linenos="350 "></span></a>        <span class=o>|</span> <span class=n>mask_below_horizon</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><a href=#__codelineno-0-351><span class=linenos data-linenos="351 "></span></a>        <span class=o>|</span> <span class=n>surface_in_shade_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><a href=#__codelineno-0-352><span class=linenos data-linenos="352 "></span></a>        <span class=n>sun_horizon_position_series</span> <span class=o>==</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><a href=#__codelineno-0-353><span class=linenos data-linenos="353 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><a href=#__codelineno-0-354><span class=linenos data-linenos="354 "></span></a>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><a href=#__codelineno-0-355><span class=linenos data-linenos="355 "></span></a>    <span class=c1># Zero out negative solar incidence angles : is the default behavior !</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><a href=#__codelineno-0-356><span class=linenos data-linenos="356 "></span></a>    <span class=k>if</span> <span class=n>zero_negative_solar_incidence_angle</span><span class=p>:</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><a href=#__codelineno-0-357><span class=linenos data-linenos="357 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><a href=#__codelineno-0-358><span class=linenos data-linenos="358 "></span></a>            <span class=sa>f</span><span class=s2>":information: Setting negative solar incidence angle values to zero..."</span><span class=p>,</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><a href=#__codelineno-0-359><span class=linenos data-linenos="359 "></span></a>            <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>":information: [bold][magenta]Setting[/magenta] [red]negative[/red] solar incidence angle values to [bold]zero[/bold]..."</span><span class=p>,</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><a href=#__codelineno-0-360><span class=linenos data-linenos="360 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><a href=#__codelineno-0-361><span class=linenos data-linenos="361 "></span></a>        <span class=n>solar_incidence_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><a href=#__codelineno-0-362><span class=linenos data-linenos="362 "></span></a>            <span class=n>mask_no_solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><a href=#__codelineno-0-363><span class=linenos data-linenos="363 "></span></a>            <span class=c1># (solar_incidence_series &lt; 0) | (solar_altitude_series.value &lt; 0),</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a><a href=#__codelineno-0-364><span class=linenos data-linenos="364 "></span></a>            <span class=n>NO_SOLAR_INCIDENCE</span><span class=p>,</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><a href=#__codelineno-0-365><span class=linenos data-linenos="365 "></span></a>            <span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><a href=#__codelineno-0-366><span class=linenos data-linenos="366 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><a href=#__codelineno-0-367><span class=linenos data-linenos="367 "></span></a>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><a href=#__codelineno-0-368><span class=linenos data-linenos="368 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><a href=#__codelineno-0-369><span class=linenos data-linenos="369 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><a href=#__codelineno-0-370><span class=linenos data-linenos="370 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><a href=#__codelineno-0-371><span class=linenos data-linenos="371 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><a href=#__codelineno-0-372><span class=linenos data-linenos="372 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><a href=#__codelineno-0-373><span class=linenos data-linenos="373 "></span></a>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><a href=#__codelineno-0-374><span class=linenos data-linenos="374 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><a href=#__codelineno-0-375><span class=linenos data-linenos="375 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><a href=#__codelineno-0-376><span class=linenos data-linenos="376 "></span></a>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><a href=#__codelineno-0-377><span class=linenos data-linenos="377 "></span></a>    <span class=k>return</span> <span class=n>SolarIncidence</span><span class=p>(</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><a href=#__codelineno-0-378><span class=linenos data-linenos="378 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><a href=#__codelineno-0-379><span class=linenos data-linenos="379 "></span></a>        <span class=n>sun_horizon_position</span><span class=o>=</span><span class=n>sun_horizon_position_series</span><span class=p>,</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><a href=#__codelineno-0-380><span class=linenos data-linenos="380 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><a href=#__codelineno-0-381><span class=linenos data-linenos="381 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><a href=#__codelineno-0-382><span class=linenos data-linenos="382 "></span></a>        <span class=n>algorithm</span><span class=o>=</span><span class=n>SolarIncidenceModel</span><span class=o>.</span><span class=n>iqbal</span><span class=p>,</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><a href=#__codelineno-0-383><span class=linenos data-linenos="383 "></span></a>        <span class=n>definition</span><span class=o>=</span><span class=n>incidence_angle_definition</span><span class=p>,</span>  <span class=c1># either the 'typical' or the 'complementary'</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><a href=#__codelineno-0-384><span class=linenos data-linenos="384 "></span></a>        <span class=n>description</span><span class=o>=</span><span class=n>incidence_angle_description</span><span class=p>,</span>  <span class=c1># same as above</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><a href=#__codelineno-0-385><span class=linenos data-linenos="385 "></span></a>        <span class=n>azimuth_origin</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>origin</span><span class=p>,</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><a href=#__codelineno-0-386><span class=linenos data-linenos="386 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.jenco> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">jenco</span> <a class=headerlink href=#pvgisprototype.algorithms.jenco title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.jenco.solar_altitude title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_altitude</span> (<code>pvgisprototype.algorithms.jenco.solar_altitude</code>)'>solar_altitude</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.jenco.solar_azimuth title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_azimuth</span> (<code>pvgisprototype.algorithms.jenco.solar_azimuth</code>)'>solar_azimuth</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.jenco.solar_declination title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_declination</span> (<code>pvgisprototype.algorithms.jenco.solar_declination</code>)'>solar_declination</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.jenco.solar_incidence title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_incidence</span> (<code>pvgisprototype.algorithms.jenco.solar_incidence</code>)'>solar_incidence</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.jenco.solar_altitude> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_altitude</span> <a class=headerlink href=#pvgisprototype.algorithms.jenco.solar_altitude title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.jenco.solar_altitude.calculate_solar_altitude_series_jenco title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_altitude_series_jenco</span> (<code>pvgisprototype.algorithms.jenco.solar_altitude.calculate_solar_altitude_series_jenco</code>)'>calculate_solar_altitude_series_jenco</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar altitude angle () for a time series at a specific</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.jenco.solar_altitude.calculate_solar_altitude_series_jenco> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_altitude_series_jenco</span> <a class=headerlink href=#pvgisprototype.algorithms.jenco.solar_altitude.calculate_solar_altitude_series_jenco title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_altitude_series_jenco</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar altitude angle () for a time series at a specific geographic latitude and longitude.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Longitude of the location in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Latitude of the location in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>Times for which the solar azimuth will be calculated.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> <p>Timezone of the location.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Data type for the calculations.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Backend array library to use.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level of the function.</p> </div> </td> <td> <code>0</code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level for the function.</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></code> </td> <td> <div class=doc-md-description> <p>A custom data class that hold a NumPy NDArray of calculated solar azimuth angles in radians, a method to convert the angles to degrees and other metadata.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> </details> <details class=references open> <summary>References</summary> </details> <p><span class=doc-section-title>Examples:</span></p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/jenco/solar_altitude.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=c1># @validate_with_pydantic(CalculateSolarAltitudeTimeSeriesJencoInput)</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_altitude_series_jenco</span><span class=p>(</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarAltitude</span><span class=p>:</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar altitude angle () for a time series at a specific</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    geographic latitude and longitude.</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    longitude : float</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>        Longitude of the location in radians.</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    latitude : float</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>        Latitude of the location in radians.</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>        Times for which the solar azimuth will be calculated.</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    timezone : ZoneInfo</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        Timezone of the location.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>        Data type for the calculations.</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>        Backend array library to use.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>        Verbosity level of the function.</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        Log level for the function.</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    SolarAltitude</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>        A custom data class that hold a NumPy NDArray of calculated solar</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>        azimuth angles in radians, a method to convert the angles to degrees</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>        and other metadata.</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>calculate_solar_declination_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>        <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=n>calculate_solar_hour_angle_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>    <span class=n>C31</span> <span class=o>=</span> <span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=n>C33</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=n>sine_solar_altitude_series</span> <span class=o>=</span> <span class=n>C31</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>+</span> <span class=n>C33</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=n>solar_altitude_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>arcsin</span><span class=p>(</span><span class=n>sine_solar_altitude_series</span><span class=p>)</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=c1># mask_positive_C31 = C31 &gt; 1e-7</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=c1># solar_altitude_series[mask_positive_C31] = numpy.where(</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=c1>#     sine_solar_altitude_series &lt; 0,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>    <span class=c1>#     NO_SOLAR_INCIDENCE,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>    <span class=c1>#     solar_altitude_series,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=p>(</span><span class=n>solar_altitude_series</span> <span class=o>&lt;</span> <span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=o>|</span> <span class=p>(</span><span class=n>solar_altitude_series</span> <span class=o>&gt;</span> <span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>any</span><span class=p>():</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>solar_altitude_series</span><span class=p>[</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>            <span class=p>(</span><span class=n>solar_altitude_series</span> <span class=o>&lt;</span> <span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>            <span class=o>|</span> <span class=p>(</span><span class=n>solar_altitude_series</span> <span class=o>&gt;</span> <span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=p>]</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=c1># raise ValueError(# ?</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>            <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>            <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=si>}</span><span class=s2>] radians"</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>            <span class=sa>f</span><span class=s2>" in [code]solar_altitude_series[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=k>return</span> <span class=n>SolarAltitude</span><span class=p>(</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>  <span class=c1>#</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>  <span class=c1>#</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.jenco.solar_azimuth> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_azimuth</span> <a class=headerlink href=#pvgisprototype.algorithms.jenco.solar_azimuth title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.jenco.solar_azimuth.calculate_solar_azimuth_series_jenco title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_azimuth_series_jenco</span> (<code>pvgisprototype.algorithms.jenco.solar_azimuth.calculate_solar_azimuth_series_jenco</code>)'>calculate_solar_azimuth_series_jenco</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar azimuth angle () between the sun and meridian</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.jenco.solar_azimuth.calculate_solar_azimuth_series_jenco> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_azimuth_series_jenco</span> <a class=headerlink href=#pvgisprototype.algorithms.jenco.solar_azimuth.calculate_solar_azimuth_series_jenco title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_azimuth_series_jenco</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar azimuth angle () between the sun and meridian measured from East for a time series at a specific geographic latitude and longitude.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Longitude of the location in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Latitude of the location in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>Times for which the solar azimuth will be calculated.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> <p>Timezone of the location.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>adjust_for_atmospheric_refraction</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> <p>Whether to correct the solar zenith angle for atmospheric refraction.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Data type for the calculations.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Backend array library to use.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level of the function.</p> </div> </td> <td> <code>0</code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level for the function.</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></code> </td> <td> <div class=doc-md-description> <p>A custom data class that hold a NumPy NDArray of calculated solar azimuth angles in radians, a method to convert the angles to degrees and other metadata.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>Two important notes on the calculation of the solar azimuth angle :</p> <ul> <li> <p>The equation implemented here follows upon the relevant Wikipedia article for the "Solar azimuth angle" [1]_.</p> </li> <li> <p>The angle derived fom the arccosine function requires an adjustment to correctly represent both morning and afternoon solar azimuth angles.</p> </li> </ul> <p>Adjusting the solar azimuth based on the time of day</p> <p>Given that arccosine ranges in [0, ] or else in [0, 180], the raw calculated solar azimuth angle will likewise range in [0, ]. This necessitates an adjustment based on the time of day.</p> <ul> <li> <p>Morning (solar hour angle &lt; 0): the azimuth angle is correctly derived directly from the arccosine function representing angles from the North clockwise to the South [0, 180].</p> </li> <li> <p>Afternoon (solar hour angle &gt; 0): the azimuth angle needs to be adjusted in order to correctly represent angles going further from the South to the West [180, 360]. This is achieved by subtracting the azimuth from 360.</p> </li> </ul> <p>On the use of arctan2 from Wikipedia :</p> <p>Corollary: if (y1, x1) and (y2, x2) are 2-dimensional vectors, the difference formula is frequently used in practice to compute the angle between those vectors with the help of atan2, since the resulting computation behaves benign in the range (, ] and can thus be used without range checks in many practical situations.</p> <p>The <code>atan2</code> function was originally designed for the convention in pure mathematics that can be termed east-counterclockwise. In practical applications, however, the north-clockwise and south-clockwise conventions are often the norm. The solar azimuth angle for example, that uses both the north-clockwise and south-clockwise conventions widely, can be calculated similarly with the east- and north-components of the solar vector as its arguments. Different conventions can be realized by swapping the positions and changing the signs of the x- and y-arguments as follows:</p> <ul> <li>atan2(y,x) : East-Counterclockwise Convention</li> <li>atan2(x,y) : North-Clockwise Convention</li> <li>atan2(-x,-y) : South-Clockwise Convention</li> </ul> <p>Changing the sign of the x- and/or y-arguments and/or swapping their positions can create 8 possible variations of the atan2 function and they, interestingly, correspond to 8 possible definitions of the angle, namely, clockwise or counterclockwise starting from each of the 4 cardinal directions, north, east, south and west.</p> </details> <details class=references open> <summary>References</summary> <p>.. [0] <a href=https://gml.noaa.gov/grad/solcalc/solareqns.PDF>https://gml.noaa.gov/grad/solcalc/solareqns.PDF</a></p> <p>.. [1] <a href=https://en.wikipedia.org/wiki/Solar_azimuth_angle#Conventional_Trigonometric_Formulas>https://en.wikipedia.org/wiki/Solar_azimuth_angle#Conventional_Trigonometric_Formulas</a></p> <p>.. [2] <a href=https://github.com/pvlib/pvlib-python>https://github.com/pvlib/pvlib-python</a></p> <p>.. [3] <a href=https://github.com/skyfielders/python-skyfield/ >https://github.com/skyfielders/python-skyfield/</a></p> <p>.. [4] <a href=https://github.com/kylebarron/suncalc-py>https://github.com/kylebarron/suncalc-py</a></p> </details> <p><span class=doc-section-title>Examples:</span></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>math</span><span class=w> </span><span class=kn>import</span> <span class=n>radians</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.api.utilities.timestamp</span><span class=w> </span><span class=kn>import</span> <span class=n>generate_datetime_series</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>timestamps</span> <span class=o>=</span> <span class=n>generate_datetime_series</span><span class=p>(</span><span class=n>start_time</span><span class=o>=</span><span class=s1>'2010-01-27'</span><span class=p>,</span> <span class=n>end_time</span><span class=o>=</span><span class=s1>'2010-01-28'</span><span class=p>)</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>zoneinfo</span><span class=w> </span><span class=kn>import</span> <span class=n>ZoneInfo</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.api.position.azimuth_series</span><span class=w> </span><span class=kn>import</span> <span class=n>calculate_solar_azimuth_series_noaa</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>calculate_solar_azimuth_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=gp>... </span><span class=n>longitude</span><span class=o>=</span><span class=n>radians</span><span class=p>(</span><span class=mf>8.628</span><span class=p>),</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=gp>... </span><span class=n>latitude</span><span class=o>=</span><span class=n>radians</span><span class=p>(</span><span class=mf>45.812</span><span class=p>),</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=gp>... </span><span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=gp>... </span><span class=n>timezone</span><span class=o>=</span><span class=n>ZoneInfo</span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>),</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=gp>... </span><span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>solar_azimuth_series</span><span class=p>)</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>degrees</span><span class=p>)</span>
</span></code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/jenco/solar_azimuth.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=c1># @validate_with_pydantic(CalculateSolarAzimuthTimeSeriesJencoInput)</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_azimuth_series_jenco</span><span class=p>(</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarAzimuth</span><span class=p>:</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar azimuth angle () between the sun and meridian</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>    measured from East for a time series at a specific geographic latitude</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    and longitude.</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    longitude : float</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>        Longitude of the location in radians.</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    latitude : float</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>        Latitude of the location in radians.</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>        Times for which the solar azimuth will be calculated.</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    timezone : ZoneInfo</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>        Timezone of the location.</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    adjust_for_atmospheric_refraction : bool, optional</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        Whether to correct the solar zenith angle for atmospheric refraction.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>        Data type for the calculations.</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>        Backend array library to use.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>        Verbosity level of the function.</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        Log level for the function.</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    SolarAzimuth</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>        A custom data class that hold a NumPy NDArray of calculated solar</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>        azimuth angles in radians, a method to convert the angles to degrees</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>        and other metadata.</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    Two important notes on the calculation of the solar azimuth angle :</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    - The equation implemented here follows upon the relevant Wikipedia article</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>      for the "Solar azimuth angle" [1]_.</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    - The angle derived fom the arccosine function requires an adjustment to</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    correctly represent both morning and afternoon solar azimuth angles.</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>    Adjusting the solar azimuth based on the time of day</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    Given that arccosine ranges in [0, ] or else in [0, 180], the raw</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    calculated solar azimuth angle will likewise range in [0, ]. This</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>    necessitates an adjustment based on the time of day.</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    - Morning (solar hour angle &lt; 0): the azimuth angle is correctly</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>      derived directly from the arccosine function representing angles from</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>      the North clockwise to the South [0, 180].</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>    - Afternoon (solar hour angle &gt; 0): the azimuth angle needs to be</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>      adjusted in order to correctly represent angles going further from</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>      the South to the West [180, 360]. This is achieved by subtracting</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>      the azimuth from 360.</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>    On the use of arctan2 from Wikipedia :</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>    Corollary: if (y1, x1) and (y2, x2) are 2-dimensional vectors, the</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>    difference formula is frequently used in practice to compute the angle</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    between those vectors with the help of atan2, since the resulting</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>    computation behaves benign in the range (, ] and can thus be used</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    without range checks in many practical situations.</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>    The `atan2` function was originally designed for the convention in pure</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>    mathematics that can be termed east-counterclockwise. In practical</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>    applications, however, the north-clockwise and south-clockwise conventions</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>    are often the norm. The solar azimuth angle for example, that uses both the</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    north-clockwise and south-clockwise conventions widely, can be calculated</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    similarly with the east- and north-components of the solar vector as its</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>    arguments. Different conventions can be realized by swapping the positions</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>    and changing the signs of the x- and y-arguments as follows:</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    - atan2(y,x) : East-Counterclockwise Convention</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>    - atan2(x,y) : North-Clockwise Convention</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>    - atan2(-x,-y) : South-Clockwise Convention</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>    Changing the sign of the x- and/or y-arguments and/or swapping their</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>    positions can create 8 possible variations of the atan2 function and they,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>    interestingly, correspond to 8 possible definitions of the angle, namely,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>    clockwise or counterclockwise starting from each of the 4 cardinal</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>    directions, north, east, south and west.</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>    .. [0] https://gml.noaa.gov/grad/solcalc/solareqns.PDF</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>    .. [1] https://en.wikipedia.org/wiki/Solar_azimuth_angle#Conventional_Trigonometric_Formulas</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=sd>    .. [2] https://github.com/pvlib/pvlib-python</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=sd>    .. [3] https://github.com/skyfielders/python-skyfield/</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a><span class=sd>    .. [4] https://github.com/kylebarron/suncalc-py</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a><span class=sd>    &gt;&gt;&gt; from math import radians</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.api.utilities.timestamp import generate_datetime_series</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a><span class=sd>    &gt;&gt;&gt; timestamps = generate_datetime_series(start_time='2010-01-27', end_time='2010-01-28')</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=sd>    &gt;&gt;&gt; from zoneinfo import ZoneInfo</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.api.position.azimuth_series import calculate_solar_azimuth_series_noaa</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>    &gt;&gt;&gt; solar_azimuth_series = calculate_solar_azimuth_series_noaa(</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=sd>    ... longitude=radians(8.628),</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>    ... latitude=radians(45.812),</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a><span class=sd>    ... timestamps=timestamps,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=sd>    ... timezone=ZoneInfo("UTC"),</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a><span class=sd>    ... adjust_for_atmospheric_refraction=True</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a><span class=sd>    &gt;&gt;&gt; print(solar_azimuth_series)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=sd>    &gt;&gt;&gt; print(solar_azimuth_series.degrees)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>calculate_solar_declination_series_jenco</span><span class=p>(</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=n>calculate_solar_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>    <span class=n>C11</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>    <span class=n>C13</span> <span class=o>=</span> <span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=n>C22</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>    <span class=n>x_solar_vector_component</span> <span class=o>=</span> <span class=n>C22</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>    <span class=n>y_solar_vector_component</span> <span class=o>=</span> <span class=n>C11</span> <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>-</span> <span class=n>C13</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>    <span class=c1># `x` to `y` derives North-Clockwise azimuth</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>    <span class=n>azimuth_origin</span> <span class=o>=</span> <span class=s2>"North"</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>mod</span><span class=p>(</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=p>(</span><span class=n>pi</span> <span class=o>+</span> <span class=n>numpy</span><span class=o>.</span><span class=n>arctan2</span><span class=p>(</span><span class=n>x_solar_vector_component</span><span class=p>,</span> <span class=n>y_solar_vector_component</span><span class=p>)),</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&lt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=o>|</span> <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&gt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>any</span><span class=p>():</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>        <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>solar_azimuth_series</span><span class=p>[</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>            <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&lt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>            <span class=o>|</span> <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&gt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>        <span class=p>]</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>        <span class=c1># raise ValueError(# ?</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>            <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>            <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=si>}</span><span class=s2>] radians"</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>            <span class=sa>f</span><span class=s2>" in [code]solar_azimuth_series[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>    <span class=k>return</span> <span class=n>SolarAzimuth</span><span class=p>(</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>        <span class=c1># positioning_algorithm=solar_declination_series.solar_positioning_algorithm,  #</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>  <span class=c1>#</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>        <span class=n>origin</span><span class=o>=</span><span class=n>azimuth_origin</span><span class=p>,</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.jenco.solar_declination> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_declination</span> <a class=headerlink href=#pvgisprototype.algorithms.jenco.solar_declination title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.jenco.solar_declination.calculate_solar_declination_series_jenco title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_declination_series_jenco</span> (<code>pvgisprototype.algorithms.jenco.solar_declination.calculate_solar_declination_series_jenco</code>)'>calculate_solar_declination_series_jenco</a></code></td> <td> <div class=doc-md-description> <p>Approximate the sun's declination for a time series.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.jenco.solar_declination.calculate_solar_declination_series_jenco> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_declination_series_jenco</span> <a class=headerlink href=#pvgisprototype.algorithms.jenco.solar_declination.calculate_solar_declination_series_jenco title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_declination_series_jenco</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarDeclination>SolarDeclination</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Approximate the sun's declination for a time series.</p> <p> = arcsin (0.3978 sin (j - 1.4 + 0.0355 sin (j - 0.0489)))</p> <p>The solar declination is the angle between the Sun's rays and the equatorial plane of Earth. It varies throughout the year due to the tilt of the Earth's axis and is an important parameter in determining the seasons and the amount of solar radiation received at different latitudes.</p> <p>The function calculates the <code>proportion</code> of the way through the year (in radians), which is given by <code>(2 * pi * day_of_year) / 365.25</code>. The <code>0.3978</code>, <code>1.4</code>, and <code>0.0355</code> are constants in the approximation formula, with the <code>0.0489</code> being an adjustment factor for the slight eccentricity of Earth's orbit.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>day_of_year</code> </td> <td> </td> <td> <div class=doc-md-description> <p>The day of the year (ranging from 1 to 365 or 366 in a leap year).</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>solar_declination</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The solar declination in radians for the given day of the year.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The equation used here is a simple approximation and bases upon a direct translation from PVGIS' rsun3 source code:</p> <ul> <li>from file: rsun_base.cpp</li> <li>function: com_declin(no_of_day)</li> </ul> <p>For more accurate calculations of solar position, comprehensive models like the Solar Position Algorithm (SPA) are typically used.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/jenco/solar_declination.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_declination_series_jenco</span><span class=p>(</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarDeclination</span><span class=p>:</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=w>    </span><span class=sd>"""Approximate the sun's declination for a time series.</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=sd>     = arcsin (0.3978 sin (j - 1.4 + 0.0355 sin (j - 0.0489)))</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>    The solar declination is the angle between the Sun's rays and the</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>    equatorial plane of Earth. It varies throughout the year due to the tilt of</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    the Earth's axis and is an important parameter in determining the seasons</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    and the amount of solar radiation received at different latitudes.</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    The function calculates the `proportion` of the way through the year (in</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    radians), which is given by `(2 * pi * day_of_year) / 365.25`.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    The `0.3978`, `1.4`, and `0.0355` are constants in the approximation</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    formula, with the `0.0489` being an adjustment factor for the slight</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    eccentricity of Earth's orbit.</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    day_of_year: int</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>        The day of the year (ranging from 1 to 365 or 366 in a leap year).</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    solar_declination: float</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>        The solar declination in radians for the given day of the year.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    The equation used here is a simple approximation and bases upon a direct</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    translation from PVGIS' rsun3 source code:</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>      - from file: rsun_base.cpp</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>      - function: com_declin(no_of_day)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>    For more accurate calculations of solar position, comprehensive models like</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    the Solar Position Algorithm (SPA) are typically used.</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>    <span class=n>day_angle_series</span> <span class=o>=</span> <span class=n>calculate_day_angle_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>arcsin</span><span class=p>(</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=mf>0.3978</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>            <span class=n>day_angle_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>            <span class=o>-</span> <span class=mf>1.4</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>            <span class=o>+</span> <span class=n>eccentricity_amplitude</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>            <span class=o>*</span> <span class=n>numpy</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>day_angle_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>-</span> <span class=n>eccentricity_phase_offset</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>        <span class=p>(</span><span class=n>solar_declination_series</span> <span class=o>&lt;</span> <span class=n>SolarDeclination</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=o>|</span> <span class=p>(</span><span class=n>solar_declination_series</span> <span class=o>&gt;</span> <span class=n>SolarDeclination</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>any</span><span class=p>():</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>solar_declination_series</span><span class=p>[</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>            <span class=p>(</span><span class=n>solar_declination_series</span> <span class=o>&lt;</span> <span class=n>SolarDeclination</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>            <span class=o>|</span> <span class=p>(</span><span class=n>solar_declination_series</span> <span class=o>&gt;</span> <span class=n>SolarDeclination</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=p>]</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=c1># raise ValueError(# ?</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>            <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>            <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>SolarDeclination</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarDeclination</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=si>}</span><span class=s2>] radians"</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>            <span class=sa>f</span><span class=s2>" in [code]solar_declination_series[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>    <span class=k>return</span> <span class=n>SolarDeclination</span><span class=p>(</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>jenco</span><span class=p>,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"Jeno"</span><span class=p>,</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.jenco.solar_incidence> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_incidence</span> <a class=headerlink href=#pvgisprototype.algorithms.jenco.solar_incidence title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.jenco.solar_incidence.calculate_relative_longitude title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_relative_longitude</span> (<code>pvgisprototype.algorithms.jenco.solar_incidence.calculate_relative_longitude</code>)'>calculate_relative_longitude</a></code></td> <td> <div class=doc-md-description> <p>Notes</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.jenco.solar_incidence.calculate_solar_incidence_series_jenco title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_incidence_series_jenco</span> (<code>pvgisprototype.algorithms.jenco.solar_incidence.calculate_solar_incidence_series_jenco</code>)'>calculate_solar_incidence_series_jenco</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar incidence angle between the position of the sun and</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.jenco.solar_incidence.calculate_relative_longitude> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_relative_longitude</span> <a class=headerlink href=#pvgisprototype.algorithms.jenco.solar_incidence.calculate_relative_longitude title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_relative_longitude</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceOrientation>SurfaceOrientation</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceTilt>SurfaceTilt</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.RelativeLongitude>RelativeLongitude</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <details class=note open> <summary>Notes</summary> <p>Hofierka (2002) uses equations presented by Jeno (1992) :</p> <div class=codehilite><pre><span></span><code>tangent_relative_longitude =
    (
        <span class=k>-</span> sin(surface_tilt)
        <span class=k>*</span> sin(surface_orientation)
    ) / (
        sin(latitude)
        <span class=k>*</span> sin(surface_tilt)
        <span class=k>*</span> cos(surface_orientation)
        + cos(latitude)
        <span class=k>*</span> cos(surface_tilt)
    )
</code></pre></div> <p>In PVGIS' C source code, there is an error of one negative sign in either of the expressions! That is so because : cos(pi/2 + x) = -sin(x). As a consequence, the numerator becomes a positive number.</p> <div class=codehilite><pre><span></span><code>Source code :

/* These calculations depend on slope and aspect. Constant for the day if not tracking <span class=gs>*/</span>
<span class=gs>sin_phi_l = -gridGeom-&gt;coslat *</span> cos_u <span class=gs>* sin_v + gridGeom-&gt;sinlat *</span> sin_u;
latid_l = asin(sin_phi_l);
cos_latid_l = cos(latid_l);
q1 = gridGeom-&gt;sinlat <span class=gs>* cos_u *</span> sin_v + gridGeom-&gt;coslat <span class=gs>* sin_u;</span>
<span class=gs>tan_lam_l = - cos_u *</span> cos_v / q1;
longit_l = atan (tan_lam_l);
if((aspect&lt;M_PI)&amp;&amp;(longit_l&lt;0.))
{
    longit_l += M_PI;
}
else if((aspect&gt;M_PI)&amp;&amp;(longit_l&gt;0.))
{
    longit_l -= M_PI;
}


Translation in to Python / pseudocode :

tangent_relative_longitude =
    (
      <span class=k>-</span> cos(half_pi - surface_tilt)         # cos(pi/2 - x) = sin(x)
      <span class=k>*</span> cos(half_pi + surface_orientation)  # cos(pi/2 + x) = -sin(x) #
    ) / (
      sin(latitude)
      <span class=k>*</span> cos(half_pi - surface_tilt)
      <span class=k>*</span> sin(half_pi + surface_orientation)  # sin(pi/2 + x) = cos(x)
      + cos(latitude)
      <span class=k>*</span> sin(half_pi - surface_tilt)         # sin(pi/2 - x) = cos(x)
    )
</code></pre></div> <p>As a consequence, PVGIS is like (note the positive numerator!) :</p> <div class=codehilite><pre><span></span><code>tangent_relative_longitude =
    (
        sin(surface_tilt)
        <span class=k>*</span> sin(surface_orientation)
    ) / (
        sin(latitude)
        <span class=k>*</span> sin(surface_tilt)
        <span class=k>*</span> cos(surface_orientation)
        + cos(latitude)
        <span class=k>*</span> cos(surface_tilt)
    )
</code></pre></div> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/jenco/solar_incidence.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateRelativeLongitudeInputModel</span><span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_relative_longitude</span><span class=p>(</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n>SurfaceOrientation</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n>SurfaceTilt</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>RelativeLongitude</span><span class=p>:</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    Hofierka (2002) uses equations presented by Jeno (1992) :</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>        tangent_relative_longitude =</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>            (</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>                - sin(surface_tilt)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>                * sin(surface_orientation)</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>            ) / (</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>                sin(latitude)</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>                * sin(surface_tilt)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>                * cos(surface_orientation)</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>                + cos(latitude)</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>                * cos(surface_tilt)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>            )</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    In PVGIS' C source code, there is an error of one negative sign in either</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    of the expressions! That is so because : cos(pi/2 + x) = -sin(x).</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>    As a consequence, the numerator becomes a positive number.</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>        Source code :</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>        /* These calculations depend on slope and aspect. Constant for the day if not tracking */</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>        sin_phi_l = -gridGeom-&gt;coslat * cos_u * sin_v + gridGeom-&gt;sinlat * sin_u;</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>        latid_l = asin(sin_phi_l);</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>        cos_latid_l = cos(latid_l);</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>        q1 = gridGeom-&gt;sinlat * cos_u * sin_v + gridGeom-&gt;coslat * sin_u;</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>        tan_lam_l = - cos_u * cos_v / q1;</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>        longit_l = atan (tan_lam_l);</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>        if((aspect&lt;M_PI)&amp;&amp;(longit_l&lt;0.))</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>        {</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>            longit_l += M_PI;</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>        }</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>        else if((aspect&gt;M_PI)&amp;&amp;(longit_l&gt;0.))</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>        {</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>            longit_l -= M_PI;</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>        }</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>        Translation in to Python / pseudocode :</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>        tangent_relative_longitude =</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>            (</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>              - cos(half_pi - surface_tilt)         # cos(pi/2 - x) = sin(x)</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>              * cos(half_pi + surface_orientation)  # cos(pi/2 + x) = -sin(x) #</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>            ) / (</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>              sin(latitude)</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>              * cos(half_pi - surface_tilt)</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>              * sin(half_pi + surface_orientation)  # sin(pi/2 + x) = cos(x)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>              + cos(latitude)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>              * sin(half_pi - surface_tilt)         # sin(pi/2 - x) = cos(x)</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>            )</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>    As a consequence, PVGIS is like (note the positive numerator!) :</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>        tangent_relative_longitude =</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>            (</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=sd>                sin(surface_tilt)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=sd>                * sin(surface_orientation)</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a><span class=sd>            ) / (</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=sd>                sin(latitude)</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a><span class=sd>                * sin(surface_tilt)</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a><span class=sd>                * cos(surface_orientation)</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a><span class=sd>                + cos(latitude)</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a><span class=sd>                * cos(surface_tilt)</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=sd>            )</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>    <span class=c1># -----------------------------------------------------------------------</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=c1># in PVGIS an extra minus sign results to an all positive numerator!</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=c1># tangent_relative_longitude_numerator = sin(surface_tilt.radians) * sin(</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=c1>#     surface_orientation.radians</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=c1># -----------------------------------------------------------------------</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>    <span class=n>tangent_relative_longitude_numerator</span> <span class=o>=</span> <span class=o>-</span><span class=p>(</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>        <span class=n>sin</span><span class=p>(</span><span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span><span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=n>tangent_relative_longitude_denominator</span> <span class=o>=</span> <span class=o>-</span><span class=p>(</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=n>sin</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=o>*</span> <span class=n>sin</span><span class=p>(</span><span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>        <span class=o>*</span> <span class=n>cos</span><span class=p>(</span><span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>        <span class=o>+</span> <span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span><span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>    <span class=c1># force dtype !</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>    <span class=n>relative_longitude</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=p>[</span><span class=n>tangent_relative_longitude_numerator</span> <span class=o>/</span> <span class=n>tangent_relative_longitude_denominator</span><span class=p>],</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>relative_longitude</span><span class=p>,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>    <span class=k>return</span> <span class=n>RelativeLongitude</span><span class=p>(</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>relative_longitude</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.jenco.solar_incidence.calculate_solar_incidence_series_jenco> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_incidence_series_jenco</span> <a class=headerlink href=#pvgisprototype.algorithms.jenco.solar_incidence.calculate_solar_incidence_series_jenco title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_incidence_series_jenco</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceOrientation>SurfaceOrientation</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceTilt>SurfaceTilt</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ATMOSPHERIC_REFRACTION_FLAG_DEFAULT>ATMOSPHERIC_REFRACTION_FLAG_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n><span title=pydantic_numpy.NpNDArray>NpNDArray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>complementary_incidence_angle</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT>COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>zero_negative_solar_incidence_angle</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT>ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarIncidence>SolarIncidence</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar incidence angle between the position of the sun and a reference solar surface.</p> <p>Calculate the solar incidence angle based on the position of the sun (sun-vector) and the a reference solar surface. Typically the solar incidence is the angle between the sun-vector and the normal to the solar surface (surface-normal). However, the underlying functions that convert horizontal irradiance components to inclined, expect the complementary incidence angle which is defined as the angle between the sun-vector and the inclination or plane of the reference solar surface (surface-plane). We call this the "complementary" incidence angle contrasting typical definitions of the incidence angle between the sun-vector and the normal to the surface in question. Alternatively the function can return the angle between the sun-vector and the normal vector to the reference surface.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Longitude in degrees</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Latitude in degrees</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>surface_orientation</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Orientation of the surface (azimuth angle in degrees)</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>surface_tilt</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Tilt of the surface in degrees</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>Solar incidence angle or NO_SOLAR_INCIDENCE series if a shadow is detected.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The solar incidence angle is the single most important quantity in the solar geometry setup. Its definition will affect all subsequent operations excluding none of the irradiance components, nor the photovoltaic power or energy estimations.</p> <p>Attention! There is no one, and only one, definition of the solar incidence angle! While many authors refer to the angle between the sun-vector and the normal to the reference surface, for example Martin and Ruiz (2002, 2005), others, like for example Jeno (1992) and Hofierka (2002), consider as incidence the angle between the sun-vector and the reference surface-plane. These angles are complementary to each other. This fact is an important one when treating trigonometric relationships that affect the calculation of the incidence angle.</p> <p>In this program, we implement and consider as <em>complementary</em> the incidence angle as defined by Jeno (1992) between the direction of the sun-rays and the inclination angle, or plane, of a reference surface. Hence, the default modus of this function returns the <em>complementary</em> incidence angle.</p> <p>Following is meant to visualise a flat horizontal surface and the direction of a sun-ray. The angle between the two is what we call complementary.</p> <div class=codehilite><pre><span></span><code>                     ____
</code></pre></div> <p>Optionally, the function can return the <em>typical</em> incidence angle between the direction of the sun-rays and the normal direction to the reference surface in question.</p> <p>Following means to visualise the same direction of a sun-ray and then the normal (vertical here) direction to the flat horizontal surface. The angle between the sun-ray and the normal (vertical here) direction is the <em>typical</em> definition of the solar incidence angle. This angle can be generated via the <code>complementary_incidence_angle</code> flag.</p> <div class=codehilite><pre><span></span><code> \  |
  \ |
</code></pre></div> </details> <details class=-------\| open> <summary><div class=codehilite><pre><span></span><code>   \|
</code></pre></div></summary> <p>Reading the paper by Jeno (1992) [1]_ (last page is a summary translation in English):</p> <div class=codehilite><pre><span></span><code><span class=nv>Orientation</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>georelief</span><span class=w> </span><span class=nv>An</span><span class=w> </span><span class=nv>with</span><span class=w> </span><span class=nv>respect</span><span class=w> </span><span class=nv>to</span><span class=w> </span><span class=nv>Cardinal</span><span class=w> </span><span class=nv>points</span><span class=w> </span><span class=nv>and</span><span class=w> </span><span class=nv>slopes</span>
<span class=nv>N</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>georelief</span><span class=w> </span><span class=nv>in</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>direction</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>slope</span><span class=w> </span><span class=nv>curves</span><span class=w> </span><span class=nv>in</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>given</span><span class=w> </span><span class=nv>point</span><span class=w> </span><span class=nv>on</span>
<span class=nv>the</span><span class=w> </span><span class=nv>georelief</span><span class=w> </span><span class=nv>with</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>latitude</span><span class=w> </span><span class=w> </span><span class=nv>determines</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>latitude</span><span class=w> </span><span class=err>' and in</span>
<span class=nv>relation</span><span class=w> </span><span class=nv>to</span><span class=w> </span><span class=nv>longitude</span><span class=w> </span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>this</span><span class=w> </span><span class=nv>point</span><span class=w> </span><span class=nv>also</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>relative</span><span class=w> </span><span class=nv>longitude</span><span class=w> </span><span class=err>' of</span>
<span class=err>the contact point of contact plane to reference spheric surface of the</span>
<span class=err>Earth with identical course of the insolation (Fig. 1). Thus sinus of</span>
<span class=err>insolation angle exp on georelief for the local time moment T can be</span>
<span class=err>expressed by modification of a relation that is well known in astronomy</span>
<span class=err>for the calculation of sinus of solar altitude h0 a form of equation</span>
<span class=ss>(</span><span class=mi>3</span><span class=ss>)</span>.<span class=w> </span><span class=nv>Latitude</span><span class=w> </span><span class=s1>' and longitude '</span><span class=w> </span><span class=nv>in</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>equation</span><span class=w> </span><span class=ss>(</span><span class=mi>3</span><span class=ss>)</span><span class=w> </span><span class=nv>is</span><span class=w> </span><span class=nv>definitely</span>
<span class=nv>determined</span><span class=w> </span><span class=nv>on</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>basis</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>transformation</span><span class=w> </span><span class=nv>equations</span><span class=w> </span><span class=ss>(</span><span class=mi>4</span>.<span class=mi>3</span>.<span class=mi>31</span><span class=ss>)</span><span class=w> </span><span class=nv>in</span><span class=w> </span><span class=nv>the</span>
<span class=nv>work</span><span class=w> </span>[<span class=mi>5</span>]<span class=w> </span><span class=nv>in</span><span class=w> </span><span class=nv>dependence</span><span class=w> </span><span class=nv>on</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>assessment</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>basic</span><span class=w> </span><span class=nv>direction</span><span class=w> </span><span class=nv>of</span>
<span class=nv>orientation</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>georelief</span><span class=w> </span><span class=nv>AN</span><span class=w> </span><span class=nv>with</span><span class=w> </span><span class=nv>respect</span><span class=w> </span><span class=nv>to</span><span class=w> </span><span class=nv>the</span><span class=w> </span><span class=nv>cardinal</span><span class=w> </span><span class=nv>points</span><span class=w> </span><span class=nv>by</span>
<span class=nv>goniometric</span><span class=w> </span><span class=nv>equations</span><span class=w> </span><span class=ss>(</span><span class=mi>5</span><span class=ss>)</span>,<span class=w> </span><span class=ss>(</span><span class=mi>6</span><span class=ss>)</span><span class=w> </span><span class=nv>or</span><span class=w> </span><span class=ss>(</span><span class=mi>9</span><span class=ss>)</span>,<span class=w> </span><span class=ss>(</span><span class=mi>10</span><span class=ss>)</span>.<span class=w> </span><span class=nv>After</span><span class=w> </span><span class=nv>determination</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>the</span>
<span class=nv>hour</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>sunrise</span><span class=w> </span><span class=ss>(</span><span class=nv>Tv</span><span class=ss>)</span><span class=nv>s</span><span class=w> </span><span class=nv>from</span><span class=w> </span><span class=nv>shadow</span><span class=w> </span><span class=nv>to</span><span class=w> </span><span class=nv>light</span><span class=w> </span><span class=nv>and</span><span class=w> </span><span class=nv>hour</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>sunset</span><span class=w> </span><span class=ss>(</span><span class=nv>Tr</span><span class=ss>)</span><span class=nv>s</span>
<span class=nv>from</span><span class=w> </span><span class=nv>light</span><span class=w> </span><span class=nv>to</span><span class=w> </span><span class=nv>shadow</span><span class=w> </span><span class=nv>by</span><span class=w> </span><span class=nv>equations</span><span class=w> </span><span class=ss>(</span><span class=mi>12</span><span class=ss>)</span>,<span class=w> </span><span class=ss>(</span><span class=mi>13</span><span class=ss>)</span><span class=w> </span><span class=nv>abstracting</span><span class=w> </span><span class=nv>also</span><span class=w> </span><span class=nv>from</span><span class=w> </span><span class=nv>hill</span>
<span class=nv>shading</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>georelief</span>,<span class=w> </span><span class=nv>total</span><span class=w> </span><span class=nv>quantity</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>direct</span><span class=w> </span><span class=nv>solar</span><span class=w> </span><span class=nv>irradiance</span><span class=w> </span><span class=nv>Qd</span><span class=w> </span><span class=nv>on</span>
<span class=nv>the</span><span class=w> </span><span class=nv>unit</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>area</span><span class=w> </span><span class=nv>of</span><span class=w> </span><span class=nv>georelief</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=nv>one</span><span class=w> </span><span class=nv>day</span><span class=w> </span><span class=nv>under</span><span class=w> </span><span class=nv>blue</span><span class=w> </span><span class=nv>sky</span><span class=w> </span><span class=nv>conditions</span><span class=w> </span><span class=nv>can</span>
<span class=nv>be</span><span class=w> </span><span class=nv>expressed</span><span class=w> </span><span class=nv>by</span><span class=w> </span><span class=nv>equation</span><span class=w> </span><span class=ss>(</span><span class=mi>14</span><span class=ss>)</span>.
</code></pre></div> <p>Although Hofierka (2002) does not explicitly state "the angle between the sun-vector and the plane to the surface," he borrows the equation defined by Jeno (1992) who measures the incidence angle between the sun-vector and plane of the reference solar surface. Care needs to be taken when comparing or using other definitions of the solar incidence angle.</p> <p>An inclined surface is defined by the inclination angle (also known as slope or tilt) <code>N</code> and the azimuth (also known as aspect or orientation) <code>AN</code>. The latter is the angle between the projection of the normal on the horizontal surface and East.</p> <p>tg(') = - (sin(N) * sin(AN)) / (sin() * sin(N) * cos(AN) + cos() * cos(N)) sin(') = - cos() * sin(N) * cos(AN) + sin() * cos(N) C'31 = cos ' cos  C'33 = sin ' sin </p> <p>From PVGIS' C++ source code:</p> <p>The <code>timeAngle</code> (which is the solar hour angle) in <code>rsun_standalone_hourly_opt.cpp</code> is calculated via:</p> <div class=codehilite><pre><span></span><code><span class=err>`</span><span class=n>sunGeom</span><span class=o>-&gt;</span><span class=n>timeAngle</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>solarTimeOfDay</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>12</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>HOURANGLE</span><span class=p>;</span><span class=err>`</span>
</code></pre></div> <p>where HOUR_ANGLE is defined as <code>HOUR_ANGLE = pi / 12.0</code> which is the conversion factor to radians ( / 12 = 0.261799) and hence this is the equation to calculate the hour angle in radians, e.g., as per NOAA's equation:</p> <div class=codehilite><pre><span></span><code><span class=sb>`solar_hour_angle = (true_solar_time - 720) * (pi / 720)`</span>.
</code></pre></div> <p>in which 720 is minutes, whereas 60 is hours in PVGIS' C++ code.</p> <ul> <li>Shadow check not implemented.</li> </ul> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/jenco/solar_incidence.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarIncidenceTimeSeriesJencoInputModel</span><span class=p>)</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_incidence_series_jenco</span><span class=p>(</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n>SurfaceOrientation</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n>SurfaceTilt</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>ATMOSPHERIC_REFRACTION_FLAG_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n>NpNDArray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>    <span class=n>complementary_incidence_angle</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>    <span class=n>zero_negative_solar_incidence_angle</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarIncidence</span><span class=p>:</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar incidence angle between the position of the sun and</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a><span class=sd>    a reference solar surface.</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a><span class=sd>    Calculate the solar incidence angle based on the position of the sun</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=sd>    (sun-vector) and the a reference solar surface. Typically the solar</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a><span class=sd>    incidence is the angle between the sun-vector and the normal to the solar</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=sd>    surface (surface-normal). However, the underlying functions that convert</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a><span class=sd>    horizontal irradiance components to inclined, expect the complementary</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a><span class=sd>    incidence angle which is defined as the angle between the sun-vector and</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a><span class=sd>    the inclination or plane of the reference solar surface (surface-plane).</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a><span class=sd>    We call this the "complementary" incidence angle contrasting typical</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a><span class=sd>    definitions of the incidence angle between the sun-vector and the normal to</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a><span class=sd>    the surface in question. Alternatively the function can return the angle</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a><span class=sd>    between the sun-vector and the normal vector to the reference surface.</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a><span class=sd>    longitude : float</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a><span class=sd>        Longitude in degrees</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a><span class=sd>    latitude : float</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a><span class=sd>        Latitude in degrees</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a><span class=sd>    surface_orientation : float</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a><span class=sd>        Orientation of the surface (azimuth angle in degrees)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a><span class=sd>    surface_tilt : float</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a><span class=sd>        Tilt of the surface in degrees</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a><span class=sd>    ndarray</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a><span class=sd>        Solar incidence angle or NO_SOLAR_INCIDENCE series if a shadow is detected.</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a><span class=sd>    The solar incidence angle is the single most important quantity in the</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a><span class=sd>    solar geometry setup. Its definition will affect all subsequent operations</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a><span class=sd>    excluding none of the irradiance components, nor the photovoltaic power or</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a><span class=sd>    energy estimations.</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a><span class=sd>    Attention! There is no one, and only one, definition of the solar incidence</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a><span class=sd>    angle! While many authors refer to the angle between the sun-vector and the</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a><span class=sd>    normal to the reference surface, for example Martin and Ruiz (2002, 2005),</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a><span class=sd>    others, like for example Jeno (1992) and Hofierka (2002), consider as</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a><span class=sd>    incidence the angle between the sun-vector and the reference surface-plane.</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a><span class=sd>    These angles are complementary to each other. This fact is an important one</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a><span class=sd>    when treating trigonometric relationships that affect the calculation of</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a><span class=sd>    the incidence angle.</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a><span class=sd>    In this program, we implement and consider as _complementary_ the incidence</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a><span class=sd>    angle as defined by Jeno (1992) between the direction of the sun-rays and</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a><span class=sd>    the inclination angle, or plane, of a reference surface. Hence, the default</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a><span class=sd>    modus of this function returns the _complementary_ incidence angle.</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a><span class=sd>    Following is meant to visualise a flat horizontal surface and the</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a><span class=sd>    direction of a sun-ray. The angle between the two is what we call</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a><span class=sd>    complementary.</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a><span class=sd>          \</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a><span class=sd>           \</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a><span class=sd>        ____\</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a><span class=sd>    Optionally, the function can return the _typical_ incidence angle between</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a><span class=sd>    the direction of the sun-rays and the normal direction to the reference</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a><span class=sd>    surface in question.</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a><span class=sd>    Following means to visualise the same direction of a sun-ray and then the</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a><span class=sd>    normal (vertical here) direction to the flat horizontal surface. The angle</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a><span class=sd>    between the sun-ray and the normal (vertical here) direction is the</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a><span class=sd>    _typical_ definition of the solar incidence angle. This angle can be</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a><span class=sd>    generated via the `complementary_incidence_angle` flag.</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a><span class=sd>         \  |</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a><span class=sd>          \ |</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a><span class=sd>           \|</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a><span class=sd>        -----</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a><span class=sd>    Reading the paper by Jeno (1992) [1]_ (last page is a summary translation in</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a><span class=sd>    English):</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a><span class=sd>        Orientation of georelief An with respect to Cardinal points and slopes</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a><span class=sd>        N of georelief in the direction of slope curves in the given point on</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a><span class=sd>        the georelief with the latitude  determines the latitude ' and in</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a><span class=sd>        relation to longitude  of this point also the relative longitude ' of</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a><span class=sd>        the contact point of contact plane to reference spheric surface of the</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a><span class=sd>        Earth with identical course of the insolation (Fig. 1). Thus sinus of</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a><span class=sd>        insolation angle exp on georelief for the local time moment T can be</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a><span class=sd>        expressed by modification of a relation that is well known in astronomy</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a><span class=sd>        for the calculation of sinus of solar altitude h0 a form of equation</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a><span class=sd>        (3). Latitude ' and longitude ' in the equation (3) is definitely</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a><span class=sd>        determined on the basis of transformation equations (4.3.31) in the</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a><span class=sd>        work [5] in dependence on the assessment of the basic direction of</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a><span class=sd>        orientation of georelief AN with respect to the cardinal points by</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a><span class=sd>        goniometric equations (5), (6) or (9), (10). After determination of the</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a><span class=sd>        hour of sunrise (Tv)s from shadow to light and hour of sunset (Tr)s</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a><span class=sd>        from light to shadow by equations (12), (13) abstracting also from hill</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a><span class=sd>        shading of georelief, total quantity of direct solar irradiance Qd on</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a><span class=sd>        the unit of area of georelief for one day under blue sky conditions can</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a><span class=sd>        be expressed by equation (14).</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a><span class=sd>    Although Hofierka (2002) does not explicitly state "the angle between the</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a><span class=sd>    sun-vector and the plane to the surface," he borrows the equation defined</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a><span class=sd>    by Jeno (1992) who measures the incidence angle between the sun-vector and</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a><span class=sd>    plane of the reference solar surface. Care needs to be taken when comparing</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a><span class=sd>    or using other definitions of the solar incidence angle.</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a><span class=sd>    An inclined surface is defined by the inclination angle (also known as</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a><span class=sd>    slope or tilt) `N` and the azimuth (also known as aspect or orientation)</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a><span class=sd>    `AN`. The latter is the angle between the projection of the normal on the</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a><span class=sd>    horizontal surface and East.</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a><span class=sd>    tg(') = - (sin(N) * sin(AN)) / (sin() * sin(N) * cos(AN) + cos() * cos(N))</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a><span class=sd>    sin(') = - cos() * sin(N) * cos(AN) + sin() * cos(N)</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a><span class=sd>    C'31 = cos ' cos </span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a><span class=sd>    C'33 = sin ' sin </span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a><span class=sd>    From PVGIS' C++ source code:</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a><span class=sd>    The `timeAngle` (which is the solar hour</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a><span class=sd>    angle) in `rsun_standalone_hourly_opt.cpp` is calculated via:</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a><span class=sd>        `sunGeom-&gt;timeAngle = (solarTimeOfDay - 12) * HOURANGLE;`</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><a href=#__codelineno-0-328><span class=linenos data-linenos="328 "></span></a>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a><span class=sd>    where HOUR_ANGLE is defined as `HOUR_ANGLE = pi / 12.0`</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a><span class=sd>    which is the conversion factor to radians ( / 12 = 0.261799)</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a><span class=sd>    and hence this is the equation to calculate the hour angle in radians,</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a><span class=sd>    e.g., as per NOAA's equation:</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a><span class=sd>        `solar_hour_angle = (true_solar_time - 720) * (pi / 720)`.</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a><span class=sd>    in which 720 is minutes, whereas 60 is hours in PVGIS' C++ code.</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><a href=#__codelineno-0-338><span class=linenos data-linenos="338 "></span></a><span class=sd>    - Shadow check not implemented.</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><a href=#__codelineno-0-339><span class=linenos data-linenos="339 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><a href=#__codelineno-0-340><span class=linenos data-linenos="340 "></span></a>    <span class=c1># Identify times without solar insolation</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><a href=#__codelineno-0-341><span class=linenos data-linenos="341 "></span></a>    <span class=n>solar_altitude_series</span> <span class=o>=</span> <span class=n>calculate_solar_altitude_series_jenco</span><span class=p>(</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><a href=#__codelineno-0-342><span class=linenos data-linenos="342 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><a href=#__codelineno-0-343><span class=linenos data-linenos="343 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><a href=#__codelineno-0-344><span class=linenos data-linenos="344 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><a href=#__codelineno-0-345><span class=linenos data-linenos="345 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><a href=#__codelineno-0-346><span class=linenos data-linenos="346 "></span></a>        <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><a href=#__codelineno-0-347><span class=linenos data-linenos="347 "></span></a>        <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><a href=#__codelineno-0-348><span class=linenos data-linenos="348 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><a href=#__codelineno-0-349><span class=linenos data-linenos="349 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><a href=#__codelineno-0-350><span class=linenos data-linenos="350 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><a href=#__codelineno-0-351><span class=linenos data-linenos="351 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><a href=#__codelineno-0-352><span class=linenos data-linenos="352 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><a href=#__codelineno-0-353><span class=linenos data-linenos="353 "></span></a>    <span class=n>solar_azimuth_east_based_series</span> <span class=o>=</span> <span class=n>calculate_solar_azimuth_series_jenco</span><span class=p>(</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><a href=#__codelineno-0-354><span class=linenos data-linenos="354 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><a href=#__codelineno-0-355><span class=linenos data-linenos="355 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><a href=#__codelineno-0-356><span class=linenos data-linenos="356 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><a href=#__codelineno-0-357><span class=linenos data-linenos="357 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><a href=#__codelineno-0-358><span class=linenos data-linenos="358 "></span></a>        <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><a href=#__codelineno-0-359><span class=linenos data-linenos="359 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><a href=#__codelineno-0-360><span class=linenos data-linenos="360 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><a href=#__codelineno-0-361><span class=linenos data-linenos="361 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><a href=#__codelineno-0-362><span class=linenos data-linenos="362 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><a href=#__codelineno-0-363><span class=linenos data-linenos="363 "></span></a>    <span class=p>)</span>  <span class=c1># Origin ?</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a><a href=#__codelineno-0-364><span class=linenos data-linenos="364 "></span></a>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><a href=#__codelineno-0-365><span class=linenos data-linenos="365 "></span></a>    <span class=c1># from pvgisprototype import SolarAzimuth</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><a href=#__codelineno-0-366><span class=linenos data-linenos="366 "></span></a>    <span class=c1># solar_azimuth_series = SolarAzimuth(</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><a href=#__codelineno-0-367><span class=linenos data-linenos="367 "></span></a>    <span class=c1>#     value=(solar_azimuth_east_based_series.value + np.pi/2),</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><a href=#__codelineno-0-368><span class=linenos data-linenos="368 "></span></a>    <span class=c1>#     unit=RADIANS,</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><a href=#__codelineno-0-369><span class=linenos data-linenos="369 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><a href=#__codelineno-0-370><span class=linenos data-linenos="370 "></span></a>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><a href=#__codelineno-0-371><span class=linenos data-linenos="371 "></span></a>    <span class=c1># Prepare relevant quantities</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><a href=#__codelineno-0-372><span class=linenos data-linenos="372 "></span></a>    <span class=n>sine_relative_inclined_latitude</span> <span class=o>=</span> <span class=o>-</span><span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><a href=#__codelineno-0-373><span class=linenos data-linenos="373 "></span></a>        <span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><a href=#__codelineno-0-374><span class=linenos data-linenos="374 "></span></a>    <span class=p>)</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span><span class=n>surface_orientation</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>+</span> <span class=n>sin</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><a href=#__codelineno-0-375><span class=linenos data-linenos="375 "></span></a>        <span class=n>surface_tilt</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><a href=#__codelineno-0-376><span class=linenos data-linenos="376 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><a href=#__codelineno-0-377><span class=linenos data-linenos="377 "></span></a>    <span class=n>relative_inclined_latitude</span> <span class=o>=</span> <span class=n>asin</span><span class=p>(</span><span class=n>sine_relative_inclined_latitude</span><span class=p>)</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><a href=#__codelineno-0-378><span class=linenos data-linenos="378 "></span></a>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><a href=#__codelineno-0-379><span class=linenos data-linenos="379 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>calculate_solar_declination_series_jenco</span><span class=p>(</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><a href=#__codelineno-0-380><span class=linenos data-linenos="380 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><a href=#__codelineno-0-381><span class=linenos data-linenos="381 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><a href=#__codelineno-0-382><span class=linenos data-linenos="382 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><a href=#__codelineno-0-383><span class=linenos data-linenos="383 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><a href=#__codelineno-0-384><span class=linenos data-linenos="384 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><a href=#__codelineno-0-385><span class=linenos data-linenos="385 "></span></a>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><a href=#__codelineno-0-386><span class=linenos data-linenos="386 "></span></a>    <span class=n>c_inclined_31_series</span> <span class=o>=</span> <span class=n>cos</span><span class=p>(</span><span class=n>relative_inclined_latitude</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><a href=#__codelineno-0-387><span class=linenos data-linenos="387 "></span></a>        <span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a><a href=#__codelineno-0-388><span class=linenos data-linenos="388 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a><a href=#__codelineno-0-389><span class=linenos data-linenos="389 "></span></a>    <span class=n>c_inclined_33_series</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>relative_inclined_latitude</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a><a href=#__codelineno-0-390><span class=linenos data-linenos="390 "></span></a>        <span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><a href=#__codelineno-0-391><span class=linenos data-linenos="391 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a><a href=#__codelineno-0-392><span class=linenos data-linenos="392 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=n>calculate_solar_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><a href=#__codelineno-0-393><span class=linenos data-linenos="393 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a><a href=#__codelineno-0-394><span class=linenos data-linenos="394 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><a href=#__codelineno-0-395><span class=linenos data-linenos="395 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><a href=#__codelineno-0-396><span class=linenos data-linenos="396 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><a href=#__codelineno-0-397><span class=linenos data-linenos="397 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><a href=#__codelineno-0-398><span class=linenos data-linenos="398 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><a href=#__codelineno-0-399><span class=linenos data-linenos="399 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><a href=#__codelineno-0-400><span class=linenos data-linenos="400 "></span></a>    <span class=n>relative_longitude</span> <span class=o>=</span> <span class=n>calculate_relative_longitude</span><span class=p>(</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><a href=#__codelineno-0-401><span class=linenos data-linenos="401 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><a href=#__codelineno-0-402><span class=linenos data-linenos="402 "></span></a>        <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><a href=#__codelineno-0-403><span class=linenos data-linenos="403 "></span></a>        <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><a href=#__codelineno-0-404><span class=linenos data-linenos="404 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><a href=#__codelineno-0-405><span class=linenos data-linenos="405 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><a href=#__codelineno-0-406><span class=linenos data-linenos="406 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><a href=#__codelineno-0-407><span class=linenos data-linenos="407 "></span></a>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><a href=#__codelineno-0-408><span class=linenos data-linenos="408 "></span></a>    <span class=c1># Note the - in front of the solar_hour_angle_series ! Explain-Me !</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a><a href=#__codelineno-0-409><span class=linenos data-linenos="409 "></span></a>    <span class=n>sine_solar_incidence_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><a href=#__codelineno-0-410><span class=linenos data-linenos="410 "></span></a>        <span class=n>c_inclined_31_series</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><a href=#__codelineno-0-411><span class=linenos data-linenos="411 "></span></a>        <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>-</span> <span class=n>relative_longitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><a href=#__codelineno-0-412><span class=linenos data-linenos="412 "></span></a>        <span class=o>+</span> <span class=n>c_inclined_33_series</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a><a href=#__codelineno-0-413><span class=linenos data-linenos="413 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a><a href=#__codelineno-0-414><span class=linenos data-linenos="414 "></span></a>    <span class=n>solar_incidence_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arcsin</span><span class=p>(</span><span class=n>sine_solar_incidence_series</span><span class=p>)</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a><a href=#__codelineno-0-415><span class=linenos data-linenos="415 "></span></a>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a><a href=#__codelineno-0-416><span class=linenos data-linenos="416 "></span></a>    <span class=n>incidence_angle_definition</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>definition_complementary</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a><a href=#__codelineno-0-417><span class=linenos data-linenos="417 "></span></a>    <span class=n>incidence_angle_description</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>description_complementary</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a><a href=#__codelineno-0-418><span class=linenos data-linenos="418 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>complementary_incidence_angle</span><span class=p>:</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a><a href=#__codelineno-0-419><span class=linenos data-linenos="419 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a><a href=#__codelineno-0-420><span class=linenos data-linenos="420 "></span></a>            <span class=sa>f</span><span class=s2>":information: Converting solar incidence angle to </span><span class=si>{</span><span class=n>COMPLEMENTARY_INCIDENCE_ANGLE_DEFINITION</span><span class=si>}</span><span class=s2>..."</span><span class=p>,</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a><a href=#__codelineno-0-421><span class=linenos data-linenos="421 "></span></a>            <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>":information: [bold][magenta]Converting[/magenta] solar incidence angle to </span><span class=si>{</span><span class=n>COMPLEMENTARY_INCIDENCE_ANGLE_DEFINITION</span><span class=si>}</span><span class=s2>[/bold]..."</span><span class=p>,</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a><a href=#__codelineno-0-422><span class=linenos data-linenos="422 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a><a href=#__codelineno-0-423><span class=linenos data-linenos="423 "></span></a>        <span class=n>solar_incidence_series</span> <span class=o>=</span> <span class=p>(</span><span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span> <span class=o>-</span> <span class=n>solar_incidence_series</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a><a href=#__codelineno-0-424><span class=linenos data-linenos="424 "></span></a>        <span class=n>incidence_angle_definition</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>definition</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><a href=#__codelineno-0-425><span class=linenos data-linenos="425 "></span></a>        <span class=n>incidence_angle_description</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>description</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><a href=#__codelineno-0-426><span class=linenos data-linenos="426 "></span></a>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a><a href=#__codelineno-0-427><span class=linenos data-linenos="427 "></span></a>    <span class=c1># Combined mask for no solar incidence, negative solar incidence or below horizon angles</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a><a href=#__codelineno-0-428><span class=linenos data-linenos="428 "></span></a>    <span class=n>mask_below_horizon_or_in_shade</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a><a href=#__codelineno-0-429><span class=linenos data-linenos="429 "></span></a>        <span class=n>solar_altitude_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&lt;</span> <span class=mi>0</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a><a href=#__codelineno-0-430><span class=linenos data-linenos="430 "></span></a>    <span class=p>)</span> <span class=o>|</span> <span class=n>surface_in_shade_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a><a href=#__codelineno-0-431><span class=linenos data-linenos="431 "></span></a>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a><a href=#__codelineno-0-432><span class=linenos data-linenos="432 "></span></a>    <span class=n>mask_no_solar_incidence_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a><a href=#__codelineno-0-433><span class=linenos data-linenos="433 "></span></a>        <span class=n>solar_incidence_series</span> <span class=o>&lt;</span> <span class=mi>0</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><a href=#__codelineno-0-434><span class=linenos data-linenos="434 "></span></a>    <span class=p>)</span> <span class=o>|</span> <span class=n>mask_below_horizon_or_in_shade</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a><a href=#__codelineno-0-435><span class=linenos data-linenos="435 "></span></a>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a><a href=#__codelineno-0-436><span class=linenos data-linenos="436 "></span></a>    <span class=k>if</span> <span class=n>zero_negative_solar_incidence_angle</span><span class=p>:</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a><a href=#__codelineno-0-437><span class=linenos data-linenos="437 "></span></a>        <span class=n>solar_incidence_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a><a href=#__codelineno-0-438><span class=linenos data-linenos="438 "></span></a>            <span class=n>mask_no_solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a><a href=#__codelineno-0-439><span class=linenos data-linenos="439 "></span></a>            <span class=c1># (solar_incidence_series &lt; 0) | (solar_altitude_series.value &lt; 0),</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a><a href=#__codelineno-0-440><span class=linenos data-linenos="440 "></span></a>            <span class=n>NO_SOLAR_INCIDENCE</span><span class=p>,</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a><a href=#__codelineno-0-441><span class=linenos data-linenos="441 "></span></a>            <span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a><a href=#__codelineno-0-442><span class=linenos data-linenos="442 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a><a href=#__codelineno-0-443><span class=linenos data-linenos="443 "></span></a>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a><a href=#__codelineno-0-444><span class=linenos data-linenos="444 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a><a href=#__codelineno-0-445><span class=linenos data-linenos="445 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a><a href=#__codelineno-0-446><span class=linenos data-linenos="446 "></span></a>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a><a href=#__codelineno-0-447><span class=linenos data-linenos="447 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a><a href=#__codelineno-0-448><span class=linenos data-linenos="448 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a><a href=#__codelineno-0-449><span class=linenos data-linenos="449 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a><a href=#__codelineno-0-450><span class=linenos data-linenos="450 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a><a href=#__codelineno-0-451><span class=linenos data-linenos="451 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a><a href=#__codelineno-0-452><span class=linenos data-linenos="452 "></span></a>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a><a href=#__codelineno-0-453><span class=linenos data-linenos="453 "></span></a>    <span class=k>return</span> <span class=n>SolarIncidence</span><span class=p>(</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a><a href=#__codelineno-0-454><span class=linenos data-linenos="454 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a><a href=#__codelineno-0-455><span class=linenos data-linenos="455 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a><a href=#__codelineno-0-456><span class=linenos data-linenos="456 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>  <span class=c1>#</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a><a href=#__codelineno-0-457><span class=linenos data-linenos="457 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>  <span class=c1>#</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a><a href=#__codelineno-0-458><span class=linenos data-linenos="458 "></span></a>        <span class=n>incidence_algorithm</span><span class=o>=</span><span class=n>SolarIncidenceModel</span><span class=o>.</span><span class=n>jenco</span><span class=p>,</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><a href=#__codelineno-0-459><span class=linenos data-linenos="459 "></span></a>        <span class=n>definition</span><span class=o>=</span><span class=n>incidence_angle_definition</span><span class=p>,</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><a href=#__codelineno-0-460><span class=linenos data-linenos="460 "></span></a>        <span class=n>description</span><span class=o>=</span><span class=n>incidence_angle_description</span><span class=p>,</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><a href=#__codelineno-0-461><span class=linenos data-linenos="461 "></span></a>        <span class=c1># azimuth_origin=solar_azimuth_east_based_series.origin,</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><a href=#__codelineno-0-462><span class=linenos data-linenos="462 "></span></a>        <span class=n>azimuth_origin</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a><a href=#__codelineno-0-463><span class=linenos data-linenos="463 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.martin_ruiz> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">martin_ruiz</span> <a class=headerlink href=#pvgisprototype.algorithms.martin_ruiz title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.martin_ruiz.reflectivity title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">reflectivity</span> (<code>pvgisprototype.algorithms.martin_ruiz.reflectivity</code>)'>reflectivity</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.martin_ruiz.reflectivity> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">reflectivity</span> <a class=headerlink href=#pvgisprototype.algorithms.martin_ruiz.reflectivity title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_effect title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_reflectivity_effect</span> (<code>pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_effect</code>)'>calculate_reflectivity_effect</a></code></td> <td> <div class=doc-md-description> <p>Calculate absolute reflectivity effect</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_effect_percentage title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_reflectivity_effect_percentage</span> (<code>pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_effect_percentage</code>)'>calculate_reflectivity_effect_percentage</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_factor_for_direct_irradiance_series title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_reflectivity_factor_for_direct_irradiance_series</span> (<code>pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_factor_for_direct_irradiance_series</code>)'>calculate_reflectivity_factor_for_direct_irradiance_series</a></code></td> <td> <div class=doc-md-description> <p>Calculate the angular loss factor for the direct horizontal radiation</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_factor_for_nondirect_irradiance title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_reflectivity_factor_for_nondirect_irradiance</span> (<code>pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_factor_for_nondirect_irradiance</code>)'>calculate_reflectivity_factor_for_nondirect_irradiance</a></code></td> <td> <div class=doc-md-description> <p>Calculate the reflectivity factor as for small angles of solar</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_effect> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_reflectivity_effect</span> <a class=headerlink href=#pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_effect title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_reflectivity_effect</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>irradiance</span><span class=p>,</span> <span class=n>reflectivity_factor</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate absolute reflectivity effect</p> <p>The total loss due to the reflectivity effect (which depends on the solar incidence angle) as the difference of the irradiance after and before.</p> <details class=note open> <summary>Notes</summary> <p>Other ideas :</p> <ul> <li> <p>Sum of reflectivity effect as a difference between the irradiance time series after and before the reflectivity effect, i.e. :</p> <p>return reflectivity_effect = np.nansum(irradiance_series * reflectivity - irradiance_series) # Total lost energy due to AOI over the period</p> </li> <li> <p>Average reflectivity effect :</p> <p>REFLECTIVITY_EFFECT_AVERAGE_COLUMN_NAME: np.nanmean(calculate_reflectivity_effect(inclined_irradiance_series, reflectivity_factor_series)),</p> </li> </ul> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/martin_ruiz/reflectivity.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_reflectivity_effect</span><span class=p>(</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>    <span class=n>irradiance</span><span class=p>,</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>    <span class=n>reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a><span class=p>):</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a><span class=w>    </span><span class=sd>"""Calculate absolute reflectivity effect</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a><span class=sd>    The total loss due to the reflectivity effect (which depends on the solar</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a><span class=sd>    incidence angle) as the difference of the irradiance after and before.</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a><span class=sd>    Other ideas :</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a><span class=sd>    - Sum of reflectivity effect as a difference between the irradiance time</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a><span class=sd>      series after and before the reflectivity effect, i.e. :</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a><span class=sd>        return reflectivity_effect = np.nansum(irradiance_series * reflectivity - irradiance_series)  # Total lost energy due to AOI over the period</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a><span class=sd>    - Average reflectivity effect :</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a><span class=sd>        REFLECTIVITY_EFFECT_AVERAGE_COLUMN_NAME: np.nanmean(calculate_reflectivity_effect(inclined_irradiance_series, reflectivity_factor_series)),</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>    <span class=n>effect</span> <span class=o>=</span> <span class=p>(</span><span class=n>irradiance</span> <span class=o>*</span> <span class=n>reflectivity_factor</span><span class=p>)</span> <span class=o>-</span> <span class=n>irradiance</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>nan_to_num</span><span class=p>(</span><span class=n>effect</span><span class=p>,</span> <span class=n>nan</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>  <span class=c1># Force 1D array output, safer output ?</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_effect_percentage> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_reflectivity_effect_percentage</span> <a class=headerlink href=#pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_effect_percentage title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_reflectivity_effect_percentage</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>irradiance</span><span class=p>,</span> <span class=n>reflectivity</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/martin_ruiz/reflectivity.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_reflectivity_effect_percentage</span><span class=p>(</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>    <span class=n>irradiance</span><span class=p>,</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>    <span class=n>reflectivity</span><span class=p>,</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a><span class=p>):</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a><span class=w>    </span><span class=sd>""" """</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>    <span class=c1># --------------------------------------------------- Is this safe ? -</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>    <span class=k>with</span> <span class=n>np</span><span class=o>.</span><span class=n>errstate</span><span class=p>(</span><span class=n>divide</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>,</span> <span class=n>invalid</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>):</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>        <span class=n>percentage</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>            <span class=n>irradiance</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>            <span class=mi>100</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=p>((</span><span class=n>irradiance</span> <span class=o>*</span> <span class=n>reflectivity</span><span class=p>)</span> <span class=o>/</span> <span class=n>irradiance</span><span class=p>)),</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>            <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>    <span class=k>return</span> <span class=n>percentage</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_factor_for_direct_irradiance_series> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_reflectivity_factor_for_direct_irradiance_series</span> <a class=headerlink href=#pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_factor_for_direct_irradiance_series title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_reflectivity_factor_for_direct_irradiance_series</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarIncidence>SolarIncidence</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>angular_loss_coefficient</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ANGULAR_LOSS_COEFFICIENT>ANGULAR_LOSS_COEFFICIENT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the angular loss factor for the direct horizontal radiation based on the solar incidence angle.</p> <p>This function implements the solar incidence angle modifier as per Martin &amp; Ruiz (2005). Expected is the angle between the sun-solar-surface vector and the vector normal to the reference solar surface. We call this the <em>typical</em> incidence angle as opposed to the <em>complementary</em> incidence angle defined by Jeno (1992).</p> <p>The adjustment factor represents the fraction of the original <code>direct_radiation</code> that is retained after accounting for the loss of radiation due to the angle of incidence or the orientation of the surface with respect to the sun.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>solar_incidence_series</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Solar incidence angle series</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>angular_loss_coefficient</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <code><span title=pvgisprototype.constants.ANGULAR_LOSS_COEFFICIENT>ANGULAR_LOSS_COEFFICIENT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>reflectivity_factor_series</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The adjustment involves:</p> <ol> <li> <p>computes the fraction of radiation that is <em>not</em> lost due to the <code>solar_incidence_angle</code> angle divided by the <code>solar_declination</code> ranging between 0 (complete loss) and 1 (no loss):</p> <p><code>( 1 - exp( -solar_incidence_angle / angle_of_incidence_constant ) )</code></p> <ul> <li> <p>The exponential function <code>exp</code>, raises the mathematical constant <code>e</code> (approximately 2.71828) to the power of the given argument.</p> </li> <li> <p>The negative exponential term of the fraction <code>solar_altitude / solar_declination</code> calculates the exponential decay or attenuation factor based on the ratio of <code>solar_altitude</code> to the <code>solar_declination</code>.</p> </li> </ul> </li> <li> <p>rescales the adjusted value to bring it within a suitable range, by multiplying it by the reciprocal of the exponential term with the reciprocal of the <code>solar_declination</code>:</p> <p><code>1 / ( 1 - exp( - 1 / solar_declination) )</code></p> </li> </ol> <p>ensuring no excessive amplification or diminishing the effect (over-amplification or under-amplification).</p> <p>The paper :</p> <div class=codehilite><pre><span></span><code><span class=k>-</span>                            -
|  1 - exp( -cos(a) / a_r )  |
</code></pre></div> <p>1 - | -------------------------- |</p> </details> <details class=----|-----1---exp(--1-/-a_r)-----| open> <summary><div class=codehilite><pre><span></span><code>|     1 - exp( -1 / a_r)     |
</code></pre></div></summary> <p>In PVGIS :</p> <div class=codehilite><pre><span></span><code>``` c
angular_loss_denom = 1. / (1 - exp(-1. / a_r));
br <span class=gs>*= (1 - exp(-sh / a_r)) *</span> angular_loss_denom;
```

where:

<span class=k>-</span> br : direct inclined irradiance
<span class=k>-</span> sh : <span class=ge>_sine_</span> of <span class=ge>_complementary_</span> solar incidence angle (as per Jeno, 1992)
<span class=k>-</span> a_r : angular loss coefficient
</code></pre></div> <p>In pvlib :</p> <div class=codehilite><pre><span></span><code>``` python
with np.errstate(invalid='ignore'):
    iam = (1 - np.exp(-cosd(aoi) / a_r)) / (1 - np.exp(-1 / a_r))
    iam = np.where(np.abs(aoi) &gt;= 90.0, 0.0, iam)
```

where:

<span class=k>-</span> iam : incidence angle modifier
<span class=k>-</span> aoi : angle of incidence
<span class=k>-</span> a_r : angular loss coefficient
</code></pre></div> <p>Review Me : --------------------------------------------------------------</p> <p>This function will return a time series <code>incidence_angle_modifier_series</code> of floating point numbers. As it may generate NaN elements, further processing in a time series context, would required attention for example when summing arrays with NaN elements.</p> <p>To circumvent eventual "problems" and the need for special handling downstream in the code, we replace all NaN elements with 0 just before returning the final time series.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/martin_ruiz/reflectivity.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_reflectivity_factor_for_direct_irradiance_series</span><span class=p>(</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n>SolarIncidence</span><span class=p>,</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a>    <span class=n>angular_loss_coefficient</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ANGULAR_LOSS_COEFFICIENT</span><span class=p>,</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=p>):</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=w>    </span><span class=sd>"""Calculate the angular loss factor for the direct horizontal radiation</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=sd>    based on the solar incidence angle.</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=sd>    This function implements the solar incidence angle modifier as per Martin &amp;</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=sd>    Ruiz (2005). Expected is the angle between the sun-solar-surface vector and</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=sd>    the vector normal to the reference solar surface. We call this the</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=sd>    _typical_ incidence angle as opposed to the _complementary_ incidence angle</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=sd>    defined by Jeno (1992).</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=sd>    The adjustment factor represents the fraction of the original</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=sd>    `direct_radiation` that is retained after accounting for the loss of</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=sd>    radiation due to the angle of incidence or the orientation of the surface</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=sd>    with respect to the sun.</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    solar_incidence_series : float</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>        Solar incidence angle series</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    angular_loss_coefficient : float</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    reflectivity_factor_series : float</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    The adjustment involves:</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    1. computes the fraction of radiation that is _not_ lost due to</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    the `solar_incidence_angle` angle divided by the `solar_declination` ranging between</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    0 (complete loss) and 1 (no loss):</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>        `( 1 - exp( -solar_incidence_angle / angle_of_incidence_constant ) )`</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        - The exponential function `exp`, raises the mathematical constant `e`</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>          (approximately 2.71828) to the power of the given argument.</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>        - The negative exponential term of the fraction `solar_altitude /</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>          solar_declination` calculates the exponential decay or attenuation</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>          factor based on the ratio of `solar_altitude` to the `solar_declination`.</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>    2. rescales the adjusted value to bring it within a suitable range,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    by multiplying it by the reciprocal of the exponential term with the</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    reciprocal of the `solar_declination`:</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>        `1 / ( 1 - exp( - 1 / solar_declination) )`</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    ensuring no excessive amplification or diminishing the effect</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    (over-amplification or under-amplification).</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    The paper :</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>        -                            -</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>        |  1 - exp( -cos(a) / a_r )  |</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    1 - | -------------------------- |</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>        |     1 - exp( -1 / a_r)     |</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>        -                            -</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    In PVGIS :</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>        ``` c</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        angular_loss_denom = 1. / (1 - exp(-1. / a_r));</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>        br *= (1 - exp(-sh / a_r)) * angular_loss_denom;</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>        where:</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>        - br : direct inclined irradiance</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>        - sh : _sine_ of _complementary_ solar incidence angle (as per Jeno, 1992)</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>        - a_r : angular loss coefficient</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>    In pvlib :</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>        ``` python</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>        with np.errstate(invalid='ignore'):</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>            iam = (1 - np.exp(-cosd(aoi) / a_r)) / (1 - np.exp(-1 / a_r))</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>            iam = np.where(np.abs(aoi) &gt;= 90.0, 0.0, iam)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>        where:</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>        - iam : incidence angle modifier</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>        - aoi : angle of incidence</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>        - a_r : angular loss coefficient</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>    Review Me : --------------------------------------------------------------</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>    This function will return a time series `incidence_angle_modifier_series`</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>    of floating point numbers. As it may generate NaN elements, further</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>    processing in a time series context, would required attention for example</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>    when summing arrays with NaN elements.</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>    To circumvent eventual "problems" and the need for special handling</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>    downstream in the code, we replace all NaN elements with 0 just before</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>    returning the final time series.</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=sa>f</span><span class=s2>"&gt; Executing solar radiation modelling function calculate_reflectivity_factor_for_direct_irradiance_series()"</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>"&gt; Executing [underline]solar radiation modelling[/underline] function calculate_reflectivity_factor_for_direct_irradiance_series()"</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=n>numerator</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>            <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_incidence_series</span><span class=p>)</span> <span class=o>/</span> <span class=n>angular_loss_coefficient</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>denominator</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span> <span class=o>/</span> <span class=n>angular_loss_coefficient</span><span class=p>))</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=n>incidence_angle_modifier_series</span> <span class=o>=</span> <span class=n>numerator</span> <span class=o>/</span> <span class=n>denominator</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=n>incidence_angle_modifier_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>            <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>solar_incidence_series</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>incidence_angle_modifier_series</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=p>)</span>  <span class=c1># Borrowed from pvlib !</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>        <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>            <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>        <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Incidence angle modifier series: </span><span class=si>{</span><span class=n>incidence_angle_modifier_series</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>            <span class=n>data</span><span class=o>=</span><span class=n>incidence_angle_modifier_series</span><span class=p>,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>            <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>            <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>            <span class=sa>f</span><span class=s2>"  &lt; Returning incidence angle modifier series :</span><span class=se>\n</span><span class=si>{</span><span class=n>incidence_angle_modifier_series</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>            <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>"  [green]&lt;[/green] Returning incidence angle modifier series :</span><span class=se>\n</span><span class=si>{</span><span class=n>incidence_angle_modifier_series</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=k>return</span> <span class=n>incidence_angle_modifier_series</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>    <span class=c1># Review-Me !</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>    <span class=k>except</span> <span class=ne>ZeroDivisionError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Zero Division Error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>"Error: Division by zero in calculating the angular loss factor."</span><span class=p>)</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>1</span><span class=p>])</span>  <span class=c1># Return an array with a single element as 1</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_factor_for_nondirect_irradiance> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_reflectivity_factor_for_nondirect_irradiance</span> <a class=headerlink href=#pvgisprototype.algorithms.martin_ruiz.reflectivity.calculate_reflectivity_factor_for_nondirect_irradiance title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_reflectivity_factor_for_nondirect_irradiance</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>indirect_angular_loss_coefficient</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>angular_loss_coefficient</span><span class=o>=</span><span class=n><span title=pvgisprototype.constants.ANGULAR_LOSS_COEFFICIENT>ANGULAR_LOSS_COEFFICIENT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the reflectivity factor as for small angles of solar incidence.</p> <details class=note open> <summary>Notes</summary> <p>Review Me : --------------------------------------------------------------</p> <p>This function will return a single <code>incidence_angle_modifier</code> (or call it loss factor) float number. Further processing in a time series context can be done by simply replicating the reflectivity factor for all timestamps.</p> <p>Further, this structure will not generate any NaNs across a time series which often need special handling, i.e. when summing arrays with NaN elements.</p> <p>Other implementations</p> <p>In PVGIS v5.2 :</p> <ul> <li>AOIConstants[0]</li> <li>AOIConstants[1]</li> </ul> <p>c1 = 4./(3.*M_PI); diff_coeff_angleloss = sinslope + (M_PI-sunSlopeGeom-&gt;slope - sinslope) / (1+cosslope); diff_loss_factor = 1. - exp( - ( c1 * diff_coeff_angleloss + AOIConstants[0] * diff_coeff_angleloss * diff_coeff_angleloss ) / AOIConstants[1]);</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/martin_ruiz/reflectivity.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_reflectivity_factor_for_nondirect_irradiance</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>    <span class=n>indirect_angular_loss_coefficient</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>    <span class=n>angular_loss_coefficient</span><span class=o>=</span><span class=n>ANGULAR_LOSS_COEFFICIENT</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=w>    </span><span class=sd>"""Calculate the reflectivity factor as for small angles of solar</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a><span class=sd>    incidence.</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a><span class=sd>    Review Me : --------------------------------------------------------------</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=sd>    This function will return a single `incidence_angle_modifier` (or call it</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a><span class=sd>    loss factor) float number. Further processing in a time series context can</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>    be done by simply replicating the reflectivity factor for all timestamps.</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a><span class=sd>    Further, this structure will not generate any NaNs across a time series</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a><span class=sd>    which often need special handling, i.e. when summing arrays with NaN</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>    elements.</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>    Other implementations</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a><span class=sd>    In PVGIS v5.2 :</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a><span class=sd>    - AOIConstants[0]</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a><span class=sd>    - AOIConstants[1]</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a><span class=sd>    c1 = 4./(3.*M_PI);</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a><span class=sd>    diff_coeff_angleloss = sinslope + (M_PI-sunSlopeGeom-&gt;slope - sinslope)</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=sd>                           /</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a><span class=sd>                           (1+cosslope);</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=sd>    diff_loss_factor =</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a><span class=sd>                       1. - exp(</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a><span class=sd>                                 - (   c1 * diff_coeff_angleloss</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a><span class=sd>                                     + AOIConstants[0]</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a><span class=sd>                                     * diff_coeff_angleloss</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a><span class=sd>                                     * diff_coeff_angleloss</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a><span class=sd>                                   ) /</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a><span class=sd>                                   AOIConstants[1]);</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>        <span class=sa>f</span><span class=s2>"&gt; Executing solar radiation modelling function calculate_reflectivity_factor_for_nondirect_irradiance()"</span><span class=p>,</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>        <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>"&gt; Executing [underline]solar radiation modelling[/underline] function calculate_reflectivity_factor_for_nondirect_irradiance()"</span><span class=p>,</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>    <span class=n>angular_loss_coefficient_product</span> <span class=o>=</span> <span class=n>angular_loss_coefficient</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=mf>0.154</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>    <span class=n>c1</span> <span class=o>=</span> <span class=mi>4</span> <span class=o>/</span> <span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=n>pi</span><span class=p>)</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>    <span class=n>incidence_angle_modifier</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>exp</span><span class=p>(</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>        <span class=o>-</span><span class=p>(</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>            <span class=n>c1</span> <span class=o>*</span> <span class=n>indirect_angular_loss_coefficient</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>            <span class=o>+</span> <span class=n>angular_loss_coefficient_product</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>angular_loss_coefficient</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>        <span class=o>/</span> <span class=n>angular_loss_coefficient</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>        <span class=sa>f</span><span class=s2>"  &lt; Returning incidence angle modifier :</span><span class=se>\n</span><span class=si>{</span><span class=n>incidence_angle_modifier</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>        <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>"  [green]&lt;[/green] Returning incidence angle modifier :</span><span class=se>\n</span><span class=si>{</span><span class=n>incidence_angle_modifier</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>    <span class=k>return</span> <span class=n>incidence_angle_modifier</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.milne1921> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">milne1921</span> <a class=headerlink href=#pvgisprototype.algorithms.milne1921 title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.milne1921.solar_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_time</span> (<code>pvgisprototype.algorithms.milne1921.solar_time</code>)'>solar_time</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.milne1921.solar_time> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_time</span> <a class=headerlink href=#pvgisprototype.algorithms.milne1921.solar_time title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.milne1921.solar_time.calculate_apparent_solar_time_milne1921 title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_apparent_solar_time_milne1921</span> (<code>pvgisprototype.algorithms.milne1921.solar_time.calculate_apparent_solar_time_milne1921</code>)'>calculate_apparent_solar_time_milne1921</a></code></td> <td> <div class=doc-md-description> <p>Calculate the apparent solar time based on the equation of time by Milne 1921</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.milne1921.solar_time.calculate_apparent_solar_time_series_milne1921 title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_apparent_solar_time_series_milne1921</span> (<code>pvgisprototype.algorithms.milne1921.solar_time.calculate_apparent_solar_time_series_milne1921</code>)'>calculate_apparent_solar_time_series_milne1921</a></code></td> <td> <div class=doc-md-description> <p>Calculate the apparent solar time based on the equation of time by Milne 1921 for a series of timestamps</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.milne1921.solar_time.calculate_apparent_solar_time_milne1921> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_apparent_solar_time_milne1921</span> <a class=headerlink href=#pvgisprototype.algorithms.milne1921.solar_time.calculate_apparent_solar_time_milne1921 title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_apparent_solar_time_milne1921</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamp</span><span class=p>:</span> <span class=n><span title=pandas.Timestamp>Timestamp</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pandas.Timestamp>Timestamp</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the apparent solar time based on the equation of time by Milne 1921</p> <details class=note open> <summary>Notes</summary> <ul> <li> <p>Local Time (LT)</p> </li> <li> <p>Local Standard Time Meridian (LSTM)</p> <ul> <li> <p>1 hour in time equals to 15 degrees of earth's rotation (from: 360/24 hours)</p> </li> <li> <p>Examples:</p> <ul> <li>Sydney Australia is UTC +10 so the LSTM is 10 * 15 = 150 E.</li> <li>Phoenix, USA is UTC -7 so the LSTM is -7 * 15 = -105E or 105 W</li> </ul> </li> </ul> </li> <li> <p>The equation of time (EoT) (in minutes) is an empirical equation that corrects for the eccentricity of the Earth's orbit and the Earth's axial tilt. An approximation accurate to within  minute is:</p> </li> </ul> <p>EoT = 9.87 * sin(2*B) - 7.53 * cos(B) - 1.5 * sin(B)</p> <div class=codehilite><pre><span></span><code>where:

<span class=k>-</span> DeltaTUTC : Local time minus UTC, in hours, also equal to the time zone
<span class=k>-</span> B = 360 / 365 * (day_of_year - 81)  # in degrees
<span class=k>-</span> Time correction (TC) factor = 4 * (longitude - LSTM) + EoT
</code></pre></div> <ul> <li> <p>Solar time (or local solar time) = LT + TC / 60</p> <ul> <li>The solar (or local) solar time here equals to :</li> <li>the apparent solar time (AST)</li> <li>or corrected local solar time</li> <li>or true solar time or (TST) as termed in other models/equations.</li> </ul> </li> <li> <p>Hour angle = 15 * (LST - 12)</p> </li> </ul> <p>_Milne</p> <p>@article{Milne1921, doi = {10.2307/3604631}, year = 1921, publisher = {Cambridge University Press ({CUP})}, volume = {10}, number = {155}, pages = {372--375}, author = {R. M. Milne}, title = {593. Note on the Equation of Time}, journal = {The Mathematical Gazette} }</p> <p>See also:</p> <p>@incollection{KALOGIROU201451, title = {Chapter 2 - Environmental Characteristics}, editor = {Soteris A. Kalogirou}, booktitle = {Solar Energy Engineering (Second Edition)}, publisher = {Academic Press}, edition = {Second Edition}, address = {Boston}, pages = {51-123}, year = {2014}, isbn = {978-0-12-397270-5}, doi = {<a href=https://doi.org/10.1016/B978-0-12-397270-5.00002-9>https://doi.org/10.1016/B978-0-12-397270-5.00002-9</a>}, url = {<a href=https://www.sciencedirect.com/science/article/pii/B9780123972705000029>https://www.sciencedirect.com/science/article/pii/B9780123972705000029</a>}, author = {Soteris A. Kalogirou}, keywords = {Atmospheric attenuation, Extraterrestrial radiation, Radiation exchange between surfaces, Shadow determination, Solar angles, Solar radiation measuring instruments, Solar radiation, Terrestrial irradiation, Total radiation on tilted surfaces, Typical meteorological year}, abstract = {Chapter 2 gives an analysis of the environmental characteristics of solar radiation and in particular the reckoning of time and solar angles. In the latter the basic solar geometry equations are given including declination, hour angle, altitude angle, azimuth angle as well as the incidence angle for stationary and moving surfaces, sun path diagrams, and shadow determination including the way to calculate shading effects. This is followed by a description of the basic principles of solar radiation heat transfer including transparent plates, radiation exchange between surfaces, extraterrestrial solar radiation, atmospheric attenuation, terrestrial irradiation, and total radiation on tilted surfaces. It concludes with a review of the solar radiation measuring instruments and the way to construct typical meteorological year files.} }</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/milne1921/solar_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarTimeMilne1921InputModel</span><span class=p>)</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_apparent_solar_time_milne1921</span><span class=p>(</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>timestamp</span><span class=p>:</span> <span class=n>Timestamp</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Timestamp</span><span class=p>:</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=w>    </span><span class=sd>"""Calculate the apparent solar time based on the equation of time by Milne 1921</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    - Local Time (LT)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    - Local Standard Time Meridian (LSTM)</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>        - 1 hour in time equals to 15 degrees of earth's rotation</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>          (from: 360/24 hours)</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>        - Examples:</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>            - Sydney Australia is UTC +10 so the LSTM is 10 * 15 = 150 E.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>            - Phoenix, USA is UTC -7 so the LSTM is -7 * 15 = -105E or 105 W</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    - The equation of time (EoT) (in minutes) is an empirical equation that</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>      corrects for the eccentricity of the Earth's orbit and the Earth's axial</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>      tilt. An approximation accurate to within  minute is:</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>      EoT = 9.87 * sin(2*B) - 7.53 * cos(B) - 1.5 * sin(B)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>        where:</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        - DeltaTUTC : Local time minus UTC, in hours, also equal to the time zone</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>        - B = 360 / 365 * (day_of_year - 81)  # in degrees</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>        - Time correction (TC) factor = 4 * (longitude - LSTM) + EoT</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    - Solar time (or local solar time) = LT + TC / 60</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>        * The solar (or local) solar time here equals to :</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>        - the apparent solar time (AST)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>        - or corrected local solar time</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>        - or true solar time or (TST)</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>        as termed in other models/equations.</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    - Hour angle = 15 * (LST - 12)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    _Milne</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    @article{Milne1921,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>        doi = {10.2307/3604631},</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>        year = 1921,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>        publisher = {Cambridge University Press ({CUP})},</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>        volume = {10},</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>        number = {155},</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>        pages = {372--375},</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>        author = {R. M. Milne},</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        title = {593. Note on the Equation of Time},</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>        journal = {The Mathematical Gazette}</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>    }</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>    See also:</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>    @incollection{KALOGIROU201451,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>    title = {Chapter 2 - Environmental Characteristics},</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    editor = {Soteris A. Kalogirou},</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>    booktitle = {Solar Energy Engineering (Second Edition)},</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>    publisher = {Academic Press},</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>    edition = {Second Edition},</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>    address = {Boston},</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    pages = {51-123},</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>    year = {2014},</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    isbn = {978-0-12-397270-5},</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    doi = {https://doi.org/10.1016/B978-0-12-397270-5.00002-9},</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>    url = {https://www.sciencedirect.com/science/article/pii/B9780123972705000029},</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>    author = {Soteris A. Kalogirou},</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>    keywords = {Atmospheric attenuation, Extraterrestrial radiation, Radiation exchange between surfaces, Shadow determination, Solar angles, Solar radiation measuring instruments, Solar radiation, Terrestrial irradiation, Total radiation on tilted surfaces, Typical meteorological year},</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>    abstract = {Chapter 2 gives an analysis of the environmental characteristics of solar radiation and in particular the reckoning of time and solar angles. In the latter the basic solar geometry equations are given including declination, hour angle, altitude angle, azimuth angle as well as the incidence angle for stationary and moving surfaces, sun path diagrams, and shadow determination including the way to calculate shading effects. This is followed by a description of the basic principles of solar radiation heat transfer including transparent plates, radiation exchange between surfaces, extraterrestrial solar radiation, atmospheric attenuation, terrestrial irradiation, and total radiation on tilted surfaces. It concludes with a review of the solar radiation measuring instruments and the way to construct typical meteorological year files.}</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    }</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>    <span class=c1># # Handle Me during input validation? -------------------------------------</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>    <span class=c1># if timezone != timestamp.tzinfo:</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>    <span class=c1>#     try:</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>    <span class=c1>#         timestamp = timestamp.astimezone(timezone)</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>    <span class=c1>#     except Exception as e:</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>    <span class=c1>#         logging.warning(f'Error setting tzinfo for timestamp = {timestamp}: {e}')</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>    <span class=c1># # Handle Me during input validation? -------------------------------------</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>    <span class=c1># Equation of Time, Milne 1921 -------------------------------------------</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=c1># The difference of local time from UTC equals the time zone, in hours</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=n>local_time_minus_utc</span> <span class=o>=</span> <span class=n>timestamp</span><span class=o>.</span><span class=n>utcoffset</span><span class=p>()</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>/</span> <span class=mi>3600</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=n>local_standard_time_meridian</span> <span class=o>=</span> <span class=mi>15</span> <span class=o>*</span> <span class=n>local_time_minus_utc</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>    <span class=c1># `b` for the equation of time -------------------------------------------</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>    <span class=n>day_of_year</span> <span class=o>=</span> <span class=n>timestamp</span><span class=o>.</span><span class=n>timetuple</span><span class=p>()</span><span class=o>.</span><span class=n>tm_yday</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>    <span class=n>b</span> <span class=o>=</span> <span class=n>radians</span><span class=p>(</span><span class=mi>360</span> <span class=o>/</span> <span class=mi>365</span> <span class=o>*</span> <span class=p>(</span><span class=n>day_of_year</span> <span class=o>-</span> <span class=mi>81</span><span class=p>))</span>  <span class=c1># from degrees to radians</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=c1># however, in :</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>    <span class=c1># Solar Energy Engineering (Second Edition),</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=c1># Chapter 2 - Environmental Characteristics,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>    <span class=c1># Soteris A. Kalogirou, Academic Press, 2014,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=c1># ISBN 9780123972705, https://doi.org/10.1016/B978-0-12-397270-5.00002-9.</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>    <span class=c1># Pages 51-123,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=c1># b = (day_of_year - 81) * 360 / 364  (in degrees)</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>    <span class=c1># -----------------------------------------------------------------------</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>    <span class=n>equation_of_time</span> <span class=o>=</span> <span class=mf>9.87</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>b</span><span class=p>)</span> <span class=o>-</span> <span class=mf>7.53</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span><span class=n>b</span><span class=p>)</span> <span class=o>-</span> <span class=mf>1.5</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=c1># ------------------------------------------------------------------------</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=c1># the following equation requires longitude in degrees!</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=n>time_correction_factor</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>        <span class=mi>4</span> <span class=o>*</span> <span class=p>(</span><span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>-</span> <span class=n>local_standard_time_meridian</span><span class=p>)</span> <span class=o>+</span> <span class=n>equation_of_time</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>    <span class=c1># ------------------------------------------------------------------------</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=n>time_correction_factor_hours</span> <span class=o>=</span> <span class=n>time_correction_factor</span> <span class=o>/</span> <span class=mi>60</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=n>apparent_solar_time</span> <span class=o>=</span> <span class=n>timestamp</span> <span class=o>+</span> <span class=n>Timedelta</span><span class=p>(</span><span class=n>hours</span><span class=o>=</span><span class=n>time_correction_factor_hours</span><span class=p>)</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>"Day of year : </span><span class=si>{day_of_year}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>"Equation of time : </span><span class=si>{equation_of_time}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>"Time correction factor : </span><span class=si>{time_correction_factor}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>    <span class=k>return</span> <span class=n>TrueSolarTime</span><span class=p>(</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>apparent_solar_time</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>MINUTES</span><span class=p>,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>        <span class=n>timing_algorithm</span><span class=o>=</span><span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>milne</span><span class=p>,</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.milne1921.solar_time.calculate_apparent_solar_time_series_milne1921> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_apparent_solar_time_series_milne1921</span> <a class=headerlink href=#pvgisprototype.algorithms.milne1921.solar_time.calculate_apparent_solar_time_series_milne1921 title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_apparent_solar_time_series_milne1921</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the apparent solar time based on the equation of time by Milne 1921 for a series of timestamps</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/milne1921/solar_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_apparent_solar_time_series_milne1921</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=p>):</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=w>    </span><span class=sd>"""Calculate the apparent solar time based on the equation of time by Milne 1921 for a series of timestamps"""</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>    <span class=c1># We need a timezone!</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>    <span class=n>utc_zoneinfo</span> <span class=o>=</span> <span class=n>ZoneInfo</span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>)</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>    <span class=n>local_standard_time_meridian_minutes_series</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># in UTC the offest is 0</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>    <span class=k>if</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>tzinfo</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>  <span class=c1># set to UTC</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>        <span class=n>timestamps</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>tz_localize</span><span class=p>(</span><span class=n>utc_zoneinfo</span><span class=p>)</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>    <span class=k>elif</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>tz</span> <span class=o>!=</span> <span class=n>utc_zoneinfo</span><span class=p>:</span>  <span class=c1># convert to UTC</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>        <span class=n>timestamps</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>tz_convert</span><span class=p>(</span><span class=n>utc_zoneinfo</span><span class=p>)</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>        <span class=c1># # ------------------------------------------- Further Optimisation ?</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>        <span class=c1># Optimisation : calculate unique offsets</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>        <span class=n>unique_timezones</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>ts</span><span class=p>:</span> <span class=n>ts</span><span class=o>.</span><span class=n>tzinfo</span><span class=p>)</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>        <span class=n>unique_offsets</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>            <span class=n>tz</span><span class=p>:</span> <span class=n>tz</span><span class=o>.</span><span class=n>utcoffset</span><span class=p>()</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>/</span> <span class=mi>60</span> <span class=k>for</span> <span class=n>tz</span> <span class=ow>in</span> <span class=nb>set</span><span class=p>(</span><span class=n>unique_timezones</span><span class=p>)</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>        <span class=p>}</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>        <span class=c1># Map offsets back to timestamps</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=n>local_standard_time_meridian_minutes_series</span> <span class=o>=</span> <span class=n>array</span><span class=p>(</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>            <span class=p>[</span><span class=n>unique_offsets</span><span class=p>[</span><span class=n>tz</span><span class=p>]</span> <span class=k>for</span> <span class=n>tz</span> <span class=ow>in</span> <span class=n>unique_timezones</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=c1># ------------------------------------------------- Further Optimisation ?</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>    <span class=n>days_of_year</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>dayofyear</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>    <span class=n>days_in_years</span> <span class=o>=</span> <span class=n>get_days_in_years</span><span class=p>(</span><span class=n>timestamps</span><span class=o>.</span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>    <span class=c1># In the original equation : days_in_years = 365</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>    <span class=n>b</span> <span class=o>=</span> <span class=n>numpy_radians</span><span class=p>(</span><span class=mi>360</span> <span class=o>/</span> <span class=n>days_in_years</span> <span class=o>*</span> <span class=p>(</span><span class=n>days_of_year</span> <span class=o>-</span> <span class=mi>81</span><span class=p>))</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>    <span class=n>equation_of_time</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>        <span class=mf>9.87</span> <span class=o>*</span> <span class=n>numpy_sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>b</span><span class=p>)</span> <span class=o>-</span> <span class=mf>7.53</span> <span class=o>*</span> <span class=n>numpy_cos</span><span class=p>(</span><span class=n>b</span><span class=p>)</span> <span class=o>-</span> <span class=mf>1.5</span> <span class=o>*</span> <span class=n>numpy_sin</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>    <span class=c1># In the original equation : </span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>    <span class=c1># time_correction_factor = 4 * (longitude - local_standard_time_meridian) + equation_of_time  in hours</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>    <span class=n>time_correction_factor_minutes</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>        <span class=n>longitude</span><span class=o>.</span><span class=n>as_minutes</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>        <span class=o>-</span> <span class=n>local_standard_time_meridian_minutes_series</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>        <span class=o>+</span> <span class=n>equation_of_time</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>    <span class=c1># time_correction_factor_hours = time_correction_factor / 60  # We are already in minutes !</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>    <span class=n>true_solar_time_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>        <span class=n>timestamps</span> <span class=o>-</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>normalize</span><span class=p>()</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>+</span> <span class=n>time_correction_factor_minutes</span> <span class=o>*</span> <span class=mi>60</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>    <span class=c1># array_parameters = {</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>    <span class=c1>#     "shape": true_solar_time_series.shape,</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>    <span class=c1>#     "dtype": dtype,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>    <span class=c1>#     "init_method": "zeros",</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>    <span class=c1>#     "backend": array_backend,</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>    <span class=c1># }</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>    <span class=c1># true_solar_time_series_in_minutes = create_array(**array_parameters)</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>    <span class=n>true_solar_time_series_in_minutes</span> <span class=o>=</span> <span class=n>numpy_mod</span><span class=p>(</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>        <span class=n>true_solar_time_series</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>dtype</span><span class=p>)</span> <span class=o>/</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>1440</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>            <span class=p>(</span><span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span> <span class=o>&lt;=</span> <span class=n>true_solar_time_series_in_minutes</span><span class=p>)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>true_solar_time_series_in_minutes</span> <span class=o>&lt;=</span> <span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=p>)</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>        <span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>():</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>            <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>true_solar_time_series_in_minutes</span><span class=p>[</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>                <span class=o>~</span><span class=p>(</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>                    <span class=p>(</span><span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span> <span class=o>&lt;=</span> <span class=n>true_solar_time_series_in_minutes</span><span class=p>)</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>                    <span class=o>&amp;</span> <span class=p>(</span><span class=n>true_solar_time_series_in_minutes</span> <span class=o>&lt;=</span> <span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=p>)</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>            <span class=p>]</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>                <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>                <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=si>}</span><span class=s2>] minutes"</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>                <span class=sa>f</span><span class=s2>" in [code]true_solar_time_series_in_minutes[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>true_solar_time_series_in_minutes</span><span class=p>,</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>    <span class=k>return</span> <span class=n>TrueSolarTime</span><span class=p>(</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>array</span><span class=p>(</span><span class=n>true_solar_time_series_in_minutes</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>),</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>MINUTES</span><span class=p>,</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>        <span class=n>timing_algorithm</span><span class=o>=</span><span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>milne</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.muneer> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">muneer</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">irradiance</span> (<code>pvgisprototype.algorithms.muneer.irradiance</code>)'>irradiance</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">irradiance</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">diffuse</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse</code>)'>diffuse</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">diffuse</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse title="Permanent link"></a></h4> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">clear_sky</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky</code>)'>clear_sky</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.in_shade title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">in_shade</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.in_shade</code>)'>in_shade</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.inclined title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">inclined</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.inclined</code>)'>inclined</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.potentially_sunlit title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">potentially_sunlit</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.potentially_sunlit</code>)'>potentially_sunlit</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.sky_irradiance title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">sky_irradiance</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.sky_irradiance</code>)'>sky_irradiance</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.sunlit title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">sunlit</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.sunlit</code>)'>sunlit</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.term_n title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">term_n</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.term_n</code>)'>term_n</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">clear_sky</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky.inclined title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">inclined</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky.inclined</code>)'>inclined</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky.inclined> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">inclined</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky.inclined title="Permanent link"></a></h6> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky.inclined.calculate_clear_sky_diffuse_inclined_irradiance_muneer title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_clear_sky_diffuse_inclined_irradiance_muneer</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky.inclined.calculate_clear_sky_diffuse_inclined_irradiance_muneer</code>)'>calculate_clear_sky_diffuse_inclined_irradiance_muneer</a></code></td> <td> <div class=doc-md-description> <p>Calculate the diffuse irradiance incident on a solar surface.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h7 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky.inclined.calculate_clear_sky_diffuse_inclined_irradiance_muneer> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_clear_sky_diffuse_inclined_irradiance_muneer</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.clear_sky.inclined.calculate_clear_sky_diffuse_inclined_irradiance_muneer title="Permanent link"></a></h7> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_clear_sky_diffuse_inclined_irradiance_muneer</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>elevation</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceOrientation>SurfaceOrientation</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceTilt>SurfaceTilt</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>(</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>        <span class=p>[</span><span class=n><span title=pandas.Timestamp.now>now</span></span><span class=p>(</span><span class=n><span title=pandas.Timestamp.now(tz)>tz</span></span><span class=o>=</span><span class=s2>"UTC"</span><span class=p>)]</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=p>),</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>),</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>global_horizontal_irradiance_series</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=n><span title=numpy.ndarray>ndarray</span></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=p>)</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>direct_horizontal_irradiance_series</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>        <span class=n><span title=numpy.ndarray>ndarray</span></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=p>)</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.LinkeTurbidityFactor>LinkeTurbidityFactor</span></span><span class=p>(),</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>apply_reflectivity_factor</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ANGULAR_LOSS_FACTOR_FLAG_DEFAULT>ANGULAR_LOSS_FACTOR_FLAG_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=n>solar_azimuth_series</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>        <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=p>)</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span><span class=p>(),</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarIncidence>SolarIncidence</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n><span title=pydantic_numpy.NpNDArray>NpNDArray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>shading_states</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.List title="<code>typing.List</code>">List</a></span><span class=p>[</span><span class=n><span title=pvgisprototype.api.position.models.ShadingState>ShadingState</span></span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n><span title=pvgisprototype.api.position.models.ShadingState.all>all</span></span><span class=p>],</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></span><span class=p>,</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.DiffuseSkyReflectedInclinedIrradiance>DiffuseSkyReflectedInclinedIrradiance</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the diffuse irradiance incident on a solar surface.</p> <details class=note open> <summary>Notes</summary> <p>In order or appearance:</p> <ul> <li>extraterrestrial_normal_irradiance : G0</li> <li>extraterrestrial_horizontal_irradiance : G0h = G0 sin(h0)</li> <li>kb : Proportion between direct (beam) and extraterrestrial irradiance : Kb</li> <li>diffuse_horizontal_component : Dhc [W.m-2]</li> <li>diffuse_transmission_function() :</li> <li>linke_turbidity_factor :</li> <li>diffuse_solar_altitude_function() :</li> <li>solar_altitude :</li> <li>calculate_term_n():</li> <li>n : the N term</li> <li>diffuse_sky_irradiance()</li> <li>sine_solar_incidence_angle</li> <li>sine_solar_altitude</li> <li>diffuse_sky_irradiance</li> <li>calculate_diffuse_sky_irradiance() : F(N)</li> <li>surface_tilt :</li> <li>diffuse_inclined_irradiance :</li> <li>diffuse_horizontal_component :</li> <li>azimuth_difference :</li> <li>solar_azimuth :</li> <li>surface_orientation :</li> <li>diffuse_irradiance</li> </ul> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/muneer/irradiance/diffuse/clear_sky/inclined.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_clear_sky_diffuse_inclined_irradiance_muneer</span><span class=p>(</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=n>elevation</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n>SurfaceOrientation</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n>SurfaceTilt</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>DatetimeIndex</span><span class=p>([</span><span class=n>Timestamp</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>tz</span><span class=o>=</span><span class=s1>'UTC'</span><span class=p>)]),</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>ZoneInfo</span><span class=p>(</span><span class=s1>'UTC'</span><span class=p>),</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=n>global_horizontal_irradiance_series</span><span class=p>:</span> <span class=n>ndarray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=n>direct_horizontal_irradiance_series</span><span class=p>:</span> <span class=n>ndarray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=n>linke_turbidity_factor_series</span><span class=p>:</span> <span class=n>LinkeTurbidityFactor</span> <span class=o>=</span> <span class=n>LinkeTurbidityFactor</span><span class=p>(),</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=n>apply_reflectivity_factor</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>ANGULAR_LOSS_FACTOR_FLAG_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n>SolarAltitude</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=n>solar_azimuth_series</span><span class=p>:</span> <span class=n>SolarAzimuth</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>SolarAzimuth</span><span class=p>(),</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n>SolarIncidence</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n>NpNDArray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=n>shading_states</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ShadingState</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>ShadingState</span><span class=o>.</span><span class=n>all</span><span class=p>],</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SOLAR_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DiffuseSkyReflectedInclinedIrradiance</span><span class=p>:</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=w>    </span><span class=sd>"""Calculate the diffuse irradiance incident on a solar surface.</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    In order or appearance:</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>    - extraterrestrial_normal_irradiance : G0</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>    - extraterrestrial_horizontal_irradiance : G0h = G0 sin(h0)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>    - kb : Proportion between direct (beam) and extraterrestrial irradiance : Kb</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>    - diffuse_horizontal_component : Dhc [W.m-2]</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    - diffuse_transmission_function() :</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    - linke_turbidity_factor :</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>    - diffuse_solar_altitude_function() :</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>    - solar_altitude :</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>    - calculate_term_n():</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    - n : the N term</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>    - diffuse_sky_irradiance()</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>    - sine_solar_incidence_angle</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>    - sine_solar_altitude</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>    - diffuse_sky_irradiance</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>    - calculate_diffuse_sky_irradiance() : F(N)</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>    - surface_tilt :</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>    - diffuse_inclined_irradiance :</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>    - diffuse_horizontal_component :</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>    - azimuth_difference :</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>    - solar_azimuth :</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>    - surface_orientation :</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>    - diffuse_irradiance</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=n>global_horizontal_irradiance_series</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=ow>and</span> <span class=n>direct_horizontal_irradiance_series</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>            <span class=s2>":information: The global_horizontal_irradiance and/or direct_horizontal_irradiance inputs should be None at this point !"</span><span class=p>,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>            <span class=n>alt</span> <span class=o>=</span> <span class=s2>":information: [bold red]The [code]global_horizontal_irradiance[/code] and/or [code]direct_horizontal_irradiance[/code] inputs should be [code]None[/code] at this point ![/bold red]"</span><span class=p>,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>            <span class=s2>":information: The `global_horizontal_irradiance` and/or `direct_horizontal_irradiance` inputs should be `None` at this point !"</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=k>else</span><span class=p>:</span>  <span class=c1># model the diffuse horizontal irradiance</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>        <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>                <span class=s2>":information: Modelling clear-sky diffuse horizontal irradiance ..."</span><span class=p>,</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=s2>":information: [bold]Modelling[/bold] clear-sky diffuse horizontal irradiance ..."</span><span class=p>,</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>        <span class=c1># create a placeholder array for global horizontal irradiance</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>        <span class=n>global_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>            <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>        <span class=c1># in which case, however and if NOT read from external series already,</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=c1># we need the direct component for the kb series</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=n>direct_horizontal_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>            <span class=n>calculate_clear_sky_direct_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>                <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>                <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>                <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>                <span class=n>surface_in_shade_series</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>                <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>                <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>                <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>                <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>                <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>                <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>                <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=n>diffuse_horizontal_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>            <span class=n>calculate_clear_sky_diffuse_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>                <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>                <span class=n>linke_turbidity_factor_series</span><span class=o>=</span><span class=n>linke_turbidity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>                <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>                <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>                <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>                <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>                <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>                <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>                <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>    <span class=c1>#</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>    <span class=c1># ----------------------------------- Diffuse Horizontal Irradiance -- ^^^</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>    <span class=c1># At this point, the diffuse_horizontal_irradiance_series are either :</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>    <span class=c1># calculated from external time series  Or  modelled</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=c1># Initialise shading_state_series to avoid the "UnboundLocalError"</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>    <span class=n>shading_state_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>        <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s1>'object'</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"empty"</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>    <span class=n>nan_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>    <span class=n>unset_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>        <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"unset"</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>    <span class=c1># np.full(timestamps.shape, "Unset", "object")</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>    <span class=k>if</span> <span class=n>surface_tilt</span> <span class=o>&lt;=</span> <span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>:</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>        <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>                <span class=s2>":information: Modelling clear-sky diffuse inclined irradiance for a horizontally flat panel..."</span><span class=p>,</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=s2>":information: [bold]Modelling[/bold] clear-sky diffuse inclined irradiance for a horizontally flat panel..."</span><span class=p>,</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>        <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>            <span class=n>diffuse_horizontal_irradiance_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>        <span class=c1># to not break the output !</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>        <span class=n>diffuse_sky_irradiance_series</span> <span class=o>=</span> <span class=n>unset_series</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>        <span class=n>n_series</span> <span class=o>=</span> <span class=n>unset_series</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>        <span class=n>kb_series</span> <span class=o>=</span> <span class=n>unset_series</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>        <span class=n>azimuth_difference_series</span> <span class=o>=</span> <span class=n>unset_series</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>        <span class=n>solar_incidence_series</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>(</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>            <span class=n>value</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>            <span class=n>incidence_algorithm</span><span class=o>=</span><span class=n>NOT_AVAILABLE</span><span class=p>,</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>            <span class=n>definition</span><span class=o>=</span><span class=n>NOT_AVAILABLE</span><span class=p>,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>            <span class=n>azimuth_origin</span><span class=o>=</span><span class=n>NOT_AVAILABLE</span><span class=p>,</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>        <span class=n>extraterrestrial_normal_irradiance_series</span> <span class=o>=</span> <span class=n>ExtraterrestrialNormalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>            <span class=n>value</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>            <span class=n>unit</span><span class=o>=</span><span class=n>NOT_AVAILABLE</span><span class=p>,</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>            <span class=n>day_angle</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>            <span class=n>solar_constant</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>            <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>            <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>            <span class=n>distance_correction_factor</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>        <span class=n>extraterrestrial_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>ExtraterrestrialHorizontalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>            <span class=n>value</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>            <span class=n>unit</span><span class=o>=</span><span class=n>NOT_AVAILABLE</span><span class=p>,</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>            <span class=n>day_angle</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>            <span class=n>solar_constant</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>            <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>            <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>            <span class=n>distance_correction_factor</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>    <span class=k>else</span><span class=p>:</span>  <span class=c1># tilted (or inclined) surface</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>        <span class=c1># Note: in PVGIS: if surface_orientation != 'UNDEF' and surface_tilt != 0:</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>        <span class=c1># --------------------------------------------------- Is this safe ? -</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>        <span class=c1># Calculate or get quantities required : ---------------------------- &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt;</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>        <span class=c1># 1. to model the diffuse horizontal irradiance [optional]</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>        <span class=c1># 2. to calculate the diffuse sky ... to consider shaded, sunlit and potentially sunlit surfaces</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>        <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>                <span class=s2>":information: Modelling clear-sky diffuse inclined irradiance for a tilted panel..."</span><span class=p>,</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=s2>":information: [bold]Modelling[/bold] clear-sky diffuse inclined irradiance for a tilted panel..."</span><span class=p>,</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>        <span class=n>extraterrestrial_normal_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>            <span class=n>calculate_extraterrestrial_normal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>                <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>                <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>                <span class=n>eccentricity_phase_offset</span><span class=o>=</span><span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>                <span class=n>eccentricity_amplitude</span><span class=o>=</span><span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>                <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>                <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>  <span class=c1># no verbosity here by choice!</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>                <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>        <span class=n>extraterrestrial_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_extraterrestrial_horizontal_irradiance_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>            <span class=n>extraterrestrial_normal_irradiance</span><span class=o>=</span><span class=n>extraterrestrial_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>            <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>        <span class=c1># Calculate quantities required : ---------------------------- &lt;&lt;&lt; &lt;&lt;&lt; &lt;&lt;&lt;</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>        <span class=k>with</span> <span class=n>np</span><span class=o>.</span><span class=n>errstate</span><span class=p>(</span><span class=n>divide</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>,</span> <span class=n>invalid</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>):</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>            <span class=n>kb_series</span> <span class=o>=</span> <span class=p>(</span>  <span class=c1># proportion between direct and extraterrestrial</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>                <span class=n>direct_horizontal_irradiance_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>                <span class=o>/</span> <span class=n>extraterrestrial_horizontal_irradiance_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>        <span class=n>n_series</span> <span class=o>=</span> <span class=n>calculate_term_n_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>            <span class=n>kb_series</span><span class=p>,</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a>            <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a>            <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a>            <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a>        <span class=n>diffuse_sky_irradiance_series</span> <span class=o>=</span> <span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>            <span class=n>np</span><span class=o>.</span><span class=n>isnan</span><span class=p>(</span><span class=n>n_series</span><span class=p>),</span>  <span class=c1># handle NaN cases</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a>            <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>            <span class=n>calculate_diffuse_sky_irradiance_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a>                <span class=n>n_series</span><span class=o>=</span><span class=n>n_series</span><span class=p>,</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a>                <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a>            <span class=p>),</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>        <span class=c1># prepare size of output array!</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>        <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>            <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"zeros"</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a>        <span class=c1># prepare cases : surfaces in shade, sunlit, potentially sunlit</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a>        <span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.api.position.models</span><span class=w> </span><span class=kn>import</span> <span class=n>select_models</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a>        <span class=n>shading_states</span> <span class=o>=</span> <span class=n>select_models</span><span class=p>(</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a>            <span class=n>ShadingState</span><span class=p>,</span> <span class=n>shading_states</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a>        <span class=p>)</span>  <span class=c1># Using a callback fails!</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>        <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_diffuse_inclined_irradiance_in_shade</span><span class=p>(</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a>            <span class=c1># mask_surface_in_shade_series=mask_surface_in_shade_series,</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a>            <span class=n>solar_incidence</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a>            <span class=n>surface_in_shade</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>            <span class=n>shading_states</span><span class=o>=</span><span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><a href=#__codelineno-0-328><span class=linenos data-linenos="328 "></span></a>            <span class=n>shading_state_series</span><span class=o>=</span><span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a>            <span class=n>diffuse_sky_irradiance</span><span class=o>=</span><span class=n>diffuse_sky_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a>            <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a>            <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a>            <span class=n>diffuse_inclined_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a>            <span class=n>diffuse_horizontal_irradiance</span><span class=o>=</span><span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a>        <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_diffuse_inclined_irradiance_sunlit</span><span class=p>(</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a>            <span class=n>solar_incidence</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><a href=#__codelineno-0-338><span class=linenos data-linenos="338 "></span></a>            <span class=n>shading_states</span><span class=o>=</span><span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><a href=#__codelineno-0-339><span class=linenos data-linenos="339 "></span></a>            <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><a href=#__codelineno-0-340><span class=linenos data-linenos="340 "></span></a>            <span class=n>shading_state_series</span><span class=o>=</span><span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><a href=#__codelineno-0-341><span class=linenos data-linenos="341 "></span></a>            <span class=n>diffuse_sky_irradiance</span><span class=o>=</span><span class=n>diffuse_sky_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><a href=#__codelineno-0-342><span class=linenos data-linenos="342 "></span></a>            <span class=n>kb_series</span><span class=o>=</span><span class=n>kb_series</span><span class=p>,</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><a href=#__codelineno-0-343><span class=linenos data-linenos="343 "></span></a>            <span class=n>diffuse_inclined_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><a href=#__codelineno-0-344><span class=linenos data-linenos="344 "></span></a>            <span class=n>diffuse_horizontal_irradiance</span><span class=o>=</span><span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><a href=#__codelineno-0-345><span class=linenos data-linenos="345 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><a href=#__codelineno-0-346><span class=linenos data-linenos="346 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><a href=#__codelineno-0-347><span class=linenos data-linenos="347 "></span></a>        <span class=n>azimuth_difference_series</span> <span class=o>=</span> <span class=n>NOT_AVAILABLE</span>  <span class=c1># not always required, set to avoid UnboundLocalError!</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><a href=#__codelineno-0-348><span class=linenos data-linenos="348 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><a href=#__codelineno-0-349><span class=linenos data-linenos="349 "></span></a>        <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_diffuse_inclined_irradiance_potentially_sunlit</span><span class=p>(</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><a href=#__codelineno-0-350><span class=linenos data-linenos="350 "></span></a>            <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><a href=#__codelineno-0-351><span class=linenos data-linenos="351 "></span></a>            <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><a href=#__codelineno-0-352><span class=linenos data-linenos="352 "></span></a>            <span class=n>solar_azimuth</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><a href=#__codelineno-0-353><span class=linenos data-linenos="353 "></span></a>            <span class=n>shading_states</span><span class=o>=</span><span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><a href=#__codelineno-0-354><span class=linenos data-linenos="354 "></span></a>            <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><a href=#__codelineno-0-355><span class=linenos data-linenos="355 "></span></a>            <span class=n>shading_state_series</span><span class=o>=</span><span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><a href=#__codelineno-0-356><span class=linenos data-linenos="356 "></span></a>            <span class=n>diffuse_sky_irradiance</span><span class=o>=</span><span class=n>diffuse_sky_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><a href=#__codelineno-0-357><span class=linenos data-linenos="357 "></span></a>            <span class=n>kb_series</span><span class=o>=</span><span class=n>kb_series</span><span class=p>,</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><a href=#__codelineno-0-358><span class=linenos data-linenos="358 "></span></a>            <span class=n>diffuse_inclined_irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><a href=#__codelineno-0-359><span class=linenos data-linenos="359 "></span></a>            <span class=n>diffuse_horizontal_irradiance</span><span class=o>=</span><span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><a href=#__codelineno-0-360><span class=linenos data-linenos="360 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><a href=#__codelineno-0-361><span class=linenos data-linenos="361 "></span></a>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><a href=#__codelineno-0-362><span class=linenos data-linenos="362 "></span></a>    <span class=c1># Replace None with a placeholder -- this is important for printing !</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><a href=#__codelineno-0-363><span class=linenos data-linenos="363 "></span></a>    <span class=n>shading_state_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a><a href=#__codelineno-0-364><span class=linenos data-linenos="364 "></span></a>        <span class=n>shading_state_series</span> <span class=o>==</span> <span class=kc>None</span><span class=p>,</span> <span class=s2>"Unset"</span><span class=p>,</span> <span class=n>shading_state_series</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><a href=#__codelineno-0-365><span class=linenos data-linenos="365 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><a href=#__codelineno-0-366><span class=linenos data-linenos="366 "></span></a>    <span class=c1># ------------------------------------------------------------------------</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><a href=#__codelineno-0-367><span class=linenos data-linenos="367 "></span></a>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><a href=#__codelineno-0-368><span class=linenos data-linenos="368 "></span></a>    <span class=c1># diffuse_inclined_irradiance_series = np.nan_to_num(</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><a href=#__codelineno-0-369><span class=linenos data-linenos="369 "></span></a>    <span class=c1>#     diffuse_inclined_irradiance_series, nan=0</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><a href=#__codelineno-0-370><span class=linenos data-linenos="370 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><a href=#__codelineno-0-371><span class=linenos data-linenos="371 "></span></a>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><a href=#__codelineno-0-372><span class=linenos data-linenos="372 "></span></a>    <span class=n>diffuse_irradiance_reflectivity_coefficient</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><a href=#__codelineno-0-373><span class=linenos data-linenos="373 "></span></a>    <span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span> <span class=o>=</span> <span class=n>nan_series</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><a href=#__codelineno-0-374><span class=linenos data-linenos="374 "></span></a>    <span class=n>diffuse_inclined_irradiance_before_reflectivity_series</span> <span class=o>=</span> <span class=n>nan_series</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><a href=#__codelineno-0-375><span class=linenos data-linenos="375 "></span></a>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><a href=#__codelineno-0-376><span class=linenos data-linenos="376 "></span></a>    <span class=k>if</span> <span class=n>apply_reflectivity_factor</span><span class=p>:</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><a href=#__codelineno-0-377><span class=linenos data-linenos="377 "></span></a>        <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>surface_tilt</span> <span class=o>-</span> <span class=n>pi</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>MINIMAL_DIFFERENCE_THRESHOLD</span><span class=p>:</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><a href=#__codelineno-0-378><span class=linenos data-linenos="378 "></span></a>            <span class=n>surface_tilt</span> <span class=o>-=</span> <span class=n>MINIMAL_DIFFERENCE_THRESHOLD</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><a href=#__codelineno-0-379><span class=linenos data-linenos="379 "></span></a>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><a href=#__codelineno-0-380><span class=linenos data-linenos="380 "></span></a>        <span class=c1># Get the reflectivity coefficient</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><a href=#__codelineno-0-381><span class=linenos data-linenos="381 "></span></a>        <span class=n>diffuse_irradiance_reflectivity_coefficient</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>surface_tilt</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><a href=#__codelineno-0-382><span class=linenos data-linenos="382 "></span></a>            <span class=n>pi</span> <span class=o>-</span> <span class=n>surface_tilt</span> <span class=o>-</span> <span class=n>sin</span><span class=p>(</span><span class=n>surface_tilt</span><span class=p>)</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><a href=#__codelineno-0-383><span class=linenos data-linenos="383 "></span></a>        <span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>cos</span><span class=p>(</span><span class=n>surface_tilt</span><span class=p>))</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><a href=#__codelineno-0-384><span class=linenos data-linenos="384 "></span></a>        <span class=n>diffuse_irradiance_reflectivity_factor</span> <span class=o>=</span> <span class=n>calculate_reflectivity_factor_for_nondirect_irradiance</span><span class=p>(</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><a href=#__codelineno-0-385><span class=linenos data-linenos="385 "></span></a>            <span class=n>indirect_angular_loss_coefficient</span><span class=o>=</span><span class=n>diffuse_irradiance_reflectivity_coefficient</span><span class=p>,</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><a href=#__codelineno-0-386><span class=linenos data-linenos="386 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><a href=#__codelineno-0-387><span class=linenos data-linenos="387 "></span></a>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a><a href=#__codelineno-0-388><span class=linenos data-linenos="388 "></span></a>        <span class=c1># Get the reflectivity factor from ...</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a><a href=#__codelineno-0-389><span class=linenos data-linenos="389 "></span></a>        <span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a><a href=#__codelineno-0-390><span class=linenos data-linenos="390 "></span></a>            <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><a href=#__codelineno-0-391><span class=linenos data-linenos="391 "></span></a>            <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a><a href=#__codelineno-0-392><span class=linenos data-linenos="392 "></span></a>            <span class=n>init_method</span><span class=o>=</span><span class=n>diffuse_irradiance_reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><a href=#__codelineno-0-393><span class=linenos data-linenos="393 "></span></a>            <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a><a href=#__codelineno-0-394><span class=linenos data-linenos="394 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><a href=#__codelineno-0-395><span class=linenos data-linenos="395 "></span></a>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><a href=#__codelineno-0-396><span class=linenos data-linenos="396 "></span></a>        <span class=c1># Apply the reflectivity factor</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><a href=#__codelineno-0-397><span class=linenos data-linenos="397 "></span></a>        <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>*=</span> <span class=p>(</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><a href=#__codelineno-0-398><span class=linenos data-linenos="398 "></span></a>            <span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><a href=#__codelineno-0-399><span class=linenos data-linenos="399 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><a href=#__codelineno-0-400><span class=linenos data-linenos="400 "></span></a>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><a href=#__codelineno-0-401><span class=linenos data-linenos="401 "></span></a>        <span class=c1># avoid copying to save memory and time ... ? ----------------- Is this safe ? -</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><a href=#__codelineno-0-402><span class=linenos data-linenos="402 "></span></a>        <span class=k>with</span> <span class=n>errstate</span><span class=p>(</span><span class=n>divide</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>,</span> <span class=n>invalid</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>):</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><a href=#__codelineno-0-403><span class=linenos data-linenos="403 "></span></a>            <span class=c1># this quantity is exclusively generated for the output dictionary !</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><a href=#__codelineno-0-404><span class=linenos data-linenos="404 "></span></a>            <span class=n>diffuse_inclined_irradiance_before_reflectivity_series</span> <span class=o>=</span> <span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><a href=#__codelineno-0-405><span class=linenos data-linenos="405 "></span></a>                <span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><a href=#__codelineno-0-406><span class=linenos data-linenos="406 "></span></a>                <span class=n>diffuse_inclined_irradiance_series</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><a href=#__codelineno-0-407><span class=linenos data-linenos="407 "></span></a>                <span class=o>/</span> <span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><a href=#__codelineno-0-408><span class=linenos data-linenos="408 "></span></a>                <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a><a href=#__codelineno-0-409><span class=linenos data-linenos="409 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><a href=#__codelineno-0-410><span class=linenos data-linenos="410 "></span></a>        <span class=c1># ------------------------------------------------------------------------------</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><a href=#__codelineno-0-411><span class=linenos data-linenos="411 "></span></a>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><a href=#__codelineno-0-412><span class=linenos data-linenos="412 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a><a href=#__codelineno-0-413><span class=linenos data-linenos="413 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a><a href=#__codelineno-0-414><span class=linenos data-linenos="414 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a><a href=#__codelineno-0-415><span class=linenos data-linenos="415 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>DiffuseSkyReflectedInclinedIrradiance</span><span class=p>(),</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a><a href=#__codelineno-0-416><span class=linenos data-linenos="416 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a><a href=#__codelineno-0-417><span class=linenos data-linenos="417 "></span></a>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a><a href=#__codelineno-0-418><span class=linenos data-linenos="418 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a><a href=#__codelineno-0-419><span class=linenos data-linenos="419 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a><a href=#__codelineno-0-420><span class=linenos data-linenos="420 "></span></a>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a><a href=#__codelineno-0-421><span class=linenos data-linenos="421 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a><a href=#__codelineno-0-422><span class=linenos data-linenos="422 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a><a href=#__codelineno-0-423><span class=linenos data-linenos="423 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a><a href=#__codelineno-0-424><span class=linenos data-linenos="424 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><a href=#__codelineno-0-425><span class=linenos data-linenos="425 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><a href=#__codelineno-0-426><span class=linenos data-linenos="426 "></span></a>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a><a href=#__codelineno-0-427><span class=linenos data-linenos="427 "></span></a>    <span class=k>return</span> <span class=n>DiffuseSkyReflectedInclinedIrradiance</span><span class=p>(</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a><a href=#__codelineno-0-428><span class=linenos data-linenos="428 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a><a href=#__codelineno-0-429><span class=linenos data-linenos="429 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a><a href=#__codelineno-0-430><span class=linenos data-linenos="430 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a><a href=#__codelineno-0-431><span class=linenos data-linenos="431 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a><a href=#__codelineno-0-432><span class=linenos data-linenos="432 "></span></a>        <span class=n>global_horizontal_irradiance</span><span class=o>=</span><span class=n>global_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a><a href=#__codelineno-0-433><span class=linenos data-linenos="433 "></span></a>        <span class=n>direct_horizontal_irradiance</span><span class=o>=</span><span class=n>direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><a href=#__codelineno-0-434><span class=linenos data-linenos="434 "></span></a>        <span class=n>diffuse_horizontal_irradiance</span><span class=o>=</span><span class=n>diffuse_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a><a href=#__codelineno-0-435><span class=linenos data-linenos="435 "></span></a>        <span class=n>extraterrestrial_horizontal_irradiance</span><span class=o>=</span><span class=n>extraterrestrial_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a><a href=#__codelineno-0-436><span class=linenos data-linenos="436 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a><a href=#__codelineno-0-437><span class=linenos data-linenos="437 "></span></a>        <span class=n>extraterrestrial_normal_irradiance</span><span class=o>=</span><span class=n>extraterrestrial_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a><a href=#__codelineno-0-438><span class=linenos data-linenos="438 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a><a href=#__codelineno-0-439><span class=linenos data-linenos="439 "></span></a>        <span class=n>reflected</span><span class=o>=</span><span class=n>calculate_reflectivity_effect</span><span class=p>(</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a><a href=#__codelineno-0-440><span class=linenos data-linenos="440 "></span></a>            <span class=n>irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_before_reflectivity_series</span><span class=p>,</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a><a href=#__codelineno-0-441><span class=linenos data-linenos="441 "></span></a>            <span class=n>reflectivity_factor</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a><a href=#__codelineno-0-442><span class=linenos data-linenos="442 "></span></a>        <span class=p>),</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a><a href=#__codelineno-0-443><span class=linenos data-linenos="443 "></span></a>        <span class=n>reflectivity_factor</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a><a href=#__codelineno-0-444><span class=linenos data-linenos="444 "></span></a>        <span class=n>reflectivity_coefficient</span><span class=o>=</span><span class=n>diffuse_irradiance_reflectivity_coefficient</span><span class=p>,</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a><a href=#__codelineno-0-445><span class=linenos data-linenos="445 "></span></a>        <span class=n>value_before_reflectivity</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_before_reflectivity_series</span><span class=p>,</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a><a href=#__codelineno-0-446><span class=linenos data-linenos="446 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a><a href=#__codelineno-0-447><span class=linenos data-linenos="447 "></span></a>        <span class=n>diffuse_sky_irradiance</span><span class=o>=</span><span class=n>diffuse_sky_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a><a href=#__codelineno-0-448><span class=linenos data-linenos="448 "></span></a>        <span class=n>term_n</span><span class=o>=</span><span class=n>n_series</span><span class=p>,</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a><a href=#__codelineno-0-449><span class=linenos data-linenos="449 "></span></a>        <span class=n>kb_ratio</span><span class=o>=</span><span class=n>kb_series</span><span class=p>,</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a><a href=#__codelineno-0-450><span class=linenos data-linenos="450 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a><a href=#__codelineno-0-451><span class=linenos data-linenos="451 "></span></a>        <span class=n>elevation</span><span class=o>=</span><span class=n>elevation</span><span class=p>,</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a><a href=#__codelineno-0-452><span class=linenos data-linenos="452 "></span></a>        <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a><a href=#__codelineno-0-453><span class=linenos data-linenos="453 "></span></a>        <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a><a href=#__codelineno-0-454><span class=linenos data-linenos="454 "></span></a>        <span class=n>surface_tilt_threshold</span><span class=o>=</span><span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>,</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a><a href=#__codelineno-0-455><span class=linenos data-linenos="455 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a><a href=#__codelineno-0-456><span class=linenos data-linenos="456 "></span></a>        <span class=n>surface_in_shade</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a><a href=#__codelineno-0-457><span class=linenos data-linenos="457 "></span></a>        <span class=n>solar_incidence</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a><a href=#__codelineno-0-458><span class=linenos data-linenos="458 "></span></a>        <span class=n>shading_state</span><span class=o>=</span><span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><a href=#__codelineno-0-459><span class=linenos data-linenos="459 "></span></a>        <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><a href=#__codelineno-0-460><span class=linenos data-linenos="460 "></span></a>        <span class=n>solar_azimuth</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><a href=#__codelineno-0-461><span class=linenos data-linenos="461 "></span></a>        <span class=n>solar_azimuth_origin</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>origin</span><span class=p>,</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><a href=#__codelineno-0-462><span class=linenos data-linenos="462 "></span></a>        <span class=n>azimuth_difference</span><span class=o>=</span><span class=n>azimuth_difference_series</span><span class=p>,</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a><a href=#__codelineno-0-463><span class=linenos data-linenos="463 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a><a href=#__codelineno-0-464><span class=linenos data-linenos="464 "></span></a>        <span class=n>solar_incidence_model</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>algorithm</span><span class=p>,</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a><a href=#__codelineno-0-465><span class=linenos data-linenos="465 "></span></a>        <span class=n>solar_incidence_definition</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>definition</span><span class=p>,</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a><a href=#__codelineno-0-466><span class=linenos data-linenos="466 "></span></a>        <span class=n>shading_states</span><span class=o>=</span><span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a><a href=#__codelineno-0-467><span class=linenos data-linenos="467 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.in_shade> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">in_shade</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.in_shade title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.in_shade.calculate_diffuse_inclined_irradiance_in_shade title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_diffuse_inclined_irradiance_in_shade</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.in_shade.calculate_diffuse_inclined_irradiance_in_shade</code>)'>calculate_diffuse_inclined_irradiance_in_shade</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.in_shade.calculate_diffuse_inclined_irradiance_in_shade> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_diffuse_inclined_irradiance_in_shade</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.in_shade.calculate_diffuse_inclined_irradiance_in_shade title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_diffuse_inclined_irradiance_in_shade</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>diffuse_inclined_irradiance</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>diffuse_sky_irradiance</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>diffuse_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>solar_incidence</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>surface_in_shade</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/muneer/irradiance/diffuse/in_shade.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_diffuse_inclined_irradiance_in_shade</span><span class=p>(</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>    <span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a>    <span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>    <span class=n>diffuse_inclined_irradiance</span><span class=p>,</span> <span class=c1># updated in-place</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>    <span class=n>diffuse_sky_irradiance</span><span class=p>,</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>    <span class=n>diffuse_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>    <span class=n>solar_incidence</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>    <span class=n>surface_in_shade</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>    <span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>    <span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a><span class=p>):</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>    <span class=k>if</span> <span class=n>ShadingState</span><span class=o>.</span><span class=n>in_shade</span> <span class=ow>in</span> <span class=n>shading_states</span><span class=p>:</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>        <span class=c1>#  ----------------------------------------------------- Review Me</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>        <span class=n>mask_surface_in_shade_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>logical_or</span><span class=p>(</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>            <span class=c1># np.sin(solar_incidence.radians) &lt; 0,  # in shade</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>            <span class=c1># will never be True ! when negative incidence angles set to 0 !</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>            <span class=n>solar_incidence</span><span class=o>.</span><span class=n>radians</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>,</span>  <span class=c1># in shade</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>            <span class=c1># ---------------------------------------------- Review Me ---</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>            <span class=c1># solar_altitude_series.radians &gt;= 0,  # yet there is ambient light</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>            <span class=n>surface_in_shade</span><span class=o>.</span><span class=n>value</span>  <span class=c1># pre-calculated in-shade moments </span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>        <span class=c1># Is this the _complementary_ incidence angle series ?</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>        <span class=c1>#  Review Me -----------------------------------------------------</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>        <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mask_surface_in_shade_series</span><span class=p>):</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>            <span class=n>shading_state_series</span><span class=p>[</span><span class=n>mask_surface_in_shade_series</span><span class=p>]</span> <span class=o>=</span> <span class=n>ShadingState</span><span class=o>.</span><span class=n>in_shade</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>                <span class=sa>f</span><span class=s2>"Shading state series including </span><span class=si>{</span><span class=n>ShadingState</span><span class=o>.</span><span class=n>in_shade</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2> :</span><span class=se>\n</span><span class=si>{</span><span class=n>shading_state_series</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>"[bold]Shading state[/bold] series including [bold white]</span><span class=si>{</span><span class=n>ShadingState</span><span class=o>.</span><span class=n>in_shade</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>[/bold white] :</span><span class=se>\n</span><span class=si>{</span><span class=n>shading_state_series</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>            <span class=n>diffuse_sky_irradiance</span><span class=p>[</span><span class=n>mask_surface_in_shade_series</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>                <span class=n>calculate_diffuse_sky_irradiance_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>                    <span class=n>n_series</span><span class=o>=</span><span class=n>full</span><span class=p>(</span><span class=n>timestamps</span><span class=o>.</span><span class=n>size</span><span class=p>,</span> <span class=n>TERM_N_IN_SHADE</span><span class=p>),</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>                    <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>                <span class=p>)[</span><span class=n>mask_surface_in_shade_series</span><span class=p>]</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>            <span class=n>diffuse_inclined_irradiance</span><span class=p>[</span><span class=n>mask_surface_in_shade_series</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>                <span class=n>diffuse_horizontal_irradiance</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_surface_in_shade_series</span><span class=p>]</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>                <span class=o>*</span> <span class=n>diffuse_sky_irradiance</span><span class=p>[</span><span class=n>mask_surface_in_shade_series</span><span class=p>]</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>    <span class=k>return</span> <span class=n>diffuse_inclined_irradiance</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.inclined> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">inclined</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.inclined title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.inclined.calculate_diffuse_inclined_irradiance_muneer title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_diffuse_inclined_irradiance_muneer</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.inclined.calculate_diffuse_inclined_irradiance_muneer</code>)'>calculate_diffuse_inclined_irradiance_muneer</a></code></td> <td> <div class=doc-md-description> <p>Calculate the diffuse irradiance incident on a solar surface.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.inclined.calculate_diffuse_inclined_irradiance_muneer> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_diffuse_inclined_irradiance_muneer</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.inclined.calculate_diffuse_inclined_irradiance_muneer title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_diffuse_inclined_irradiance_muneer</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceOrientation>SurfaceOrientation</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceTilt>SurfaceTilt</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>=</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>(</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=p>[</span><span class=n><span title=pandas.Timestamp.now>now</span></span><span class=p>(</span><span class=n><span title=pandas.Timestamp.now(tz)>tz</span></span><span class=o>=</span><span class=s2>"UTC"</span><span class=p>)]</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=p>),</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>),</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>global_horizontal_irradiance_series</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=n><span title=numpy.ndarray>ndarray</span></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=p>)</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>direct_horizontal_irradiance_series</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>        <span class=n><span title=numpy.ndarray>ndarray</span></span> <span class=o>|</span> <span class=kc>None</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=p>)</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>apply_reflectivity_factor</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ANGULAR_LOSS_FACTOR_FLAG_DEFAULT>ANGULAR_LOSS_FACTOR_FLAG_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>solar_azimuth_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarIncidence>SolarIncidence</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n><span title=pydantic_numpy.NpNDArray>NpNDArray</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=n>shading_states</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.List title="<code>typing.List</code>">List</a></span><span class=p>[</span><span class=n><span title=pvgisprototype.api.position.models.ShadingState>ShadingState</span></span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n><span title=pvgisprototype.api.position.models.ShadingState.all>all</span></span><span class=p>],</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SOLAR_CONSTANT>SOLAR_CONSTANT</span></span><span class=p>,</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_PHASE_OFFSET>ECCENTRICITY_PHASE_OFFSET</span></span><span class=p>,</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ECCENTRICITY_CORRECTION_FACTOR>ECCENTRICITY_CORRECTION_FACTOR</span></span><span class=p>,</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.DiffuseSkyReflectedInclinedIrradianceFromExternalData>DiffuseSkyReflectedInclinedIrradianceFromExternalData</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the diffuse irradiance incident on a solar surface.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/muneer/irradiance/diffuse/inclined.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_diffuse_inclined_irradiance_muneer</span><span class=p>(</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n>SurfaceOrientation</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n>SurfaceTilt</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>    <span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SURFACE_TILT_HORIZONTALLY_FLAT_PANEL_THRESHOLD</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>=</span> <span class=n>DatetimeIndex</span><span class=p>([</span><span class=n>Timestamp</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>tz</span><span class=o>=</span><span class=s1>'UTC'</span><span class=p>)]),</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>ZoneInfo</span><span class=p>(</span><span class=s1>'UTC'</span><span class=p>),</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>    <span class=n>global_horizontal_irradiance_series</span><span class=p>:</span> <span class=n>ndarray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=n>direct_horizontal_irradiance_series</span><span class=p>:</span> <span class=n>ndarray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>    <span class=n>apply_reflectivity_factor</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>ANGULAR_LOSS_FACTOR_FLAG_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=n>solar_altitude_series</span><span class=p>:</span> <span class=n>SolarAltitude</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=n>solar_azimuth_series</span><span class=p>:</span> <span class=n>SolarAzimuth</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>    <span class=n>solar_incidence_series</span><span class=p>:</span> <span class=n>SolarIncidence</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=n>surface_in_shade_series</span><span class=p>:</span> <span class=n>NpNDArray</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=n>shading_states</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ShadingState</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>ShadingState</span><span class=o>.</span><span class=n>all</span><span class=p>],</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>    <span class=n>solar_constant</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SOLAR_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=n>eccentricity_phase_offset</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_PHASE_OFFSET</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=n>eccentricity_amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>ECCENTRICITY_CORRECTION_FACTOR</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DiffuseSkyReflectedInclinedIrradianceFromExternalData</span><span class=p>:</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=w>    </span><span class=sd>"""Calculate the diffuse irradiance incident on a solar surface."""</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=c1># build reusable parameter dictionaries</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=n>no_earth_orbit</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=s1>'eccentricity_phase_offset'</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=s1>'eccentricity_amplitude'</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>    <span class=n>earth_orbit</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=s1>'eccentricity_phase_offset'</span><span class=p>:</span> <span class=n>eccentricity_phase_offset</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=s1>'eccentricity_amplitude'</span><span class=p>:</span> <span class=n>eccentricity_amplitude</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=s2>"array_backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=n>extended_array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=s2>"shape"</span><span class=p>:</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>global_horizontal_irradiance_series</span><span class=p>,</span> <span class=n>ndarray</span><span class=p>)</span> <span class=ow>and</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=n>direct_horizontal_irradiance_series</span><span class=p>,</span> <span class=n>ndarray</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>            <span class=s2>":information: The global_horizontal_irradiance and/or direct_horizontal_irradiance inputs should be NumPy arrays at this point !"</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>            <span class=n>alt</span> <span class=o>=</span> <span class=s2>":information: [bold red]The [code]global_horizontal_irradiance[/code] and/or [code]direct_horizontal_irradiance[/code] inputs should be [code]NumPy arrays[/code] at this point ![/bold red]"</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>            <span class=s2>":information: The `global_horizontal_irradiance` and/or `direct_horizontal_irradiance` inputs should be NumPy arrays at this point !"</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=s2>":information: Calculating sky-diffuse horizontal irradiance from external time series ..."</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=n>alt</span> <span class=o>=</span> <span class=s2>":information: [bold]Calculating[/bold] sky-diffuse horizontal irradiance from external time series ..."</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=n>diffuse_horizontal_irradiance</span> <span class=o>=</span> <span class=n>calculate_diffuse_horizontal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>global_horizontal_irradiance_series</span><span class=o>=</span><span class=n>global_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>direct_horizontal_irradiance_series</span><span class=o>=</span><span class=n>direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=o>**</span><span class=n>array_parameters</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>    <span class=c1># At this point, the diffuse_horizontal_irradiance_series are either :</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=c1># calculated from external time series  Or  modelled</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=c1># Initialise shading_state_series to avoid the "UnboundLocalError"</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>    <span class=n>shading_state_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=s2>"object"</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=n>init_method</span><span class=o>=</span><span class=s2>"empty"</span><span class=p>,</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>        <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=n>nan_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>extended_array_parameters</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=n>unset_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>extended_array_parameters</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"unset"</span><span class=p>)</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=c1># np.full(timestamps.shape, "Unset", "object")</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=k>if</span> <span class=n>surface_tilt</span> <span class=o>&lt;=</span> <span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>:</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>            <span class=n>diffuse_horizontal_irradiance</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>        <span class=c1># to not break the output !</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=n>diffuse_sky_irradiance_series</span> <span class=o>=</span> <span class=n>unset_series</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=n>n_series</span> <span class=o>=</span> <span class=n>unset_series</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>        <span class=n>kb_series</span> <span class=o>=</span> <span class=n>unset_series</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>        <span class=n>azimuth_difference_series</span> <span class=o>=</span> <span class=n>unset_series</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=n>solar_incidence_series</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>(</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>            <span class=n>value</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>            <span class=n>algorithm</span><span class=o>=</span><span class=n>NOT_AVAILABLE</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>            <span class=n>definition</span><span class=o>=</span><span class=n>NOT_AVAILABLE</span><span class=p>,</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>            <span class=n>azimuth_origin</span><span class=o>=</span><span class=n>NOT_AVAILABLE</span><span class=p>,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>extraterrestrial_normal_irradiance_series</span> <span class=o>=</span> <span class=n>ExtraterrestrialNormalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>            <span class=n>value</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>            <span class=n>unit</span><span class=o>=</span><span class=n>NOT_AVAILABLE</span><span class=p>,</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>            <span class=n>day_angle</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>            <span class=n>solar_constant</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>            <span class=o>**</span><span class=n>no_earth_orbit</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>            <span class=n>distance_correction_factor</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=n>extraterrestrial_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>ExtraterrestrialHorizontalIrradiance</span><span class=p>(</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>            <span class=n>value</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>            <span class=n>unit</span><span class=o>=</span><span class=n>NOT_AVAILABLE</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>            <span class=n>day_angle</span><span class=o>=</span><span class=n>unset_series</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>            <span class=n>solar_constant</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>            <span class=o>**</span><span class=n>no_earth_orbit</span><span class=p>,</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>            <span class=n>distance_correction_factor</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>    <span class=k>else</span><span class=p>:</span>  <span class=c1># tilted (or inclined) surface</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=c1># Calculate or get quantities required : ---------------------------- &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt;</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=c1># 1. to model the diffuse horizontal irradiance [optional]</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>        <span class=c1># 2. to calculate the diffuse sky ... to consider shaded, sunlit and potentially sunlit surfaces</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=n>extraterrestrial_normal_irradiance_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>            <span class=n>calculate_extraterrestrial_normal_irradiance_hofierka</span><span class=p>(</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>                <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>                <span class=n>solar_constant</span><span class=o>=</span><span class=n>solar_constant</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>                <span class=o>**</span><span class=n>earth_orbit</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>                <span class=o>**</span><span class=n>array_parameters</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>                <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>  <span class=c1># no verbosity here by choice!</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>                <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>        <span class=n>extraterrestrial_horizontal_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_extraterrestrial_horizontal_irradiance_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>            <span class=n>extraterrestrial_normal_irradiance</span><span class=o>=</span><span class=n>extraterrestrial_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>            <span class=n>solar_altitude_series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>        <span class=c1># Calculate quantities required : ---------------------------- &lt;&lt;&lt; &lt;&lt;&lt; &lt;&lt;&lt;</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>        <span class=k>with</span> <span class=n>np</span><span class=o>.</span><span class=n>errstate</span><span class=p>(</span><span class=n>divide</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>,</span> <span class=n>invalid</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>):</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>            <span class=n>kb_series</span> <span class=o>=</span> <span class=p>(</span>  <span class=c1># proportion between direct and extraterrestrial</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>                <span class=n>direct_horizontal_irradiance_series</span>  <span class=c1># Array from external data !</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>                <span class=o>/</span> <span class=n>extraterrestrial_horizontal_irradiance_series</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>        <span class=n>n_series</span> <span class=o>=</span> <span class=n>calculate_term_n_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>            <span class=n>kb_series</span><span class=p>,</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>            <span class=o>**</span><span class=n>array_parameters</span><span class=p>,</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>            <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>        <span class=n>diffuse_sky_irradiance_series</span> <span class=o>=</span> <span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>            <span class=n>np</span><span class=o>.</span><span class=n>isnan</span><span class=p>(</span><span class=n>n_series</span><span class=p>),</span>  <span class=c1># handle NaN cases</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>            <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>            <span class=n>calculate_diffuse_sky_irradiance_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>                <span class=n>n_series</span><span class=o>=</span><span class=n>n_series</span><span class=p>,</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>                <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>            <span class=p>),</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>        <span class=c1># prepare size of output array!</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>        <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>            <span class=o>**</span><span class=n>extended_array_parameters</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"zeros"</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>        <span class=n>diffuse_irradiance</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>            <span class=s1>'diffuse_inclined_irradiance'</span><span class=p>:</span> <span class=n>diffuse_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>            <span class=s1>'diffuse_horizontal_irradiance'</span><span class=p>:</span> <span class=n>diffuse_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>        <span class=p>}</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>        <span class=c1># prepare cases : surfaces in-shade, sunlit, potentially sunlit</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>        <span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.api.position.models</span><span class=w> </span><span class=kn>import</span> <span class=n>select_models</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>        <span class=n>shading_states</span> <span class=o>=</span> <span class=n>select_models</span><span class=p>(</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>            <span class=n>ShadingState</span><span class=p>,</span> <span class=n>shading_states</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>        <span class=p>)</span>  <span class=c1># Using a callback fails!</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>        <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_diffuse_inclined_irradiance_in_shade</span><span class=p>(</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>            <span class=c1># mask_surface_in_shade_series=mask_surface_in_shade_series,</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>            <span class=n>solar_incidence</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>            <span class=n>surface_in_shade</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>            <span class=n>shading_states</span><span class=o>=</span><span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>            <span class=n>shading_state_series</span><span class=o>=</span><span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>            <span class=n>diffuse_sky_irradiance</span><span class=o>=</span><span class=n>diffuse_sky_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>            <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>            <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>            <span class=o>**</span><span class=n>diffuse_irradiance</span><span class=p>,</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>        <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_diffuse_inclined_irradiance_sunlit</span><span class=p>(</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>            <span class=n>solar_incidence</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>            <span class=n>shading_states</span><span class=o>=</span><span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>            <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>            <span class=n>shading_state_series</span><span class=o>=</span><span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>            <span class=n>diffuse_sky_irradiance</span><span class=o>=</span><span class=n>diffuse_sky_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>            <span class=n>kb_series</span><span class=o>=</span><span class=n>kb_series</span><span class=p>,</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>            <span class=o>**</span><span class=n>diffuse_irradiance</span><span class=p>,</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>        <span class=n>azimuth_difference_series</span> <span class=o>=</span> <span class=n>NOT_AVAILABLE</span>  <span class=c1># not always required, set to avoid UnboundLocalError!</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>        <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>=</span> <span class=n>calculate_diffuse_inclined_irradiance_potentially_sunlit</span><span class=p>(</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>            <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>            <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>            <span class=n>solar_azimuth</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>            <span class=n>shading_states</span><span class=o>=</span><span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>            <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>            <span class=n>shading_state_series</span><span class=o>=</span><span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>            <span class=n>diffuse_sky_irradiance</span><span class=o>=</span><span class=n>diffuse_sky_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>            <span class=n>kb_series</span><span class=o>=</span><span class=n>kb_series</span><span class=p>,</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>            <span class=o>**</span><span class=n>diffuse_irradiance</span><span class=p>,</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>    <span class=c1># Replace None with a placeholder -- this is important for printing !</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>    <span class=n>shading_state_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>        <span class=n>shading_state_series</span> <span class=o>==</span> <span class=kc>None</span><span class=p>,</span> <span class=s2>"Unset"</span><span class=p>,</span> <span class=n>shading_state_series</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>    <span class=c1># ------------------------------------------------------------------------</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>    <span class=c1># diffuse_inclined_irradiance_series = np.nan_to_num(</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>    <span class=c1>#     diffuse_inclined_irradiance_series, nan=0</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a>    <span class=n>EPSILON</span> <span class=o>=</span> <span class=mf>0.1</span> <span class=c1>#1e-10  # Define a small threshold for comparison</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>    <span class=n>diffuse_irradiance_reflectivity_coefficient</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a>    <span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span> <span class=o>=</span> <span class=n>nan_series</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>    <span class=n>diffuse_inclined_irradiance_before_reflectivity_series</span> <span class=o>=</span> <span class=n>nan_series</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>    <span class=k>if</span> <span class=n>apply_reflectivity_factor</span><span class=p>:</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a>        <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>surface_tilt</span> <span class=o>-</span> <span class=n>pi</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>EPSILON</span><span class=p>:</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a>            <span class=n>surface_tilt</span> <span class=o>-=</span> <span class=n>EPSILON</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>        <span class=c1># Get the reflectivity coefficient</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>        <span class=n>diffuse_irradiance_reflectivity_coefficient</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>surface_tilt</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>            <span class=n>pi</span> <span class=o>-</span> <span class=n>surface_tilt</span> <span class=o>-</span> <span class=n>sin</span><span class=p>(</span><span class=n>surface_tilt</span><span class=p>)</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>        <span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>cos</span><span class=p>(</span><span class=n>surface_tilt</span><span class=p>))</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>        <span class=n>diffuse_irradiance_reflectivity_factor</span> <span class=o>=</span> <span class=n>calculate_reflectivity_factor_for_nondirect_irradiance</span><span class=p>(</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>            <span class=n>indirect_angular_loss_coefficient</span><span class=o>=</span><span class=n>diffuse_irradiance_reflectivity_coefficient</span><span class=p>,</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a>        <span class=c1># Get the reflectivity factor from ...</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>        <span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a>                <span class=o>**</span><span class=n>extended_array_parameters</span><span class=p>,</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a>            <span class=n>init_method</span><span class=o>=</span><span class=n>diffuse_irradiance_reflectivity_factor</span><span class=p>,</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a>        <span class=c1># Apply the reflectivity factor</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>        <span class=n>diffuse_inclined_irradiance_series</span> <span class=o>*=</span> <span class=p>(</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a>            <span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>        <span class=c1># avoid copying to save memory and time ... ? ----------------- Is this safe ? -</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><a href=#__codelineno-0-328><span class=linenos data-linenos="328 "></span></a>        <span class=k>with</span> <span class=n>errstate</span><span class=p>(</span><span class=n>divide</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>,</span> <span class=n>invalid</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>):</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a>            <span class=c1># this quantity is exclusively generated for the output dictionary !</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a>            <span class=n>diffuse_inclined_irradiance_before_reflectivity_series</span> <span class=o>=</span> <span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a>                <span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a>                <span class=n>diffuse_inclined_irradiance_series</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a>                <span class=o>/</span> <span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a>                <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a>        <span class=c1># ------------------------------------------------------------------------------</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><a href=#__codelineno-0-338><span class=linenos data-linenos="338 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range</span><span class=p>(</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><a href=#__codelineno-0-339><span class=linenos data-linenos="339 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><a href=#__codelineno-0-340><span class=linenos data-linenos="340 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><a href=#__codelineno-0-341><span class=linenos data-linenos="341 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>DiffuseSkyReflectedInclinedIrradianceFromExternalData</span><span class=p>(),</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><a href=#__codelineno-0-342><span class=linenos data-linenos="342 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><a href=#__codelineno-0-343><span class=linenos data-linenos="343 "></span></a>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><a href=#__codelineno-0-344><span class=linenos data-linenos="344 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><a href=#__codelineno-0-345><span class=linenos data-linenos="345 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><a href=#__codelineno-0-346><span class=linenos data-linenos="346 "></span></a>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><a href=#__codelineno-0-347><span class=linenos data-linenos="347 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><a href=#__codelineno-0-348><span class=linenos data-linenos="348 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><a href=#__codelineno-0-349><span class=linenos data-linenos="349 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><a href=#__codelineno-0-350><span class=linenos data-linenos="350 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><a href=#__codelineno-0-351><span class=linenos data-linenos="351 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><a href=#__codelineno-0-352><span class=linenos data-linenos="352 "></span></a>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><a href=#__codelineno-0-353><span class=linenos data-linenos="353 "></span></a>    <span class=k>return</span> <span class=n>DiffuseSkyReflectedInclinedIrradianceFromExternalData</span><span class=p>(</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><a href=#__codelineno-0-354><span class=linenos data-linenos="354 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><a href=#__codelineno-0-355><span class=linenos data-linenos="355 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><a href=#__codelineno-0-356><span class=linenos data-linenos="356 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><a href=#__codelineno-0-357><span class=linenos data-linenos="357 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><a href=#__codelineno-0-358><span class=linenos data-linenos="358 "></span></a>        <span class=n>global_horizontal_irradiance</span><span class=o>=</span><span class=n>global_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><a href=#__codelineno-0-359><span class=linenos data-linenos="359 "></span></a>        <span class=n>direct_horizontal_irradiance</span><span class=o>=</span><span class=n>direct_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><a href=#__codelineno-0-360><span class=linenos data-linenos="360 "></span></a>        <span class=n>diffuse_horizontal_irradiance</span><span class=o>=</span><span class=n>diffuse_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><a href=#__codelineno-0-361><span class=linenos data-linenos="361 "></span></a>        <span class=n>extraterrestrial_horizontal_irradiance</span><span class=o>=</span><span class=n>extraterrestrial_horizontal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><a href=#__codelineno-0-362><span class=linenos data-linenos="362 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><a href=#__codelineno-0-363><span class=linenos data-linenos="363 "></span></a>        <span class=n>extraterrestrial_normal_irradiance</span><span class=o>=</span><span class=n>extraterrestrial_normal_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a><a href=#__codelineno-0-364><span class=linenos data-linenos="364 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><a href=#__codelineno-0-365><span class=linenos data-linenos="365 "></span></a>        <span class=n>reflected</span><span class=o>=</span><span class=n>calculate_reflectivity_effect</span><span class=p>(</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><a href=#__codelineno-0-366><span class=linenos data-linenos="366 "></span></a>            <span class=n>irradiance</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_before_reflectivity_series</span><span class=p>,</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><a href=#__codelineno-0-367><span class=linenos data-linenos="367 "></span></a>            <span class=n>reflectivity_factor</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><a href=#__codelineno-0-368><span class=linenos data-linenos="368 "></span></a>        <span class=p>),</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><a href=#__codelineno-0-369><span class=linenos data-linenos="369 "></span></a>        <span class=n>reflectivity_factor</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_reflectivity_factor_series</span><span class=p>,</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><a href=#__codelineno-0-370><span class=linenos data-linenos="370 "></span></a>        <span class=n>reflectivity_coefficient</span><span class=o>=</span><span class=n>diffuse_irradiance_reflectivity_coefficient</span><span class=p>,</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><a href=#__codelineno-0-371><span class=linenos data-linenos="371 "></span></a>        <span class=n>value_before_reflectivity</span><span class=o>=</span><span class=n>diffuse_inclined_irradiance_before_reflectivity_series</span><span class=p>,</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><a href=#__codelineno-0-372><span class=linenos data-linenos="372 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><a href=#__codelineno-0-373><span class=linenos data-linenos="373 "></span></a>        <span class=n>diffuse_sky_irradiance</span><span class=o>=</span><span class=n>diffuse_sky_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><a href=#__codelineno-0-374><span class=linenos data-linenos="374 "></span></a>        <span class=n>term_n</span><span class=o>=</span><span class=n>n_series</span><span class=p>,</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><a href=#__codelineno-0-375><span class=linenos data-linenos="375 "></span></a>        <span class=n>kb_ratio</span><span class=o>=</span><span class=n>kb_series</span><span class=p>,</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><a href=#__codelineno-0-376><span class=linenos data-linenos="376 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><a href=#__codelineno-0-377><span class=linenos data-linenos="377 "></span></a>        <span class=n>surface_orientation</span><span class=o>=</span><span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><a href=#__codelineno-0-378><span class=linenos data-linenos="378 "></span></a>        <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><a href=#__codelineno-0-379><span class=linenos data-linenos="379 "></span></a>        <span class=n>surface_tilt_threshold</span><span class=o>=</span><span class=n>surface_tilt_horizontally_flat_panel_threshold</span><span class=p>,</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><a href=#__codelineno-0-380><span class=linenos data-linenos="380 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><a href=#__codelineno-0-381><span class=linenos data-linenos="381 "></span></a>        <span class=n>surface_in_shade</span><span class=o>=</span><span class=n>surface_in_shade_series</span><span class=p>,</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><a href=#__codelineno-0-382><span class=linenos data-linenos="382 "></span></a>        <span class=n>solar_incidence</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=p>,</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><a href=#__codelineno-0-383><span class=linenos data-linenos="383 "></span></a>        <span class=n>shading_state</span><span class=o>=</span><span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><a href=#__codelineno-0-384><span class=linenos data-linenos="384 "></span></a>        <span class=n>solar_altitude</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><a href=#__codelineno-0-385><span class=linenos data-linenos="385 "></span></a>        <span class=n>solar_azimuth</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><a href=#__codelineno-0-386><span class=linenos data-linenos="386 "></span></a>        <span class=n>solar_azimuth_origin</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>origin</span><span class=p>,</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><a href=#__codelineno-0-387><span class=linenos data-linenos="387 "></span></a>        <span class=n>azimuth_difference</span><span class=o>=</span><span class=n>azimuth_difference_series</span><span class=p>,</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a><a href=#__codelineno-0-388><span class=linenos data-linenos="388 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a><a href=#__codelineno-0-389><span class=linenos data-linenos="389 "></span></a>        <span class=n>solar_incidence_model</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>algorithm</span><span class=p>,</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a><a href=#__codelineno-0-390><span class=linenos data-linenos="390 "></span></a>        <span class=n>solar_incidence_definition</span><span class=o>=</span><span class=n>solar_incidence_series</span><span class=o>.</span><span class=n>definition</span><span class=p>,</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><a href=#__codelineno-0-391><span class=linenos data-linenos="391 "></span></a>        <span class=n>shading_states</span><span class=o>=</span><span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a><a href=#__codelineno-0-392><span class=linenos data-linenos="392 "></span></a>        <span class=c1>#</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><a href=#__codelineno-0-393><span class=linenos data-linenos="393 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.potentially_sunlit> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">potentially_sunlit</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.potentially_sunlit title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.potentially_sunlit.calculate_diffuse_inclined_irradiance_potentially_sunlit title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_diffuse_inclined_irradiance_potentially_sunlit</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.potentially_sunlit.calculate_diffuse_inclined_irradiance_potentially_sunlit</code>)'>calculate_diffuse_inclined_irradiance_potentially_sunlit</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.potentially_sunlit.calculate_diffuse_inclined_irradiance_potentially_sunlit> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_diffuse_inclined_irradiance_potentially_sunlit</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.potentially_sunlit.calculate_diffuse_inclined_irradiance_potentially_sunlit title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_diffuse_inclined_irradiance_potentially_sunlit</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>solar_azimuth</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>solar_altitude</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>diffuse_inclined_irradiance</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>diffuse_sky_irradiance</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>kb_series</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>diffuse_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/muneer/irradiance/diffuse/potentially_sunlit.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_diffuse_inclined_irradiance_potentially_sunlit</span><span class=p>(</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a>    <span class=n>surface_orientation</span><span class=p>,</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a>    <span class=n>surface_tilt</span><span class=p>,</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a>    <span class=n>solar_azimuth</span><span class=p>,</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>    <span class=n>solar_altitude</span><span class=p>,</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a>    <span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>    <span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>    <span class=n>diffuse_inclined_irradiance</span><span class=p>,</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>    <span class=n>diffuse_sky_irradiance</span><span class=p>,</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>    <span class=n>kb_series</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>    <span class=n>diffuse_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a><span class=p>):</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>    <span class=k>if</span> <span class=n>ShadingState</span><span class=o>.</span><span class=n>potentially_sunlit</span> <span class=ow>in</span> <span class=n>shading_states</span><span class=p>:</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>        <span class=n>mask_potentially_sunlit_surface_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>logical_and</span><span class=p>(</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>                <span class=n>solar_altitude</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span>  <span class=c1>#  sun above horizon</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>            <span class=n>solar_altitude</span><span class=o>.</span><span class=n>radians</span> <span class=o>&lt;</span> <span class=mf>0.1</span><span class=p>,</span>  <span class=c1>#  radians or &lt; 5.7 degrees</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>            <span class=n>shading_state_series</span> <span class=o>==</span> <span class=kc>None</span>  <span class=c1># operate only on unset elements</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>        <span class=c1># else:  # if solar altitude &lt; 0.1 : potentially sunlit surface series</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>        <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mask_potentially_sunlit_surface_series</span><span class=p>):</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>            <span class=n>shading_state_series</span><span class=p>[</span><span class=n>mask_potentially_sunlit_surface_series</span><span class=p>]</span> <span class=o>=</span> <span class=n>ShadingState</span><span class=o>.</span><span class=n>potentially_sunlit</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>                <span class=sa>f</span><span class=s2>"Shading state series including </span><span class=si>{</span><span class=n>ShadingState</span><span class=o>.</span><span class=n>potentially_sunlit</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2> :</span><span class=se>\n</span><span class=si>{</span><span class=n>shading_state_series</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>"[bold]Shading state[/bold] series including [bold orange]</span><span class=si>{</span><span class=n>ShadingState</span><span class=o>.</span><span class=n>potentially_sunlit</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>[/bold orange] :</span><span class=se>\n</span><span class=si>{</span><span class=n>shading_state_series</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>            <span class=c1># requires the solar azimuth</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>            <span class=c1># Normalize the azimuth difference to be within the range -pi to pi</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>            <span class=c1># A0 : solar azimuth _measured from East_ in radians</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>            <span class=c1># ALN : angle between the vertical surface containing the normal to the</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>            <span class=c1>#   surface and vertical surface passing through the centre of the solar</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>            <span class=c1>#   disc [rad]</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>surface_orientation</span><span class=p>,</span> <span class=n>SurfaceOrientation</span><span class=p>):</span> <span class=c1># FIXME This should always be SurfaceOrientation instance and MUST BE FIXED with pydantic!</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>                <span class=n>surface_orientation</span> <span class=o>=</span> <span class=n>surface_orientation</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>            <span class=n>azimuth_difference_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>                    <span class=n>solar_azimuth</span><span class=o>.</span><span class=n>value</span> <span class=o>-</span> <span class=n>surface_orientation</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>            <span class=n>azimuth_difference_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arctan2</span><span class=p>(</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>                <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>azimuth_difference_series</span><span class=p>),</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>                <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>azimuth_difference_series</span><span class=p>),</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>            <span class=n>diffuse_inclined_irradiance</span><span class=p>[</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>                <span class=n>mask_potentially_sunlit_surface_series</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>            <span class=p>]</span> <span class=o>=</span> <span class=n>diffuse_horizontal_irradiance</span><span class=o>.</span><span class=n>value</span><span class=p>[</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>                <span class=n>mask_potentially_sunlit_surface_series</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>            <span class=p>]</span> <span class=o>*</span> <span class=p>(</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>                <span class=n>diffuse_sky_irradiance</span><span class=p>[</span><span class=n>mask_potentially_sunlit_surface_series</span><span class=p>]</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>                <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>kb_series</span><span class=p>[</span><span class=n>mask_potentially_sunlit_surface_series</span><span class=p>])</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>                <span class=o>+</span> <span class=n>kb_series</span><span class=p>[</span><span class=n>mask_potentially_sunlit_surface_series</span><span class=p>]</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>                <span class=o>*</span> <span class=n>sin</span><span class=p>(</span><span class=n>surface_tilt</span><span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos="81 "></span></a>                <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos="82 "></span></a>                    <span class=n>azimuth_difference_series</span><span class=p>[</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos="83 "></span></a>                        <span class=n>mask_potentially_sunlit_surface_series</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos="84 "></span></a>                    <span class=p>]</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos="85 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos="86 "></span></a>                <span class=o>/</span> <span class=p>(</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos="87 "></span></a>                    <span class=mf>0.1</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos="88 "></span></a>                    <span class=o>-</span> <span class=mf>0.008</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos="89 "></span></a>                    <span class=o>*</span> <span class=n>solar_altitude</span><span class=o>.</span><span class=n>radians</span><span class=p>[</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos="90 "></span></a>                        <span class=n>mask_potentially_sunlit_surface_series</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos="91 "></span></a>                    <span class=p>]</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos="92 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos="93 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos="94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos="95 "></span></a>    <span class=k>return</span> <span class=n>diffuse_inclined_irradiance</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.sky_irradiance> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">sky_irradiance</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.sky_irradiance title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.sky_irradiance.calculate_diffuse_sky_irradiance_series_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_diffuse_sky_irradiance_series_hofierka</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.sky_irradiance.calculate_diffuse_sky_irradiance_series_hofierka</code>)'>calculate_diffuse_sky_irradiance_series_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Calculate the diffuse sky irradiance</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.sky_irradiance.calculate_diffuse_sky_irradiance_series_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_diffuse_sky_irradiance_series_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.sky_irradiance.calculate_diffuse_sky_irradiance_series_hofierka title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_diffuse_sky_irradiance_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>n_series</span><span class=p>:</span> <span class=n><span title=numpy.ndarray>ndarray</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the diffuse sky irradiance</p> <p>The diffuse sky irradiance function F(N) depends on the surface tilt <code>N</code> (in radians)</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>surface_tilt</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The tilt (also referred to as : inclination or slope) angle of a solar surface</p> </div> </td> <td> <code><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>n_series</code> </td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>The term N</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=Notes>Notes</span></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td> <code>-----</code> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td> <code>Internally the function calculates first the dimensionless fraction of the</code> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td> <code>sky dome viewed by a tilted (or inclined) surface `ri(N)`.</code> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td> <code>The sky-view fraction as defined in Hofierka, 2002 [1]_ is :</code> </td> <td> <div class=doc-md-description> <p>(1 + cos(surface_tilt)) / 2</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code>which in turn is trigonometrically identical to the definition in Muneer,</code> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td> <code>1990 [2]_</code> </td> <td> <div class=doc-md-description> <p>power(cos(surface_tilt / 2), 2)</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/muneer/irradiance/diffuse/sky_irradiance.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_diffuse_sky_irradiance_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>    <span class=n>n_series</span><span class=p>:</span> <span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a><span class=p>):</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=sd>"""Calculate the diffuse sky irradiance</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a><span class=sd>    The diffuse sky irradiance function F(N) depends on the surface tilt `N`</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a><span class=sd>    (in radians)</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a><span class=sd>    surface_tilt: float (radians)</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a><span class=sd>        The tilt (also referred to as : inclination or slope) angle of a solar</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a><span class=sd>        surface</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a><span class=sd>    n_series: float</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a><span class=sd>        The term N</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a><span class=sd>    Internally the function calculates first the dimensionless fraction of the</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a><span class=sd>    sky dome viewed by a tilted (or inclined) surface `ri(N)`.</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a><span class=sd>    The sky-view fraction as defined in Hofierka, 2002 [1]_ is :</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a><span class=sd>        (1 + cos(surface_tilt)) / 2</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a><span class=sd>    which in turn is trigonometrically identical to the definition in Muneer,</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a><span class=sd>    1990 [2]_</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a><span class=sd>        power(cos(surface_tilt / 2), 2)</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>    <span class=n>diffuse_sky_irradiance_series</span> <span class=o>=</span> <span class=p>((</span><span class=mi>1</span> <span class=o>+</span> <span class=n>cos</span><span class=p>(</span><span class=n>surface_tilt</span><span class=p>))</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>        <span class=n>sin</span><span class=p>(</span><span class=n>surface_tilt</span><span class=p>)</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>        <span class=o>-</span> <span class=n>surface_tilt</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span><span class=n>surface_tilt</span><span class=p>)</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>        <span class=o>-</span> <span class=n>pi</span> <span class=o>*</span> <span class=n>power</span><span class=p>((</span><span class=n>sin</span><span class=p>(</span><span class=n>surface_tilt</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)),</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos="81 "></span></a>    <span class=p>)</span> <span class=o>*</span> <span class=n>n_series</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos="82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos="83 "></span></a>    <span class=c1># out_of_range, out_of_range_index = identify_values_out_of_range(</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos="84 "></span></a>    <span class=c1>#     series=diffuse_sky_irradiance_series,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos="85 "></span></a>    <span class=c1>#     shape=n_series.shape,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos="86 "></span></a>    <span class=c1>#     # data_model=DiffuseSkyReflectedHorizontalIrradianceFromExternalData(),</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos="87 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos="88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos="89 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos="90 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos="91 "></span></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos="92 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos="93 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>diffuse_sky_irradiance_series</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos="94 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos="95 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos="96 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos="97 "></span></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos="98 "></span></a>    <span class=k>return</span> <span class=n>array</span><span class=p>(</span><span class=n>diffuse_sky_irradiance_series</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.sunlit> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">sunlit</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.sunlit title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.sunlit.calculate_diffuse_inclined_irradiance_sunlit title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_diffuse_inclined_irradiance_sunlit</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.sunlit.calculate_diffuse_inclined_irradiance_sunlit</code>)'>calculate_diffuse_inclined_irradiance_sunlit</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.sunlit.calculate_diffuse_inclined_irradiance_sunlit> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_diffuse_inclined_irradiance_sunlit</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.sunlit.calculate_diffuse_inclined_irradiance_sunlit title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_diffuse_inclined_irradiance_sunlit</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>solar_incidence</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>solar_altitude</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>diffuse_sky_irradiance</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>kb_series</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>diffuse_inclined_irradiance</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>diffuse_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/muneer/irradiance/diffuse/sunlit.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_diffuse_inclined_irradiance_sunlit</span><span class=p>(</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>    <span class=n>solar_incidence</span><span class=p>,</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>    <span class=n>shading_states</span><span class=p>,</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a>    <span class=n>solar_altitude</span><span class=p>,</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a>    <span class=n>shading_state_series</span><span class=p>,</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a>    <span class=n>diffuse_sky_irradiance</span><span class=p>,</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a>    <span class=n>kb_series</span><span class=p>,</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a>    <span class=n>diffuse_inclined_irradiance</span><span class=p>,</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>    <span class=n>diffuse_horizontal_irradiance</span><span class=p>,</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a><span class=p>):</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>    <span class=k>if</span> <span class=n>ShadingState</span><span class=o>.</span><span class=n>sunlit</span> <span class=ow>in</span> <span class=n>shading_states</span><span class=p>:</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>        <span class=n>mask_sunlit_surface_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>logical_and</span><span class=p>(</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>            <span class=n>solar_altitude</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;=</span> <span class=mf>0.1</span><span class=p>,</span>  <span class=c1># or &gt;= 5.7 degrees</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>            <span class=n>shading_state_series</span> <span class=o>==</span> <span class=kc>None</span>  <span class=c1># operate only on unset elements</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a>        <span class=c1># else:  # sunlit surface and non-overcast sky</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>        <span class=c1>#     # ----------------------------------------------------------------</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>        <span class=c1>#     solar_azimuth_series = None ?</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>        <span class=c1>#     # ----------------------------------------------------------------</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>        <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mask_sunlit_surface_series</span><span class=p>):</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>            <span class=n>shading_state_series</span><span class=p>[</span><span class=n>mask_sunlit_surface_series</span><span class=p>]</span> <span class=o>=</span> <span class=n>ShadingState</span><span class=o>.</span><span class=n>sunlit</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>                <span class=sa>f</span><span class=s2>"Shading state series including </span><span class=si>{</span><span class=n>ShadingState</span><span class=o>.</span><span class=n>sunlit</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2> :</span><span class=se>\n</span><span class=si>{</span><span class=n>shading_state_series</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>                <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>"[bold]Shading state[/bold] series including [bold yellow]</span><span class=si>{</span><span class=n>ShadingState</span><span class=o>.</span><span class=n>sunlit</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>[/bold yellow] :</span><span class=se>\n</span><span class=si>{</span><span class=n>shading_state_series</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>            <span class=n>diffuse_inclined_irradiance</span><span class=p>[</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>                <span class=n>mask_sunlit_surface_series</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>            <span class=p>]</span> <span class=o>=</span> <span class=n>diffuse_horizontal_irradiance</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=n>mask_sunlit_surface_series</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>                <span class=n>diffuse_sky_irradiance</span><span class=p>[</span><span class=n>mask_sunlit_surface_series</span><span class=p>]</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>                <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>kb_series</span><span class=p>[</span><span class=n>mask_sunlit_surface_series</span><span class=p>])</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>                <span class=o>+</span> <span class=n>kb_series</span><span class=p>[</span><span class=n>mask_sunlit_surface_series</span><span class=p>]</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>                <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>                    <span class=n>solar_incidence</span><span class=o>.</span><span class=n>radians</span><span class=p>[</span><span class=n>mask_sunlit_surface_series</span><span class=p>]</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>                <span class=p>)</span>  <span class=c1># Should be the _complementary_ incidence angle!</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>                <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_altitude</span><span class=o>.</span><span class=n>radians</span><span class=p>[</span><span class=n>mask_sunlit_surface_series</span><span class=p>])</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>    <span class=k>return</span> <span class=n>diffuse_inclined_irradiance</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h5 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.term_n> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">term_n</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.term_n title="Permanent link"></a></h5> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.term_n.calculate_term_n_series_hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_term_n_series_hofierka</span> (<code>pvgisprototype.algorithms.muneer.irradiance.diffuse.term_n.calculate_term_n_series_hofierka</code>)'>calculate_term_n_series_hofierka</a></code></td> <td> <div class=doc-md-description> <p>Define the N term for a period of time</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 class="doc doc-heading" id=pvgisprototype.algorithms.muneer.irradiance.diffuse.term_n.calculate_term_n_series_hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_term_n_series_hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.muneer.irradiance.diffuse.term_n.calculate_term_n_series_hofierka title="Permanent link"></a></h6> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_term_n_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>kb_series</span><span class=p>:</span> <span class=n><span title=numpy.ndarray>ndarray</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pydantic_numpy.NpNDArray>NpNDArray</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Define the N term for a period of time</p> <p>N = 0.00263  0.712  kb  0.6883  kb2</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>kb_series</code> </td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>Direct horizontal to extraterrestrial horizontal irradiance ratio</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>N</code></td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The N term</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>Muneer's model treats the shaded and sunlit surfaces separately and further distinguishes between overcast and non-overcast conditions of the sunlit surface. The diffuse sky-reflected irradiance for both surfaces in-shade and sunlit under <em>overcast</em> sky is computed as :</p> <p>and a sunlit surface under non-overcast sky as :</p> <p>According to Muneer (1990) the radiance distribution index <code>b</code> (dimensionless)</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/muneer/irradiance/diffuse/term_n.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_term_n_series_hofierka</span><span class=p>(</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>    <span class=n>kb_series</span><span class=p>:</span> <span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NpNDArray</span><span class=p>:</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=sd>"""Define the N term for a period of time</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a><span class=sd>    N = 0.00263  0.712  kb  0.6883  kb2</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a><span class=sd>    kb_series: float</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a><span class=sd>        Direct horizontal to extraterrestrial horizontal irradiance ratio</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a><span class=sd>    N: float</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a><span class=sd>        The N term</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a><span class=sd>    Muneer's model treats the shaded and sunlit surfaces separately and further</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a><span class=sd>    distinguishes between overcast and non-overcast conditions of the sunlit</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a><span class=sd>    surface.  The diffuse sky-reflected irradiance for both surfaces in-shade and</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a><span class=sd>    sunlit under _overcast_ sky is computed as :</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a><span class=sd>    and a sunlit surface under non-overcast sky as :</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a><span class=sd>    According to Muneer (1990) the radiance distribution index `b` (dimensionless) </span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>    <span class=n>kb_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>kb_series</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>    <span class=n>term_n_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>        <span class=mf>0.00263</span> <span class=o>-</span> <span class=p>(</span><span class=mf>0.712</span> <span class=o>*</span> <span class=n>kb_series</span><span class=p>)</span> <span class=o>-</span> <span class=p>(</span><span class=mf>0.6883</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=n>kb_series</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>))</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>term_n_series</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos="81 "></span></a>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos="82 "></span></a>    <span class=k>return</span> <span class=n>term_n_series</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.equation_of_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">equation_of_time</span> (<code>pvgisprototype.algorithms.noaa.equation_of_time</code>)'>equation_of_time</a></code></td> <td> <div class=doc-md-description> <p>The Equation of Time based on the General Solar Position Calculations provided</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.event_hour_angle title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">event_hour_angle</span> (<code>pvgisprototype.algorithms.noaa.event_hour_angle</code>)'>event_hour_angle</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.event_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">event_time</span> (<code>pvgisprototype.algorithms.noaa.event_time</code>)'>event_time</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.events title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">events</span> (<code>pvgisprototype.algorithms.noaa.events</code>)'>events</a></code></td> <td> <div class=doc-md-description> <p>This module contains days within the year that have some solar significance.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.fractional_year title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">fractional_year</span> (<code>pvgisprototype.algorithms.noaa.fractional_year</code>)'>fractional_year</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.local_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">local_time</span> (<code>pvgisprototype.algorithms.noaa.local_time</code>)'>local_time</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.parameter_models title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">parameter_models</span> (<code>pvgisprototype.algorithms.noaa.parameter_models</code>)'>parameter_models</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_altitude title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_altitude</span> (<code>pvgisprototype.algorithms.noaa.solar_altitude</code>)'>solar_altitude</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_azimuth title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_azimuth</span> (<code>pvgisprototype.algorithms.noaa.solar_azimuth</code>)'>solar_azimuth</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_declination title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_declination</span> (<code>pvgisprototype.algorithms.noaa.solar_declination</code>)'>solar_declination</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_hour_angle title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_hour_angle</span> (<code>pvgisprototype.algorithms.noaa.solar_hour_angle</code>)'>solar_hour_angle</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_time</span> (<code>pvgisprototype.algorithms.noaa.solar_time</code>)'>solar_time</a></code></td> <td> <div class=doc-md-description> <p>The true solar time based on NOAA's General Solar Position Calculations.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_zenith title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_zenith</span> (<code>pvgisprototype.algorithms.noaa.solar_zenith</code>)'>solar_zenith</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.time_offset title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">time_offset</span> (<code>pvgisprototype.algorithms.noaa.time_offset</code>)'>time_offset</a></code></td> <td> <div class=doc-md-description> <p>The time offset based on NOAA's General Solar Position Calculations.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.equation_of_time> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">equation_of_time</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.equation_of_time title="Permanent link"></a></h3> <div class="doc doc-contents"> <p>The Equation of Time based on the General Solar Position Calculations provided by the NOAA Global Monitoring Division.</p> <p>See also: <a href=https://unpkg.com/solar-calculator@0.1.0/index.js>https://unpkg.com/solar-calculator@0.1.0/index.js</a></p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.equation_of_time.calculate_equation_of_time_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_equation_of_time_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.equation_of_time.calculate_equation_of_time_series_noaa</code>)'>calculate_equation_of_time_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the Equation of Time for a time series in minutes.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.equation_of_time.calculate_equation_of_time_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_equation_of_time_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.equation_of_time.calculate_equation_of_time_series_noaa title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_equation_of_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.EquationOfTime>EquationOfTime</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the Equation of Time for a time series in minutes.</p> <p>The Equation of Time is the difference between the apparent solar time and the mean solar time.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>equation_of_time_series</code></td> <td> <code><span title=numeric>numeric</span></code> </td> <td> <div class=doc-md-description> <p>Difference in time between solar time and mean solar time in minutes.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/equation_of_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateEquationOfTimeTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_equation_of_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>EquationOfTime</span><span class=p>:</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=w>    </span><span class=sd>"""Calculate the Equation of Time for a time series in minutes.</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    The Equation of Time is the difference between the apparent solar time and</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    the mean solar time.</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    equation_of_time_series : numeric</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        Difference in time between solar time and mean solar time in minutes.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>    <span class=n>fractional_year_series</span> <span class=o>=</span> <span class=n>calculate_fractional_year_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=n>equation_of_time_series</span> <span class=o>=</span> <span class=mf>229.18</span> <span class=o>*</span> <span class=p>(</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=mf>0.000075</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=o>+</span> <span class=mf>0.001868</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>        <span class=o>-</span> <span class=mf>0.032077</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=o>-</span> <span class=mf>0.014615</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=o>-</span> <span class=mf>0.040849</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>            <span class=p>(</span><span class=n>EquationOfTime</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span> <span class=o>&lt;=</span> <span class=n>equation_of_time_series</span><span class=p>)</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>equation_of_time_series</span> <span class=o>&lt;=</span> <span class=n>EquationOfTime</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=p>):</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>                <span class=s2>"The equation of time must be within the range [{EquationOfTime().min_minutes}, {EquationOfTime().max_minutes()}] minutes for all timestamps."</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>equation_of_time_series</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=k>return</span> <span class=n>EquationOfTime</span><span class=p>(</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>equation_of_time_series</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>MINUTES</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>position_algorithm</span><span class=o>=</span><span class=n>fractional_year_series</span><span class=o>.</span><span class=n>position_algorithm</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=n>timing_algorithm</span><span class=o>=</span><span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.event_hour_angle> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">event_hour_angle</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.event_hour_angle title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.event_hour_angle.calculate_event_hour_angle_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_event_hour_angle_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.event_hour_angle.calculate_event_hour_angle_series_noaa</code>)'>calculate_event_hour_angle_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculates the event hour angle using the NOAA method.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.event_hour_angle.calculate_event_hour_angle_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_event_hour_angle_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.event_hour_angle.calculate_event_hour_angle_series_noaa title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_event_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>unrefracted_solar_zenith</span><span class=p>:</span> <span class=n><span title=pvgisprototype.UnrefractedSolarZenith>UnrefractedSolarZenith</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.EventHourAngle>EventHourAngle</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculates the event hour angle using the NOAA method.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><span title=pvgisprototype.Latitude>Latitude</span></code> </td> <td> <div class=doc-md-description> <p>The geographic latitude for which to calculate the event hour angle.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamp</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/datetime.html#module-datetime>datetime</a></code> </td> <td> <div class=doc-md-description> <p>The date and time for which to calculate the event hour angle.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unrefracted_solar_zenith</code> </td> <td> <code><span title=pvgisprototype.UnrefractedSolarZenith>UnrefractedSolarZenith</span></code> </td> <td> <div class=doc-md-description> <p>The zenith of the sun, adjusted for atmospheric refraction. Defaults to 1.5853349194640094 radians, which corresponds to 90.833 degrees. This is the zenith at sunrise or sunset, adjusted for the approximate correction for atmospheric refraction at those times, and the size of the solar disk.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>angle_units</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The unit in which the angles are input. Defaults to 'radians'.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.EventHourAngle>EventHourAngle</span></code> </td> <td> <div class=doc-md-description> <p>PVGIS native data structure carrying the calculated event hour angle along with relevant metadata.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The function implements NOAA calculations for the solar declination and the event hour angle. The solar declination is calculated first in radians, followed by the event hour angle in radians.</p> <p>Commented out: If the output units are 'degrees', the function will convert the calculated event hour angle from radians to degrees.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/event_hour_angle.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateEventHourAngleTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_event_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>unrefracted_solar_zenith</span><span class=p>:</span> <span class=n>UnrefractedSolarZenith</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>EventHourAngle</span><span class=p>:</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>    Calculates the event hour angle using the NOAA method.</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    latitude : Latitude</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>        The geographic latitude for which to calculate the event hour angle.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    timestamp : datetime</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>        The date and time for which to calculate the event hour angle.</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    unrefracted_solar_zenith : UnrefractedSolarZenith, optional</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>        The zenith of the sun, adjusted for atmospheric refraction. Defaults to</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>        1.5853349194640094 radians, which corresponds to 90.833 degrees. This</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>        is the zenith at sunrise or sunset, adjusted for the approximate</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        correction for atmospheric refraction at those times, and the size of</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>        the solar disk.</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    angle_units : str, optional</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>        The unit in which the angles are input. Defaults to 'radians'.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    EventHourAngle</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>        PVGIS native data structure carrying the calculated event hour angle</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>        along with relevant metadata.</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>    The function implements NOAA calculations for the solar declination and</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    the event hour angle. The solar declination is calculated first in radians,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    followed by the event hour angle in radians.</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    Commented out: If the output units are 'degrees', the function</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    will convert the calculated event hour angle from radians to degrees.</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>calculate_solar_declination_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=p>)</span>  <span class=c1># radians</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=n>cosine_event_hour_angle_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>unrefracted_solar_zenith</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=p>)</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>tan</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>tan</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=n>event_hour_angle_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arccos</span><span class=p>(</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>cosine_event_hour_angle_series</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=p>)</span>  <span class=c1># radians</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>event_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>    <span class=k>return</span> <span class=n>EventHourAngle</span><span class=p>(</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>event_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=n>timing_algorithm</span><span class=o>=</span><span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.event_time> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">event_time</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.event_time title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_in_minutes title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_event_time_in_minutes</span> (<code>pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_in_minutes</code>)'>calculate_solar_event_time_in_minutes</a></code></td> <td> <div class=doc-md-description> <p>Calculate the event time in minutes based on the event type.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_event_time_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_series_noaa</code>)'>calculate_solar_event_time_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the time of solar events like sunrise, noon, or sunset.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.event_time.match_event_times_to_timestamps title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">match_event_times_to_timestamps</span> (<code>pvgisprototype.algorithms.noaa.event_time.match_event_times_to_timestamps</code>)'>match_event_times_to_timestamps</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_in_minutes> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_event_time_in_minutes</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_in_minutes title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_event_time_in_minutes</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>event_hour_angle</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>equation_of_time</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone_offset_hours_utc</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>event_type</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the event time in minutes based on the event type.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><span title=pvgisprototype.Longitude>Longitude</span></code> </td> <td> <div class=doc-md-description> <p>The longitude in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>event_hour_angle</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The event hour angle in minutes.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>equation_of_time</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The equation of time in minutes.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone_offset_hours_utc</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The timezone offset in hours.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>event_type</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The type of solar event ('sunrise', 'noon', 'sunset').</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The calculated event time in minutes.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/event_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_event_time_in_minutes</span><span class=p>(</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>event_hour_angle</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>equation_of_time</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>timezone_offset_hours_utc</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>event_type</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    Calculate the event time in minutes based on the event type.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    longitude : Longitude</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>        The longitude in radians.</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    event_hour_angle : float</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>        The event hour angle in minutes.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    equation_of_time : float</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>        The equation of time in minutes.</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    timezone_offset_hours_utc : float</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>        The timezone offset in hours.</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    event_type : str</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>        The type of solar event ('sunrise', 'noon', 'sunset').</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    float</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        The calculated event time in minutes.</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=c1># Calculate the base time</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=n>base</span> <span class=o>=</span> <span class=mi>720</span> <span class=o>-</span> <span class=n>equation_of_time</span><span class=o>.</span><span class=n>minutes</span> <span class=o>+</span> <span class=n>timezone_offset_hours_utc</span> <span class=o>*</span> <span class=mi>60</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>    <span class=n>longitude_minutes</span> <span class=o>=</span> <span class=n>longitude</span><span class=o>.</span><span class=n>as_minutes</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=n>event_hour_angle_minutes</span> <span class=o>=</span> <span class=n>event_hour_angle</span><span class=o>.</span><span class=n>as_minutes</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>    <span class=c1># Define event calculations</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>    <span class=n>event_calculations</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>astronomical_twilight</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>+</span> <span class=n>event_hour_angle_minutes</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=mi>18</span><span class=p>),</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>nautical_twilight</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>+</span> <span class=n>event_hour_angle_minutes</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=mi>12</span><span class=p>),</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>civil_twilight</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>+</span> <span class=n>event_hour_angle_minutes</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=mi>6</span><span class=p>),</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>sunrise</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>+</span> <span class=n>event_hour_angle_minutes</span><span class=p>),</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>noon</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>base</span> <span class=o>-</span> <span class=n>longitude_minutes</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>sunset</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>-</span> <span class=n>event_hour_angle_minutes</span><span class=p>),</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>daylength</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>            <span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>-</span> <span class=n>event_hour_angle_minutes</span><span class=p>)</span> <span class=o>-</span> 
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>            <span class=p>(</span><span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>+</span> <span class=n>event_hour_angle_minutes</span><span class=p>))</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=p>),</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=c1># Calculate and return the event time</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=k>if</span> <span class=n>event_type</span> <span class=ow>in</span> <span class=n>event_calculations</span><span class=p>:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=k>return</span> <span class=n>event_calculations</span><span class=p>[</span><span class=n>event_type</span><span class=p>]()</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=c1># raise ValueError(f"Unknown event type: {event_type}")</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>                <span class=sa>f</span><span class=s2>"Calculation for the </span><span class=si>{</span><span class=n>event_type</span><span class=si>}</span><span class=s2> yet not implemented!"</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>                <span class=n>alt</span><span class=o>=</span> <span class=sa>f</span><span class=s2>"Calculation for the [code]</span><span class=si>{</span><span class=n>event_type</span><span class=si>}</span><span class=s2>[/code] yet [bold]not implemented[/bold]!"</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=k>return</span> <span class=n>NaT</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_event_time_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_series_noaa title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_event_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>event</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.List title="<code>typing.List</code>">List</a></span><span class=p>[</span><span class=n><span title=pvgisprototype.api.position.models.SolarEvent>SolarEvent</span></span> <span class=o>|</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>],</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>unrefracted_solar_zenith</span><span class=p>:</span> <span class=n><span title=pvgisprototype.UnrefractedSolarZenith>UnrefractedSolarZenith</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT>UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.EventTime>EventTime</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the time of solar events like sunrise, noon, or sunset.</p> <p>For sunrise and sunset, the zenith is set to 90.833 degrees (the approximate correction for atmospheric refraction and the size of the solar disk).</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><span title=pvgisprototype.Latitude>Latitude</span></code> </td> <td> <div class=doc-md-description> <p>The latitude in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><span title=pvgisprototype.Longitude>Longitude</span></code> </td> <td> <div class=doc-md-description> <p>The longitude in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>The date to calculate the event for.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> <p>The timezone information.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unrefracted_solar_zenith</code> </td> <td> <code><span title=pvgisprototype.UnrefractedSolarZenith>UnrefractedSolarZenith</span></code> </td> <td> <div class=doc-md-description> <p>The zenith of the sun, adjusted for atmospheric refraction. Defaults to 1.5853349194640094 radians, which corresponds to 90.833 degrees. This is the zenith at sunrise or sunset, adjusted for the approximate correction for atmospheric refraction at those times, and the size of the solar disk.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT>UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>event</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.List title="<code>typing.List</code>">List</a>[<span title=Optional>Optional</span>[<span title=pvgisprototype.api.position.models.SolarEvent>SolarEvent</span>]]</code> </td> <td> <div class=doc-md-description> <p>A list of solar events to calculate the hour angle for, i.e. 'noon', 'sunrise', or 'sunset'.</p> </div> </td> <td> <code>[None]</code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Data type for calculations. Default is DATA_TYPE_DEFAULT.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Backend for array operations. Default is ARRAY_BACKEND_DEFAULT.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level for logging. Default is VERBOSE_LEVEL_DEFAULT.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level for logging. Default is LOG_LEVEL_DEFAULT.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.EventTime>EventTime</span></code> </td> <td> <div class=doc-md-description> <p>The calculated times of the requested solar events as a DatetimeIndex.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <ul> <li>All angles are in radians.</li> <li>The calculation <code>(1440 / (2 * pi)) * value_in_radians</code> maps a 'value in radians' from a range of [0, 2 * pi] which is a full circle to a range of [0, 1440] which is a full day in minutes.</li> </ul> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/event_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateEventTimeTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_event_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>    <span class=n>event</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>SolarEvent</span> <span class=o>|</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>],</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>    <span class=n>unrefracted_solar_zenith</span><span class=p>:</span> <span class=n>UnrefractedSolarZenith</span> <span class=o>=</span> <span class=n>UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>    <span class=c1># adjust_for_atmospheric_refraction: bool = False,</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>EventTime</span><span class=p>:</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a><span class=w>    </span><span class=sd>"""Calculate the time of solar events like sunrise, noon, or sunset.</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=sd>    For sunrise and sunset, the zenith is set to 90.833 degrees (the</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a><span class=sd>    approximate correction for atmospheric refraction and the size of the solar</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a><span class=sd>    disk).</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>    latitude : Latitude</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=sd>        The latitude in radians.</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a><span class=sd>    longitude : Longitude</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a><span class=sd>        The longitude in radians.</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=sd>        The date to calculate the event for.</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=sd>    timezone : ZoneInfo</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a><span class=sd>        The timezone information.</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>    unrefracted_solar_zenith : UnrefractedSolarZenith, optional</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=sd>        The zenith of the sun, adjusted for atmospheric refraction. Defaults to</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>        1.5853349194640094 radians, which corresponds to 90.833 degrees. This</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>        is the zenith at sunrise or sunset, adjusted for the approximate</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a><span class=sd>        correction for atmospheric refraction at those times, and the size of</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a><span class=sd>        the solar disk.</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=sd>    event : List[Optional[SolarEvent]], optional</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a><span class=sd>        A list of solar events to calculate the hour angle for, i.e. 'noon', 'sunrise', or 'sunset'.</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a><span class=sd>        Data type for calculations. Default is DATA_TYPE_DEFAULT.</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a><span class=sd>        Backend for array operations. Default is ARRAY_BACKEND_DEFAULT.</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a><span class=sd>        Verbosity level for logging. Default is VERBOSE_LEVEL_DEFAULT.</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a><span class=sd>        Log level for logging. Default is LOG_LEVEL_DEFAULT.</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a><span class=sd>    EventTime</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a><span class=sd>        The calculated times of the requested solar events as a DatetimeIndex.</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a><span class=sd>    - All angles are in radians.</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=sd>    - The calculation `(1440 / (2 * pi)) * value_in_radians` maps a 'value in</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a><span class=sd>      radians' from a range of [0, 2 * pi] which is a full circle to a range of</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a><span class=sd>      [0, 1440] which is a full day in minutes.</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>    <span class=k>if</span> <span class=n>event</span> <span class=o>==</span> <span class=p>[</span><span class=n>SolarEvent</span><span class=o>.</span><span class=n>none</span><span class=p>]:</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>        <span class=k>return</span> <span class=n>EventTime</span><span class=p>(</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>            <span class=n>value</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>            <span class=n>event</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>    <span class=c1># Create an array of NaTs based on unique days from timestamps</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>    <span class=n>unique_days</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>normalize</span><span class=p>()</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>    <span class=n>event_hour_angle_series</span> <span class=o>=</span> <span class=n>calculate_event_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>unique_days</span><span class=p>,</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>        <span class=n>unrefracted_solar_zenith</span><span class=o>=</span><span class=n>unrefracted_solar_zenith</span><span class=p>,</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>    <span class=n>equation_of_time_series</span> <span class=o>=</span> <span class=n>calculate_equation_of_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>unique_days</span><span class=p>,</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>    <span class=n>timezone_offset_timedelta</span> <span class=o>=</span> <span class=n>timezone</span><span class=o>.</span><span class=n>utcoffset</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>    <span class=n>timezone_offset_hours_utc</span> <span class=o>=</span> <span class=n>timezone_offset_timedelta</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>/</span> <span class=mi>3600</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>    <span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.api.position.models</span><span class=w> </span><span class=kn>import</span> <span class=n>select_models</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>    <span class=n>requested_solar_events</span> <span class=o>=</span> <span class=n>select_models</span><span class=p>(</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>        <span class=n>SolarEvent</span><span class=p>,</span> <span class=n>event</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>    <span class=p>)</span>  <span class=c1># Using a callback fails!</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>    <span class=c1># Vectorized calculation of event times</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>    <span class=n>solar_events_time_series_in_minutes</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>        <span class=n>solar_event</span><span class=p>:</span> <span class=n>calculate_solar_event_time_in_minutes</span><span class=p>(</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>            <span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>            <span class=n>event_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>            <span class=n>equation_of_time_series</span><span class=p>,</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>            <span class=n>timezone_offset_hours_utc</span><span class=p>,</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>            <span class=n>solar_event</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>        <span class=k>for</span> <span class=n>solar_event</span> <span class=ow>in</span> <span class=n>requested_solar_events</span> <span class=k>if</span> <span class=n>solar_event</span> <span class=ow>in</span> <span class=n>SolarEvent</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>    <span class=n>solar_event_series</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>    <span class=k>for</span> <span class=n>solar_event</span> <span class=ow>in</span> <span class=n>requested_solar_events</span><span class=p>:</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>        <span class=c1># Check if the event has calculated times</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>        <span class=k>if</span> <span class=n>solar_event</span> <span class=ow>in</span> <span class=n>solar_events_time_series_in_minutes</span><span class=p>:</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>            <span class=c1># Get the event times in minutes</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>            <span class=n>solar_event_series</span><span class=p>[</span><span class=n>solar_event</span><span class=p>]</span> <span class=o>=</span> <span class=n>DatetimeIndex</span><span class=p>(</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>                <span class=p>[</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>                    <span class=n>Timestamp</span><span class=p>(</span><span class=n>ts</span><span class=o>.</span><span class=n>date</span><span class=p>())</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>minutes</span><span class=o>=</span><span class=nb>float</span><span class=p>(</span><span class=n>et</span><span class=p>))</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>                    <span class=k>for</span> <span class=n>ts</span><span class=p>,</span> <span class=n>et</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>                        <span class=n>unique_days</span><span class=p>,</span> <span class=n>solar_events_time_series_in_minutes</span><span class=p>[</span><span class=n>solar_event</span><span class=p>]</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>                    <span class=p>)</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>                <span class=p>]</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Event </span><span class=si>{</span><span class=n>event</span><span class=si>}</span><span class=s2> not found in event_time_series_in_minutes."</span><span class=p>)</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>    <span class=n>event_types</span><span class=p>,</span> <span class=n>event_timestamps</span> <span class=o>=</span> <span class=n>match_event_times_to_timestamps</span><span class=p>(</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>            <span class=n>solar_event_series</span><span class=o>=</span><span class=n>solar_event_series</span><span class=p>,</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>            <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>            <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_event_series</span><span class=p>,</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>    <span class=k>return</span> <span class=n>EventTime</span><span class=p>(</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>event_timestamps</span><span class=p>,</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>        <span class=n>event_type</span><span class=o>=</span><span class=n>event_types</span><span class=p>,</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>        <span class=n>hour_angle</span><span class=o>=</span><span class=n>event_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>        <span class=n>equation_of_time</span><span class=o>=</span><span class=n>equation_of_time_series</span><span class=p>,</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.event_time.match_event_times_to_timestamps> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">match_event_times_to_timestamps</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.event_time.match_event_times_to_timestamps title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>match_event_times_to_timestamps</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>solar_event_series</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#dict>dict</a></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/event_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>match_event_times_to_timestamps</span><span class=p>(</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>solar_event_series</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=p>):</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=n>frequency_string</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>freqstr</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=c1># Define matching threshold dynamically based on inferred frequency</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=k>if</span> <span class=s1>'W-'</span> <span class=ow>in</span> <span class=nb>str</span><span class=p>(</span><span class=n>frequency_string</span><span class=p>):</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>            <span class=n>frequency_string</span> <span class=o>=</span> <span class=s1>'1'</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>frequency_string</span><span class=p>)</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>'-'</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># 'W'</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>            <span class=n>frequency_string</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>freq</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=n>frequency_threshold</span> <span class=o>=</span> <span class=n>Timedelta</span><span class=p>(</span><span class=n>frequency_string</span><span class=p>)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>    <span class=k>except</span><span class=p>:</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>"Unable to infer frequency from timestamps."</span><span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>    <span class=n>event_timestamps</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>full</span><span class=p>(</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>            <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>            <span class=n>fill_value</span><span class=o>=</span><span class=n>numpy</span><span class=o>.</span><span class=n>datetime64</span><span class=p>(</span><span class=s1>'NaT'</span><span class=p>),</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>            <span class=n>dtype</span><span class=o>=</span><span class=s1>'datetime64[ns]'</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>    <span class=n>event_types</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s2>"object"</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"empty"</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=n>naive_timestamps</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>tz_localize</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>    <span class=k>for</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>event_times</span> <span class=ow>in</span> <span class=n>solar_event_series</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=c1># Find indices of closest matching timestamps</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>event_indexer</span> <span class=o>=</span> <span class=n>naive_timestamps</span><span class=o>.</span><span class=n>get_indexer</span><span class=p>(</span><span class=n>event_times</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=s1>'nearest'</span><span class=p>)</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=c1># However, assign event times to indices only if within the frequency threshold</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>event_time</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>event_indexer</span><span class=p>,</span> <span class=n>event_times</span><span class=p>):</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>            <span class=k>if</span> <span class=n>idx</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>:</span>  <span class=c1># Valid index</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>                <span class=n>closest_timestamp</span> <span class=o>=</span> <span class=n>naive_timestamps</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>                <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>event_time</span> <span class=o>-</span> <span class=n>closest_timestamp</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=n>frequency_threshold</span><span class=p>:</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>                    <span class=n>event_timestamps</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>event_time</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>                    <span class=n>event_types</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>event_type</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>    <span class=k>return</span> <span class=n>event_types</span><span class=p>,</span> <span class=n>event_timestamps</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.events> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">events</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.events title="Permanent link"></a></h3> <div class="doc doc-contents"> <p>This module contains days within the year that have some solar significance.</p> <p>The <code>SIGNIFICANT_DAYS</code> list includes key dates such as solstices, equinoxes, and points of perihelion and aphelion, among others. These dates are significant in understanding the Earth's orbit around the Sun and its effects on solar irradiance.</p> <p>Each date is represented as a tuple, where the first element is the day of the year, and the second element is an event or description.</p> <p>Constants: SIGNIFICANT_DAYS (list): A list of tuples representing significant dates. Each tuple contains a day of the year and a description of the significant event on that day. Source : Significant Days of the Year, <a href=https://andrewmarsh.com/articles/2019/significant-dates/ >https://andrewmarsh.com/articles/2019/significant-dates/</a></p> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.fractional_year> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">fractional_year</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.fractional_year title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.fractional_year.calculate_fractional_year_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_fractional_year_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.fractional_year.calculate_fractional_year_series_noaa</code>)'>calculate_fractional_year_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the fractional year for a time series.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.fractional_year.calculate_fractional_year_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_fractional_year_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.fractional_year.calculate_fractional_year_series_noaa title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_fractional_year_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.FractionalYear>FractionalYear</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the fractional year for a time series.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>A Pandas DatetimeIndex representing the timestamps.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The data type for the calculations (the default is 'float32').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The backend used for calculations (the default is 'NUMPY').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.FractionalYear>FractionalYear</span></code> </td> <td> <div class=doc-md-description> <p>A FractionalYear object containing the calculated fractional year series.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </td> <td> <div class=doc-md-description> <p>If any calculated fractional year value is outside the expected range.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>timestamps</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=n>start</span><span class=o>=</span><span class=s1>'2020-01-01'</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>'2020-12-31'</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>'D'</span><span class=p>)</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fractional_year_series</span> <span class=o>=</span> <span class=n>calculate_fractional_year_series_noaa</span><span class=p>(</span><span class=n>timestamps</span><span class=p>)</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>fractional_year_series</span><span class=p>)</span>
</span></code></pre></div> <details class=note open> <summary>Notes</summary> <p>The function calculates the fractional year considering leap years and converts the timestamps into fractional values considering their position within the year.</p> </details> <details class=see-also open> <summary>See also</summary> <p>The default data type (<code>dtype</code>) and backend (<code>array_backend</code>) for arrays are set in <code>constants.py</code> via the global variables <code>DATA_TYPE_DEFAULT</code> and <code>ARRAY_BACKEND_DEFAULT</code>.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/fractional_year.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateFractionalYearTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_fractional_year_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>FractionalYear</span><span class=p>:</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=w>    </span><span class=sd>"""Calculate the fractional year for a time series.</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>        A Pandas DatetimeIndex representing the timestamps.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>        The data type for the calculations (the default is 'float32').</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>        The backend used for calculations (the default is 'NUMPY').</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    verbose: int</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>        Verbosity level</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    log: int</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>        Log level</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    FractionalYear</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        A FractionalYear object containing the calculated fractional year</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        series.</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    Raises</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    ------</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    ValueError</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>        If any calculated fractional year value is outside the expected range.</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    &gt;&gt;&gt; timestamps = pd.date_range(start='2020-01-01', end='2020-12-31', freq='D')</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    &gt;&gt;&gt; fractional_year_series = calculate_fractional_year_series_noaa(timestamps)</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    &gt;&gt;&gt; print(fractional_year_series)</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    The function calculates the fractional year considering leap years and</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    converts the timestamps into fractional values considering their position</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    within the year.</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    See also</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    The default data type (`dtype`) and backend (`array_backend`) for arrays</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    are set in `constants.py` via the global variables `DATA_TYPE_DEFAULT` and</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    `ARRAY_BACKEND_DEFAULT`.</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=n>days_of_year</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>dayofyear</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=n>hours</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>hour</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=n>days_in_years</span> <span class=o>=</span> <span class=n>get_days_in_years</span><span class=p>(</span><span class=n>timestamps</span><span class=o>.</span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=n>array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=s2>"shape"</span><span class=p>:</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=s2>"init_method"</span><span class=p>:</span> <span class=s2>"zeros"</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=p>}</span>  <span class=c1># Borrow shape from timestamps</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=n>fractional_year_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>array_parameters</span><span class=p>)</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>fractional_year_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>/</span> <span class=n>days_in_years</span> <span class=o>*</span> <span class=p>(</span><span class=n>days_of_year</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>hours</span> <span class=o>-</span> <span class=mi>12</span><span class=p>)</span> <span class=o>/</span> <span class=mi>24</span><span class=p>),</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=c1># Is this "restriction" correct ?</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=n>fractional_year_series</span><span class=p>[</span><span class=n>fractional_year_series</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>            <span class=p>(</span><span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span> <span class=o>&lt;=</span> <span class=n>fractional_year_series</span><span class=p>)</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>fractional_year_series</span> <span class=o>&lt;=</span> <span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=p>):</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>            <span class=n>index_of_out_of_range_values</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>                <span class=p>(</span><span class=n>fractional_year_series</span> <span class=o>&lt;</span> <span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>                <span class=o>|</span> <span class=p>(</span><span class=n>fractional_year_series</span> <span class=o>&gt;</span> <span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>            <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>fractional_year_series</span><span class=p>[</span><span class=n>index_of_out_of_range_values</span><span class=p>]</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>            <span class=c1># Report values in "human readable" degrees</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>                <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>                <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=si>}</span><span class=s2>] radians"</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>                <span class=sa>f</span><span class=s2>" in [code]fractional_year_series[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>fractional_year_series</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=k>return</span> <span class=n>FractionalYear</span><span class=p>(</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>fractional_year_series</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.local_time> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">local_time</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.local_time title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.local_time.calculate_local_solar_time_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_local_solar_time_noaa</span> (<code>pvgisprototype.algorithms.noaa.local_time.calculate_local_solar_time_noaa</code>)'>calculate_local_solar_time_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the Local Solar Time (LST) based on the sun's position.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.local_time.calculate_local_solar_time_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_local_solar_time_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.local_time.calculate_local_solar_time_noaa title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_local_solar_time_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>event</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarEvent>SolarEvent</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SolarEvent.noon>noon</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>unrefracted_solar_zenith</span><span class=p>:</span> <span class=n><span title=pvgisprototype.UnrefractedSolarZenith>UnrefractedSolarZenith</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT>UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the Local Solar Time (LST) based on the sun's position.</p> <p>This function computes the local solar time for a series of timestamps, considering solar noon and corrections for the Equation of Time (ET) and longitude. Local solar time reflects the actual position of the sun in the sky, which may differ from local standard time.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><span title=pvgisprototype.Longitude>Longitude</span></code> </td> <td> <div class=doc-md-description> <p>Longitude of the location in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><span title=pvgisprototype.Latitude>Latitude</span></code> </td> <td> <div class=doc-md-description> <p>Latitude of the location in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>Timestamps for which to calculate the local solar time.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> <p>Timezone information for the location.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unrefracted_solar_zenith</code> </td> <td> <code><span title=pvgisprototype.UnrefractedSolarZenith>UnrefractedSolarZenith</span></code> </td> <td> <div class=doc-md-description> <p>The zenith of the sun, adjusted for atmospheric refraction. Defaults to 1.5853349194640094 radians, which corresponds to 90.833 degrees. This is the zenith at sunrise or sunset, adjusted for the approximate correction for atmospheric refraction at those times, and the size of the solar disk.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT>UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Data type for the output (default is DATA_TYPE_DEFAULT).</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Backend for array operations (default is ARRAY_BACKEND_DEFAULT).</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level for debugging (default is VERBOSE_LEVEL_DEFAULT).</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Logging level (default is LOG_LEVEL_DEFAULT).</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>A series of local solar times corresponding to the input timestamps.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <div class=codehilite><pre><span></span><code>In solar energy calculations, the Apparent Solar Time (AST) is based on the
</code></pre></div> <p>apparent angular motion of the sun across the sky, expressing the time of day. The moment when the sun crosses the meridian of the observer is known as local solar noon. This does not usually coincide with 12:00 PM on the clock.</p> <p>Local Solar Time (LST) is calculated based on the Apparent Solar Time (AST), which is determined by the sun's position. The general equation for converting between Local Solar Time (LST) and Apparent Solar Time (AST) is:</p> <div class=codehilite><pre><span></span><code>AST = LST + ET  4 * (SL - LL) - DS
</code></pre></div> <p>Where: - AST: Apparent Solar Time - LST: Local Standard Time - ET: Equation of Time - SL: Standard Longitude for the time zone - LL: Local Longitude - DS: Daylight Saving Time adjustment. Working with UTC, DS is removed from the equation.</p> <p>Thus, the LST is given by :</p> <div class=codehilite><pre><span></span><code>LST = AST - ET  4 * (SL - LL)
</code></pre></div> <p>For noon, AST = 12 thus :</p> <div class=codehilite><pre><span></span><code>LST = 12 - ET  4 * (SL - LL)
</code></pre></div> <p>Definitions:</p> <ul> <li><strong>Local Solar Time (LST)</strong>: Time based on the sun's position at a specific location.</li> <li><strong>Apparent Solar Time (AST)</strong>: Time measured by the sun's position, specifically at solar noon.</li> <li><strong>Equation of Time (ET)</strong>: Difference between apparent solar time and mean solar time.</li> <li><strong>Standard Longitude</strong>: Longitude that defines the center of a time zone.</li> <li><strong>Local Longitude</strong>: Specific longitude of a location, used for corrections.</li> <li><strong>Daylight Saving Time (DS)</strong>: Adjustment of the clock to extend evening daylight.</li> </ul> <p>This function is useful for solar energy calculations and other applications where the actual solar time is relevant.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/local_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateLocalSolarTimeNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_local_solar_time_noaa</span><span class=p>(</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>event</span><span class=p>:</span> <span class=n>SolarEvent</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>SolarEvent</span><span class=o>.</span><span class=n>noon</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>unrefracted_solar_zenith</span><span class=p>:</span> <span class=n>UnrefractedSolarZenith</span> <span class=o>=</span> <span class=n>UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=c1># adjust_for_atmospheric_refraction: bool = False,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DatetimeIndex</span><span class=p>:</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>    Calculate the Local Solar Time (LST) based on the sun's position.</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    This function computes the local solar time for a series of timestamps,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    considering solar noon and corrections for the Equation of Time (ET) </span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    and longitude. Local solar time reflects the actual position of the sun </span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    in the sky, which may differ from local standard time.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    longitude : Longitude</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>        Longitude of the location in radians.</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    latitude : Latitude</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>        Latitude of the location in radians.</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        Timestamps for which to calculate the local solar time.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    timezone : ZoneInfo</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>        Timezone information for the location.</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    unrefracted_solar_zenith : UnrefractedSolarZenith, optional</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>        The zenith of the sun, adjusted for atmospheric refraction. Defaults to</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>        1.5853349194640094 radians, which corresponds to 90.833 degrees. This</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>        is the zenith at sunrise or sunset, adjusted for the approximate</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        correction for atmospheric refraction at those times, and the size of</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        the solar disk.</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    # adjust_for_atmospheric_refraction : bool, optional</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    #     Whether to apply atmospheric refraction corrections (default is False).</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>        Data type for the output (default is DATA_TYPE_DEFAULT).</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>        Backend for array operations (default is ARRAY_BACKEND_DEFAULT).</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>        Verbosity level for debugging (default is VERBOSE_LEVEL_DEFAULT).</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>        Logging level (default is LOG_LEVEL_DEFAULT).</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    DatetimeIndex</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>        A series of local solar times corresponding to the input timestamps.</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>        In solar energy calculations, the Apparent Solar Time (AST) is based on the</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    apparent angular motion of the sun across the sky, expressing the time of day.</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    The moment when the sun crosses the meridian of the observer is known as </span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    local solar noon. This does not usually coincide with 12:00 PM on the clock.</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    Local Solar Time (LST) is calculated based on the Apparent Solar Time (AST),</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    which is determined by the sun's position. The general equation for converting </span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    between Local Solar Time (LST) and Apparent Solar Time (AST) is:</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>        AST = LST + ET  4 * (SL - LL) - DS</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>    Where:</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>    - AST: Apparent Solar Time</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>    - LST: Local Standard Time</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    - ET: Equation of Time</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>    - SL: Standard Longitude for the time zone</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>    - LL: Local Longitude</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>    - DS: Daylight Saving Time adjustment. Working with UTC, DS is removed from the equation.</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    Thus, the LST is given by :</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>        LST = AST - ET  4 * (SL - LL)</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>    For noon, AST = 12 thus :</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>        LST = 12 - ET  4 * (SL - LL)</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    Definitions:</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>    - **Local Solar Time (LST)**: Time based on the sun's position at a specific location.</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>    - **Apparent Solar Time (AST)**: Time measured by the sun's position, specifically at solar noon.</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>    - **Equation of Time (ET)**: Difference between apparent solar time and mean solar time.</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    - **Standard Longitude**: Longitude that defines the center of a time zone.</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>    - **Local Longitude**: Specific longitude of a location, used for corrections.</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>    - **Daylight Saving Time (DS)**: Adjustment of the clock to extend evening daylight.</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>    This function is useful for solar energy calculations and other applications</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>    where the actual solar time is relevant.</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=c1># Calculate solar noon for the given timestamps</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=n>solar_noon_series</span> <span class=o>=</span> <span class=n>calculate_solar_event_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>event</span><span class=o>=</span><span class=n>event</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=n>unrefracted_solar_zenith</span><span class=o>=</span><span class=n>unrefracted_solar_zenith</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=c1># adjust_for_atmospheric_refraction=adjust_for_atmospheric_refraction,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=c1># Calculate the time difference from solar noon</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>    <span class=n>local_solar_time_delta</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=n>timestamps</span> <span class=o>&lt;</span> <span class=n>solar_noon_series</span><span class=p>,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=n>timestamps</span> <span class=o>-</span> <span class=p>(</span><span class=n>solar_noon_series</span> <span class=o>-</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>1</span><span class=p>)),</span>  <span class=c1># Previous solar noon</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=n>timestamps</span> <span class=o>-</span> <span class=n>solar_noon_series</span><span class=p>,</span>  <span class=c1># Current solar noon</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=c1># Convert time difference to seconds and add to timestamps</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=n>total_seconds</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>local_solar_time_delta</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>())</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=n>local_solar_time_series</span> <span class=o>=</span> <span class=n>timestamps</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>seconds</span><span class=o>=</span><span class=n>total_seconds</span><span class=p>)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=k>return</span> <span class=n>local_solar_time_series</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.parameter_models> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">parameter_models</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.parameter_models title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Classes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.parameter_models.AngleInRadiansOutputUnitsModel title='<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">AngleInRadiansOutputUnitsModel</span> (<code>pvgisprototype.algorithms.noaa.parameter_models.AngleInRadiansOutputUnitsModel</code>)'>AngleInRadiansOutputUnitsModel</a></code></td> <td> <div class=doc-md-description> <p>The angle in radians output units argument is passed along with the</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.parameter_models.AngleInRadiansOutputUnitsModel> <code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">AngleInRadiansOutputUnitsModel</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.parameter_models.AngleInRadiansOutputUnitsModel title="Permanent link"></a></h4> <div class="doc doc-contents"> <p class="doc doc-class-bases"> Bases: <code><span title=pydantic.BaseModel>BaseModel</span></code></p> <p>The angle in radians output units argument is passed along with the returned value. This is not a real test. Hopefully, and however, it helps for clarity and understanding of what the function should return.</p> <div class="doc doc-children"> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_altitude> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_altitude</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_altitude title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_altitude.calculate_solar_altitude_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_altitude_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.solar_altitude.calculate_solar_altitude_series_noaa</code>)'>calculate_solar_altitude_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar altitude angle for a location over a time series</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_altitude.calculate_solar_altitude_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_altitude_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_altitude.calculate_solar_altitude_series_noaa title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_altitude_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar altitude angle for a location over a time series</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_altitude.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarAltitudeTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_altitude_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarAltitude</span><span class=p>:</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar altitude angle for a location over a time series"""</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>    <span class=n>solar_zenith_series</span> <span class=o>=</span> <span class=n>calculate_solar_zenith_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>        <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>    <span class=n>solar_altitude_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range_x</span><span class=p>(</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>SolarAltitude</span><span class=p>(),</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos="81 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos="82 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos="83 "></span></a>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos="84 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos="85 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos="86 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos="87 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos="88 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos="89 "></span></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos="90 "></span></a>    <span class=k>return</span> <span class=n>SolarAltitude</span><span class=p>(</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos="91 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos="92 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos="93 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos="94 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos="95 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos="96 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos="97 "></span></a>        <span class=n>adjusted_for_atmospheric_refraction</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>adjusted_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos="98 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_azimuth> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_azimuth</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_azimuth title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_azimuth.calculate_solar_azimuth_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_azimuth_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.solar_azimuth.calculate_solar_azimuth_series_noaa</code>)'>calculate_solar_azimuth_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar azimuth angle () for a time series at a specific</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_azimuth.calculate_solar_azimuth_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_azimuth_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_azimuth.calculate_solar_azimuth_series_noaa title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_azimuth_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar azimuth angle () for a time series at a specific geographic latitude and longitude.</p> <p>Calculate the solar azimuth angle () for a time series at a specific geographic latitude and longitude, by default correcting the solar zenith angle for atmospheric refraction, as described in the following steps:</p> <div class=codehilite><pre><span></span><code><span class=mf>1.</span><span class=w> </span><span class=n>Calculate</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>solar</span><span class=w> </span><span class=n>declination</span><span class=p>,</span><span class=w> </span><span class=n>solar</span><span class=w> </span><span class=n>hour</span><span class=w> </span><span class=n>angle</span><span class=p>,</span><span class=w> </span><span class=ow>and</span><span class=w> </span><span class=n>solar</span><span class=w> </span><span class=n>zenith</span>
<span class=n>using</span><span class=w> </span><span class=n>NOAA</span><span class=err>'</span><span class=n>s</span><span class=w> </span><span class=n>General</span><span class=w> </span><span class=n>Solar</span><span class=w> </span><span class=nb>Pos</span><span class=n>ition</span><span class=w> </span><span class=n>Calculations</span><span class=mf>.</span>

<span class=mf>2.</span><span class=w> </span><span class=n>Calculate</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>solar</span><span class=w> </span><span class=n>azimuth</span><span class=w> </span><span class=n>angle</span><span class=w> </span><span class=n>using</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>equation</span><span class=w> </span><span class=n>reported</span><span class=w> </span><span class=n>in</span>
<span class=n>Wikipedia</span><span class=err>'</span><span class=n>s</span><span class=w> </span><span class=n>article</span><span class=w> </span><span class=s>"Solar azimuth angle"</span><span class=w> </span><span class=n>adjusting</span><span class=w> </span><span class=kr>for</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>time</span><span class=w> </span><span class=n>of</span>
<span class=n>day</span><span class=w> </span><span class=o>--</span><span class=w> </span><span class=n>see</span><span class=w> </span><span class=n>also</span><span class=w> </span><span class=ow>Not</span><span class=n>es</span><span class=w> </span><span class=p>:</span>

<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>Morning</span><span class=w> </span><span class=p>(</span><span class=n>solar</span><span class=w> </span><span class=n>hour</span><span class=w> </span><span class=n>angle</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mf>0</span><span class=p>):</span><span class=w> </span><span class=n>azimuth</span><span class=w> </span><span class=n>derived</span><span class=w> </span><span class=n>directly</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=n>the</span>
<span class=w>      </span><span class=n>arccosine</span><span class=w> </span><span class=n>function</span><span class=mf>.</span>

<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>Afternoon</span><span class=w> </span><span class=p>(</span><span class=n>solar</span><span class=w> </span><span class=n>hour</span><span class=w> </span><span class=n>angle</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>0</span><span class=p>):</span><span class=w> </span><span class=n>azimuth</span><span class=w> </span><span class=n>adjusted</span><span class=w> </span><span class=kr>to</span><span class=w> </span><span class=n>range</span><span class=w> </span><span class=n>in</span>
<span class=w>      </span><span class=err>[</span><span class=mf>180</span><span class=err></span><span class=p>,</span><span class=w> </span><span class=mf>360</span><span class=err>]</span><span class=w> </span><span class=n>by</span><span class=w> </span><span class=n>subtracting</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=mf>360</span><span class=err></span><span class=mf>.</span>
</code></pre></div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Longitude of the location in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Latitude of the location in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>Times for which the solar azimuth will be calculated.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> <p>Timezone of the location.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>adjust_for_atmospheric_refraction</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> <p>Whether to correct the solar zenith angle for atmospheric refraction.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Data type for the calculations.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Backend array library to use.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level of the function.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level for the function.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></code> </td> <td> <div class=doc-md-description> <p>A custom data class that hold a NumPy NDArray of calculated solar azimuth angles in radians, a method to convert the angles to degrees and other metadata.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>From .. Excel sheet :</p> <p>=IF(AC2&gt;0, MOD( DEGREES(ACOS(((SIN(RADIANS(<span class=arithmatex>\(B\)</span>3))*COS(RADIANS(AD2)))-SIN(RADIANS(T2)))/(COS(RADIANS(<span class=arithmatex>\(B\)</span>3))*SIN(RADIANS(AD2)))))+180, 360), MOD( 540-DEGREES(ACOS(((SIN(RADIANS(<span class=arithmatex>\(B\)</span>3))*COS(RADIANS(AD2)))-SIN(RADIANS(T2)))/(COS(RADIANS(<span class=arithmatex>\(B\)</span>3))*SIN(RADIANS(AD2))))), 360) )</p> <p>numerator = (sin(latitude.radians) * cos(solar_zenith.radians)) - sin(solar_declination.radians) denominator = (cos(latitude.radians) * sin(solar_zenith.radians)) cosine_solar_azimuth = numerator / denominator</p> <p>if solar_hour_angle &gt; 0: (pi + arccos(cosine_solar_azimuth)) % 2*pi</p> <p>else: (3*pi - arccos(cosine_solar_azimuth)) % 2*pi</p> <p>Two important notes on the calculation of the solar azimuth angle :</p> <ul> <li> <p>The equation implemented here follows upon the relevant Wikipedia article for the "Solar azimuth angle" [1]_.</p> </li> <li> <p>The angle derived fom the arccosine function requires an adjustment to correctly represent both morning and afternoon solar azimuth angles.</p> </li> <li> <p>The equation given in NOAA's General Solar Position Calculations [0]_ is</p> <div class=codehilite><pre><span></span><code>             sin(latitude) * cos(solar_zenith) - sin(solar_declination)
</code></pre></div> <p>cos(180 - ) = - ---------------------------------------------------------- cos(latitude) * sin(solar_zenith)</p> <p>or after converting cos(180 - ) to - cos() :</p> <div class=codehilite><pre><span></span><code>         sin(latitude) * cos(solar_zenith) - sin(solar_declination)
</code></pre></div> <ul> <li>cos() = - ------------------------------------------------------------ cos(latitude) * sin(solar_zenith)</li> </ul> <p>or :</p> <div class=codehilite><pre><span></span><code>     sin(latitude) * cos(solar_zenith) - sin(solar_declination)
</code></pre></div> <p>cos() = ---------------------------------------------------------- cos(latitude) * sin(solar_zenith)</p> <p>and finally :</p> <div class=codehilite><pre><span></span><code>          sin(latitude) * cos(solar_zenith) - sin(solar_declination)
</code></pre></div> <p> = arccos( -------------------------------------------------------------- ) cos(latitude) * sin(solar_zenith)</p> <p>where  is the wanted solar azimuth angle.</p> <p>However, comparing this equation with the <em>almost identical</em> equation reported in Wikipedia's relevant article and subsection titled "Conventional Trigonometric Formulas" [1]_, there seems to be a difference of a minus sign :</p> <div class=codehilite><pre><span></span><code>         sin(declination) - cos(zenith) * sin(latitude)
</code></pre></div> <p>s = arccos( ---------------------------------------------- ) sin(zenith) * cos(latitude)</p> <p>where s is the wanted solar azimuth angle.</p> <p>A cross-comparison of the solar azimuth angle derived by the equation reported in Wikipedia's article [1]_ and the libraries pvlib [2]<em>, Skyfield [3]</em> and suncalc [4]_, show a high agreement across all of them.</p> </li> <li> <p>Adjusting the solar azimuth based on the time of day</p> <p>Given that arccosine ranges in [0, ] or else in [0, 180], the raw calculated solar azimuth angle will likewise range in [0, ]. This necessitates an adjustment based on the time of day.</p> <ul> <li> <p>Morning (solar hour angle &lt; 0): the azimuth angle is correctly derived directly from the arccosine function representing angles from the North clockwise to the South [0, 180].</p> </li> <li> <p>Afternoon (solar hour angle &gt; 0): the azimuth angle needs to be adjusted in order to correctly represent angles going further from the South to the West [180, 360]. This is achieved by subtracting the azimuth from 360.</p> </li> </ul> </li> </ul> </details> <details class=references open> <summary>References</summary> <p>.. [0] <a href=https://gml.noaa.gov/grad/solcalc/solareqns.PDF>https://gml.noaa.gov/grad/solcalc/solareqns.PDF</a></p> <p>.. [1] <a href=https://en.wikipedia.org/wiki/Solar_azimuth_angle#Conventional_Trigonometric_Formulas>https://en.wikipedia.org/wiki/Solar_azimuth_angle#Conventional_Trigonometric_Formulas</a></p> <p>.. [2] <a href=https://github.com/pvlib/pvlib-python>https://github.com/pvlib/pvlib-python</a></p> <p>.. [3] <a href=https://github.com/skyfielders/python-skyfield/ >https://github.com/skyfielders/python-skyfield/</a></p> <p>.. [4] <a href=https://github.com/kylebarron/suncalc-py>https://github.com/kylebarron/suncalc-py</a></p> </details> <p><span class=doc-section-title>Examples:</span></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>math</span><span class=w> </span><span class=kn>import</span> <span class=n>radians</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.api.datetime.datetimeindex</span><span class=w> </span><span class=kn>import</span> <span class=n>generate_datetime_series</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>timestamps</span> <span class=o>=</span> <span class=n>generate_datetime_series</span><span class=p>(</span><span class=n>start_time</span><span class=o>=</span><span class=s1>'2010-01-27'</span><span class=p>,</span> <span class=n>end_time</span><span class=o>=</span><span class=s1>'2010-01-28'</span><span class=p>)</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>zoneinfo</span><span class=w> </span><span class=kn>import</span> <span class=n>ZoneInfo</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.api.position.azimuth</span><span class=w> </span><span class=kn>import</span> <span class=n>calculate_solar_azimuth_series_noaa</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>calculate_solar_azimuth_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=gp>... </span><span class=n>longitude</span><span class=o>=</span><span class=n>radians</span><span class=p>(</span><span class=mf>8.628</span><span class=p>),</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=gp>... </span><span class=n>latitude</span><span class=o>=</span><span class=n>radians</span><span class=p>(</span><span class=mf>45.812</span><span class=p>),</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=gp>... </span><span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=gp>... </span><span class=n>timezone</span><span class=o>=</span><span class=n>ZoneInfo</span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>),</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=gp>... </span><span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>solar_azimuth_series</span><span class=p>)</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a><span class=go>solar_timing_algorithm='NOAA' solar_positioning_algorithm='NOAA' min_degrees=0 min_radians=0 data_source=None equation=None algorithm=None unit='radians' value=array([0.20324755, 0.68162394, 1.0347457 , 1.2956891 , 1.5057368 ,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a><span class=go>       1.6915469 , 1.8700204 , 2.0612502 , 2.250216  , 2.466558  ,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a><span class=go>       2.7086406 , 2.9751859 , 3.2346225 , 3.50884   , 3.757659  ,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a><span class=go>       3.9807858 , 4.1786404 , 4.3685203 , 4.547683  , 4.73073   ,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a><span class=go>       4.933111  , 5.178298  , 5.503539  , 5.949113  , 0.19983101],</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a><span class=go>      dtype=float32) symbol='' description='Solar azimuth angle data for a location and period in time' label=None title='Solar Azimuth' supertitle='Solar Irradiance' shortname='Azimuth' name='Solar Azimuth' max_radians=6.283185307179586 max_degrees=360 definition='Solar azimuth angle' origin='North'</span>
</span></code></pre></div> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>degrees</span><span class=p>)</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=go>[ 11.6452265  39.054173   59.286556   74.23751    86.27236    96.918495</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=go> 107.14427   118.10093   128.92787   141.32335   155.19366   170.46559</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=go> 185.3302    201.04172   215.29799   228.08221   239.41844   250.29776</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=go> 260.56302   271.05084   282.64642   296.6946    315.32956   340.85904</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=go>  11.449472 ]</span>
</span></code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_azimuth.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarAzimuthTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_azimuth_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>    <span class=n>validate_output</span><span class=p>:</span><span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarAzimuth</span><span class=p>:</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar azimuth angle () for a time series at a specific</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    geographic latitude and longitude.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    Calculate the solar azimuth angle () for a time series at a specific</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    geographic latitude and longitude, by default correcting the solar zenith</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    angle for atmospheric refraction, as described in the following steps:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>        1. Calculate the solar declination, solar hour angle, and solar zenith</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        using NOAA's General Solar Position Calculations.</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>        2. Calculate the solar azimuth angle using the equation reported in</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>        Wikipedia's article "Solar azimuth angle" adjusting for the time of</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        day -- see also Notes :</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>            - Morning (solar hour angle &lt; 0): azimuth derived directly from the</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>              arccosine function.</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>            - Afternoon (solar hour angle &gt; 0): azimuth adjusted to range in</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>              [180, 360] by subtracting it from 360.</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    longitude : float</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>        Longitude of the location in radians.</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    latitude : float</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>        Latitude of the location in radians.</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>        Times for which the solar azimuth will be calculated.</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    timezone : ZoneInfo</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>        Timezone of the location.</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    adjust_for_atmospheric_refraction : bool, optional</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>        Whether to correct the solar zenith angle for atmospheric refraction.</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>        Data type for the calculations.</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        Backend array library to use.</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>        Verbosity level of the function.</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>        Log level for the function.</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    SolarAzimuth</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>        A custom data class that hold a NumPy NDArray of calculated solar</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>        azimuth angles in radians, a method to convert the angles to degrees</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>        and other metadata.</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    From .. Excel sheet :</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>    =IF(AC2&gt;0,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>        MOD(</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>            DEGREES(ACOS(((SIN(RADIANS($B$3))*COS(RADIANS(AD2)))-SIN(RADIANS(T2)))/(COS(RADIANS($B$3))*SIN(RADIANS(AD2)))))+180,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>        360),</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>        MOD(</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>            540-DEGREES(ACOS(((SIN(RADIANS($B$3))*COS(RADIANS(AD2)))-SIN(RADIANS(T2)))/(COS(RADIANS($B$3))*SIN(RADIANS(AD2))))),</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>        360)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>    )</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>    numerator = (sin(latitude.radians) * cos(solar_zenith.radians)) - sin(solar_declination.radians)</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>    denominator = (cos(latitude.radians) * sin(solar_zenith.radians))</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>    cosine_solar_azimuth = numerator / denominator</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>    if solar_hour_angle &gt; 0:</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>        (pi + arccos(cosine_solar_azimuth)) % 2*pi</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>    else:</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>        (3*pi - arccos(cosine_solar_azimuth)) % 2*pi</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>    Two important notes on the calculation of the solar azimuth angle :</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>    - The equation implemented here follows upon the relevant Wikipedia article</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=sd>      for the "Solar azimuth angle" [1]_.</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a><span class=sd>    - The angle derived fom the arccosine function requires an adjustment to</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=sd>    correctly represent both morning and afternoon solar azimuth angles.</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a><span class=sd>    1. The equation given in NOAA's General Solar Position Calculations [0]_ is</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=sd>                         sin(latitude) * cos(solar_zenith) - sin(solar_declination)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a><span class=sd>        cos(180 - ) = - ----------------------------------------------------------</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=sd>                                  cos(latitude) * sin(solar_zenith)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=sd>        or after converting cos(180 - ) to - cos() :</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=sd>                     sin(latitude) * cos(solar_zenith) - sin(solar_declination)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>        - cos() = - ------------------------------------------------------------</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a><span class=sd>                                cos(latitude) * sin(solar_zenith)</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=sd>        or :</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=sd>                 sin(latitude) * cos(solar_zenith) - sin(solar_declination)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=sd>        cos() = ----------------------------------------------------------</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a><span class=sd>                             cos(latitude) * sin(solar_zenith)</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=sd>        and finally :</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a><span class=sd>                      sin(latitude) * cos(solar_zenith) - sin(solar_declination)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=sd>         = arccos( -------------------------------------------------------------- )</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a><span class=sd>                                  cos(latitude) * sin(solar_zenith)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a><span class=sd>        where  is the wanted solar azimuth angle.</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>        However, comparing this equation with the _almost identical_ equation</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>        reported in Wikipedia's relevant article and subsection titled</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=sd>        "Conventional Trigonometric Formulas" [1]_, there seems to be a</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a><span class=sd>        difference of a minus sign :</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>                     sin(declination) - cos(zenith) * sin(latitude)</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=sd>        s = arccos( ---------------------------------------------- )</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=sd>                             sin(zenith) * cos(latitude)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>        where s is the wanted solar azimuth angle.</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>        A cross-comparison of the solar azimuth angle derived by the equation</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>        reported in Wikipedia's article [1]_ and the libraries pvlib [2]_,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a><span class=sd>        Skyfield [3]_ and suncalc [4]_, show a high agreement</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a><span class=sd>        across all of them.</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>    2. Adjusting the solar azimuth based on the time of day</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a><span class=sd>        Given that arccosine ranges in [0, ] or else in [0, 180], the raw</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a><span class=sd>        calculated solar azimuth angle will likewise range in [0, ]. This</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>        necessitates an adjustment based on the time of day.</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>        - Morning (solar hour angle &lt; 0): the azimuth angle is correctly</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a><span class=sd>          derived directly from the arccosine function representing angles from</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a><span class=sd>          the North clockwise to the South [0, 180].</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a><span class=sd>        - Afternoon (solar hour angle &gt; 0): the azimuth angle needs to be</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a><span class=sd>          adjusted in order to correctly represent angles going further from</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a><span class=sd>          the South to the West [180, 360]. This is achieved by subtracting</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a><span class=sd>          the azimuth from 360.</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=sd>    .. [0] https://gml.noaa.gov/grad/solcalc/solareqns.PDF</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a><span class=sd>    .. [1] https://en.wikipedia.org/wiki/Solar_azimuth_angle#Conventional_Trigonometric_Formulas</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a><span class=sd>    .. [2] https://github.com/pvlib/pvlib-python</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a><span class=sd>    .. [3] https://github.com/skyfielders/python-skyfield/</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a><span class=sd>    .. [4] https://github.com/kylebarron/suncalc-py</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a><span class=sd>    &gt;&gt;&gt; from math import radians</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.api.datetime.datetimeindex import generate_datetime_series</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a><span class=sd>    &gt;&gt;&gt; timestamps = generate_datetime_series(start_time='2010-01-27', end_time='2010-01-28')</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a><span class=sd>    &gt;&gt;&gt; from zoneinfo import ZoneInfo</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.api.position.azimuth import calculate_solar_azimuth_series_noaa</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a><span class=sd>    &gt;&gt;&gt; solar_azimuth_series = calculate_solar_azimuth_series_noaa(</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a><span class=sd>    ... longitude=radians(8.628),</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a><span class=sd>    ... latitude=radians(45.812),</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a><span class=sd>    ... timestamps=timestamps,</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a><span class=sd>    ... timezone=ZoneInfo("UTC"),</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a><span class=sd>    ... adjust_for_atmospheric_refraction=True</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a><span class=sd>    &gt;&gt;&gt; print(solar_azimuth_series)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a><span class=sd>    solar_timing_algorithm='NOAA' solar_positioning_algorithm='NOAA' min_degrees=0 min_radians=0 data_source=None equation=None algorithm=None unit='radians' value=array([0.20324755, 0.68162394, 1.0347457 , 1.2956891 , 1.5057368 ,</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a><span class=sd>           1.6915469 , 1.8700204 , 2.0612502 , 2.250216  , 2.466558  ,</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a><span class=sd>           2.7086406 , 2.9751859 , 3.2346225 , 3.50884   , 3.757659  ,</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a><span class=sd>           3.9807858 , 4.1786404 , 4.3685203 , 4.547683  , 4.73073   ,</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a><span class=sd>           4.933111  , 5.178298  , 5.503539  , 5.949113  , 0.19983101],</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a><span class=sd>          dtype=float32) symbol='\U000f19a5' description='Solar azimuth angle data for a location and period in time' label=None title='Solar Azimuth' supertitle='Solar Irradiance' shortname='Azimuth' name='Solar Azimuth' max_radians=6.283185307179586 max_degrees=360 definition='Solar azimuth angle' origin='North'</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a><span class=sd>    &gt;&gt;&gt; print(solar_azimuth_series.degrees)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a><span class=sd>    [ 11.6452265  39.054173   59.286556   74.23751    86.27236    96.918495</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a><span class=sd>     107.14427   118.10093   128.92787   141.32335   155.19366   170.46559</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a><span class=sd>     185.3302    201.04172   215.29799   228.08221   239.41844   250.29776</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a><span class=sd>     260.56302   271.05084   282.64642   296.6946    315.32956   340.85904</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a><span class=sd>      11.449472 ]</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>calculate_solar_declination_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=n>calculate_solar_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>    <span class=n>solar_zenith_series</span> <span class=o>=</span> <span class=n>calculate_solar_zenith_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>        <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>    <span class=n>numerator_series</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>        <span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>    <span class=p>)</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>    <span class=n>denominator_series</span> <span class=o>=</span> <span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>    <span class=n>cosine_solar_azimuth_series</span> <span class=o>=</span> <span class=n>numerator_series</span> <span class=o>/</span> <span class=n>denominator_series</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arccos</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>cosine_solar_azimuth_series</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>        <span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span>  <span class=c1># afternoon hours !</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>mod</span><span class=p>((</span><span class=n>pi</span> <span class=o>+</span> <span class=n>solar_azimuth_series</span><span class=p>),</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>),</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>mod</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=n>pi</span> <span class=o>-</span> <span class=n>solar_azimuth_series</span><span class=p>,</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>),</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a>        <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a>            <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&lt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a>            <span class=o>|</span> <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&gt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>        <span class=p>)</span><span class=o>.</span><span class=n>any</span><span class=p>():</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a>            <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>solar_azimuth_series</span><span class=p>[</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>                <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&lt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a>                <span class=o>|</span> <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&gt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>            <span class=p>]</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a>            <span class=c1># raise ValueError(# ?</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a>                <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>                <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=si>}</span><span class=s2>] radians"</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>                <span class=sa>f</span><span class=s2>" in [code]solar_azimuth_series[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a>    <span class=k>return</span> <span class=n>SolarAzimuth</span><span class=p>(</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a>        <span class=n>origin</span><span class=o>=</span><span class=s2>"North"</span><span class=p>,</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_declination> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_declination</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_declination title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_declination.calculate_solar_declination_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_declination_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.solar_declination.calculate_solar_declination_series_noaa</code>)'>calculate_solar_declination_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar declination for a time series.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_declination.calculate_solar_declination_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_declination_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_declination.calculate_solar_declination_series_noaa title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_declination_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarDeclination>SolarDeclination</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar declination for a time series.</p> <details class=note open> <summary>Notes</summary> <p>From NOAA's .. Excel sheet:</p> <p>sine_solar_declination = ASIN( SIN(RADIANS(R2))*SIN(RADIANS(P2)) )</p> <p>where:</p> <p>P2 = M2-0.00569-0.00478*SIN(RADIANS(125.04-1934.136*G2))</p> <div class=codehilite><pre><span></span><code><span class=n>where</span><span class=o>:</span>

<span class=n>M2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Geom</span><span class=w> </span><span class=n>Mean</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>Sun</span><span class=w> </span><span class=o>(</span><span class=n>deg</span><span class=o>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>Geom</span><span class=w> </span><span class=n>Mean</span><span class=w> </span><span class=n>Anom</span><span class=w> </span><span class=n>Sun</span><span class=w> </span><span class=o>(</span><span class=n>deg</span><span class=o>)</span>
</code></pre></div> <p>R2 = Q2 + 0.00256 * COS(RADIANS(125.04 - 1934.136*G2))</p> <div class=codehilite><pre><span></span><code>where :
</code></pre></div> <p>Q2 = Mean Obliq Ecliptic (deg)</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_declination.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarDeclinationTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_declination_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>validate_output</span><span class=p>:</span><span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarDeclination</span><span class=p>:</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar declination for a time series.</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    From NOAA's .. Excel sheet:</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    sine_solar_declination</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    = ASIN(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>        SIN(RADIANS(R2))*SIN(RADIANS(P2))</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    )</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    where:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    P2 = M2-0.00569-0.00478*SIN(RADIANS(125.04-1934.136*G2))</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>        where:</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>        M2 = Geom Mean Long Sun (deg) + Geom Mean Anom Sun (deg)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    R2 = Q2 + 0.00256 * COS(RADIANS(125.04 - 1934.136*G2))</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        where :</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>       Q2 = Mean Obliq Ecliptic (deg)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=n>fractional_year_series</span> <span class=o>=</span> <span class=n>calculate_fractional_year_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=mf>0.006918</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=o>-</span> <span class=mf>0.399912</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>        <span class=o>+</span> <span class=mf>0.070257</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>        <span class=o>-</span> <span class=mf>0.006758</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=o>+</span> <span class=mf>0.000907</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=o>-</span> <span class=mf>0.002697</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>        <span class=o>+</span> <span class=mf>0.00148</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=n>out_of_range</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range_x</span><span class=p>(</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>            <span class=n>series</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>            <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>            <span class=n>data_model</span><span class=o>=</span><span class=n>SolarDeclination</span><span class=p>(),</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=k>return</span> <span class=n>SolarDeclination</span><span class=p>(</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span> <span class=k>if</span> <span class=n>out_of_range</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span> <span class=k>if</span> <span class=n>out_of_range</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>fractional_year_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_hour_angle> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_hour_angle</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_hour_angle title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_hour_angle.calculate_solar_hour_angle_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_hour_angle_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.solar_hour_angle.calculate_solar_hour_angle_series_noaa</code>)'>calculate_solar_hour_angle_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar hour angle for a time series.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_hour_angle.calculate_solar_hour_angle_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_hour_angle_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_hour_angle.calculate_solar_hour_angle_series_noaa title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarHourAngle>SolarHourAngle</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar hour angle for a time series.</p> <p>The solar hour angle calculation converts the local solar time (LST) into the number of degrees which the sun moves across the sky. In other words, it reflects the Earth's rotation and indicates the time of the day relative to the position of the Sun. It bases on the longitude and timestamp and by definition, the solar hour angle is :</p> <ul> <li>0 at solar noon</li> <li>negative in the morning</li> <li>positive in the afternoon.</li> </ul> <p>Since the Earth rotates 15 per hour (or pi / 12 in radians), each hour away from solar noon corresponds to an angular motion of the sun in the sky of 15. Practically, the calculation converts a timestamp into a solar time.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>Returns</code> </td> <td> </td> <td> <div class=doc-md-description> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>In the "original" equation, the solar hour angle is measured in degrees.</p> <div class=codehilite><pre><span></span><code><span class=sb>`hour_angle = true_solar_time / 4 - 180`</span>

which is the same as

<span class=sb>`hour_angle = true_solar_time * 0.25 - 180`</span>
</code></pre></div> <p>In the present implementation, we calculate the solar hour angle directly in radians. A full circle corresponds to 360 degrees or 2 radians. With 1440 minutes in a day, the angular change per minute is calculated as 2 radians divided by 1440 minutes. This results in approximately 0.004363323129985824 radians per minute.</p> <p>To find the solar hour angle, we first calculate the time difference from solar noon (by subtracting the true solar time in minutes from 720). We then multiply this difference by the angular change per minute (0.004363323129985824) to convert the time difference into radians. This approach (accurately?) represents the solar hour angle as an angular measurement in radians, reflecting the Earth's rotation and the position of the sun in the sky relative to a given location on Earth.</p> <p>In NREL's SPA ... , equation 32:</p> <div class=codehilite><pre><span></span><code><span class=nx></span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx></span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx></span><span class=w> </span><span class=err></span><span class=w> </span><span class=nx></span>

<span class=nx>Where</span><span class=w> </span><span class=p>:</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=nx></span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>observer</span><span class=w> </span><span class=nx>geographical</span><span class=w> </span><span class=nx>longitude</span><span class=p>,</span><span class=w> </span><span class=nx>positive</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=nx>negative</span>
<span class=w>      </span><span class=k>for</span><span class=w> </span><span class=nx>east</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=nx>west</span><span class=w> </span><span class=nx>of</span><span class=w> </span><span class=nx>Greenwich</span><span class=p>,</span><span class=w> </span><span class=nx>respectively</span><span class=p>.</span>

<span class=nx>Limit</span><span class=w> </span><span class=nx></span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>range</span><span class=w> </span><span class=nx>from</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=mi>360</span><span class=w> </span><span class=nx>degrees</span><span class=w> </span><span class=nx>using</span><span class=w> </span><span class=nx>step</span><span class=w> </span><span class="m m-Double">3.2.6</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=nx>note</span><span class=w> </span><span class=nx>that</span><span class=w> </span><span class=nx>it</span>
<span class=k>is</span><span class=w> </span><span class=nx>measured</span><span class=w> </span><span class=nx>westward</span><span class=w> </span><span class=nx>from</span><span class=w> </span><span class=nx>south</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=nx>this</span><span class=w> </span><span class=nx>algorithm</span><span class=p>.</span>

<span class=nx>Step</span><span class=w> </span><span class="m m-Double">3.2.6</span><span class=w> </span><span class=p>:</span>

<span class=w>    </span><span class=nx>Limit</span><span class=w> </span><span class=nx>L</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>range</span><span class=w> </span><span class=nx>from</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=mi>360</span><span class=w> </span><span class=nx>degrees</span><span class=p>.</span><span class=w> </span><span class=nx>That</span><span class=w> </span><span class=nx>can</span><span class=w> </span><span class=nx>be</span>
<span class=w>    </span><span class=nx>accomplished</span><span class=w> </span><span class=nx>by</span><span class=w> </span><span class=nx>dividing</span><span class=w> </span><span class=nx>L</span><span class=w> </span><span class=nx>by</span><span class=w> </span><span class=mi>360</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=nx>recording</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>decimal</span>
<span class=w>    </span><span class=nx>fraction</span><span class=w> </span><span class=nx>of</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>division</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nx>F</span><span class=p>.</span><span class=w> </span><span class=nx>If</span><span class=w> </span><span class=nx>L</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=nx>positive</span><span class=p>,</span><span class=w> </span><span class=k>then</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>limited</span><span class=w> </span><span class=nx>L</span>
<span class=w>    </span><span class=p>=</span><span class=w> </span><span class=mi>360</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=nx>F</span><span class=p>.</span><span class=w> </span><span class=nx>If</span><span class=w> </span><span class=nx>L</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=nx>negative</span><span class=p>,</span><span class=w> </span><span class=k>then</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>limited</span><span class=w> </span><span class=nx>L</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>360</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>360</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=nx>F</span><span class=p>.</span>
</code></pre></div> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_hour_angle.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarHourAngleTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>validate_output</span><span class=p>:</span><span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarHourAngle</span><span class=p>:</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar hour angle for a time series.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    The solar hour angle calculation converts the local solar time (LST) into</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    the number of degrees which the sun moves across the sky. In other words,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    it reflects the Earth's rotation and indicates the time of the day relative</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    to the position of the Sun. It bases on the longitude and timestamp and by</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    definition, the solar hour angle is :</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>      - 0 at solar noon</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>      - negative in the morning</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>      - positive in the afternoon.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    Since the Earth rotates 15 per hour (or pi / 12 in radians), each hour</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    away from solar noon corresponds to an angular motion of the sun in the sky</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    of 15. Practically, the calculation converts a timestamp into a solar</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    time.</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    In the "original" equation, the solar hour angle is measured in degrees.</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>        `hour_angle = true_solar_time / 4 - 180`</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>        which is the same as</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>        `hour_angle = true_solar_time * 0.25 - 180`</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    In the present implementation, we calculate the solar hour angle directly</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    in radians. A full circle corresponds to 360 degrees or 2 radians. With</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    1440 minutes in a day, the angular change per minute is calculated as 2</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    radians divided by 1440 minutes. This results in approximately</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    0.004363323129985824 radians per minute.</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    To find the solar hour angle, we first calculate the time difference from</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    solar noon (by subtracting the true solar time in minutes from 720). We</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    then multiply this difference by the angular change per minute</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>    (0.004363323129985824) to convert the time difference into radians. This</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    approach (accurately?) represents the solar hour angle as an angular</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    measurement in radians, reflecting the Earth's rotation and the position of</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    the sun in the sky relative to a given location on Earth.</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    In NREL's SPA ... , equation 32:</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>         =  +   </span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>        Where :</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>            -  the observer geographical longitude, positive or negative</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>              for east or west of Greenwich, respectively.</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>        Limit  to the range from 0 to 360 degrees using step 3.2.6 and note that it</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>        is measured westward from south in this algorithm.</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>        Step 3.2.6 :</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>            Limit L to the range from 0 to 360 degrees. That can be</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>            accomplished by dividing L by 360 and recording the decimal</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>            fraction of the division as F. If L is positive, then the limited L</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>            = 360 * F. If L is negative, then the limited L = 360 - 360 * F.</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>    <span class=n>true_solar_time_series</span> <span class=o>=</span> <span class=n>calculate_true_solar_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=p>(</span><span class=n>true_solar_time_series</span><span class=o>.</span><span class=n>minutes</span> <span class=o>-</span> <span class=mf>720.0</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>/</span> <span class=mf>720.0</span><span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=c1># solar_hour_angle_series = np.where(</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=c1>#         # true_solar_time_series.minutes &lt; 0,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=c1>#         solar_hour_angle_series &lt; 0,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>    <span class=c1>#         solar_hour_angle_series + pi,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>    <span class=c1>#         solar_hour_angle_series - pi,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>    <span class=c1>#         )</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>            <span class=p>(</span><span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span> <span class=o>&lt;=</span> <span class=n>solar_hour_angle_series</span><span class=p>)</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>solar_hour_angle_series</span> <span class=o>&lt;=</span> <span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=p>):</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>            <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>solar_hour_angle_series</span><span class=p>[</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>                <span class=o>~</span><span class=p>(</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>                    <span class=p>(</span><span class=o>-</span><span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span> <span class=o>&lt;=</span> <span class=n>solar_hour_angle_series</span><span class=p>)</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>                    <span class=o>&amp;</span> <span class=p>(</span><span class=n>solar_hour_angle_series</span> <span class=o>&lt;=</span> <span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>            <span class=p>]</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>                <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>                <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>min_degrees</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>max_degrees</span><span class=si>}</span><span class=s2>] degrees"</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>                <span class=sa>f</span><span class=s2>" in [code]solar_hour_angle_series[/code] : </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>out_of_range_values</span><span class=p>)</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>    <span class=k>return</span> <span class=n>SolarHourAngle</span><span class=p>(</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>true_solar_time_series</span><span class=o>.</span><span class=n>timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_time> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_time</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_time title="Permanent link"></a></h3> <div class="doc doc-contents"> <p>The true solar time based on NOAA's General Solar Position Calculations.</p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_time.calculate_true_solar_time_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_true_solar_time_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.solar_time.calculate_true_solar_time_series_noaa</code>)'>calculate_true_solar_time_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the true solar time at a specific geographic locations for a</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_time.calculate_true_solar_time_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_true_solar_time_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_time.calculate_true_solar_time_series_noaa title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_true_solar_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.TrueSolarTime>TrueSolarTime</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the true solar time at a specific geographic locations for a time series.</p> <p>Calculate the true solar time at a specific geographic locations for a series of timestamps based on NOAA's General Solar Position Calculations [0]_.</p> <p>The true solar time is the sum of the mean solar time and the equation of time. CONFIRM!?</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>The timestamp to calculate offset for</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> <p>The timezone for calculation</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The data type for the calculations (the default is 'float32').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The backend used for calculations (the default is 'NUMPY').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.TrueSolarTime>TrueSolarTime</span></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The true solar time is the sum of the time offset and the true solar time in minutes.</p> <div class=codehilite><pre><span></span><code>time_offset = eqtime + 4*longitude  60*timezone
</code></pre></div> </details> <details class=see-also open> <summary>See also</summary> <p>pysolar</p> <p>In pysolar the true solar time is calculated as follows :</p> <div class=codehilite><pre><span></span><code><span class=s>```</span>
(math.tm_hour(when) * 60 + math.tm_min(when) + 4 * longitude_deg + equation_of_time(math.tm_yday(when)))
<span class=s>```</span>

in which equation the last part is the time offset

<span class=s>```</span>
4 * longitude_deg + equation_of_time(math.tm_yday(when)))
<span class=s>```</span>
</code></pre></div> <p>Additional notes:</p> <p>From NOAA's General Solar Position Calculations</p> <div class=codehilite><pre><span></span><code><span class=s>"Next, the true solar time is calculated in the following two</span>
<span class=s>equations. First the time offset is found, in minutes, and then the</span>
<span class=s>true solar time, in minutes."</span>

<span class=n>time_offset</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>eqtime</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>4</span><span class=o>*</span><span class=n>longitude</span><span class=w> </span><span class=err></span><span class=w> </span><span class=mi>60</span><span class=o>*</span><span class=n>timezone</span>

<span class=n>where</span><span class=w> </span><span class=p>:</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>eqtime</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=n>minutes</span><span class=p>,</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>longitude</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=n>degrees</span><span class=w> </span><span class=p>(</span><span class=n>positive</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>east</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>Prime</span>
<span class=w>      </span><span class=n>Meridian</span><span class=p>),</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>timezone</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=n>hours</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=n>UTC</span><span class=w> </span><span class=p>(</span><span class=n>U</span><span class=o>.</span><span class=n>S</span><span class=o>.</span><span class=w> </span><span class=n>Mountain</span><span class=w> </span><span class=n>Standard</span><span class=w> </span><span class=n>Time</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err></span><span class=mi>7</span>
<span class=w>      </span><span class=n>hours</span><span class=p>)</span><span class=o>.</span>

<span class=n>tst</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>hr</span><span class=o>*</span><span class=mi>60</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>mn</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>sc</span><span class=o>/</span><span class=mi>60</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>time_offset</span>

<span class=n>where</span><span class=w> </span><span class=p>:</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>hr</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>hour</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>23</span><span class=p>),</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>mn</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>minute</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>59</span><span class=p>),</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>sc</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>second</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>59</span><span class=p>)</span><span class=o>.</span>
</code></pre></div> </details> <details class=references open> <summary>References</summary> <p>.. [0] <a href=https://gml.noaa.gov/grad/solcalc/solareqns.PDF>https://gml.noaa.gov/grad/solcalc/solareqns.PDF</a></p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateTrueSolarTimeTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_true_solar_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>TrueSolarTime</span><span class=p>:</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=w>    </span><span class=sd>"""Calculate the true solar time at a specific geographic locations for a</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    time series.</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    Calculate the true solar time at a specific geographic locations for a</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    series of timestamps based on NOAA's General Solar Position Calculations</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    [0]_.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    The true solar time is the sum of the mean solar time and the equation of</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    time.  CONFIRM!?</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    timestamps: DatetimeIndex, optional</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>        The timestamp to calculate offset for</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    timezone: str, optional</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        The timezone for calculation</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        The data type for the calculations (the default is 'float32').</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>        The backend used for calculations (the default is 'NUMPY').</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    verbose: int</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>        Verbosity level</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    log: int</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>        Log level</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    TrueSolarTime</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>    The true solar time is the sum of the time offset and the true solar time</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    in minutes.</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>        time_offset = eqtime + 4*longitude  60*timezone</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    See also</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    pysolar</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    In pysolar the true solar time is calculated as follows :</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>        (math.tm_hour(when) * 60 + math.tm_min(when) + 4 * longitude_deg + equation_of_time(math.tm_yday(when)))</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>        in which equation the last part is the time offset</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>        4 * longitude_deg + equation_of_time(math.tm_yday(when)))</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    Additional notes:</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>    From NOAA's General Solar Position Calculations</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>        "Next, the true solar time is calculated in the following two</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>        equations. First the time offset is found, in minutes, and then the</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>        true solar time, in minutes."</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>        time_offset = eqtime + 4*longitude  60*timezone</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>        where :</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>            - eqtime is in minutes,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>            - longitude is in degrees (positive to the east of the Prime</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>              Meridian),</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>            - timezone is in hours from UTC (U.S. Mountain Standard Time = 7</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>              hours).</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>        tst = hr*60 + mn + sc/60 + time_offset</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>        where :</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>            - hr is the hour (0 - 23),</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>            - mn is the minute (0 - 59),</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>            - sc is the second (0 - 59).</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=sd>    .. [0] https://gml.noaa.gov/grad/solcalc/solareqns.PDF</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>    <span class=n>time_offset_series</span> <span class=o>=</span> <span class=n>calculate_time_offset_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=n>true_solar_time_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>        <span class=n>timestamps</span> <span class=o>-</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>normalize</span><span class=p>()</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>+</span> <span class=n>time_offset_series</span><span class=o>.</span><span class=n>value</span> <span class=o>*</span> <span class=mi>60</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>    <span class=c1># array_parameters = {</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>    <span class=c1>#     "shape": true_solar_time_series.shape,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=c1>#     "dtype": dtype,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=c1>#     "init_method": "zeros",</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>    <span class=c1>#     "backend": array_backend,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>    <span class=c1># }</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>    <span class=c1># true_solar_time_series_in_minutes = create_array(**array_parameters)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>    <span class=n>true_solar_time_series_in_minutes</span> <span class=o>=</span> <span class=n>mod</span><span class=p>(</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=p>(</span><span class=n>true_solar_time_series</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>dtype</span><span class=p>)</span> <span class=o>/</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>1440</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>            <span class=p>(</span><span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span> <span class=o>&lt;=</span> <span class=n>true_solar_time_series_in_minutes</span><span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>true_solar_time_series_in_minutes</span> <span class=o>&lt;=</span> <span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=p>)</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>():</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>            <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>true_solar_time_series_in_minutes</span><span class=p>[</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>                <span class=o>~</span><span class=p>(</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>                    <span class=p>(</span><span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span> <span class=o>&lt;=</span> <span class=n>true_solar_time_series_in_minutes</span><span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>                    <span class=o>&amp;</span> <span class=p>(</span><span class=n>true_solar_time_series_in_minutes</span> <span class=o>&lt;=</span> <span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=p>)</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>            <span class=p>]</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>                <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>                <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=si>}</span><span class=s2>] minutes"</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>                <span class=sa>f</span><span class=s2>" in [code]true_solar_time_series_in_minutes[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>true_solar_time_series_in_minutes</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>    <span class=k>return</span> <span class=n>TrueSolarTime</span><span class=p>(</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>array</span><span class=p>(</span><span class=n>true_solar_time_series_in_minutes</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>),</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>MINUTES</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>        <span class=n>timing_algorithm</span><span class=o>=</span><span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_zenith> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_zenith</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_zenith title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_zenith.adjust_solar_zenith_for_atmospheric_refraction_time_series title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">adjust_solar_zenith_for_atmospheric_refraction_time_series</span> (<code>pvgisprototype.algorithms.noaa.solar_zenith.adjust_solar_zenith_for_atmospheric_refraction_time_series</code>)'>adjust_solar_zenith_for_atmospheric_refraction_time_series</a></code></td> <td> <div class=doc-md-description> <p>Adjust solar zenith for atmospheric refraction for a time series of solar zenith angles</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_zenith.atmospheric_refraction_adjustment title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">atmospheric_refraction_adjustment</span> (<code>pvgisprototype.algorithms.noaa.solar_zenith.atmospheric_refraction_adjustment</code>)'>atmospheric_refraction_adjustment</a></code></td> <td> <div class=doc-md-description> <p>Vectorized calculation of atmospheric refraction adjustment for different solar altitudes.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_zenith.calculate_solar_zenith_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_zenith_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.solar_zenith.calculate_solar_zenith_series_noaa</code>)'>calculate_solar_zenith_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar zenith angle for a location over a time series</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_zenith.adjust_solar_zenith_for_atmospheric_refraction_time_series> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">adjust_solar_zenith_for_atmospheric_refraction_time_series</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_zenith.adjust_solar_zenith_for_atmospheric_refraction_time_series title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>adjust_solar_zenith_for_atmospheric_refraction_time_series</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>solar_zenith_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarZenith>SolarZenith</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarZenith>SolarZenith</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Adjust solar zenith for atmospheric refraction for a time series of solar zenith angles</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_zenith.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>AdjustSolarZenithForAtmosphericRefractionTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>adjust_solar_zenith_for_atmospheric_refraction_time_series</span><span class=p>(</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=n>solar_zenith_series</span><span class=p>:</span> <span class=n>SolarZenith</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=n>validate_output</span><span class=p>:</span><span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarZenith</span><span class=p>:</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=w>    </span><span class=sd>"""Adjust solar zenith for atmospheric refraction for a time series of solar zenith angles"""</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=c1># Mask</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>solar_altitude_series_array</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=mi>90</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span> <span class=o>-</span> <span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=p>)</span>  <span class=c1># in radians</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=c1># Adjust using vectorized operations</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=n>adjustment</span> <span class=o>=</span> <span class=n>atmospheric_refraction_adjustment</span><span class=p>(</span><span class=n>solar_altitude_series_array</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=n>adjusted_solar_zenith_series_array</span> <span class=o>=</span> <span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>-</span> <span class=n>adjustment</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=c1># Validate</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=w>    </span><span class=sd>'''</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>    if not np.all(np.isfinite(adjusted_solar_zenith_series_array)) or not np.all(</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>        (SolarZenith().min_radians &lt;= adjusted_solar_zenith_series_array)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>        &amp; (adjusted_solar_zenith_series_array &lt;= SolarZenith().max_radians)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    ):</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>        raise ValueError(</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>            f"The `adjusted_solar_zenith` should be a finite number ranging in [{SolarZenith().min_radians}, {SolarZenith().max_radians}] radians"</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>        )</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    '''</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>    <span class=k>return</span> <span class=n>SolarZenith</span><span class=p>(</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>adjusted_solar_zenith_series_array</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>adjusted_for_atmospheric_refraction</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>  <span class=c1># This is what this function does !</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_zenith.atmospheric_refraction_adjustment> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">atmospheric_refraction_adjustment</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_zenith.atmospheric_refraction_adjustment title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>atmospheric_refraction_adjustment</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>solar_altitude</span><span class=p>:</span> <span class=n><span title=numpy.ndarray>ndarray</span></span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=s2>"float64"</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=numpy.ndarray>ndarray</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Vectorized calculation of atmospheric refraction adjustment for different solar altitudes. Applies different formulas based on the solar altitude angle.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_zenith.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>atmospheric_refraction_adjustment</span><span class=p>(</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>    <span class=n>solar_altitude</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>"float64"</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a><span class=sd>    Vectorized calculation of atmospheric refraction adjustment for different solar altitudes.</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a><span class=sd>    Applies different formulas based on the solar altitude angle.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>    <span class=n>tangent_solar_altitude</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>tan</span><span class=p>(</span><span class=n>solar_altitude</span><span class=p>)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>    <span class=c1># Conditions</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>    <span class=n>mask_high</span> <span class=o>=</span> <span class=n>solar_altitude</span> <span class=o>&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>    <span class=n>mask_near</span> <span class=o>=</span> <span class=p>(</span><span class=n>solar_altitude</span> <span class=o>&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=o>-</span><span class=mf>0.575</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>))</span> <span class=o>&amp;</span> <span class=o>~</span><span class=n>mask_high</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>    <span class=n>mask_below</span> <span class=o>=</span> <span class=n>solar_altitude</span> <span class=o>&lt;=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=o>-</span><span class=mf>0.575</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>    <span class=c1># High solar altitude adjustment</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>    <span class=n>adjustment_high</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>        <span class=mf>58.1</span> <span class=o>/</span> <span class=n>tangent_solar_altitude</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>        <span class=o>-</span> <span class=mf>0.07</span> <span class=o>/</span> <span class=p>(</span><span class=n>tangent_solar_altitude</span><span class=o>**</span><span class=mi>3</span><span class=p>)</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>        <span class=o>+</span> <span class=mf>0.000086</span> <span class=o>/</span> <span class=p>(</span><span class=n>tangent_solar_altitude</span><span class=o>**</span><span class=mi>5</span><span class=p>)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>    <span class=p>)</span> <span class=o>/</span> <span class=mi>3600</span>  <span class=c1># 1 degree / 3600 seconds</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>    <span class=c1># Near horizon adjustment</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>    <span class=n>solar_altitude_deg</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>solar_altitude</span><span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>    <span class=n>adjustment_near</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>        <span class=mi>1735</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>        <span class=o>+</span> <span class=n>solar_altitude_deg</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos="81 "></span></a>        <span class=o>*</span> <span class=p>(</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos="82 "></span></a>            <span class=o>-</span><span class=mf>518.2</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos="83 "></span></a>            <span class=o>+</span> <span class=n>solar_altitude_deg</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos="84 "></span></a>            <span class=o>*</span> <span class=p>(</span><span class=mf>103.4</span> <span class=o>+</span> <span class=n>solar_altitude_deg</span> <span class=o>*</span> <span class=p>(</span><span class=o>-</span><span class=mf>12.79</span> <span class=o>+</span> <span class=n>solar_altitude_deg</span> <span class=o>*</span> <span class=mf>0.711</span><span class=p>))</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos="85 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos="86 "></span></a>    <span class=p>)</span> <span class=o>/</span> <span class=mi>3600</span>  <span class=c1># 1 degree / 3600 seconds</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos="87 "></span></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos="88 "></span></a>    <span class=c1># Below horizon adjustment</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos="89 "></span></a>    <span class=n>adjustment_below</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mf>20.774</span> <span class=o>/</span> <span class=n>tangent_solar_altitude</span><span class=p>)</span> <span class=o>/</span> <span class=mi>3600</span>  <span class=c1># 1 degree / 3600 seconds</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos="90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos="91 "></span></a>    <span class=c1># Initialize adjustment array</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos="92 "></span></a>    <span class=n>adjustment</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>solar_altitude</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos="93 "></span></a>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos="94 "></span></a>    <span class=c1># Apply adjustments based on conditions</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos="95 "></span></a>    <span class=n>adjustment</span><span class=p>[</span><span class=n>mask_high</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>adjustment_high</span><span class=p>[</span><span class=n>mask_high</span><span class=p>])</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos="96 "></span></a>    <span class=n>adjustment</span><span class=p>[</span><span class=n>mask_near</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>adjustment_near</span><span class=p>[</span><span class=n>mask_near</span><span class=p>])</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos="97 "></span></a>    <span class=n>adjustment</span><span class=p>[</span><span class=n>mask_below</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>adjustment_below</span><span class=p>[</span><span class=n>mask_below</span><span class=p>])</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos="98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos="99 "></span></a>    <span class=k>return</span> <span class=n>adjustment</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_zenith.calculate_solar_zenith_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_zenith_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_zenith.calculate_solar_zenith_series_noaa title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_zenith_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarZenith>SolarZenith</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar zenith angle for a location over a time series</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_zenith.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarZenithTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_zenith_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=c1># solar_hour_angle_series: SolarHourAngle,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarZenith</span><span class=p>:</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar zenith angle for a location over a time series"""</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>calculate_solar_declination_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=n>calculate_solar_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>    <span class=n>cosine_solar_zenith</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>        <span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>    <span class=p>)</span> <span class=o>+</span> <span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>    <span class=n>solar_zenith_series</span> <span class=o>=</span> <span class=n>SolarZenith</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>arccos</span><span class=p>(</span><span class=n>cosine_solar_zenith</span><span class=p>),</span>  <span class=c1># Important !</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=k>if</span> <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=n>solar_zenith_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>            <span class=n>adjust_solar_zenith_for_atmospheric_refraction_time_series</span><span class=p>(</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>                <span class=n>solar_zenith_series</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>isfinite</span><span class=p>(</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span><span class=p>))</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>            <span class=p>(</span><span class=n>SolarZenith</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span> <span class=o>&lt;=</span> <span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&lt;=</span> <span class=n>SolarZenith</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=p>):</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>                <span class=sa>f</span><span class=s2>"Solar zenith values should be finite numbers and range in [</span><span class=si>{</span><span class=n>SolarZenith</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarZenith</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=si>}</span><span class=s2>] radians"</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>    <span class=k>return</span> <span class=n>solar_zenith_series</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.time_offset> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">time_offset</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.time_offset title="Permanent link"></a></h3> <div class="doc doc-contents"> <p>The time offset based on NOAA's General Solar Position Calculations.</p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.time_offset.calculate_time_offset_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_time_offset_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.time_offset.calculate_time_offset_series_noaa</code>)'>calculate_time_offset_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the variation of the local solar time within a</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.time_offset.calculate_time_offset_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_time_offset_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.time_offset.calculate_time_offset_series_noaa title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_time_offset_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.algorithms.noaa.time_offset.ZONEINFO_UTC>ZONEINFO_UTC</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.TimeOffset>TimeOffset</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the variation of the local solar time within a given timezone for a time series.</p> <p>Calculate the variation of the local solar time, also referred to as <em>time offset</em>, within a timezone for NOAA's General Solar Position Calculations [0]_.</p> <p>The time offset (in minutes) incorporates the Equation of Time and accounts for the variation of the Local Solar Time (LST) within a given timezone due to the longitude variations within the time zone.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><span title=pvgisprototype.Longitude>Longitude</span></code> </td> <td> <div class=doc-md-description> <p>The longitude for calculation in radians (note: differs from the original equation which expects degrees).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>The timestamp to calculate the offset for</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> <p>The timezone</p> </div> </td> <td> <code><span title=pvgisprototype.algorithms.noaa.time_offset.ZONEINFO_UTC>ZONEINFO_UTC</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The data type for the calculations (the default is 'float32').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The backend used for calculations (the default is 'NUMPY').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>TimeOffset</code></td> <td> <code><span title=pvgisprototype.TimeOffset>TimeOffset</span></code> </td> <td> <div class=doc-md-description> <p>The time offset for a single or a series of timestamps.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The equation given in NOAA's General Solar Position Calculations [0]_ is</p> <div class=codehilite><pre><span></span><code><span class=n>time_offset</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>eqtime</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>4</span><span class=o>*</span><span class=n>longitude</span><span class=w> </span><span class=err></span><span class=w> </span><span class=mi>60</span><span class=o>*</span><span class=n>timezone</span>

<span class=n>where</span><span class=w> </span><span class=p>(</span><span class=n>variable</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=ow>and</span><span class=w> </span><span class=n>units</span><span class=p>):</span>
<span class=o>-</span><span class=w> </span><span class=n>time_offset</span><span class=p>,</span><span class=w> </span><span class=n>minutes</span>
<span class=o>-</span><span class=w> </span><span class=n>longitude</span><span class=p>,</span><span class=w> </span><span class=n>degrees</span>
<span class=o>-</span><span class=w> </span><span class=n>timezone</span><span class=p>,</span><span class=w> </span><span class=n>hours</span>
<span class=o>-</span><span class=w> </span><span class=n>eqtime</span><span class=p>,</span><span class=w> </span><span class=n>minutes</span>
</code></pre></div> </details> <details class=see-also open> <summary>See also</summary> <p>pysolar</p> <div class=codehilite><pre><span></span><code>In pysolar the true solar time is calculated as follows :

<span class=s>```</span>
(math.tm_hour(when) * 60 + math.tm_min(when) + 4 * longitude_deg + equation_of_time(math.tm_yday(when)))
<span class=s>```</span>

in which equation the time offset is the last part.

<span class=s>```</span>
4 * longitude_deg + equation_of_time(math.tm_yday(when)))
<span class=s>```</span>
</code></pre></div> <p>Another reference</p> <div class=codehilite><pre><span></span><code>TC = 4 <span class=gs>* (Longitude - LSTM) + EoT</span>

<span class=gs>where:</span>

<span class=gs>- TC        : Time Correction Factor, minutes</span>
<span class=gs>- Longitude : Geographical Longitude, degrees</span>
<span class=gs>- LSTM      : Local Standard Time Meridian, degrees *</span> hours
<span class=k>-</span> EoT       : Equation of Time

    where:
    <span class=k>-</span> <span class=sb>`LSTM = 15 degrees * TUTC`</span>

        where:
        <span class=k>-</span> TUTC = LT - UTC, hours

            where:
            <span class=k>-</span> TUTC : difference of LT from UTC in hours
            <span class=k>-</span> LT    : Local Time
            <span class=k>-</span> UTC   : Universal Coordinated Time

    <span class=k>-</span> The factor 4 (minutes) comes from the fact that the Earth
      rotates 1 every 4 minutes.

    Examples:

        Mount Olympus is UTC + 2, hence LSTM = 15 * 2 = 30 deg. East
</code></pre></div> <p>The time offset in minutes ranges in</p> <div class=codehilite><pre><span></span><code>[ -720 (Longitude) - 720 (Up to -12 TimeZones) - 20 (Equation of Time) = -1460,
  +720 (Longitude) + 840 (Up to +14 TimeZones) + 20 (Equation of Time) = 1580 ]
</code></pre></div> <p>The valid ranges of the components that contribute to the time offset are:</p> <ul> <li> <p>Geographical longitude ranges from west to east in [-180, 180] degrees. A day is approximately 1440 minutes, hence converting the degrees to minutes, the longitude ranges in [-720, 720] minutes.</p> </li> <li> <p>The timezone offset from the Coordinated Universal Time (UTC), considering time zones that are offset by unusual amounts of time from UTC, ranges from west of UTC to east of UTC in [-12, 14] hours or [-720, 840] minutes.</p> </li> <li> <p>The Equation of Time accounts for the variations in the Earth's orbital speed and axial tilt. It varies throughout the year, but is typically within the range of about -20 minutes to +20 minutes.</p> </li> </ul> </details> <details class=references open> <summary>References</summary> <p>.. [0] <a href=https://gml.noaa.gov/grad/solcalc/solareqns.PDF>https://gml.noaa.gov/grad/solcalc/solareqns.PDF</a></p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/noaa/time_offset.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateTimeOffsetTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_time_offset_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>=</span> <span class=n>ZONEINFO_UTC</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>TimeOffset</span><span class=p>:</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=w>    </span><span class=sd>"""Calculate the variation of the local solar time within a</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    given timezone for a time series.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    Calculate the variation of the local solar time, also referred to as _time</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    offset_, within a timezone for NOAA's General Solar Position Calculations</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    [0]_.</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    The time offset (in minutes) incorporates the Equation of Time and</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    accounts for the variation of the Local Solar Time (LST) within a given</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    timezone due to the longitude variations within the time zone.</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    longitude: float</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>        The longitude for calculation in radians (note: differs from the original</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        equation which expects degrees).</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    timestamps: DatetimeIndex</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>        The timestamp to calculate the offset for</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    timezone: ZoneInfo, optional</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>        The timezone</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>        The data type for the calculations (the default is 'float32').</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>        The backend used for calculations (the default is 'NUMPY').</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    verbose: int, optional</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>        Verbosity level</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>    log: int, optional</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>        Log level</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    TimeOffset:</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        The time offset for a single or a series of timestamps.</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>    The equation given in NOAA's General Solar Position Calculations [0]_ is</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>        time_offset = eqtime + 4*longitude  60*timezone</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>        where (variable name and units):</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>        - time_offset, minutes</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>        - longitude, degrees</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>        - timezone, hours</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>        - eqtime, minutes</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>    See also</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    pysolar</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>        In pysolar the true solar time is calculated as follows :</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>        (math.tm_hour(when) * 60 + math.tm_min(when) + 4 * longitude_deg + equation_of_time(math.tm_yday(when)))</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>        in which equation the time offset is the last part.</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>        4 * longitude_deg + equation_of_time(math.tm_yday(when)))</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>    Another reference</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>        TC = 4 * (Longitude - LSTM) + EoT</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>        where:</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>        - TC        : Time Correction Factor, minutes</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>        - Longitude : Geographical Longitude, degrees</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>        - LSTM      : Local Standard Time Meridian, degrees * hours</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>        - EoT       : Equation of Time</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=sd>            where:</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=sd>            - `LSTM = 15 degrees * TUTC`</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=sd>                where:</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a><span class=sd>                - TUTC = LT - UTC, hours</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a><span class=sd>                    where:</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a><span class=sd>                    - TUTC : difference of LT from UTC in hours</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=sd>                    - LT    : Local Time</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a><span class=sd>                    - UTC   : Universal Coordinated Time</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a><span class=sd>            - The factor 4 (minutes) comes from the fact that the Earth</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=sd>              rotates 1 every 4 minutes.</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>            Examples:</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>                Mount Olympus is UTC + 2, hence LSTM = 15 * 2 = 30 deg. East</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=sd>    The time offset in minutes ranges in</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=sd>        [ -720 (Longitude) - 720 (Up to -12 TimeZones) - 20 (Equation of Time) = -1460,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a><span class=sd>          +720 (Longitude) + 840 (Up to +14 TimeZones) + 20 (Equation of Time) = 1580 ]</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=sd>    The valid ranges of the components that contribute to the time offset are:</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a><span class=sd>    - Geographical longitude ranges from west to east in [-180, 180] degrees.</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a><span class=sd>      A day is approximately 1440 minutes, hence converting the degrees to</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=sd>      minutes, the longitude ranges in [-720, 720] minutes.</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a><span class=sd>    - The timezone offset from the Coordinated Universal Time (UTC),</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=sd>      considering time zones that are offset by unusual amounts of time from</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a><span class=sd>      UTC, ranges  from west of UTC to east of UTC in [-12, 14] hours or [-720,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a><span class=sd>      840] minutes.</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a><span class=sd>    - The Equation of Time accounts for the variations in the Earth's orbital</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>      speed and axial tilt. It varies throughout the year, but is typically</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>      within the range of about -20 minutes to +20 minutes.</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>    .. [0] https://gml.noaa.gov/grad/solcalc/solareqns.PDF</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=n>local_standard_time_meridian_minutes_series</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># in UTC the offest is 0</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>    <span class=k>if</span> <span class=n>timezone</span> <span class=ow>and</span> <span class=n>timezone</span> <span class=o>!=</span> <span class=n>ZONEINFO_UTC</span><span class=p>:</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=c1># We need the .tz attribute to compare with the user-requested timezone !</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>tz</span><span class=p>:</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>            <span class=n>timestamps</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>tz_localize</span><span class=p>(</span><span class=n>timezone</span><span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=c1># Explain why this is necessary !-------------- Further Optimisation ?</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=n>unique_timezone_offsets_in_minutes</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>            <span class=n>stamp</span><span class=o>.</span><span class=n>tzinfo</span><span class=p>:</span> <span class=n>stamp</span><span class=o>.</span><span class=n>tzinfo</span><span class=o>.</span><span class=n>utcoffset</span><span class=p>(</span><span class=n>stamp</span><span class=p>)</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>/</span> <span class=mi>60</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>            <span class=k>for</span> <span class=n>stamp</span> <span class=ow>in</span> <span class=n>timestamps</span> <span class=k>if</span> <span class=n>stamp</span><span class=o>.</span><span class=n>tzinfo</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=p>}</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=n>local_standard_time_meridian_minutes_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>            <span class=p>[</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>                <span class=n>unique_timezone_offsets_in_minutes</span><span class=p>[</span><span class=n>stamp</span><span class=o>.</span><span class=n>tzinfo</span><span class=p>]</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>                <span class=k>for</span> <span class=n>stamp</span> <span class=ow>in</span> <span class=n>timestamps</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>                <span class=k>if</span> <span class=n>stamp</span><span class=o>.</span><span class=n>tzinfo</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>            <span class=p>],</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>            <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>        <span class=c1># # ------------------------------------------- Further Optimisation ?</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>    <span class=n>equation_of_time_series</span> <span class=o>=</span> <span class=n>calculate_equation_of_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>    <span class=n>time_offset_series_in_minutes</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>        <span class=n>longitude</span><span class=o>.</span><span class=n>as_minutes</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>        <span class=o>-</span> <span class=n>local_standard_time_meridian_minutes_series</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>        <span class=o>+</span> <span class=n>equation_of_time_series</span><span class=o>.</span><span class=n>minutes</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>numpy</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>            <span class=p>(</span><span class=n>TimeOffset</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span> <span class=o>&lt;=</span> <span class=n>time_offset_series_in_minutes</span><span class=p>)</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>time_offset_series_in_minutes</span> <span class=o>&lt;=</span> <span class=n>TimeOffset</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=p>)</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>        <span class=p>):</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>            <span class=n>index_of_out_of_range_values</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>                <span class=p>(</span><span class=n>time_offset_series_in_minutes</span> <span class=o>&lt;</span> <span class=n>TimeOffset</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span><span class=p>)</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>                <span class=o>|</span> <span class=p>(</span><span class=n>time_offset_series_in_minutes</span> <span class=o>&gt;</span> <span class=n>TimeOffset</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=p>)</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>            <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>time_offset_series_in_minutes</span><span class=p>[</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>                <span class=n>index_of_out_of_range_values</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>            <span class=p>]</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>                <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>                <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>TimeOffset</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>TimeOffset</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=si>}</span><span class=s2>] minutes"</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>                <span class=sa>f</span><span class=s2>" in [code]time_offset_series_in_minutes[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>time_offset_series_in_minutes</span><span class=p>,</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>    <span class=k>return</span> <span class=n>TimeOffset</span><span class=p>(</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>time_offset_series_in_minutes</span><span class=p>,</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>MINUTES</span><span class=p>,</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=s2>"NOAA"</span><span class=p>,</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"NOAA"</span><span class=p>,</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.pelland> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">pelland</span> <a class=headerlink href=#pvgisprototype.algorithms.pelland title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pelland.spectral_effect title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">spectral_effect</span> (<code>pvgisprototype.algorithms.pelland.spectral_effect</code>)'>spectral_effect</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.pelland.spectral_effect> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">spectral_effect</span> <a class=headerlink href=#pvgisprototype.algorithms.pelland.spectral_effect title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pelland.spectral_effect.calculate_spectral_factor_pelland title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_spectral_factor_pelland</span> (<code>pvgisprototype.algorithms.pelland.spectral_effect.calculate_spectral_factor_pelland</code>)'>calculate_spectral_factor_pelland</a></code></td> <td> <div class=doc-md-description> <p>Calculate the spectral factor for each PV technology based on</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.pelland.spectral_effect.calculate_spectral_factor_pelland> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_spectral_factor_pelland</span> <a class=headerlink href=#pvgisprototype.algorithms.pelland.spectral_effect.calculate_spectral_factor_pelland title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_spectral_factor_pelland</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>irradiance</span><span class=p>:</span> <span class=n><span title=xarray.DataArray>DataArray</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>responsivity</span><span class=p>:</span> <span class=n><span title=pandas.DataFrame>DataFrame</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>reference_spectrum</span><span class=p>:</span> <span class=n><span title=pandas.DataFrame>DataFrame</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pandas.DataFrame>DataFrame</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the spectral factor for each PV technology based on Pelland 2022.</p> <details class=note open> <summary>Notes</summary> <p>Some Python source code shared via personal communication.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/pelland/spectral_effect.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_spectral_factor_pelland</span><span class=p>(</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a>    <span class=n>irradiance</span><span class=p>:</span> <span class=n>DataArray</span><span class=p>,</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a>    <span class=n>responsivity</span><span class=p>:</span> <span class=n>DataFrame</span><span class=p>,</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a>    <span class=n>reference_spectrum</span><span class=p>:</span> <span class=n>DataFrame</span><span class=p>,</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a><span class=w>    </span><span class=sd>"""Calculate the spectral factor for each PV technology based on</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a><span class=sd>    Pelland 2022.</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=sd>    Some Python source code shared via personal communication.</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>    <span class=c1># Verify the reference spectrum is valid (no zero or near-zero values) ?</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>    <span class=c1># if (reference_spectrum &lt;= 0).any():</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>    <span class=c1>#     raise ValueError(</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=c1>#         "The reference spectrum contains zero or negative values, which are invalid."</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=c1>#     )</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=c1># else:</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=c1>#     print(f'Reference spectrum input : {reference_spectrum}')</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=c1># Align wavelengths (columns) between dataframes</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=c1># if not isinstance(irradiance, DataFrame):</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=c1>#     irradiance = irradiance.to_dataframe()</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=c1># wavelengths = irradiance.columns.intersection(responsivity.index).intersection(</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=c1>#     reference_spectrum.columns</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=c1># )</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=kn>import</span><span class=w> </span><span class=nn>numpy</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>        <span class=sa>f</span><span class=s2>"Wavelengths in `irradiance` input : </span><span class=si>{</span><span class=n>irradiance</span><span class=o>.</span><span class=n>center_wavelength</span><span class=o>.</span><span class=n>values</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>        <span class=sa>f</span><span class=s2>"Wavelengths in `responsivity` input : </span><span class=si>{</span><span class=n>responsivity</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>        <span class=sa>f</span><span class=s2>"Wavelengths in `reference_spectrum` input : </span><span class=si>{</span><span class=n>reference_spectrum</span><span class=o>.</span><span class=n>columns</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>    <span class=c1># Common wavelength range</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>    <span class=n>common_wavelengths</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>intersect1d</span><span class=p>(</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>        <span class=n>irradiance</span><span class=o>.</span><span class=n>center_wavelength</span><span class=o>.</span><span class=n>values</span><span class=p>,</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>        <span class=n>numpy</span><span class=o>.</span><span class=n>intersect1d</span><span class=p>(</span><span class=n>responsivity</span><span class=o>.</span><span class=n>center_wavelength</span><span class=p>,</span> <span class=n>reference_spectrum</span><span class=o>.</span><span class=n>columns</span><span class=p>),</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>        <span class=sa>f</span><span class=s2>"Intersection of wavelengths across input data : </span><span class=si>{</span><span class=n>common_wavelengths</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>    <span class=c1># in Pelland : useful reference spectrum &gt; average over the reference spectrum</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=n>responsivity_selected</span> <span class=o>=</span> <span class=n>responsivity</span><span class=o>.</span><span class=n>sel</span><span class=p>(</span><span class=n>center_wavelength</span><span class=o>=</span><span class=n>common_wavelengths</span><span class=p>)</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Selected responsivity data : </span><span class=si>{</span><span class=n>responsivity_selected</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>    <span class=n>reference_spectrum_selected</span> <span class=o>=</span> <span class=n>reference_spectrum</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s2>"global"</span><span class=p>,</span> <span class=n>common_wavelengths</span><span class=p>]</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Selected reference spectrum data : </span><span class=si>{</span><span class=n>reference_spectrum_selected</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>    <span class=c1># in Pelland 2022 : useful fraction of reference spectrum</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>    <span class=n>reference_current_density</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>responsivity_selected</span> <span class=o>*</span> <span class=n>reference_spectrum_selected</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=n>reference_spectrum_selected</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=sa>f</span><span class=s2>"Reference Current Density : </span><span class=si>{</span><span class=n>reference_current_density</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>"[bold][yellow]Reference[/yellow] current density[/bold] : </span><span class=si>{</span><span class=n>reference_current_density</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=c1># useful irradiance (time-varying)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=n>irradiance_selected</span> <span class=o>=</span> <span class=n>irradiance</span><span class=o>.</span><span class=n>sel</span><span class=p>(</span><span class=n>center_wavelength</span><span class=o>=</span><span class=n>common_wavelengths</span><span class=p>)</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Selected irradiance data : </span><span class=si>{</span><span class=n>irradiance_selected</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=n>sum_of_responsivity_by_irradiance</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>        <span class=n>responsivity_selected</span> <span class=o>*</span> <span class=n>irradiance_selected</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dim</span><span class=o>=</span><span class=s2>"center_wavelength"</span><span class=p>)</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=sa>f</span><span class=s2>"Sum of responsivity * irradiance : </span><span class=si>{</span><span class=n>sum_of_responsivity_by_irradiance</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=n>sum_of_irradiance</span> <span class=o>=</span> <span class=p>(</span><span class=n>irradiance_selected</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dim</span><span class=o>=</span><span class=s2>"center_wavelength"</span><span class=p>)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Sum of irradiance : </span><span class=si>{</span><span class=n>sum_of_irradiance</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=n>observed_current_density</span> <span class=o>=</span> <span class=p>(</span><span class=n>responsivity_selected</span> <span class=o>*</span> <span class=n>irradiance_selected</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>dim</span><span class=o>=</span><span class=s2>"center_wavelength"</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=p>)</span> <span class=o>/</span> <span class=n>irradiance_selected</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dim</span><span class=o>=</span><span class=s2>"center_wavelength"</span><span class=p>)</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Current Density of Observed Irradiance : </span><span class=si>{</span><span class=n>observed_current_density</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=n>spectral_factor</span> <span class=o>=</span> <span class=n>observed_current_density</span> <span class=o>/</span> <span class=n>reference_current_density</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Spectral factor = </span><span class=si>{</span><span class=n>spectral_factor</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>components_container</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=s2>"Metadata"</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=p>{},</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=s2>"Spectral factor"</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>            <span class=n>TITLE_KEY_NAME</span><span class=p>:</span> <span class=n>SPECTRAL_FACTOR_NAME</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>            <span class=n>SPECTRAL_FACTOR_COLUMN_NAME</span><span class=p>:</span> <span class=n>spectral_factor</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=p>},</span>  <span class=c1># if verbose &gt; 0 else {},</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=s2>"Inputs"</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>            <span class=s2>"Irradiance"</span><span class=p>:</span> <span class=n>irradiance</span><span class=p>,</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>            <span class=s2>"Responsivity"</span><span class=p>:</span> <span class=n>responsivity</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>            <span class=s2>"Reference spectrum"</span><span class=p>:</span> <span class=n>reference_spectrum</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=p>},</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=s2>"Intermediate quantities"</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>            <span class=s2>"Common spectral wavelengths"</span><span class=p>:</span> <span class=n>common_wavelengths</span><span class=p>,</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>            <span class=s2>"Selected spectral responsivity"</span><span class=p>:</span> <span class=n>responsivity_selected</span><span class=p>,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>            <span class=s2>"Selected observed irradiance"</span><span class=p>:</span> <span class=n>irradiance_selected</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>            <span class=s2>"Selected reference spectrum"</span><span class=p>:</span> <span class=n>reference_spectrum_selected</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=p>},</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=s2>"Sum of quantities"</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>            <span class=s2>"Sum of Irradiance"</span><span class=p>:</span> <span class=n>sum_of_irradiance</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>            <span class=s2>"Sum of responsivity by irradiance"</span><span class=p>:</span> <span class=n>sum_of_responsivity_by_irradiance</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>            <span class=s2>"Sum of Reference spectrum"</span><span class=p>:</span> <span class=n>reference_spectrum</span><span class=o>.</span><span class=n>sum</span><span class=p>(),</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=p>},</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=c1># "Energy" : lambda: {</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=c1>#     'Reference energy': total_reference_energy,</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>        <span class=c1>#     'Observed energy': total_observed_energy,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=c1>#     },</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=s2>"Current density"</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>            <span class=s2>"Reference current"</span><span class=p>:</span> <span class=n>reference_current_density</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>            <span class=s2>"Observed current"</span><span class=p>:</span> <span class=n>observed_current_density</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=p>},</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=c1># if verbose &gt; 1</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=c1># else {},</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=n>components</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>component</span> <span class=ow>in</span> <span class=n>components_container</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>components</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>component</span><span class=p>())</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=k>return</span> <span class=n>SpectralFactorSeries</span><span class=p>(</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>spectral_factor</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>UNITLESS</span><span class=p>,</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>        <span class=n>spectral_factor_algorithm</span><span class=o>=</span><span class=s2>"Pelland 2022"</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>        <span class=n>components</span><span class=o>=</span><span class=n>components</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">pvlib</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib.solar_altitude title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_altitude</span> (<code>pvgisprototype.algorithms.pvlib.solar_altitude</code>)'>solar_altitude</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib.solar_azimuth title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_azimuth</span> (<code>pvgisprototype.algorithms.pvlib.solar_azimuth</code>)'>solar_azimuth</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib.solar_declination title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_declination</span> (<code>pvgisprototype.algorithms.pvlib.solar_declination</code>)'>solar_declination</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib.solar_hour_angle title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_hour_angle</span> (<code>pvgisprototype.algorithms.pvlib.solar_hour_angle</code>)'>solar_hour_angle</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib.solar_incidence title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_incidence</span> (<code>pvgisprototype.algorithms.pvlib.solar_incidence</code>)'>solar_incidence</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib.solar_zenith title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_zenith</span> (<code>pvgisprototype.algorithms.pvlib.solar_zenith</code>)'>solar_zenith</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib.solar_altitude> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_altitude</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib.solar_altitude title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib.solar_altitude.calculate_solar_altitude_series_pvlib title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_altitude_series_pvlib</span> (<code>pvgisprototype.algorithms.pvlib.solar_altitude.calculate_solar_altitude_series_pvlib</code>)'>calculate_solar_altitude_series_pvlib</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar altitude ()</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib.solar_altitude.calculate_solar_altitude_series_pvlib> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_altitude_series_pvlib</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib.solar_altitude.calculate_solar_altitude_series_pvlib title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_altitude_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar altitude ()</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/pvlib/solar_altitude.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a><span class=c1># @validate_with_pydantic(CalculateSolarAltitudePVLIBInputModel)</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_altitude_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>  <span class=c1># degrees</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>  <span class=c1># degrees</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>    <span class=c1># timezone: ZoneInfo,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarAltitude</span><span class=p>:</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar altitude ()"""</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>    <span class=n>solar_position</span> <span class=o>=</span> <span class=n>get_solarposition</span><span class=p>(</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>        <span class=n>timestamps</span><span class=p>,</span> <span class=n>latitude</span><span class=o>.</span><span class=n>degrees</span><span class=p>,</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>    <span class=n>solar_altitude_series</span> <span class=o>=</span> <span class=n>solar_position</span><span class=p>[</span><span class=s2>"apparent_elevation"</span><span class=p>]</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>numpy</span><span class=o>.</span><span class=n>all</span><span class=p>(</span><span class=n>numpy</span><span class=o>.</span><span class=n>isfinite</span><span class=p>(</span><span class=n>solar_altitude_series</span><span class=p>))</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>numpy</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>        <span class=p>(</span><span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>min_degrees</span> <span class=o>&lt;=</span> <span class=n>solar_altitude_series</span><span class=p>)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>        <span class=o>&amp;</span> <span class=p>(</span><span class=n>solar_altitude_series</span> <span class=o>&lt;=</span> <span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>max_degrees</span><span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>            <span class=sa>f</span><span class=s2>"Solar altitude values should be finite numbers and range in [</span><span class=si>{</span><span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>min_degrees</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarAltitude</span><span class=p>()</span><span class=o>.</span><span class=n>max_degrees</span><span class=si>}</span><span class=s2>] degrees"</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>    <span class=k>return</span> <span class=n>SolarAltitude</span><span class=p>(</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>DEGREES</span><span class=p>,</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=s2>"pvlib"</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"pvlib"</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib.solar_azimuth> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_azimuth</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib.solar_azimuth title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib.solar_azimuth.calculate_solar_azimuth_series_pvlib title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_azimuth_series_pvlib</span> (<code>pvgisprototype.algorithms.pvlib.solar_azimuth.calculate_solar_azimuth_series_pvlib</code>)'>calculate_solar_azimuth_series_pvlib</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar azimuth ()</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib.solar_azimuth.calculate_solar_azimuth_series_pvlib> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_azimuth_series_pvlib</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib.solar_azimuth.calculate_solar_azimuth_series_pvlib title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_azimuth_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar azimuth ()</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/pvlib/solar_azimuth.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a><span class=c1># @validate_with_pydantic(CalculateSolarAzimuthPVLIBInputModel)</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_azimuth_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>  <span class=c1># degrees</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>  <span class=c1># degrees</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>    <span class=c1># timezone: ZoneInfo,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarAzimuth</span><span class=p>:</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar azimuth ()"""</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>    <span class=n>solar_position</span> <span class=o>=</span> <span class=n>pvlib</span><span class=o>.</span><span class=n>solarposition</span><span class=o>.</span><span class=n>get_solarposition</span><span class=p>(</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>        <span class=n>timestamps</span><span class=p>,</span> <span class=n>latitude</span><span class=o>.</span><span class=n>degrees</span><span class=p>,</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>    <span class=n>azimuth_origin</span> <span class=o>=</span> <span class=s2>"North"</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>solar_position</span><span class=p>[</span><span class=s2>"azimuth"</span><span class=p>]</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>numpy</span><span class=o>.</span><span class=n>all</span><span class=p>(</span><span class=n>numpy</span><span class=o>.</span><span class=n>isfinite</span><span class=p>(</span><span class=n>solar_azimuth_series</span><span class=p>))</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>numpy</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>        <span class=p>(</span><span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_degrees</span> <span class=o>&lt;=</span> <span class=n>solar_azimuth_series</span><span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>        <span class=o>&amp;</span> <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&lt;=</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_degrees</span><span class=p>)</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>            <span class=sa>f</span><span class=s2>"Solar azimuth values should be finite numbers and range in [</span><span class=si>{</span><span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_degrees</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_degrees</span><span class=si>}</span><span class=s2>] degrees"</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>    <span class=k>return</span> <span class=n>SolarAzimuth</span><span class=p>(</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>DEGREES</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=s2>"pvlib"</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"pvlib"</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>        <span class=n>origin</span><span class=o>=</span><span class=n>azimuth_origin</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib.solar_declination> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_declination</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib.solar_declination title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib.solar_declination.calculate_solar_declination_series_pvlib title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_declination_series_pvlib</span> (<code>pvgisprototype.algorithms.pvlib.solar_declination.calculate_solar_declination_series_pvlib</code>)'>calculate_solar_declination_series_pvlib</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar declination in radians</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib.solar_declination.calculate_solar_declination_series_pvlib> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_declination_series_pvlib</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib.solar_declination.calculate_solar_declination_series_pvlib title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_declination_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarDeclination>SolarDeclination</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar declination in radians</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/pvlib/solar_declination.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarDeclinationSeriesPVLIBInput</span><span class=p>)</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_declination_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarDeclination</span><span class=p>:</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar declination in radians"""</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>    <span class=n>days_of_year</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>dayofyear</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>pvlib</span><span class=o>.</span><span class=n>solarposition</span><span class=o>.</span><span class=n>declination_spencer71</span><span class=p>(</span><span class=n>days_of_year</span><span class=p>)</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>    <span class=c1># solar_declination = pvlib.solarposition.declination_spencer71(doy)</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>    <span class=c1># if (</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>    <span class=c1>#         not isfinite(solar_declination.degrees)</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>    <span class=c1>#         or not solar_declination.min_degrees &lt;= solar_declination.degrees &lt;= solar_declination.max_degrees</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>    <span class=c1># ):</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a>    <span class=c1>#         raise ValueError(</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>    <span class=c1>#         f"The calculated solar declination angle {solar_declination.degrees} is out of the expected range\</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>    <span class=c1>#         [{solar_declination.min_degrees}, {solar_declination.max_degrees}] degrees"</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>    <span class=c1>#         )</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>    <span class=k>return</span> <span class=n>SolarDeclination</span><span class=p>(</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>values</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=s2>"pvlib (Spencer, 1971)"</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"pvlib"</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib.solar_hour_angle> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_hour_angle</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib.solar_hour_angle title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib.solar_hour_angle.calculate_solar_hour_angle_series_pvlib title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_hour_angle_series_pvlib</span> (<code>pvgisprototype.algorithms.pvlib.solar_hour_angle.calculate_solar_hour_angle_series_pvlib</code>)'>calculate_solar_hour_angle_series_pvlib</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar hour angle in radians.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib.solar_hour_angle.calculate_solar_hour_angle_series_pvlib> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_hour_angle_series_pvlib</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib.solar_hour_angle.calculate_solar_hour_angle_series_pvlib title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_hour_angle_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarHourAngle>SolarHourAngle</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar hour angle in radians.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/pvlib/solar_hour_angle.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>SolarHourAngleSeriesPVLIBInput</span><span class=p>)</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_hour_angle_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarHourAngle</span><span class=p>:</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar hour angle in radians."""</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>    <span class=n>equation_of_time_series</span> <span class=o>=</span> <span class=n>pvlib</span><span class=o>.</span><span class=n>solarposition</span><span class=o>.</span><span class=n>equation_of_time_spencer71</span><span class=p>(</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>        <span class=n>timestamps</span><span class=o>.</span><span class=n>dayofyear</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=n>pvlib</span><span class=o>.</span><span class=n>solarposition</span><span class=o>.</span><span class=n>hour_angle</span><span class=p>(</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>        <span class=n>timestamps</span><span class=p>,</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span><span class=p>,</span> <span class=n>equation_of_time</span><span class=o>=</span><span class=n>equation_of_time_series</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>numpy</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>        <span class=p>(</span><span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>min_degrees</span> <span class=o>&lt;=</span> <span class=n>solar_hour_angle_series</span><span class=p>)</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>        <span class=o>&amp;</span> <span class=p>(</span><span class=n>solar_hour_angle_series</span> <span class=o>&lt;=</span> <span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>max_degrees</span><span class=p>)</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>        <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>solar_hour_angle_series</span><span class=p>[</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>            <span class=o>~</span><span class=p>(</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>                <span class=p>(</span><span class=o>-</span><span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>min_degrees</span> <span class=o>&lt;=</span> <span class=n>solar_hour_angle_series</span><span class=p>)</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>                <span class=o>&amp;</span> <span class=p>(</span><span class=n>solar_hour_angle_series</span> <span class=o>&lt;=</span> <span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>max_degrees</span><span class=p>)</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>        <span class=p>]</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>            <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>            <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>min_degrees</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>max_degrees</span><span class=si>}</span><span class=s2>] degrees"</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>            <span class=sa>f</span><span class=s2>" in [code]solar_hour_angle_series[/code] : </span><span class=si>{</span><span class=n>numpy</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>out_of_range_values</span><span class=p>)</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos="81 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos="82 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos="83 "></span></a>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos="84 "></span></a>    <span class=k>return</span> <span class=n>SolarHourAngle</span><span class=p>(</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos="85 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos="86 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>DEGREES</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos="87 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>pvlib</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos="88 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>pvlib</span> <span class=o>+</span> <span class=s2>" (Spencer 1971)"</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos="89 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib.solar_incidence> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_incidence</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib.solar_incidence title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib.solar_incidence.calculate_solar_incidence_series_pvlib title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_incidence_series_pvlib</span> (<code>pvgisprototype.algorithms.pvlib.solar_incidence.calculate_solar_incidence_series_pvlib</code>)'>calculate_solar_incidence_series_pvlib</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar incidence ()</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib.solar_incidence.calculate_solar_incidence_series_pvlib> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_incidence_series_pvlib</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib.solar_incidence.calculate_solar_incidence_series_pvlib title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_incidence_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceOrientation>SurfaceOrientation</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_ORIENTATION_DEFAULT>SURFACE_ORIENTATION_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SurfaceTilt>SurfaceTilt</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.SURFACE_TILT_DEFAULT>SURFACE_TILT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span> <span class=o>=</span> <span class=n><a class="autorefs autorefs-internal" href=../api/#pvgisprototype.api.datetime.now.now_utc_datetimezone title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">now_utc_datetimezone</span> (<code>pvgisprototype.api.datetime.now.now_utc_datetimezone</code>)'>now_utc_datetimezone</a></span><span class=p>(),</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>complementary_incidence_angle</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT>COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>zero_negative_solar_incidence_angle</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT>ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarIncidence>SolarIncidence</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar incidence ()</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/pvlib/solar_incidence.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=c1># @validate_with_pydantic(CalculateSolarIncidencePVLIBInputModel)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_incidence_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>surface_orientation</span><span class=p>:</span> <span class=n>SurfaceOrientation</span> <span class=o>=</span> <span class=n>SURFACE_ORIENTATION_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=n>surface_tilt</span><span class=p>:</span> <span class=n>SurfaceTilt</span> <span class=o>=</span> <span class=n>SURFACE_TILT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span> <span class=o>=</span> <span class=n>now_utc_datetimezone</span><span class=p>(),</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=c1># adjust_for_atmospheric_refraction: bool = ATMOSPHERIC_REFRACTION_FLAG_DEFAULT,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=n>complementary_incidence_angle</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>COMPLEMENTARY_INCIDENCE_ANGLE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>    <span class=n>zero_negative_solar_incidence_angle</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>ZERO_NEGATIVE_INCIDENCE_ANGLE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarIncidence</span><span class=p>:</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar incidence ()"""</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>    <span class=n>solar_position</span> <span class=o>=</span> <span class=n>pvlib</span><span class=o>.</span><span class=n>solarposition</span><span class=o>.</span><span class=n>get_solarposition</span><span class=p>(</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>        <span class=n>timestamps</span><span class=p>,</span> <span class=n>latitude</span><span class=o>.</span><span class=n>degrees</span><span class=p>,</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=n>solar_zenith_series</span> <span class=o>=</span> <span class=n>calculate_solar_zenith_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>calculate_solar_azimuth_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>    <span class=n>solar_incidence_series_in_degrees</span> <span class=o>=</span> <span class=n>pvlib</span><span class=o>.</span><span class=n>irradiance</span><span class=o>.</span><span class=n>aoi</span><span class=p>(</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>        <span class=n>surface_tilt</span><span class=o>=</span><span class=n>surface_tilt</span><span class=o>.</span><span class=n>degrees</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>        <span class=n>surface_azimuth</span><span class=o>=</span><span class=n>surface_orientation</span><span class=o>.</span><span class=n>degrees</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=n>solar_zenith</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>degrees</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=n>solar_azimuth</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>degrees</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=c1># solar_incidence_series = solar_position["apparent_elevation"].values</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>incidence_angle_definition</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>definition</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=n>incidence_angle_description</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>description</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=k>if</span> <span class=n>complementary_incidence_angle</span><span class=p>:</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>            <span class=sa>f</span><span class=s2>":information: Converting solar incidence angle to </span><span class=si>{</span><span class=n>COMPLEMENTARY_INCIDENCE_ANGLE_DEFINITION</span><span class=si>}</span><span class=s2>..."</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>            <span class=n>alt</span><span class=o>=</span><span class=sa>f</span><span class=s2>":information: [bold][magenta]Converting[/magenta] solar incidence angle to </span><span class=si>{</span><span class=n>COMPLEMENTARY_INCIDENCE_ANGLE_DEFINITION</span><span class=si>}</span><span class=s2>[/bold]..."</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=n>solar_incidence_series_in_degrees</span> <span class=o>=</span> <span class=mi>90</span> <span class=o>-</span> <span class=n>solar_incidence_series_in_degrees</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=n>incidence_angle_definition</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>definition_complementary</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>incidence_angle_description</span> <span class=o>=</span> <span class=n>SolarIncidence</span><span class=p>()</span><span class=o>.</span><span class=n>description_complementary</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=k>if</span> <span class=n>zero_negative_solar_incidence_angle</span><span class=p>:</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=c1># set negative or below horizon angles ( == solar zenith &gt; 90 ) to 0 !</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=n>solar_incidence_series_in_degrees</span><span class=p>[</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>            <span class=p>(</span><span class=n>solar_incidence_series_in_degrees</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>degrees</span> <span class=o>&gt;</span> <span class=mi>90</span><span class=p>)</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=p>]</span> <span class=o>=</span> <span class=n>NO_SOLAR_INCIDENCE</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_incidence_series_in_degrees</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>    <span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.constants</span><span class=w> </span><span class=kn>import</span> <span class=n>DEGREES</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>    <span class=k>return</span> <span class=n>SolarIncidence</span><span class=p>(</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_incidence_series_in_degrees</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>DEGREES</span><span class=p>,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>solar_solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>incidence_algorithm</span><span class=o>=</span><span class=n>SolarIncidenceModel</span><span class=o>.</span><span class=n>pvlib</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=n>definition</span><span class=o>=</span><span class=n>incidence_angle_definition</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=n>description</span><span class=o>=</span><span class=n>incidence_angle_description</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=n>azimuth_origin</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>origin</span><span class=p>,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib.solar_zenith> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_zenith</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib.solar_zenith title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.pvlib.solar_zenith.calculate_solar_zenith_series_pvlib title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_zenith_series_pvlib</span> (<code>pvgisprototype.algorithms.pvlib.solar_zenith.calculate_solar_zenith_series_pvlib</code>)'>calculate_solar_zenith_series_pvlib</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar azimith () in radians</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.pvlib.solar_zenith.calculate_solar_zenith_series_pvlib> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_zenith_series_pvlib</span> <a class=headerlink href=#pvgisprototype.algorithms.pvlib.solar_zenith.calculate_solar_zenith_series_pvlib title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_zenith_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/datetime.html#datetime.datetime title="<code>datetime.datetime</code>">datetime</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarZenith>SolarZenith</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar azimith () in radians</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/pvlib/solar_zenith.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a><span class=c1># @validate_with_pydantic(CalculateSolarZenithPVLIBInputModel)</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_zenith_series_pvlib</span><span class=p>(</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>  <span class=c1># degrees</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>  <span class=c1># degrees</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>datetime</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>    <span class=c1># timezone: ZoneInfo,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarZenith</span><span class=p>:</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar azimith () in radians"""</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>    <span class=n>solar_position</span> <span class=o>=</span> <span class=n>pvlib</span><span class=o>.</span><span class=n>solarposition</span><span class=o>.</span><span class=n>get_solarposition</span><span class=p>(</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>        <span class=n>timestamps</span><span class=p>,</span> <span class=n>latitude</span><span class=o>.</span><span class=n>degrees</span><span class=p>,</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>    <span class=n>solar_zenith_series</span> <span class=o>=</span> <span class=n>solar_position</span><span class=p>[</span><span class=s2>"zenith"</span><span class=p>]</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>numpy</span><span class=o>.</span><span class=n>all</span><span class=p>(</span><span class=n>numpy</span><span class=o>.</span><span class=n>isfinite</span><span class=p>(</span><span class=n>solar_zenith_series</span><span class=p>))</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>numpy</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>        <span class=p>(</span><span class=n>SolarZenith</span><span class=p>()</span><span class=o>.</span><span class=n>min_degrees</span> <span class=o>&lt;=</span> <span class=n>solar_zenith_series</span><span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>        <span class=o>&amp;</span> <span class=p>(</span><span class=n>solar_zenith_series</span> <span class=o>&lt;=</span> <span class=n>SolarZenith</span><span class=p>()</span><span class=o>.</span><span class=n>max_degrees</span><span class=p>)</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>            <span class=sa>f</span><span class=s2>"Solar zenith values should be finite numbers and range in [</span><span class=si>{</span><span class=n>SolarZenith</span><span class=p>()</span><span class=o>.</span><span class=n>min_degrees</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarZenith</span><span class=p>()</span><span class=o>.</span><span class=n>max_degrees</span><span class=si>}</span><span class=s2>] degrees"</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>    <span class=k>return</span> <span class=n>SolarZenith</span><span class=p>(</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=p>,</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>DEGREES</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=s2>"pvlib"</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"pvlib"</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.skyfield> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">skyfield</span> <a class=headerlink href=#pvgisprototype.algorithms.skyfield title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.skyfield.solar_geometry title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_geometry</span> (<code>pvgisprototype.algorithms.skyfield.solar_geometry</code>)'>solar_geometry</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.skyfield.solar_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_time</span> (<code>pvgisprototype.algorithms.skyfield.solar_time</code>)'>solar_time</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.skyfield.sunrise_and_sunset title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">sunrise_and_sunset</span> (<code>pvgisprototype.algorithms.skyfield.sunrise_and_sunset</code>)'>sunrise_and_sunset</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.skyfield.solar_geometry> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_geometry</span> <a class=headerlink href=#pvgisprototype.algorithms.skyfield.solar_geometry title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_altitude_azimuth_skyfield title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_altitude_azimuth_skyfield</span> (<code>pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_altitude_azimuth_skyfield</code>)'>calculate_solar_altitude_azimuth_skyfield</a></code></td> <td> <div class=doc-md-description> <p>Calculate sun position</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_hour_angle_declination_skyfield title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_hour_angle_declination_skyfield</span> (<code>pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_hour_angle_declination_skyfield</code>)'>calculate_solar_hour_angle_declination_skyfield</a></code></td> <td> <div class=doc-md-description> <p>Calculate the hour angle '</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_position_skyfield title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_position_skyfield</span> (<code>pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_position_skyfield</code>)'>calculate_solar_position_skyfield</a></code></td> <td> <div class=doc-md-description> <p>Calculate sun position above the local horizon using Skyfield.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_altitude_azimuth_skyfield> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_altitude_azimuth_skyfield</span> <a class=headerlink href=#pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_altitude_azimuth_skyfield title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_altitude_azimuth_skyfield</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamp</span><span class=p>:</span> <span class=n><span title=pandas.Timestamp>Timestamp</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.Tuple title="<code>typing.Tuple</code>">Tuple</a></span><span class=p>[</span><span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span><span class=p>,</span> <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span><span class=p>]</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate sun position</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/skyfield/solar_geometry.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarAltitudeAzimuthSkyfieldInputModel</span><span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_altitude_azimuth_skyfield</span><span class=p>(</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>timestamp</span><span class=p>:</span> <span class=n>Timestamp</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>SolarAltitude</span><span class=p>,</span> <span class=n>SolarAzimuth</span><span class=p>]:</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=w>    </span><span class=sd>"""Calculate sun position"""</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=n>solar_position</span> <span class=o>=</span> <span class=n>calculate_solar_position_skyfield</span><span class=p>(</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=n>timestamp</span><span class=o>=</span><span class=n>timestamp</span><span class=p>,</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=n>solar_altitude</span><span class=p>,</span> <span class=n>solar_azimuth</span><span class=p>,</span> <span class=n>distance_to_sun</span> <span class=o>=</span> <span class=n>solar_position</span><span class=o>.</span><span class=n>altaz</span><span class=p>()</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>    <span class=n>solar_altitude</span> <span class=o>=</span> <span class=n>SolarAltitude</span><span class=p>(</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_altitude</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=s2>"Skyfield"</span><span class=p>,</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"Skyfield"</span><span class=p>,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>    <span class=n>solar_azimuth</span> <span class=o>=</span> <span class=n>SolarAzimuth</span><span class=p>(</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_azimuth</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=s2>"Skyfield"</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"Skyfield"</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=ow>not</span> <span class=n>isfinite</span><span class=p>(</span><span class=n>solar_azimuth</span><span class=o>.</span><span class=n>degrees</span><span class=p>)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>        <span class=ow>or</span> <span class=ow>not</span> <span class=n>solar_azimuth</span><span class=o>.</span><span class=n>min_degrees</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=o>&lt;=</span> <span class=n>solar_azimuth</span><span class=o>.</span><span class=n>degrees</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=o>&lt;=</span> <span class=n>solar_azimuth</span><span class=o>.</span><span class=n>max_degrees</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>            <span class=sa>f</span><span class=s2>"The calculated solar azimuth angle </span><span class=si>{</span><span class=n>solar_azimuth</span><span class=o>.</span><span class=n>degrees</span><span class=si>}</span><span class=s2> is out of the expected range</span><span class=se>\</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=s2>            [</span><span class=si>{</span><span class=n>solar_azimuth</span><span class=o>.</span><span class=n>min_degrees</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>solar_azimuth</span><span class=o>.</span><span class=n>max_degrees</span><span class=si>}</span><span class=s2>] degrees"</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=ow>not</span> <span class=n>isfinite</span><span class=p>(</span><span class=n>solar_altitude</span><span class=o>.</span><span class=n>degrees</span><span class=p>)</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=ow>or</span> <span class=ow>not</span> <span class=n>solar_altitude</span><span class=o>.</span><span class=n>min_degrees</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=o>&lt;=</span> <span class=n>solar_altitude</span><span class=o>.</span><span class=n>degrees</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=o>&lt;=</span> <span class=n>solar_altitude</span><span class=o>.</span><span class=n>max_degrees</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>            <span class=sa>f</span><span class=s2>"The calculated solar altitude angle </span><span class=si>{</span><span class=n>solar_altitude</span><span class=o>.</span><span class=n>degrees</span><span class=si>}</span><span class=s2> is out of the expected range</span><span class=se>\</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=s2>            [</span><span class=si>{</span><span class=n>solar_altitude</span><span class=o>.</span><span class=n>min_degrees</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>solar_altitude</span><span class=o>.</span><span class=n>max_degrees</span><span class=si>}</span><span class=s2>] degrees"</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=k>return</span> <span class=n>solar_altitude</span><span class=p>,</span> <span class=n>solar_azimuth</span>  <span class=c1># , distance_to_sun</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_hour_angle_declination_skyfield> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_hour_angle_declination_skyfield</span> <a class=headerlink href=#pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_hour_angle_declination_skyfield title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_hour_angle_declination_skyfield</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamp</span><span class=p>:</span> <span class=n><span title=pandas.Timestamp>Timestamp</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.Tuple title="<code>typing.Tuple</code>">Tuple</a></span><span class=p>[</span><span class=n><span title=pvgisprototype.SolarHourAngle>SolarHourAngle</span></span><span class=p>,</span> <span class=n><span title=pvgisprototype.SolarDeclination>SolarDeclination</span></span><span class=p>]</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the hour angle '</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>Returns</code> </td> <td> </td> <td> <div class=doc-md-description> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>hour_angle</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Hour angle is the angle () at any instant through which the earth has to turn to bring the meridian of the observer directly in line with the sun's rays measured in radian.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/skyfield/solar_geometry.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>SolarHourAngleSkyfieldInput</span><span class=p>)</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_hour_angle_declination_skyfield</span><span class=p>(</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>    <span class=n>timestamp</span><span class=p>:</span> <span class=n>Timestamp</span><span class=p>,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>SolarHourAngle</span><span class=p>,</span> <span class=n>SolarDeclination</span><span class=p>]:</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=w>    </span><span class=sd>"""Calculate the hour angle '</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a><span class=sd>    hour_angle: float</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a><span class=sd>        Hour angle is the angle () at any instant through which the earth has</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a><span class=sd>        to turn to bring the meridian of the observer directly in line with the</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>        sun's rays measured in radian.</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>    <span class=n>solar_position</span> <span class=o>=</span> <span class=n>calculate_solar_position_skyfield</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=n>timestamp</span><span class=o>=</span><span class=n>timestamp</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=n>hour_angle</span><span class=p>,</span> <span class=n>solar_declination</span><span class=p>,</span> <span class=n>distance_to_sun</span> <span class=o>=</span> <span class=n>solar_position</span><span class=o>.</span><span class=n>hadec</span><span class=p>()</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>    <span class=n>hour_angle</span> <span class=o>=</span> <span class=n>SolarHourAngle</span><span class=p>(</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>hour_angle</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=s2>"Skyfield"</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"Skyfield"</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>    <span class=n>solar_declination</span> <span class=o>=</span> <span class=n>SolarDeclination</span><span class=p>(</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_declination</span><span class=o>.</span><span class=n>radians</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=s2>"Skyfield"</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"Skyfield"</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>        <span class=ow>not</span> <span class=n>isfinite</span><span class=p>(</span><span class=n>hour_angle</span><span class=o>.</span><span class=n>degrees</span><span class=p>)</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>        <span class=ow>or</span> <span class=ow>not</span> <span class=n>hour_angle</span><span class=o>.</span><span class=n>min_degrees</span> <span class=o>&lt;=</span> <span class=n>hour_angle</span><span class=o>.</span><span class=n>degrees</span> <span class=o>&lt;=</span> <span class=n>hour_angle</span><span class=o>.</span><span class=n>max_degrees</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>            <span class=sa>f</span><span class=s2>"The calculated solar hour angle </span><span class=si>{</span><span class=n>hour_angle</span><span class=o>.</span><span class=n>degrees</span><span class=si>}</span><span class=s2> is out of the expected range</span><span class=se>\</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a><span class=s2>            [</span><span class=si>{</span><span class=n>hour_angle</span><span class=o>.</span><span class=n>min_degrees</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>hour_angle</span><span class=o>.</span><span class=n>max_degrees</span><span class=si>}</span><span class=s2>] degrees"</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=ow>not</span> <span class=n>isfinite</span><span class=p>(</span><span class=n>solar_declination</span><span class=o>.</span><span class=n>degrees</span><span class=p>)</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=ow>or</span> <span class=ow>not</span> <span class=n>solar_declination</span><span class=o>.</span><span class=n>min_degrees</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>        <span class=o>&lt;=</span> <span class=n>solar_declination</span><span class=o>.</span><span class=n>degrees</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>        <span class=o>&lt;=</span> <span class=n>solar_declination</span><span class=o>.</span><span class=n>max_degrees</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>            <span class=sa>f</span><span class=s2>"The calculated solar declination angle </span><span class=si>{</span><span class=n>solar_declination</span><span class=o>.</span><span class=n>degrees</span><span class=si>}</span><span class=s2> is out of the expected range</span><span class=se>\</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a><span class=s2>            [</span><span class=si>{</span><span class=n>solar_declination</span><span class=o>.</span><span class=n>min_degrees</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>solar_declination</span><span class=o>.</span><span class=n>max_degrees</span><span class=si>}</span><span class=s2>] degrees"</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>    <span class=k>return</span> <span class=n>hour_angle</span><span class=p>,</span> <span class=n>solar_declination</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_position_skyfield> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_position_skyfield</span> <a class=headerlink href=#pvgisprototype.algorithms.skyfield.solar_geometry.calculate_solar_position_skyfield title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_position_skyfield</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamp</span><span class=p>:</span> <span class=n><span title=pandas.Timestamp>Timestamp</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate sun position above the local horizon using Skyfield.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>solar_altitude</code></td> <td> </td> <td> <div class=doc-md-description> <p>Altitude measures the angle above or below the horizon. The zenith is at +90, an object on the horizons great circle is at 0, and the nadir beneath your feet is at 90.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>solar_azimuth</code></td> <td> </td> <td> <div class=doc-md-description> <p>Azimuth measures the angle around the sky from the north pole: 0 means exactly north, 90 is east, 180 is south, and 270 is west.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>For the implementation, see also: <a href=https://techoverflow.net/2022/06/19/how-to-compute-position-of-sun-in-the-sky-in-python-using-skyfield/ >https://techoverflow.net/2022/06/19/how-to-compute-position-of-sun-in-the-sky-in-python-using-skyfield/</a></p> <p>Factors influencing the accuracy of the calculation using Skyfield:</p> <ul> <li> <p>Skyfield considers:</p> <ul> <li>The slight shift in position caused by light speed</li> <li>The very very slight shift in position caused by earths gravity</li> </ul> </li> <li> <p>Skyfield does not consider:</p> <ul> <li>Atmospheric distortions shifting the suns position</li> <li>The extent of the suns disk causing the sun to emanate not from a point but apparently from an area</li> </ul> </li> </ul> </details> <details class=note open> <summary>Notes</summary> <p>To consider:</p> <ul> <li><a href=https://rhodesmill.org/skyfield/almanac.html#elevated-vantage-points>https://rhodesmill.org/skyfield/almanac.html#elevated-vantage-points</a></li> <li>The <code>Time</code> class in Skyfield (i.e. <code>timescale()</code>) only uses UTC for input and output</li> <li><a href=https://rhodesmill.org/skyfield/time.html#utc-and-your-timezone>https://rhodesmill.org/skyfield/time.html#utc-and-your-timezone</a></li> <li><a href=https://rhodesmill.org/skyfield/time.html#utc-and-leap-seconds>https://rhodesmill.org/skyfield/time.html#utc-and-leap-seconds</a></li> </ul> </details> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/skyfield/solar_geometry.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarPositionSkyfieldInputModel</span><span class=p>)</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_position_skyfield</span><span class=p>(</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=n>timestamp</span><span class=p>:</span> <span class=n>Timestamp</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=p>):</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=w>    </span><span class=sd>"""Calculate sun position above the local horizon using Skyfield.</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=sd>    solar_altitude:</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=sd>        Altitude measures the angle above or below the horizon. The</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=sd>        zenith is at +90, an object on the horizons great circle is at 0,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>        and the nadir beneath your feet is at 90.</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    solar_azimuth:</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>        Azimuth measures the angle around the sky from the north pole: 0 means</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>        exactly north, 90 is east, 180 is south, and 270 is west.</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    For the implementation, see also:</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    https://techoverflow.net/2022/06/19/how-to-compute-position-of-sun-in-the-sky-in-python-using-skyfield/</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    Factors influencing the accuracy of the calculation using Skyfield:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    - Skyfield considers:</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>        - The slight shift in position caused by light speed</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>        - The very very slight shift in position caused by earths gravity</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    - Skyfield does not consider:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>        - Atmospheric distortions shifting the suns position</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        - The extent of the suns disk causing the sun to emanate not from a</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>          point but apparently from an area</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    To consider:</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    - https://rhodesmill.org/skyfield/almanac.html#elevated-vantage-points</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    - The `Time` class in Skyfield (i.e. `timescale()`) only uses UTC for input</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>      and output</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    - https://rhodesmill.org/skyfield/time.html#utc-and-your-timezone</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    - https://rhodesmill.org/skyfield/time.html#utc-and-leap-seconds</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=c1># # Handle Me during input validation? -------------------------------------</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=c1># try:</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>    <span class=c1>#     timestamp = timezone.localize(timestamp)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=c1># except Exception:</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=c1>#     logging.warning(f'tzinfo already set for timestamp = {timestamp}')</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>    <span class=c1># # Handle Me during input validation? -------------------------------------</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=n>planets</span> <span class=o>=</span> <span class=n>load</span><span class=p>(</span><span class=s2>"de421.bsp"</span><span class=p>)</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=n>sun</span> <span class=o>=</span> <span class=n>planets</span><span class=p>[</span><span class=s2>"Sun"</span><span class=p>]</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=n>earth</span> <span class=o>=</span> <span class=n>planets</span><span class=p>[</span><span class=s2>"Earth"</span><span class=p>]</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=n>location</span> <span class=o>=</span> <span class=n>wgs84</span><span class=o>.</span><span class=n>latlon</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>degrees</span><span class=p>,</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span><span class=p>)</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>timescale</span> <span class=o>=</span> <span class=n>load</span><span class=o>.</span><span class=n>timescale</span><span class=p>()</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=n>requested_timestamp</span> <span class=o>=</span> <span class=n>timescale</span><span class=o>.</span><span class=n>from_datetime</span><span class=p>(</span><span class=n>timestamp</span><span class=p>)</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=c1># sun position seen from observer location</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=c1># sun position seen from observer location</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=n>solar_position</span> <span class=o>=</span> <span class=p>(</span><span class=n>earth</span> <span class=o>+</span> <span class=n>location</span><span class=p>)</span><span class=o>.</span><span class=n>at</span><span class=p>(</span><span class=n>requested_timestamp</span><span class=p>)</span><span class=o>.</span><span class=n>observe</span><span class=p>(</span><span class=n>sun</span><span class=p>)</span><span class=o>.</span><span class=n>apparent</span><span class=p>()</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=k>return</span> <span class=n>solar_position</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.skyfield.solar_time> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_time</span> <a class=headerlink href=#pvgisprototype.algorithms.skyfield.solar_time title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.skyfield.solar_time.calculate_solar_time_skyfield title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_time_skyfield</span> (<code>pvgisprototype.algorithms.skyfield.solar_time.calculate_solar_time_skyfield</code>)'>calculate_solar_time_skyfield</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar time using Skyfield</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.skyfield.solar_time.calculate_solar_time_skyfield> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_time_skyfield</span> <a class=headerlink href=#pvgisprototype.algorithms.skyfield.solar_time.calculate_solar_time_skyfield title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_time_skyfield</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamp</span><span class=p>:</span> <span class=n><span title=pandas.Timestamp>Timestamp</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pandas.Timestamp>Timestamp</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar time using Skyfield</p> <p>The position of the Sun in the sky changes slightly day to day due to the Earth's elliptical orbit and axis tilt around the Sun. In consequence, the length of each solar day varies slightly.</p> <p>The mean solar time (as "opposed" to the apparent solar time which is measured with a sundial), averages out these variations to create a "mean" or average solar day of 24 hours long. This is the basis of our standard time system, although further adjusted to create the time zones.</p> <p>A key concept in solar time is the solar noon, the moment when the Sun reaches its highest point in the sky each day. In apparent solar time, solar noon is the moment the Sun crosses the local meridian (an imaginary line that runs from North to South overhead).</p> <p>Solar time can vary significantly from standard clock time, depending on the time of year and the observer's longitude within their time zone. For example, at the eastern edge of a time zone, the Sun may reach its highest point (solar noon) significantly earlier than noon according to standard clock time.</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/skyfield/solar_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarTimeSkyfieldInputModel</span><span class=p>)</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_time_skyfield</span><span class=p>(</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a>    <span class=n>timestamp</span><span class=p>:</span> <span class=n>Timestamp</span><span class=p>,</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Timestamp</span><span class=p>:</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar time using Skyfield</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=sd>    The position of the Sun in the sky changes slightly day to day due to the</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=sd>    Earth's elliptical orbit and axis tilt around the Sun. In consequence, the</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=sd>    length of each solar day varies slightly.</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=sd>    The mean solar time (as "opposed" to the apparent solar time which is</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=sd>    measured with a sundial), averages out these variations to create a "mean"</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=sd>    or average solar day of 24 hours long. This is the basis of our standard</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=sd>    time system, although further adjusted to create the time zones.</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=sd>    A key concept in solar time is the solar noon, the moment when the Sun</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=sd>    reaches its highest point in the sky each day. In apparent solar time,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=sd>    solar noon is the moment the Sun crosses the local meridian (an imaginary</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>    line that runs from North to South overhead).</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    Solar time can vary significantly from standard clock time, depending on</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    the time of year and the observer's longitude within their time zone. For</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    example, at the eastern edge of a time zone, the Sun may reach its highest</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    point (solar noon) significantly earlier than noon according to standard</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    clock time.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=c1># Handle Me during input validation? -------------------------------------</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=k>if</span> <span class=n>timezone</span> <span class=o>!=</span> <span class=n>timestamp</span><span class=o>.</span><span class=n>tzinfo</span><span class=p>:</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>            <span class=n>timestamp</span> <span class=o>=</span> <span class=n>timestamp</span><span class=o>.</span><span class=n>astimezone</span><span class=p>(</span><span class=n>timezone</span><span class=p>)</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Error setting tzinfo for timestamp = </span><span class=si>{</span><span class=n>timestamp</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>    <span class=c1># Handle Me during input validation? -------------------------------------</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>    <span class=n>midnight</span> <span class=o>=</span> <span class=n>timestamp</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>hour</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>minute</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>second</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>microsecond</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>    <span class=n>next_midnight</span> <span class=o>=</span> <span class=n>midnight</span> <span class=o>+</span> <span class=n>Timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>    <span class=n>timescale</span> <span class=o>=</span> <span class=n>load</span><span class=o>.</span><span class=n>timescale</span><span class=p>()</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>    <span class=n>midnight_time</span> <span class=o>=</span> <span class=n>timescale</span><span class=o>.</span><span class=n>from_datetime</span><span class=p>(</span><span class=n>midnight</span><span class=p>)</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=n>next_midnight_time</span> <span class=o>=</span> <span class=n>timescale</span><span class=o>.</span><span class=n>from_datetime</span><span class=p>(</span><span class=n>next_midnight</span><span class=p>)</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>    <span class=n>planets</span> <span class=o>=</span> <span class=n>load</span><span class=p>(</span><span class=s2>"de421.bsp"</span><span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>    <span class=n>sun</span> <span class=o>=</span> <span class=n>planets</span><span class=p>[</span><span class=s2>"Sun"</span><span class=p>]</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=k>if</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>        <span class=n>location</span> <span class=o>=</span> <span class=n>wgs84</span><span class=o>.</span><span class=n>latlon</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>*</span> <span class=n>N</span><span class=p>,</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>*</span> <span class=n>E</span><span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=k>if</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=n>location</span> <span class=o>=</span> <span class=n>wgs84</span><span class=o>.</span><span class=n>latlon</span><span class=p>(</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>            <span class=n>latitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>*</span> <span class=n>N</span><span class=p>,</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>*</span> <span class=n>W</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>        <span class=p>)</span>  <span class=c1># Correct ?</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>    <span class=k>if</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=n>location</span> <span class=o>=</span> <span class=n>wgs84</span><span class=o>.</span><span class=n>latlon</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>*</span> <span class=n>N</span><span class=p>,</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>*</span> <span class=n>E</span><span class=p>)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>    <span class=k>if</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=n>location</span> <span class=o>=</span> <span class=n>wgs84</span><span class=o>.</span><span class=n>latlon</span><span class=p>(</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>            <span class=n>latitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>*</span> <span class=n>N</span><span class=p>,</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>*</span> <span class=n>W</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=p>)</span>  <span class=c1># Correct ?</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=n>location</span> <span class=o>=</span> <span class=n>wgs84</span><span class=o>.</span><span class=n>latlon</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>*</span> <span class=n>N</span><span class=p>,</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span><span class=p>)</span>  <span class=c1># Correct ?</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=n>location</span> <span class=o>=</span> <span class=n>wgs84</span><span class=o>.</span><span class=n>latlon</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>degrees</span> <span class=o>*</span> <span class=n>N</span><span class=p>,</span> <span class=n>longitude</span><span class=o>.</span><span class=n>degrees</span><span class=p>)</span>  <span class=c1># Correct ?</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=n>f</span> <span class=o>=</span> <span class=n>almanac</span><span class=o>.</span><span class=n>meridian_transits</span><span class=p>(</span><span class=n>planets</span><span class=p>,</span> <span class=n>sun</span><span class=p>,</span> <span class=n>location</span><span class=p>)</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=n>times</span><span class=p>,</span> <span class=n>events</span> <span class=o>=</span> <span class=n>almanac</span><span class=o>.</span><span class=n>find_discrete</span><span class=p>(</span><span class=n>midnight_time</span><span class=p>,</span> <span class=n>next_midnight_time</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=n>times</span> <span class=o>=</span> <span class=n>times</span><span class=p>[</span><span class=n>events</span> <span class=o>==</span> <span class=mi>1</span><span class=p>]</span>  <span class=c1># select transits instead of antitransits</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>times</span><span class=p>:</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>"No solar noon found in the given time range"</span><span class=p>)</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=n>next_solar_noon</span> <span class=o>=</span> <span class=n>times</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># first in `times` is the _next_ solar noon!</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=n>previous_solar_noon</span> <span class=o>=</span> <span class=n>next_solar_noon</span> <span class=o>-</span> <span class=n>Timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=k>if</span> <span class=n>timestamp</span> <span class=o>&lt;</span> <span class=n>next_solar_noon</span><span class=o>.</span><span class=n>utc_datetime</span><span class=p>()</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>tzinfo</span><span class=o>=</span><span class=n>ZoneInfo</span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>)):</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=c1># if morning : calculate hours until next solar noon</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>hours_since_solar_noon</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>            <span class=n>timestamp</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>            <span class=o>-</span> <span class=n>previous_solar_noon</span><span class=o>.</span><span class=n>utc_datetime</span><span class=p>()</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>tzinfo</span><span class=o>=</span><span class=n>ZoneInfo</span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>))</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=p>)</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>/</span> <span class=mi>3600</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=c1># if afternoon : calculate hours since last solar noon</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>hours_since_solar_noon</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>            <span class=n>timestamp</span> <span class=o>-</span> <span class=n>next_solar_noon</span><span class=o>.</span><span class=n>utc_datetime</span><span class=p>()</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>tzinfo</span><span class=o>=</span><span class=n>ZoneInfo</span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>))</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=p>)</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>/</span> <span class=mi>3600</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=n>hours</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>hours_since_solar_noon</span><span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=n>minutes</span> <span class=o>=</span> <span class=nb>int</span><span class=p>((</span><span class=n>hours_since_solar_noon</span> <span class=o>-</span> <span class=n>hours</span><span class=p>)</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=n>seconds</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(((</span><span class=n>hours_since_solar_noon</span> <span class=o>-</span> <span class=n>hours</span><span class=p>)</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>-</span> <span class=n>minutes</span><span class=p>)</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=n>local_solar_time</span> <span class=o>=</span> <span class=n>Timestamp</span><span class=p>(</span>  <span class=c1># NOTE gounaol: Maybe wrong implementation</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=n>year</span><span class=o>=</span><span class=n>timestamp</span><span class=o>.</span><span class=n>year</span><span class=p>,</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=n>month</span><span class=o>=</span><span class=n>timestamp</span><span class=o>.</span><span class=n>month</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>day</span><span class=o>=</span><span class=n>timestamp</span><span class=o>.</span><span class=n>day</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=n>hour</span><span class=o>=</span><span class=nb>int</span><span class=p>(</span><span class=n>hours</span><span class=p>),</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=n>minute</span><span class=o>=</span><span class=nb>int</span><span class=p>(</span><span class=n>minutes</span><span class=p>),</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>        <span class=n>second</span><span class=o>=</span><span class=nb>int</span><span class=p>(</span><span class=n>seconds</span><span class=p>),</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>tzinfo</span><span class=o>=</span><span class=n>timestamp</span><span class=o>.</span><span class=n>tzinfo</span><span class=p>,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>    <span class=c1># local_solar_time = previous_solar_noon.utc_datetime() + Timedelta(hours=hours_since_solar_noon)</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>    <span class=k>if</span> <span class=n>verbose</span><span class=p>:</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Local solar time: </span><span class=si>{</span><span class=n>local_solar_time</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=n>previous_solar_noon_string</span> <span class=o>=</span> <span class=n>previous_solar_noon</span><span class=o>.</span><span class=n>astimezone</span><span class=p>(</span><span class=n>timezone</span><span class=p>)</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>            <span class=s2>"%Y-%m-</span><span class=si>%d</span><span class=s2> %H:%M:%S"</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Previous solar noon: </span><span class=si>{</span><span class=n>previous_solar_noon_string</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>next_solar_noon_string</span> <span class=o>=</span> <span class=n>next_solar_noon</span><span class=o>.</span><span class=n>astimezone</span><span class=p>(</span><span class=n>timezone</span><span class=p>)</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>            <span class=s2>"%Y-%m-</span><span class=si>%d</span><span class=s2> %H:%M:%S"</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Next solar noon: </span><span class=si>{</span><span class=n>next_solar_noon_string</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=k>return</span> <span class=n>local_solar_time</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.skyfield.sunrise_and_sunset> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">sunrise_and_sunset</span> <a class=headerlink href=#pvgisprototype.algorithms.skyfield.sunrise_and_sunset title="Permanent link"></a></h3> <div class="doc doc-contents"> <div class="doc doc-children"> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.usno> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">usno</span> <a class=headerlink href=#pvgisprototype.algorithms.usno title="Permanent link"></a></h2> <div class="doc doc-contents"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.local_hour_angle title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">local_hour_angle</span> (<code>pvgisprototype.algorithms.usno.local_hour_angle</code>)'>local_hour_angle</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.sidereal_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">sidereal_time</span> (<code>pvgisprototype.algorithms.usno.sidereal_time</code>)'>sidereal_time</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.solar_altitude title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_altitude</span> (<code>pvgisprototype.algorithms.usno.solar_altitude</code>)'>solar_altitude</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.solar_azimuth title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_azimuth</span> (<code>pvgisprototype.algorithms.usno.solar_azimuth</code>)'>solar_azimuth</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.usno.local_hour_angle> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">local_hour_angle</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.local_hour_angle title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.local_hour_angle.calculate_local_hour_angle title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_local_hour_angle</span> (<code>pvgisprototype.algorithms.usno.local_hour_angle.calculate_local_hour_angle</code>)'>calculate_local_hour_angle</a></code></td> <td> <div class=doc-md-description> <p>Calculate the Local Hour Angle (local_hour_angle)</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.local_hour_angle.calculate_local_hour_angle> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_local_hour_angle</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.local_hour_angle.calculate_local_hour_angle title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_local_hour_angle</span><span class=p>(</span><span class=n>gast</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>longitude</span><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the Local Hour Angle (local_hour_angle)</p> <p><span class=doc-section-title>Examples:</span></p> <p>gast_array = np.array([15.0116663, 16.08011407]) alpha_array = np.array([14.261, 14.261]) # Example right ascension in hours longitude_array = np.array([77.5946, 77.5946]) # Example longitude in degrees (east) delta_array = np.array([23.44, 23.44]) # Example declination in degrees latitude_array = np.array([12.9714, 12.9714]) # Example latitude in degrees local_hour_angle_array = calculate_local_hour_angle(gast_array, alpha_array, longitude_array)</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/local_hour_angle.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos="17 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_local_hour_angle</span><span class=p>(</span><span class=n>gast</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>longitude</span><span class=p>):</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=sd>"""Calculate the Local Hour Angle (local_hour_angle)</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a><span class=sd>    gast_array = np.array([15.0116663, 16.08011407])</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a><span class=sd>    alpha_array = np.array([14.261, 14.261])  # Example right ascension in hours</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a><span class=sd>    longitude_array = np.array([77.5946, 77.5946])  # Example longitude in degrees (east)</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a><span class=sd>    delta_array = np.array([23.44, 23.44])  # Example declination in degrees</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a><span class=sd>    latitude_array = np.array([12.9714, 12.9714])  # Example latitude in degrees</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a><span class=sd>    local_hour_angle_array = calculate_local_hour_angle(gast_array, alpha_array, longitude_array)</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a>    <span class=k>return</span> <span class=p>(</span><span class=n>gast</span> <span class=o>-</span> <span class=n>alpha</span><span class=p>)</span> <span class=o>*</span> <span class=mi>15</span> <span class=o>+</span> <span class=n>longitude</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.usno.sidereal_time> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">sidereal_time</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.sidereal_time title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_apparent_sidereal_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_apparent_sidereal_time</span> (<code>pvgisprototype.algorithms.usno.sidereal_time.calculate_apparent_sidereal_time</code>)'>calculate_apparent_sidereal_time</a></code></td> <td> <div class=doc-md-description> <p>Calculate the apparent sidereal time (GAST)</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_apparent_sidereal_time_time_series title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_apparent_sidereal_time_time_series</span> (<code>pvgisprototype.algorithms.usno.sidereal_time.calculate_apparent_sidereal_time_time_series</code>)'>calculate_apparent_sidereal_time_time_series</a></code></td> <td> <div class=doc-md-description> <p>Calculate the apparent sidereal time</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_eqeq title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_eqeq</span> (<code>pvgisprototype.algorithms.usno.sidereal_time.calculate_eqeq</code>)'>calculate_eqeq</a></code></td> <td> <div class=doc-md-description> <p>Compute the equation of the equinoxes (eqeq)</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_eqeq_time_series title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_eqeq_time_series</span> (<code>pvgisprototype.algorithms.usno.sidereal_time.calculate_eqeq_time_series</code>)'>calculate_eqeq_time_series</a></code></td> <td> <div class=doc-md-description> <p>Calculate the equation of the equinoxes (eqeq)</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_gast title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_gast</span> (<code>pvgisprototype.algorithms.usno.sidereal_time.calculate_gast</code>)'>calculate_gast</a></code></td> <td> <div class=doc-md-description> <p>Compute the Greenwich apparent sidereal time (GAST)</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_gast_time_series title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_gast_time_series</span> (<code>pvgisprototype.algorithms.usno.sidereal_time.calculate_gast_time_series</code>)'>calculate_gast_time_series</a></code></td> <td> <div class=doc-md-description> <p>Calculate the Greenwich apparent sidereal time (GAST)</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_gmst title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_gmst</span> (<code>pvgisprototype.algorithms.usno.sidereal_time.calculate_gmst</code>)'>calculate_gmst</a></code></td> <td> <div class=doc-md-description> <p>Compute the Greenwich mean sidereal time (GMST)</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_gmst_time_series title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_gmst_time_series</span> (<code>pvgisprototype.algorithms.usno.sidereal_time.calculate_gmst_time_series</code>)'>calculate_gmst_time_series</a></code></td> <td> <div class=doc-md-description> <p>Calculate the Greenwich mean sidereal time (GMST) using NumPy</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_local_sidereal_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_local_sidereal_time</span> (<code>pvgisprototype.algorithms.usno.sidereal_time.calculate_local_sidereal_time</code>)'>calculate_local_sidereal_time</a></code></td> <td> <div class=doc-md-description> <p>Compute the local mean or apparent sidereal time</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_local_sidereal_time_time_series title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_local_sidereal_time_time_series</span> (<code>pvgisprototype.algorithms.usno.sidereal_time.calculate_local_sidereal_time_time_series</code>)'>calculate_local_sidereal_time_time_series</a></code></td> <td> <div class=doc-md-description> <p>Calculate the local mean or apparent sidereal time</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.sidereal_time.calculate_apparent_sidereal_time> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_apparent_sidereal_time</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_apparent_sidereal_time title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_apparent_sidereal_time</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>julian_date_universal_time</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>H</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>local_longitude_deg</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>use_precise_formula</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the apparent sidereal time (GAST)</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/sidereal_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_apparent_sidereal_time</span><span class=p>(</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>julian_date_universal_time</span><span class=p>,</span> <span class=n>H</span><span class=p>,</span> <span class=n>local_longitude_deg</span><span class=p>,</span> <span class=n>use_precise_formula</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=p>):</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=w>    </span><span class=sd>"""Calculate the apparent sidereal time (GAST)"""</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>    <span class=n>GMST</span> <span class=o>=</span> <span class=n>calculate_GMST</span><span class=p>(</span><span class=n>julian_date_universal_time</span><span class=p>,</span> <span class=n>H</span><span class=p>,</span> <span class=n>use_precise_formula</span><span class=p>)</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=n>DTT</span> <span class=o>=</span> <span class=n>julian_date_universal_time</span> <span class=o>-</span> <span class=mf>2451545.0</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=n>eqeq</span> <span class=o>=</span> <span class=n>calculate_eqeq</span><span class=p>(</span><span class=n>DTT</span><span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=n>GAST</span> <span class=o>=</span> <span class=n>calculate_GAST</span><span class=p>(</span><span class=n>GMST</span><span class=p>,</span> <span class=n>eqeq</span><span class=p>)</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=n>local_sidereal_time</span> <span class=o>=</span> <span class=n>calculate_local_sidereal_time</span><span class=p>(</span><span class=n>GAST</span><span class=p>,</span> <span class=n>local_longitude_deg</span><span class=p>)</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=s2>"GMST"</span><span class=p>:</span> <span class=n>GMST</span><span class=p>,</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=s2>"eqeq"</span><span class=p>:</span> <span class=n>eqeq</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=s2>"GAST"</span><span class=p>:</span> <span class=n>GAST</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=s2>"local_sidereal_time"</span><span class=p>:</span> <span class=n>local_sidereal_time</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>    <span class=p>}</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.sidereal_time.calculate_apparent_sidereal_time_time_series> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_apparent_sidereal_time_time_series</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_apparent_sidereal_time_time_series title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_apparent_sidereal_time_time_series</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>julian_date_universal_time</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>H</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>local_longitude_deg</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>use_precise_formula</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the apparent sidereal time</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/sidereal_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_apparent_sidereal_time_time_series</span><span class=p>(</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>    <span class=n>julian_date_universal_time</span><span class=p>,</span> <span class=n>H</span><span class=p>,</span> <span class=n>local_longitude_deg</span><span class=p>,</span> <span class=n>use_precise_formula</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=p>):</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=w>    </span><span class=sd>"""Calculate the apparent sidereal time"""</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>    <span class=n>GMST</span> <span class=o>=</span> <span class=n>calculate_GMST_time_series</span><span class=p>(</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>julian_date_universal_time</span><span class=p>,</span> <span class=n>H</span><span class=p>,</span> <span class=n>use_precise_formula</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>    <span class=n>DTT</span> <span class=o>=</span> <span class=n>julian_date_universal_time</span> <span class=o>-</span> <span class=mf>2451545.0</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>    <span class=n>eqeq</span> <span class=o>=</span> <span class=n>calculate_eqeq_time_series</span><span class=p>(</span><span class=n>DTT</span><span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=n>GAST</span> <span class=o>=</span> <span class=n>calculate_GAST_time_series</span><span class=p>(</span><span class=n>GMST</span><span class=p>,</span> <span class=n>eqeq</span><span class=p>)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=n>local_sidereal_time</span> <span class=o>=</span> <span class=n>calculate_local_sidereal_time_time_series</span><span class=p>(</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>GAST</span><span class=p>,</span> <span class=n>local_longitude_deg</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>    <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=s2>"GMST"</span><span class=p>:</span> <span class=n>GMST</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=s2>"eqeq"</span><span class=p>:</span> <span class=n>eqeq</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=s2>"GAST"</span><span class=p>:</span> <span class=n>GAST</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=s2>"local_sidereal_time"</span><span class=p>:</span> <span class=n>local_sidereal_time</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>    <span class=p>}</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.sidereal_time.calculate_eqeq> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_eqeq</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_eqeq title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_eqeq</span><span class=p>(</span><span class=n>DTT</span><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Compute the equation of the equinoxes (eqeq)</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/sidereal_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_eqeq</span><span class=p>(</span><span class=n>DTT</span><span class=p>):</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a><span class=w>    </span><span class=sd>"""Compute the equation of the equinoxes (eqeq)"""</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>    <span class=n>Omega</span> <span class=o>=</span> <span class=mf>125.04</span> <span class=o>-</span> <span class=mf>0.052954</span> <span class=o>*</span> <span class=n>DTT</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>    <span class=n>L</span> <span class=o>=</span> <span class=mf>280.47</span> <span class=o>+</span> <span class=mf>0.98565</span> <span class=o>*</span> <span class=n>DTT</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>    <span class=n>epsilon</span> <span class=o>=</span> <span class=mf>23.4393</span> <span class=o>-</span> <span class=mf>0.0000004</span> <span class=o>*</span> <span class=n>DTT</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>    <span class=n>delta_psi</span> <span class=o>=</span> <span class=o>-</span><span class=mf>0.000319</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span><span class=n>radians</span><span class=p>(</span><span class=n>Omega</span><span class=p>))</span> <span class=o>-</span> <span class=mf>0.000024</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span><span class=n>radians</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>L</span><span class=p>))</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>    <span class=n>eqeq</span> <span class=o>=</span> <span class=n>delta_psi</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span><span class=n>radians</span><span class=p>(</span><span class=n>epsilon</span><span class=p>))</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>    <span class=k>return</span> <span class=n>eqeq</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.sidereal_time.calculate_eqeq_time_series> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_eqeq_time_series</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_eqeq_time_series title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_eqeq_time_series</span><span class=p>(</span><span class=n>DTT</span><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the equation of the equinoxes (eqeq)</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/sidereal_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_eqeq_time_series</span><span class=p>(</span><span class=n>DTT</span><span class=p>):</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a><span class=w>    </span><span class=sd>"""Calculate the equation of the equinoxes (eqeq)"""</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>    <span class=n>Omega</span> <span class=o>=</span> <span class=mf>125.04</span> <span class=o>-</span> <span class=mf>0.052954</span> <span class=o>*</span> <span class=n>DTT</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>    <span class=n>L</span> <span class=o>=</span> <span class=mf>280.47</span> <span class=o>+</span> <span class=mf>0.98565</span> <span class=o>*</span> <span class=n>DTT</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos="81 "></span></a>    <span class=n>epsilon</span> <span class=o>=</span> <span class=mf>23.4393</span> <span class=o>-</span> <span class=mf>0.0000004</span> <span class=o>*</span> <span class=n>DTT</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos="82 "></span></a>    <span class=n>delta_psi</span> <span class=o>=</span> <span class=o>-</span><span class=mf>0.000319</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>Omega</span><span class=p>))</span> <span class=o>-</span> <span class=mf>0.000024</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos="83 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>L</span><span class=p>)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos="84 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos="85 "></span></a>    <span class=n>eqeq</span> <span class=o>=</span> <span class=n>delta_psi</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>epsilon</span><span class=p>))</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos="86 "></span></a>    <span class=k>return</span> <span class=n>eqeq</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.sidereal_time.calculate_gast> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_gast</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_gast title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_gast</span><span class=p>(</span><span class=n>GMST</span><span class=p>,</span> <span class=n>eqeq</span><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Compute the Greenwich apparent sidereal time (GAST)</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/sidereal_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos="89 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_gast</span><span class=p>(</span><span class=n>GMST</span><span class=p>,</span> <span class=n>eqeq</span><span class=p>):</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos="90 "></span></a><span class=w>    </span><span class=sd>"""Compute the Greenwich apparent sidereal time (GAST)"""</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos="91 "></span></a>    <span class=k>return</span> <span class=n>fmod</span><span class=p>(</span><span class=n>GMST</span> <span class=o>+</span> <span class=n>eqeq</span><span class=p>,</span> <span class=mi>24</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.sidereal_time.calculate_gast_time_series> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_gast_time_series</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_gast_time_series title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_gast_time_series</span><span class=p>(</span><span class=n>GMST</span><span class=p>,</span> <span class=n>eqeq</span><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the Greenwich apparent sidereal time (GAST)</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/sidereal_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos="94 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_gast_time_series</span><span class=p>(</span><span class=n>GMST</span><span class=p>,</span> <span class=n>eqeq</span><span class=p>):</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos="95 "></span></a><span class=w>    </span><span class=sd>"""Calculate the Greenwich apparent sidereal time (GAST)"""</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos="96 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>mod</span><span class=p>(</span><span class=n>GMST</span> <span class=o>+</span> <span class=n>eqeq</span><span class=p>,</span> <span class=mi>24</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.sidereal_time.calculate_gmst> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_gmst</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_gmst title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_gmst</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>julian_date_universal_time</span><span class=p>,</span> <span class=n>H</span><span class=p>,</span> <span class=n>use_precise_formula</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Compute the Greenwich mean sidereal time (GMST)</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/sidereal_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_gmst</span><span class=p>(</span><span class=n>julian_date_universal_time</span><span class=p>,</span> <span class=n>H</span><span class=p>,</span> <span class=n>use_precise_formula</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a><span class=w>    </span><span class=sd>"""Compute the Greenwich mean sidereal time (GMST)"""</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a>    <span class=n>difference_universal_time_minus_20000101120000</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a>        <span class=n>julian_date_universal_time</span> <span class=o>-</span> <span class=mf>2451545.0</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>    <span class=n>T</span> <span class=o>=</span> <span class=n>difference_universal_time_minus_20000101120000</span> <span class=o>/</span> <span class=mf>36525.0</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>    <span class=k>if</span> <span class=n>use_precise_formula</span><span class=p>:</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a>        <span class=n>GMST</span> <span class=o>=</span> <span class=n>fmod</span><span class=p>(</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a>            <span class=mf>6.697375</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a>            <span class=o>+</span> <span class=mf>0.065709824279</span> <span class=o>*</span> <span class=n>difference_universal_time_minus_20000101120000</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a>            <span class=o>+</span> <span class=mf>1.0027379</span> <span class=o>*</span> <span class=n>H</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a>            <span class=o>+</span> <span class=mf>0.0000258</span> <span class=o>*</span> <span class=n>T</span><span class=o>**</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>            <span class=mi>24</span><span class=p>,</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>        <span class=n>GMST</span> <span class=o>=</span> <span class=n>fmod</span><span class=p>(</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>            <span class=mf>18.697375</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>            <span class=o>+</span> <span class=mf>24.065709824279</span> <span class=o>*</span> <span class=n>difference_universal_time_minus_20000101120000</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>            <span class=mi>24</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>    <span class=k>return</span> <span class=n>GMST</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.sidereal_time.calculate_gmst_time_series> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_gmst_time_series</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_gmst_time_series title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_gmst_time_series</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>julian_date_universal_time</span><span class=p>,</span> <span class=n>H</span><span class=p>,</span> <span class=n>use_precise_formula</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the Greenwich mean sidereal time (GMST) using NumPy</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/sidereal_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_gmst_time_series</span><span class=p>(</span><span class=n>julian_date_universal_time</span><span class=p>,</span> <span class=n>H</span><span class=p>,</span> <span class=n>use_precise_formula</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=sd>"""Calculate the Greenwich mean sidereal time (GMST) using NumPy"""</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>    <span class=n>difference_universal_time_minus_20000101120000</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>        <span class=n>julian_date_universal_time</span> <span class=o>-</span> <span class=mf>2451545.0</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>    <span class=n>centuries_since_2000</span> <span class=o>=</span> <span class=n>difference_universal_time_minus_20000101120000</span> <span class=o>/</span> <span class=mf>36525.0</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>    <span class=k>if</span> <span class=n>use_precise_formula</span><span class=p>:</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>        <span class=n>GMST</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mod</span><span class=p>(</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>            <span class=mf>6.697375</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>            <span class=o>+</span> <span class=mf>0.065709824279</span> <span class=o>*</span> <span class=n>difference_universal_time_minus_20000101120000</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>            <span class=o>+</span> <span class=mf>1.0027379</span> <span class=o>*</span> <span class=n>H</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>            <span class=o>+</span> <span class=mf>0.0000258</span> <span class=o>*</span> <span class=n>centuries_since_2000</span><span class=o>**</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>            <span class=mi>24</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>        <span class=n>GMST</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mod</span><span class=p>(</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>            <span class=mf>18.697375</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>            <span class=o>+</span> <span class=mf>24.065709824279</span> <span class=o>*</span> <span class=n>difference_universal_time_minus_20000101120000</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>            <span class=mi>24</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>    <span class=k>return</span> <span class=n>GMST</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.sidereal_time.calculate_local_sidereal_time> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_local_sidereal_time</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_local_sidereal_time title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_local_sidereal_time</span><span class=p>(</span><span class=n>GAST</span><span class=p>,</span> <span class=n>local_longitude_deg</span><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Compute the local mean or apparent sidereal time</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/sidereal_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_local_sidereal_time</span><span class=p>(</span><span class=n>GAST</span><span class=p>,</span> <span class=n>local_longitude_deg</span><span class=p>):</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=w>    </span><span class=sd>"""Compute the local mean or apparent sidereal time"""</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>local_longitude_hours</span> <span class=o>=</span> <span class=n>local_longitude_deg</span> <span class=o>/</span> <span class=mf>15.0</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=k>return</span> <span class=n>fmod</span><span class=p>(</span><span class=n>GAST</span> <span class=o>+</span> <span class=n>local_longitude_hours</span><span class=p>,</span> <span class=mi>24</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.sidereal_time.calculate_local_sidereal_time_time_series> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_local_sidereal_time_time_series</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.sidereal_time.calculate_local_sidereal_time_time_series title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_local_sidereal_time_time_series</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>GAST</span><span class=p>,</span> <span class=n>local_longitude_deg</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the local mean or apparent sidereal time</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/sidereal_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_local_sidereal_time_time_series</span><span class=p>(</span><span class=n>GAST</span><span class=p>,</span> <span class=n>local_longitude_deg</span><span class=p>):</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=w>    </span><span class=sd>"""Calculate the local mean or apparent sidereal time"""</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=n>local_longitude_hours</span> <span class=o>=</span> <span class=n>local_longitude_deg</span> <span class=o>/</span> <span class=mf>15.0</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>mod</span><span class=p>(</span><span class=n>GAST</span> <span class=o>+</span> <span class=n>local_longitude_hours</span><span class=p>,</span> <span class=mi>24</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.usno.solar_altitude> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_altitude</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.solar_altitude title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.solar_altitude.compute_altitude title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_altitude</span> (<code>pvgisprototype.algorithms.usno.solar_altitude.compute_altitude</code>)'>compute_altitude</a></code></td> <td> <div class=doc-md-description> <p>Function to calculate the Altitude (a)</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.solar_altitude.compute_altitude> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">compute_altitude</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.solar_altitude.compute_altitude title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>compute_altitude</span><span class=p>(</span><span class=n>LHA</span><span class=p>,</span> <span class=n>delta</span><span class=p>,</span> <span class=n>latitude</span><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Function to calculate the Altitude (a)</p> <p><span class=doc-section-title>Examples:</span></p> <p>GAST_array = np.array([15.0116663, 16.08011407]) alpha_array = np.array([14.261, 14.261]) # Example right ascension in hours longitude_array = np.array([77.5946, 77.5946]) # Example longitude in degrees (east) delta_array = np.array([23.44, 23.44]) # Example declination in degrees latitude_array = np.array([12.9714, 12.9714]) # Example latitude in degrees LHA_array = compute_LHA(GAST_array, alpha_array, longitude_array) azimuth_array = compute_azimuth(LHA_array, delta_array, latitude_array)</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/solar_altitude.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>compute_altitude</span><span class=p>(</span><span class=n>LHA</span><span class=p>,</span> <span class=n>delta</span><span class=p>,</span> <span class=n>latitude</span><span class=p>):</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a><span class=w>    </span><span class=sd>"""Function to calculate the Altitude (a)</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a><span class=sd>    GAST_array = np.array([15.0116663, 16.08011407])</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a><span class=sd>    alpha_array = np.array([14.261, 14.261])  # Example right ascension in hours</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a><span class=sd>    longitude_array = np.array([77.5946, 77.5946])  # Example longitude in degrees (east)</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a><span class=sd>    delta_array = np.array([23.44, 23.44])  # Example declination in degrees</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a><span class=sd>    latitude_array = np.array([12.9714, 12.9714])  # Example latitude in degrees</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a><span class=sd>    LHA_array = compute_LHA(GAST_array, alpha_array, longitude_array)</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a><span class=sd>    azimuth_array = compute_azimuth(LHA_array, delta_array, latitude_array)</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a>    <span class=n>LHA_rad</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>LHA</span><span class=p>)</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a>    <span class=n>delta_rad</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>delta</span><span class=p>)</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>    <span class=n>latitude_rad</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>latitude</span><span class=p>)</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a>    <span class=n>sin_altitude</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>LHA_rad</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>delta_rad</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>latitude_rad</span><span class=p>)</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>        <span class=n>delta_rad</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>    <span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>latitude_rad</span><span class=p>)</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arcsin</span><span class=p>(</span><span class=n>sin_altitude</span><span class=p>))</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 class="doc doc-heading" id=pvgisprototype.algorithms.usno.solar_azimuth> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_azimuth</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.solar_azimuth title="Permanent link"></a></h3> <div class="doc doc-contents"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.usno.solar_azimuth.calculate_azimuth title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_azimuth</span> (<code>pvgisprototype.algorithms.usno.solar_azimuth.calculate_azimuth</code>)'>calculate_azimuth</a></code></td> <td> <div class=doc-md-description> <p>Calculate the Azimuth (A)</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h4 class="doc doc-heading" id=pvgisprototype.algorithms.usno.solar_azimuth.calculate_azimuth> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_azimuth</span> <a class=headerlink href=#pvgisprototype.algorithms.usno.solar_azimuth.calculate_azimuth title="Permanent link"></a></h4> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_azimuth</span><span class=p>(</span><span class=n>local_hour_angle</span><span class=p>,</span> <span class=n>delta</span><span class=p>,</span> <span class=n>latitude</span><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the Azimuth (A)</p> <p><span class=doc-section-title>Examples:</span></p> <p>azimuth_array = calculate_azimuth(local_hour_angle_array, delta_array, latitude_array)</p> <details class=mkdocstrings-source> <summary>Source code in <code>pvgisprototype/algorithms/usno/solar_azimuth.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_azimuth</span><span class=p>(</span><span class=n>local_hour_angle</span><span class=p>,</span> <span class=n>delta</span><span class=p>,</span> <span class=n>latitude</span><span class=p>):</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a><span class=w>    </span><span class=sd>"""Calculate the Azimuth (A)</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a><span class=sd>    azimuth_array = calculate_azimuth(local_hour_angle_array, delta_array, latitude_array)</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a>    <span class=n>local_hour_angle_rad</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>local_hour_angle</span><span class=p>)</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>    <span class=n>delta_rad</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>delta</span><span class=p>)</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>    <span class=n>latitude_rad</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>latitude</span><span class=p>)</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a>    <span class=n>tan_azimuth</span> <span class=o>=</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>local_hour_angle_rad</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>tan</span><span class=p>(</span><span class=n>delta_rad</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>latitude_rad</span><span class=p>)</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a>        <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>latitude_rad</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>local_hour_angle_rad</span><span class=p>)</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a>    <span class=n>azimuth</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>arctan2</span><span class=p>(</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a>            <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>local_hour_angle_rad</span><span class=p>),</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>            <span class=n>np</span><span class=o>.</span><span class=n>tan</span><span class=p>(</span><span class=n>delta_rad</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>latitude_rad</span><span class=p>)</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>            <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>latitude_rad</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>local_hour_angle_rad</span><span class=p>),</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>mod</span><span class=p>(</span><span class=n>azimuth</span> <span class=o>+</span> <span class=mi>360</span><span class=p>,</span> <span class=mi>360</span><span class=p>)</span>  <span class=c1># Normalize to [0, 360)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="November 29, 2025 20:55:02 UTC"><span class=timeago datetime=2025-11-29T20:55:02+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="November 29, 2025 20:55:02 UTC">2025-11-29</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="January 20, 2024 21:45:23 UTC"><span class=timeago datetime=2024-01-20T21:45:23+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="January 20, 2024 21:45:23 UTC">2024-01-20</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component=top hidden type=button> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <nav aria-label=Footer class="md-footer__inner md-grid"> <a aria-label="Previous: Package Init" href=../package_init/ class="md-footer__link md-footer__link--prev"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Package Init </div> </div> </a> <a aria-label="Next: API" href=../api/ class="md-footer__link md-footer__link--next"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> API </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright  2025 European Commission. Licensed under the EUPL-1.2 or later </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["announce.dismiss", "header.autohide", "search.highlight", "search.share", "content.tooltips", "content.code.copy", "content.action.view", "content.action.edit", "navigation.top", "navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.indexes", "toc.follow", "toc.integrate", "navigation.footer"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": {"CLI": "cli", "Chunking": "chunking", "Concepts": "concepts", "How-To": "howto", "See-Also": "seealso", "To Do": "todo"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.e71a0d61.min.js></script> <script src=../../assets/_markdown_exec_pyodide.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> <script src=../../assets/mkdocs_pagetree_plugin.js></script> <script src=../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../js/termynal.js></script> <script src=../../js/custom.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../js/tablesort.js></script> <script src=../../js/mermaid_config.js></script> <script src=../../js/extra-loader.js></script> <script async src=../../assets/javascripts/badge.js></script> </body> </html>