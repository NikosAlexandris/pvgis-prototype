<!DOCTYPE html><html class=no-js lang=en> <head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Photovoltaic Geographical Information System" name=description><meta content="Nikos Alexandris and the PVGIS team" name=author><link href=http://pvgis-reference.jrc.it/source_code/algorithms/ rel=canonical><link href=../duck_arrays/ rel=prev><link href=../api/ rel=next><link href=../../assets/images/favicon.png rel=icon><meta content="mkdocs-1.6.1, mkdocs-material-9.6.23" name=generator><title>Algorithms - PVGIS</title><link href=../../assets/stylesheets/main.84d31ad4.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><style>:root{.md-tag.md-tag--concepts{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M21.809%205.524%2012.806.179l-.013-.007.078-.045h-.166a1.28%201.28%200%200%200-1.196.043l-.699.403-8.604%204.954a1.29%201.29%200%200%200-.644%201.113v10.718c0%20.46.245.884.644%201.113l9.304%205.357c.402.232.898.228%201.297-.009l9.002-5.345c.39-.231.629-.651.629-1.105V6.628c0-.453-.239-.873-.629-1.104m-19.282.559L11.843.719a.64.64%200%200%201%20.636.012l9.002%205.345a.64.64%200%200%201%20.207.203l-4.543%202.555-4.498-2.7a.96.96%200%200%200-.968-.014L6.83%208.848%202.287%206.329a.64.64%200%200%201%20.24-.246m14.13%208.293-4.496-2.492V6.641a.3.3%200%200%201%20.155.045l4.341%202.605zm-4.763-1.906%204.692%202.601-4.431%202.659-4.648-2.615a.3.3%200%200%201-.115-.112zm-.064%2010.802-9.304-5.357a.64.64%200%200%201-.322-.557V7.018L6.7%209.51v5.324c0%20.348.188.669.491.84l4.811%202.706.157.088v4.887a.64.64%200%200%201-.329-.083%22/%3E%3C/svg%3E');}.md-tag.md-tag--chunking{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M192%2032c0-17.7%2014.3-32%2032-32h64c17.7%200%2032%2014.3%2032%2032v64c0%2017.7-14.3%2032-32%2032h-64c-17.7%200-32-14.3-32-32zm32%20352h64c17.7%200%2032%2014.3%2032%2032v64c0%2017.7-14.3%2032-32%2032h-64c-17.7%200-32-14.3-32-32v-64c0-17.7%2014.3-32%2032-32m192%200h64c17.7%200%2032%2014.3%2032%2032v64c0%2017.7-14.3%2032-32%2032h-64c-17.7%200-32-14.3-32-32v-64c0-17.7%2014.3-32%2032-32m-96-192h64c17.7%200%2032%2014.3%2032%2032v64c0%2017.7-14.3%2032-32%2032h-64c-17.7%200-32-14.3-32-32v-64c0-17.7%2014.3-32%2032-32m-182.6-3.9c12.5-12.5%2032.8-12.5%2045.3%200l45.3%2045.3c12.5%2012.5%2012.5%2032.8%200%2045.3L182.7%20324c-12.5%2012.5-32.8%2012.5-45.3%200l-45.3-45.4c-12.5-12.5-12.5-32.8%200-45.3l45.3-45.3zM32%20384h64c17.7%200%2032%2014.3%2032%2032v64c0%2017.7-14.3%2032-32%2032H32c-17.7%200-32-14.3-32-32v-64c0-17.7%2014.3-32%2032-32%22/%3E%3C/svg%3E');}.md-tag.md-tag--cli{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%202.75C0%201.784.784%201%201.75%201h12.5c.966%200%201.75.784%201.75%201.75v10.5A1.75%201.75%200%200%201%2014.25%2015H1.75A1.75%201.75%200%200%201%200%2013.25Zm1.75-.25a.25.25%200%200%200-.25.25v10.5c0%20.138.112.25.25.25h12.5a.25.25%200%200%200%20.25-.25V2.75a.25.25%200%200%200-.25-.25ZM7.25%208a.75.75%200%200%201-.22.53l-2.25%202.25a.749.749%200%200%201-1.275-.326.75.75%200%200%201%20.215-.734L5.44%208%203.72%206.28a.749.749%200%200%201%20.326-1.275.75.75%200%200%201%20.734.215l2.25%202.25c.141.14.22.331.22.53m1.5%201.5h3a.75.75%200%200%201%200%201.5h-3a.75.75%200%200%201%200-1.5%22/%3E%3C/svg%3E');}.md-tag.md-tag--howto{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22m21.71%2020.29-1.42%201.42a1%201%200%200%201-1.41%200L7%209.85A3.8%203.8%200%200%201%206%2010a4%204%200%200%201-3.78-5.3l2.54%202.54.53-.53%201.42-1.42.53-.53L4.7%202.22A4%204%200%200%201%2010%206a3.8%203.8%200%200%201-.15%201l11.86%2011.88a1%201%200%200%201%200%201.41M2.29%2018.88a1%201%200%200%200%200%201.41l1.42%201.42a1%201%200%200%200%201.41%200l5.47-5.46-2.83-2.83M20%202l-4%202v2l-2.17%202.17%202%202L18%208h2l2-4Z%22/%3E%3C/svg%3E');}.md-tag.md-tag--todo{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%202h4a1%201%200%200%201%201%201v4a1%201%200%200%201-1%201H2a1%201%200%200%201-1-1V3a1%201%200%200%201%201-1m4.655%208.595a.75.75%200%200%201%200%201.06L4.03%2014.28a.75.75%200%200%201-1.06%200l-1.5-1.5a.749.749%200%200%201%20.326-1.275.75.75%200%200%201%20.734.215l.97.97%202.095-2.095a.75.75%200%200%201%201.06%200M9.75%202.5h5.5a.75.75%200%200%201%200%201.5h-5.5a.75.75%200%200%201%200-1.5m0%205h5.5a.75.75%200%200%201%200%201.5h-5.5a.75.75%200%200%201%200-1.5m0%205h5.5a.75.75%200%200%201%200%201.5h-5.5a.75.75%200%200%201%200-1.5m-7.25-9v3h3v-3Z%22/%3E%3C/svg%3E');}.md-tag.md-tag--seealso{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M12%209a3%203%200%200%200-3%203%203%203%200%200%200%203%203%203%203%200%200%200%203-3%203%203%200%200%200-3-3m0%208a5%205%200%200%201-5-5%205%205%200%200%201%205-5%205%205%200%200%201%205%205%205%205%200%200%201-5%205m0-12.5C7%204.5%202.73%207.61%201%2012c1.73%204.39%206%207.5%2011%207.5s9.27-3.11%2011-7.5c-1.73-4.39-6-7.5-11-7.5%22/%3E%3C/svg%3E');}}</style><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../assets/_markdown_exec_pyodide.css rel=stylesheet><link href=../../assets/_markdown_exec_ansi.css rel=stylesheet><link href=../../assets/_mkdocstrings.css rel=stylesheet><link href=../../css/timeago.css rel=stylesheet><link href=../../assets/mkdocs_pagetree_plugin.css rel=stylesheet><link href=../../stylesheets/extra.css rel=stylesheet><link href=../../stylesheets/links.css rel=stylesheet><link href=../../stylesheets/code_select.css rel=stylesheet><link href=../../stylesheets/mermaid.css rel=stylesheet><link href=../../css/termynal.css rel=stylesheet><link href=../../css/custom.css rel=stylesheet><link href=../../css/mkdocstrings.css rel=stylesheet><link href=../../assets/stylesheets/badge.css rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body data-md-color-accent=indigo data-md-color-primary=indigo data-md-color-scheme=yellow dir=ltr> <input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox> <input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a class=md-skip href=#pvgisprototype.algorithms> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button aria-label="Don't show this again" class="md-banner__button md-icon"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> <div style="text-align: center; margin: 20px; padding: 10px; background-color: #ffcc00; color: black; border-radius: 5px;"> <strong> Under Continuous Development! </strong> <br> This documentation is auto-generated and regularly updated to reflect the latest development changes. Check out the <a href=../../development style="color:
        darkblue;">Development</a> pages. </div> </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav aria-label=Header class="md-header__inner md-grid"> <a aria-label=PVGIS class="md-header__button md-logo" data-md-component=logo href=../.. title=PVGIS> <img alt=logo src=../../images/pvgis_image_squared.png> </a> <label class="md-header__button md-icon" for=__drawer> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> PVGIS </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Algorithms </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input aria-label="Switch to dark mode" class=md-option data-md-color-accent=indigo data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary=indigo data-md-color-scheme=yellow id=__palette_0 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_1 hidden title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"></path></svg> </label> <input aria-label="Switch to light mode" class=md-option data-md-color-accent=indigo data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary=indigo data-md-color-scheme=blue id=__palette_1 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_0 hidden title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.04 7 9.54s-2.94 8.27-7 9.54c.95.3 1.95.46 3 .46a10 10 0 0 0 10-10A10 10 0 0 0 9 2"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false type=text> <label class="md-search__icon md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav aria-label=Search class=md-search__options> <a aria-label=Share class="md-search__icon md-icon" data-clipboard data-clipboard-text data-md-component=search-share href=javascript:void(0) tabindex=-1 title=Share> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button aria-label=Clear class="md-search__icon md-icon" tabindex=-1 title=Clear type=reset> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix tabindex=0> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a class=md-source data-md-component=source href=https://code.europa.eu/pvgis/pvgis.git title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> pvgis </div> </a> </div> </nav> <nav aria-label=Tabs class=md-tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a class=md-tabs__link href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"></path></svg> Overview </a> </li> <li class=md-tabs__item> <a href=../../install/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> Installation </a> </li> <li class=md-tabs__item> <a href=../../tutorials/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M14.19 14.19 6 18l3.81-8.19L18 6m-6-4A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2m0 8.9a1.1 1.1 0 0 0-1.1 1.1 1.1 1.1 0 0 0 1.1 1.1 1.1 1.1 0 0 0 1.1-1.1 1.1 1.1 0 0 0-1.1-1.1"></path></svg> Tutorials </a> </li> <li class=md-tabs__item> <a href=../../cli/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 19v-3h8v3zm-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5z"></path></svg> CLI </a> </li> <li class=md-tabs__item> <a href=../../web_api/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 .039c-6.627 0-12 5.354-12 11.96-.001 6.606 5.372 11.963 12 11.962S24.001 18.605 24 12 18.627.039 12 .039m-.829 5.415h7.55l-7.58 5.329h5.182L5.28 18.543Q8.226 12 11.171 5.455"></path></svg> Web API </a> </li> <li class=md-tabs__item> <a href=../../api/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"></path></svg> API </a> </li> <li class=md-tabs__item> <a href=../../reference/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13.5 4A1.5 1.5 0 0 0 12 5.5 1.5 1.5 0 0 0 13.5 7 1.5 1.5 0 0 0 15 5.5 1.5 1.5 0 0 0 13.5 4m-.36 4.77c-1.19.1-4.44 2.69-4.44 2.69-.2.15-.14.14.02.42.16.27.14.29.33.16.2-.13.53-.34 1.08-.68 2.12-1.36.34 1.78-.57 7.07-.36 2.62 2 1.27 2.61.87.6-.39 2.21-1.5 2.37-1.61.22-.15.06-.27-.11-.52-.12-.17-.24-.05-.24-.05-.65.43-1.84 1.33-2 .76-.19-.57 1.03-4.48 1.7-7.17.11-.64.41-2.04-.75-1.94"></path></svg> Reference </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15 4v2h3v12h-3v2h5V4M4 4v16h5v-2H6V6h3V4z"></path></svg> Source Code </a> </li> <li class=md-tabs__item> <a href=../../development/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M22 9V7h-2V5a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-2h2v-2h-2v-2h2v-2h-2V9zm-4 10H4V5h14zM6 13h5v4H6zm6-6h4v3h-4zM6 7h5v5H6zm6 4h4v6h-4z"></path></svg> Development </a> </li> <li class=md-tabs__item> <a href=../../includes/tags/ class=md-tabs__link> Tags </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label=Navigation class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level=0> <label class=md-nav__title for=__drawer> <a aria-label=PVGIS class="md-nav__button md-logo" data-md-component=logo href=../.. title=PVGIS> <img alt=logo src=../../images/pvgis_image_squared.png> </a> PVGIS </label> <div class=md-nav__source> <a class=md-source data-md-component=source href=https://code.europa.eu/pvgis/pvgis.git title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> pvgis </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_1 type=checkbox> <div class="md-nav__link md-nav__container"> <a class=md-nav__link href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"></path></svg> <span class=md-ellipsis> Overview <br> <small>Photovoltaic Geographic Information System</small> </span> </a> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_1_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Overview </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../site_tree/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M21 16v-3c0-1.11-.89-2-2-2h-6V8h2V2H9v6h2v3H5c-1.11 0-2 .89-2 2v3H1v6h6v-6H5v-3h6v3H9v6h6v-6h-2v-3h6v3h-2v6h6v-6zM11 4h2v2h-2zM5 20H3v-2h2zm8 0h-2v-2h2zm8 0h-2v-2h2z"></path></svg> <span class=md-ellipsis> Site tree </span> </a> </li> <li class=md-nav__item> <a href=../../license/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9 10a3.04 3.04 0 0 1 3-3 3.04 3.04 0 0 1 3 3 3.04 3.04 0 0 1-3 3 3.04 3.04 0 0 1-3-3m3 9 4 1v-3.08A7.54 7.54 0 0 1 12 18a7.54 7.54 0 0 1-4-1.08V20m4-16a5.78 5.78 0 0 0-4.24 1.74A5.78 5.78 0 0 0 6 10a5.78 5.78 0 0 0 1.76 4.23A5.78 5.78 0 0 0 12 16a5.78 5.78 0 0 0 4.24-1.77A5.78 5.78 0 0 0 18 10a5.78 5.78 0 0 0-1.76-4.26A5.78 5.78 0 0 0 12 4m8 6a8 8 0 0 1-.57 2.8A7.8 7.8 0 0 1 18 15.28V23l-6-2-6 2v-7.72A7.9 7.9 0 0 1 4 10a7.68 7.68 0 0 1 2.33-5.64A7.73 7.73 0 0 1 12 2a7.73 7.73 0 0 1 5.67 2.36A7.68 7.68 0 0 1 20 10"></path></svg> <span class=md-ellipsis> License <br> <small>European Union Public License 1.2</small> </span> </a> </li> <li class=md-nav__item> <a href=../../acknowledgements/ class=md-nav__link> <svg viewbox="0 0 576 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M64 0C28.7 0 0 28.7 0 64v72c0 13.3 10.7 24 24 24s24-10.7 24-24V64c0-8.8 7.2-16 16-16h72c13.3 0 24-10.7 24-24S149.3 0 136 0zm376 0c-13.3 0-24 10.7-24 24s10.7 24 24 24h72c8.8 0 16 7.2 16 16v72c0 13.3 10.7 24 24 24s24-10.7 24-24V64c0-35.3-28.7-64-64-64zM48 376c0-13.3-10.7-24-24-24S0 362.7 0 376v72c0 35.3 28.7 64 64 64h72c13.3 0 24-10.7 24-24s-10.7-24-24-24H64c-8.8 0-16-7.2-16-16zm528 0c0-13.3-10.7-24-24-24s-24 10.7-24 24v72c0 8.8-7.2 16-16 16h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h72c35.3 0 64-28.7 64-64zM288 216a56 56 0 1 0 0-112 56 56 0 1 0 0 112m0 40c-53 0-96 43-96 96v24c0 13.3 10.7 24 24 24h144c13.3 0 24-10.7 24-24v-24c0-53-43-96-96-96m192-64a48 48 0 1 0-96 0 48 48 0 1 0 96 0m-312 80.3c-49.3 4.1-88 45.3-88 95.7v10.7c0 11.8 9.6 21.3 21.3 21.3h46.8c-2.7-7.5-4.1-15.6-4.1-24v-24c0-29.5 8.8-56.9 24-79.7M427.9 400h46.8c11.8 0 21.3-9.6 21.3-21.3V368c0-50.3-38.7-91.6-88-95.7 15.2 22.8 24 50.2 24 79.7v24c0 8.4-1.4 16.5-4.1 24M192 192a48 48 0 1 0-96 0 48 48 0 1 0 96 0"></path></svg> <span class=md-ellipsis> Acknowledgments </span> </a> </li> <li class=md-nav__item> <a href=../../credits/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9 10a3.04 3.04 0 0 1 3-3 3.04 3.04 0 0 1 3 3 3.04 3.04 0 0 1-3 3 3.04 3.04 0 0 1-3-3m3 9 4 1v-3.08A7.54 7.54 0 0 1 12 18a7.54 7.54 0 0 1-4-1.08V20m4-16a5.78 5.78 0 0 0-4.24 1.74A5.78 5.78 0 0 0 6 10a5.78 5.78 0 0 0 1.76 4.23A5.78 5.78 0 0 0 12 16a5.78 5.78 0 0 0 4.24-1.77A5.78 5.78 0 0 0 18 10a5.78 5.78 0 0 0-1.76-4.26A5.78 5.78 0 0 0 12 4m8 6a8 8 0 0 1-.57 2.8A7.8 7.8 0 0 1 18 15.28V23l-6-2-6 2v-7.72A7.9 7.9 0 0 1 4 10a7.68 7.68 0 0 1 2.33-5.64A7.73 7.73 0 0 1 12 2a7.73 7.73 0 0 1 5.67 2.36A7.68 7.68 0 0 1 20 10"></path></svg> <span class=md-ellipsis> Credits </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../install/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Installation </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_3 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../tutorials/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M14.19 14.19 6 18l3.81-8.19L18 6m-6-4A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2m0 8.9a1.1 1.1 0 0 0-1.1 1.1 1.1 1.1 0 0 0 1.1 1.1 1.1 1.1 0 0 0 1.1-1.1 1.1 1.1 0 0 0-1.1-1.1"></path></svg> <span class=md-ellipsis> Tutorials <br> <small>Hands-on walkthroughs</small> </span> </a> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_3_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/introduction/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14 12-4-4v3H2v2h8v3m12-4a10 10 0 0 1-19.54 3h2.13a8 8 0 1 0 0-6H2.46A10 10 0 0 1 22 12"></path></svg> <span class=md-ellipsis> Introduction <br> <small>A gentle introduction to elements of photovoltaic performance using PVGIS</small> </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_3_2 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../tutorials/solar_position/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13.8 5.2C13 5 12.2 5 11.4 5l3.2-2.7 1.4 4c-.7-.5-1.4-.8-2.2-1.1M7 7.1c.6-.6 1.3-1.1 2-1.4l-4.1-.8.7 4.1c.4-.7.8-1.4 1.4-1.9m-1.8 6.7C5 13 5 12.2 5 11.4l-2.7 3.2 4 1.4c-.5-.6-.9-1.4-1.1-2.2M22 19v2H3l5.4-5.5c-1.9-2-1.9-5.1 0-7.1 1.9-1.9 5.1-1.9 7 0l3-3 1.4 1.4L7.7 19z"></path></svg> <span class=md-ellipsis> Solar Position </span> </a> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_3_2_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Solar Position </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../notebooks/solar_position_pvgis_noaa_vs_other_models/ class=md-nav__link> <span class=md-ellipsis> Comparison of Positioning Algorithms </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../notebooks/surface_position_optimization_examples/ class=md-nav__link> <span class=md-ellipsis> Optimization of Surface Position </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/solar_irradiance/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M11 6c2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5 2.24-5 5-5m0-5 2.39 3.42C12.65 4.15 11.84 4 11 4s-1.65.15-2.39.42zM2.34 6l4.16-.35A7.2 7.2 0 0 0 4.94 7.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM19.65 6l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zM23 13h-2c0 2.05-.78 4.1-2.34 5.66A7.96 7.96 0 0 1 13 21v2c2.56 0 5.12-1 7.07-2.93S23 15.56 23 13m-4 0h-2c0 1-.39 2.05-1.17 2.83S14 17 13 17v2a5.989 5.989 0 0 0 6-6"></path></svg> <span class=md-ellipsis> Solar Irradiance </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/photovoltaic_performance/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3.33 16H11v-3H4zM13 16h7.67L20 13h-7zm8.11 2H13v4h9zM2 22h9v-4H2.89zm9-14h2v3h-2zm4.76-.79 1.42-1.42 2.12 2.12-1.41 1.42zm-11.05.7 2.12-2.12 1.41 1.42-2.12 2.12zM3 2h3v2H3zm15 0h3v2h-3zm-6 5c2.76 0 5-2.24 5-5H7c0 2.76 2.24 5 5 5"></path></svg> <span class=md-ellipsis> Photovoltaic Performance </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_4 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../cli/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 19v-3h8v3zm-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5z"></path></svg> <span class=md-ellipsis> CLI <br> <small>Work with PVGIS interactively</small> </span> </a> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_4_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> CLI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/features/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 3v8h8V3zM3 21h8v-8H3zM3 3v8h8V3zm10 13h3v-3h2v3h3v2h-3v3h-2v-3h-3z"></path></svg> <span class=md-ellipsis> Features </span> </a> </li> <li class=md-nav__item> <a href=../../cli/basics/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M6 11a2 2 0 0 1 2 2v4H4a2 2 0 0 1-2-2v-2a2 2 0 0 1 2-2zm-2 2v2h2v-2zm16 0v2h2v2h-2a2 2 0 0 1-2-2v-2a2 2 0 0 1 2-2h2v2zm-8-6v4h2a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-2a2 2 0 0 1-2-2V7zm0 8h2v-2h-2z"></path></svg> <span class=md-ellipsis> Basics <br> <small>Basics of the Command Line Interface</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/verbosity/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 3c5.5 0 10 3.58 10 8s-4.5 8-10 8c-1.24 0-2.43-.18-3.53-.5C5.55 21 2 21 2 21c2.33-2.33 2.7-3.9 2.75-4.5C3.05 15.07 2 13.13 2 11c0-4.42 4.5-8 10-8m5 9v-2h-2v2zm-4 0v-2h-2v2zm-4 0v-2H7v2z"></path></svg> <span class=md-ellipsis> Verbosity <br> <small>Show what's going on</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/symbols/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M2 7v7h2V7zm4 0v2h4v2H8v3h2v-1c1.11 0 2-.89 2-2V9c0-1.11-.89-2-2-2zm9.8 0-.2 2H14v2h1.4l-.2 2H14v2h1l-.2 2h2l.2-2h1.4l-.2 2h2l.2-2H22v-2h-1.4l.2-2H22V9h-1l.2-2h-2L19 9h-1.4l.2-2zm1.6 4h1.4l-.2 2h-1.4zM2 15v2h2v-2zm6 0v2h2v-2z"></path></svg> <span class=md-ellipsis> Symbols </span> </a> </li> <li class=md-nav__item> <a href=../../cli/timestamps/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15 13h1.5v2.82l2.44 1.41-.75 1.3L15 16.69zm4-5H5v11h4.67c-.43-.91-.67-1.93-.67-3a7 7 0 0 1 7-7c1.07 0 2.09.24 3 .67zM5 21a2 2 0 0 1-2-2V5c0-1.11.89-2 2-2h1V1h2v2h8V1h2v2h1a2 2 0 0 1 2 2v6.1c1.24 1.26 2 2.99 2 4.9a7 7 0 0 1-7 7c-1.91 0-3.64-.76-4.9-2zm11-9.85A4.85 4.85 0 0 0 11.15 16c0 2.68 2.17 4.85 4.85 4.85A4.85 4.85 0 0 0 20.85 16c0-2.68-2.17-4.85-4.85-4.85"></path></svg> <span class=md-ellipsis> Timestamps <br> <small>Work with time series</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/precision/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M5 13v3H4l-1-3a1 1 0 0 1 2 0m10 3v-2l-3 3 3 3v-2h6v-2m-9-5a3 3 0 0 1-6 0V8a3 3 0 0 1 6 0m-2 0a1 1 0 0 0-2 0v3a1 1 0 0 0 2 0Z"></path></svg> <span class=md-ellipsis> Precision </span> </a> </li> <li class=md-nav__item> <a href=../../cli/plots/ class=md-nav__link> <svg viewbox="0 0 16 16" xmlns=http://www.w3.org/2000/svg><path d="M1.5 1.75V13.5h13.75a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75V1.75a.75.75 0 0 1 1.5 0m14.28 2.53-5.25 5.25a.75.75 0 0 1-1.06 0L7 7.06 4.28 9.78a.75.75 0 0 1-1.042-.018.75.75 0 0 1-.018-1.042l3.25-3.25a.75.75 0 0 1 1.06 0L10 7.94l4.72-4.72a.75.75 0 0 1 1.042.018.75.75 0 0 1 .018 1.042"></path></svg> <span class=md-ellipsis> Plots <br> <small>Plot time series data</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/fingerprint/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M17.81 4.47c-.08 0-.16-.02-.23-.06C15.66 3.42 14 3 12 3c-1.97 0-3.85.47-5.56 1.41-.24.13-.54.04-.68-.2a.506.506 0 0 1 .2-.68C7.82 2.5 9.86 2 12 2s4 .47 6.04 1.5c.25.15.34.45.21.69a.48.48 0 0 1-.44.28M3.5 9.72c-.1 0-.2-.03-.29-.09a.517.517 0 0 1-.12-.7c.99-1.4 2.25-2.5 3.75-3.27C10 4.04 14 4.03 17.15 5.65c1.5.77 2.76 1.85 3.75 3.25.16.22.1.54-.12.7-.23.16-.54.11-.7-.1a9.26 9.26 0 0 0-3.39-2.96c-2.87-1.47-6.54-1.47-9.4.01-1.36.7-2.5 1.7-3.4 2.95-.08.15-.23.22-.39.22m6.25 12.07c-.13 0-.25-.05-.35-.15-.87-.87-1.34-1.43-2.01-2.64-.69-1.23-1.05-2.73-1.05-4.34 0-2.97 2.54-5.39 5.66-5.39s5.66 2.42 5.66 5.39a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5c0-2.42-2.09-4.39-4.66-4.39s-4.66 1.97-4.66 4.39c0 1.44.32 2.77.93 3.84.64 1.16 1.08 1.65 1.85 2.43.19.2.19.51 0 .71-.12.1-.24.15-.37.15m7.17-1.85c-1.19 0-2.24-.3-3.1-.89-1.49-1.01-2.38-2.65-2.38-4.39a.5.5 0 0 1 .5-.5.5.5 0 0 1 .5.5c0 1.41.72 2.74 1.94 3.56.71.48 1.54.71 2.54.71.24 0 .64-.03 1.04-.1.27-.05.54.13.58.41.05.26-.13.53-.41.58-.57.11-1.07.12-1.21.12M14.91 22h-.13c-1.59-.46-2.63-1.05-3.72-2.12a7.28 7.28 0 0 1-2.17-5.22c0-1.62 1.38-2.94 3.08-2.94s3.08 1.32 3.08 2.94c0 1.07.95 1.94 2.08 1.94 1.15 0 2.08-.87 2.08-1.94 0-3.77-3.25-6.83-7.25-6.83-2.84 0-5.46 1.58-6.61 4.03-.39.81-.59 1.76-.59 2.8 0 .78.07 2.01.67 3.61.1.26-.03.55-.29.64a.504.504 0 0 1-.64-.29c-.5-1.31-.73-2.62-.73-3.96 0-1.2.23-2.29.68-3.24 1.33-2.79 4.28-4.6 7.51-4.6 4.54 0 8.25 3.51 8.25 7.83 0 1.62-1.38 2.94-3.08 2.94s-3.08-1.32-3.08-2.94c0-1.07-.93-1.94-2.08-1.94s-2.08.87-2.08 1.94c0 1.71.66 3.31 1.87 4.51.95.94 1.86 1.46 3.27 1.84.27.08.42.36.35.62-.05.23-.26.38-.47.38"></path></svg> <span class=md-ellipsis> Fingerprint <br> <small>Fingerprint calculation output</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/csv/ class=md-nav__link> <svg viewbox="0 0 576 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M96 0C60.7 0 32 28.7 32 64v384c0 35.3 28.7 64 64 64h80V400c0-35.3 28.7-64 64-64h176V170.5c0-17-6.7-33.3-18.7-45.3L290.7 18.7C278.7 6.7 262.5 0 245.5 0zm261.5 176H264c-13.3 0-24-10.7-24-24V58.5zM264 380c-24.3 0-44 19.7-44 44v80c0 24.3 19.7 44 44 44h16c24.3 0 44-19.7 44-44v-8c0-11-9-20-20-20s-20 9-20 20v8c0 2.2-1.8 4-4 4h-16c-2.2 0-4-1.8-4-4v-80c0-2.2 1.8-4 4-4h16c2.2 0 4 1.8 4 4v8c0 11 9 20 20 20s20-9 20-20v-8c0-24.3-19.7-44-44-44zm136 0c-28.7 0-52 23.3-52 52s23.3 52 52 52c6.6 0 12 5.4 12 12s-5.4 12-12 12h-32c-11 0-20 9-20 20s9 20 20 20h32c28.7 0 52-23.3 52-52s-23.3-52-52-52c-6.6 0-12-5.4-12-12s5.4-12 12-12h24c11 0 20-9 20-20s-9-20-20-20zm96 0c-11 0-20 9-20 20v31.6c0 35.5 10.5 70.3 30.2 99.8l5.1 7.7c3.7 5.6 10 8.9 16.6 8.9s12.9-3.3 16.6-8.9l5.1-7.7c19.7-29.6 30.2-64.3 30.2-99.8V400c0-11-9-20-20-20s-20 9-20 20v31.6c0 19.6-4.1 38.9-12 56.7-7.9-17.8-12-37.1-12-56.7V400c0-11-9-20-20-20z"></path></svg> <span class=md-ellipsis> CSV <br> <small>Export output as CSV</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/qrcode/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M4 4h6v6H4zm16 0v6h-6V4zm-6 11h2v-2h-2v-2h2v2h2v-2h2v2h-2v2h2v3h-2v2h-2v-2h-3v2h-2v-4h3zm2 0v3h2v-3zM4 20v-6h6v6zM6 6v2h2V6zm10 0v2h2V6zM6 16v2h2v-2zm-2-5h2v2H4zm5 0h4v4h-2v-2H9zm2-5h2v4h-2zM2 2v4H0V2a2 2 0 0 1 2-2h4v2zm20-2a2 2 0 0 1 2 2v4h-2V2h-4V0zM2 18v4h4v2H2a2 2 0 0 1-2-2v-4zm20 4v-4h2v4a2 2 0 0 1-2 2h-4v-2z"></path></svg> <span class=md-ellipsis> QR Code <br> <small>Share result via a QR Code</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/metadata/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10 7v2H9v6h1v2H6v-2h1V9H6V7zm6 0a2 2 0 0 1 2 2v6c0 1.11-.89 2-2 2h-4V7m4 2h-2v6h2z"></path></svg> <span class=md-ellipsis> Metadata </span> </a> </li> <li class=md-nav__item> <a href=../../cli/numpy/ class=md-nav__link> <?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg height=19.443359 id=svg1 inkscape:version="1.3.2 (091e20ef0f, 2023-11-25, custom)" role=img sodipodi:docname=data_array.svg version=1.1 viewbox="0 0 18.183593 19.443359" width=18.183594 xmlns=http://www.w3.org/2000/svg xmlns:cc=http://creativecommons.org/ns# xmlns:dc=http://purl.org/dc/elements/1.1/ xmlns:inkscape=http://www.inkscape.org/namespaces/inkscape xmlns:rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# xmlns:sodipodi=http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd xmlns:svg=http://www.w3.org/2000/svg> <defs id=defs1></defs> <sodipodi:namedview bordercolor=#ffffff borderopacity=1 id=namedview1 inkscape:current-layer=svg1 inkscape:cx=18.164856 inkscape:cy=8.2982623 inkscape:deskcolor=#505050 inkscape:pagecheckerboard=1 inkscape:pageopacity=0 inkscape:showpageshadow=0 inkscape:window-height=1080 inkscape:window-maximized=0 inkscape:window-width=1920 inkscape:window-x=0 inkscape:window-y=0 inkscape:zoom=25.185996 pagecolor=#505050 showguides=true> <sodipodi:guide id=guide9 inkscape:locked=false orientation=0,-1 position=8.4117921,14.634449></sodipodi:guide> <sodipodi:guide id=guide10 inkscape:locked=false orientation=1,0 position=9.0775011,15.239638></sodipodi:guide> </sodipodi:namedview> <title id=title1>NumPy</title> <path d="M 9.1028758,1.8471229 6.5795357,3.1064197 9.2072897,4.4321619 11.654692,3.1269862 Z m -3.7509964,1.871543 -2.887207,1.4412304 2.7021094,1.3573828 2.8160156,-1.469707 z m 7.5225586,0.020567 -2.464805,1.2988476 2.763809,1.3953515 2.534414,-1.2735351 z M 9.1898868,5.6550721 6.3801998,7.1263612 9.085473,8.4853257 11.947367,7.0472596 Z m 7.2662702,0.405 -2.640411,1.3130859 0.0016,3.453574 2.638829,-1.3415625 z M 1.7274459,6.0632362 V 9.4883341 L 4.366274,10.829897 4.3678535,7.3763221 Z M 12.741547,7.9063025 9.6597508,9.4392911 v 3.4472459 l 3.0865422,-1.532989 z m -7.3010738,0.00317 -0.00317,3.4472455 3.086543,1.532989 V 9.4424549 Z m 11.0156838,2.7986135 -2.638828,1.330488 0.0031,3.478887 2.635664,-1.314668 z m -14.7287111,0.0016 v 3.496289 l 2.635664,1.314668 0.00158,-3.478887 z M 12.746293,12.56859 9.6597508,14.112652 v 3.482051 l 3.0897072,-1.542481 z m -7.3105658,0.0031 -0.00317,3.483632 3.0912891,1.540899 v -3.480469 z" id=path8 style=stroke-width:0.6561></path> <metadata id=metadata1> <rdf:rdf> <cc:work rdf:about> <dc:title>NumPy</dc:title> </cc:work> </rdf:rdf> </metadata> </svg> <span class=md-ellipsis> Array Computing </span> </a> </li> <li class=md-nav__item> <a href=../../cli/logging/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m19.07 14.88 2.05 2.05L15.06 23H13v-2.06zm1.97-1.75c.14 0 .27.06.38.17l1.28 1.28c.22.21.22.56 0 .77l-1 1-2.05-2.05 1-1c.11-.11.25-.17.39-.17M17 4v6l-2-2-2 2V4H9v16h2v2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7H3V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v6l-2 2V4zM5 5v2h2V5zm0 6v2h2v-2zm0 6v2h2v-2z"></path></svg> <span class=md-ellipsis> Logging <br> <small>Log details of a command execution</small> </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_4_14 type=checkbox> <label class=md-nav__link for=__nav_4_14 id=__nav_4_14_label tabindex=0> <span class=md-ellipsis> Power </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_14_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_14> <span class="md-nav__icon md-icon"></span> Power </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/power/introduction/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14 12-4-4v3H2v2h8v3m12-4a10 10 0 0 1-19.54 3h2.13a8 8 0 1 0 0-6H2.46A10 10 0 0 1 22 12"></path></svg> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../cli/power/tools/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Power Tools <br> <small>Estimate photovoltaic power</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/power/broadband/ class=md-nav__link> <svg role=img viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><title>Spectrum</title><path d="M0 10.2A1.8 1.8 0 001.8 12h1.8a8.4 8.4 0 018.4 8.4v1.8a1.8 1.8 0 001.8 1.8h8.4a1.8 1.8 0 001.8-1.8v-1.8C24 9.133 14.867 0 3.6 0H1.8A1.8 1.8 0 000 1.8v8.4z"></path></svg> <span class=md-ellipsis> Broadband <br> <small>Estimate photovoltaic performance over a time series based on broadband irradiance</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/power/spectral/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m8.5 4.5-3.1 5 3.1 5.2-3.3 5.8-1.8-.9 2.7-4.9L3 9.5l3.7-5.9zm6.2-.1-3.1 5.1 3.1 5-3.3 5.8-1.8-.9 2.7-4.9-3.1-5 3.7-6zm6.3 0-3.1 5.1 3.1 5-3.3 5.8-1.8-.9 2.7-4.9-3.1-5 3.7-6z"></path></svg> <span class=md-ellipsis> Spectrally Resolved <br> <small>Estimate photovoltaic performance over a time series based on spectrally resolved irradiance</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/power/spectral_effect/ class=md-nav__link> <svg role=img viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><title>Spectrum</title><path d="M0 10.2A1.8 1.8 0 001.8 12h1.8a8.4 8.4 0 018.4 8.4v1.8a1.8 1.8 0 001.8 1.8h8.4a1.8 1.8 0 001.8-1.8v-1.8C24 9.133 14.867 0 3.6 0H1.8A1.8 1.8 0 000 1.8v8.4z"></path></svg> <span class=md-ellipsis> Spectral Effect </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_4_15 type=checkbox> <label class=md-nav__link for=__nav_4_15 id=__nav_4_15_label tabindex=0> <span class=md-ellipsis> Irradiance </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_15_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_15> <span class="md-nav__icon md-icon"></span> Irradiance </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/irradiance/introduction/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14 12-4-4v3H2v2h8v3m12-4a10 10 0 0 1-19.54 3h2.13a8 8 0 1 0 0-6H2.46A10 10 0 0 1 22 12"></path></svg> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../cli/irradiance/tools/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Irradiance Tools </span> </a> </li> <li class=md-nav__item> <a href=../../cli/irradiance/global/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M11 6c2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5 2.24-5 5-5m0-5 2.39 3.42C12.65 4.15 11.84 4 11 4s-1.65.15-2.39.42zM2.34 6l4.16-.35A7.2 7.2 0 0 0 4.94 7.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM19.65 6l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zM23 13h-2c0 2.05-.78 4.1-2.34 5.66A7.96 7.96 0 0 1 13 21v2c2.56 0 5.12-1 7.07-2.93S23 15.56 23 13m-4 0h-2c0 1-.39 2.05-1.17 2.83S14 17 13 17v2a5.989 5.989 0 0 0 6-6"></path></svg> <span class=md-ellipsis> Global </span> </a> </li> <li class=md-nav__item> <a href=../../cli/irradiance/direct/ class=md-nav__link> <?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg height=110 id=svg1 inkscape:version="1.3.2 (091e20ef0f, 2023-11-25, custom)" sodipodi:docname=direct_irradiance.svg.svg version=1.1 viewbox="0 0 110 110" width=110 xmlns=http://www.w3.org/2000/svg xmlns:inkscape=http://www.inkscape.org/namespaces/inkscape xmlns:sodipodi=http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd xmlns:svg=http://www.w3.org/2000/svg> <defs id=defs1></defs> <sodipodi:namedview bordercolor=#ffffff borderopacity=1 id=namedview1 inkscape:current-layer=svg1 inkscape:cx=27.493312 inkscape:cy=32.641462 inkscape:deskcolor=#505050 inkscape:pagecheckerboard=1 inkscape:pageopacity=0 inkscape:showpageshadow=0 inkscape:window-height=1080 inkscape:window-maximized=0 inkscape:window-width=1920 inkscape:window-x=0 inkscape:window-y=0 inkscape:zoom=4.5647465 pagecolor=#505050></sodipodi:namedview> <path d="m 29.135039,0 -8.040865,11.50667 c 2.489716,-0.90841 5.214701,-1.413596 8.040865,-1.413596 2.826164,0 5.552813,0.505186 8.042528,1.413596 z M 44.27548,15.611087 c 2.018689,1.715884 3.802256,3.835644 5.215337,6.258071 1.413082,2.45607 2.32124,5.046988 2.792268,7.704928 L 58.23848,16.823452 Z M 13.99626,15.644353 0,16.823457 5.9537317,29.574091 c 0.4710284,-2.65794 1.3135599,-5.215213 2.7939308,-7.704928 1.4130825,-2.422427 3.2299085,-4.508925 5.2485975,-6.22481 z m 15.138779,1.179104 c -9.285967,0 -16.821789,7.535822 -16.821789,16.821789 0,9.285968 7.535822,16.82179 16.821789,16.82179 9.285967,0 16.823452,-7.535822 16.823452,-16.82179 0,-9.285967 -7.537485,-16.821789 -16.823452,-16.821789 z m 0,6.728716 c 5.551394,0 10.094736,4.54168 10.094736,10.093073 0,5.551394 -4.543342,10.093075 -10.094736,10.093075 -5.551395,0 -10.093074,-4.541681 -10.093074,-10.093075 0,-5.551393 4.541679,-10.093073 10.093074,-10.093073 z M 95.29298,36.41589 82.989711,48.719162 77.247186,54.461687 60.022938,72.096709 54.280413,77.839234 32.133524,100.39523 H 110.05758 V 92.193054 H 51.409982 L 101.0355,42.156752 Z M 5.9886564,37.78292 0.06652152,50.467031 13.99626,51.712658 C 12.011216,49.996774 10.194004,47.911041 8.7809238,45.421325 7.3678409,42.9989 6.4596825,40.373569 5.9886564,37.78292 Z m 43.3341926,2.591038 c 0,3.364481 -1.312153,6.896688 -3.936448,9.520982 -2.624295,2.624295 -6.156502,3.936449 -9.520983,3.936449 v 6.730379 c 5.1813,0 10.362494,-1.985692 14.298936,-5.922135 3.902799,-3.902798 5.887211,-9.084374 5.887211,-14.265675 z m 13.457432,0 c 0,6.897187 -2.624307,13.795038 -7.872897,19.043628 -5.282235,5.282237 -12.144781,7.872897 -19.041966,7.872897 V 74.0192 c 8.61307,0 17.22592,-3.365136 23.786659,-9.858584 6.560737,-6.493448 9.856919,-15.173587 9.856919,-23.786658 z" id=path7 style=stroke-width:3.36448></path> </svg> <span class=md-ellipsis> Direct </span> </a> </li> <li class=md-nav__item> <a href=../../cli/irradiance/diffuse/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14.264 2.761-1.23 9.432-1.648 1.882-1.71-11.301h-.002l-.2.042-.066.013-.132.03-.064.016a12 12 0 0 0-1.74.55l-.037.019 3.398 11.263-.158.18-1.598-.703-.105.134L3.445 6.1a11 11 0 0 0-.927 1.047 13 13 0 0 0-.552.76v.006l6.481 7.081-1.021 1.313-7.205-4.15a11.7 11.7 0 0 0-.22 2.31l6.853 2.575-1.576 2.025-4.31.02A12 12 0 0 0 2.18 21.24h.003l1.696-.373h.45l4.863-6.223 1.583.701 3.338-3.812c1.85 3.145 3.844 6.17 5.657 9.337h.453l-.008-.014 1.612.363.016-.018a11 11 0 0 0 .774-1.256 11 11 0 0 0 .353-.726l-3.788-.064-1.333-2.196 6.146-2.241v-.031l.004-.203v-.312l-.004-.064v-.067l-.003-.068-.003-.067-.003-.068-.003-.067-.005-.064-.003-.068-.007-.067-.003-.067-.006-.064-.006-.068-.006-.067-.007-.067-.006-.065a10 10 0 0 0-.113-.796v-.016l-6.506 3.72-1.047-1.725 5.737-6.493a11 11 0 0 0-.888-1.17 12 12 0 0 0-.692-.729l-4.725 7.455-1.372-2.258 2.153-7.754-.055-.021a11.6 11.6 0 0 0-2.006-.595l-.132-.027zm-.159 9.331-3.246 3.721-1.583-.659-4.483 5.708h.496l4.103-5.251 1.574.652 3.084-3.537 4.851 8.152.477-.01zm-.073 1.302-2.912 3.344-1.605-.653-3.746 4.774 12.636.007z"></path></svg> <span class=md-ellipsis> Diffuse </span> </a> </li> <li class=md-nav__item> <a href=../../cli/irradiance/reflected/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m22 12-5 10L7.1 6.04 4.24 12H2L7 2l9.9 15.96L19.76 12z"></path></svg> <span class=md-ellipsis> Reflected </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_4_16 type=checkbox> <label class=md-nav__link for=__nav_4_16 id=__nav_4_16_label tabindex=0> <span class=md-ellipsis> Position </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_16_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_16> <span class="md-nav__icon md-icon"></span> Position </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/position/introduction/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14 12-4-4v3H2v2h8v3m12-4a10 10 0 0 1-19.54 3h2.13a8 8 0 1 0 0-6H2.46A10 10 0 0 1 22 12"></path></svg> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../cli/position/tools/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Position Tools </span> </a> </li> <li class=md-nav__item> <a href=../../cli/position/overview/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13.8 5.2C13 5 12.2 5 11.4 5l3.2-2.7 1.4 4c-.7-.5-1.4-.8-2.2-1.1M7 7.1c.6-.6 1.3-1.1 2-1.4l-4.1-.8.7 4.1c.4-.7.8-1.4 1.4-1.9m-1.8 6.7C5 13 5 12.2 5 11.4l-2.7 3.2 4 1.4c-.5-.6-.9-1.4-1.1-2.2M22 19v2H3l5.4-5.5c-1.9-2-1.9-5.1 0-7.1 1.9-1.9 5.1-1.9 7 0l3-3 1.4 1.4L7.7 19z"></path></svg> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../cli/position/time/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18.1 9.3 19.6 6l-4.1-.4c.6.5 1.1 1.1 1.5 1.9.3.6.5 1.1.7 1.7-.5-.1-1.1-.2-1.7-.2h-.4c-.8-1.8-2.5-3-4.6-3-2.8 0-5 2.2-5 5 0 2.1 1.2 3.8 3 4.6v.4c0 3.9 3.1 7 7 7s7-3.1 7-7c0-3.1-2.1-5.8-4.9-6.7M16 21c-2.8 0-5-2.2-5-5s2.2-5 5-5 5 2.2 5 5-2.2 5-5 5m.5-4.8 2.9 1.7-.8 1.2L15 17v-5h1.5zM11 4c-.8 0-1.6.2-2.4.4L11 1l2.4 3.4c-.8-.2-1.6-.4-2.4-.4M4.9 14.5c.4.7 1 1.4 1.6 1.9L2.4 16l1.8-3.8c.1.8.3 1.6.7 2.3m-.8-4.7L2.3 6l4.2-.3c-.6.5-1.1 1.1-1.6 1.8-.4.7-.7 1.5-.8 2.3"></path></svg> <span class=md-ellipsis> Solar Time <br> <small>All about solar time</small> </span> </a> </li> <li class=md-nav__item> <a href=../../cli/position/incidence/ class=md-nav__link> <span class=md-ellipsis> Incidence </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_5 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../web_api/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 .039c-6.627 0-12 5.354-12 11.96-.001 6.606 5.372 11.963 12 11.962S24.001 18.605 24 12 18.627.039 12 .039m-.829 5.415h7.55l-7.58 5.329h5.182L5.28 18.543Q8.226 12 11.171 5.455"></path></svg> <span class=md-ellipsis> Web API </span> </a> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_5_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Web API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../web_api/install/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Install </span> </a> </li> <li class=md-nav__item> <a href=../../web_api/run/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 12v7l-3 1-3-4.67c-.29-.44-1-.19-.92.34L14 23 4 18l.96-5.25C5.56 9.42 8.46 7 11.84 7H13l6-6-2 6h3l-1.58 2.37C19.36 9.88 20 10.86 20 12"></path></svg> <span class=md-ellipsis> Run </span> </a> </li> <li class=md-nav__item> <a href=../../web_api/examples/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 19h1a1 1 0 0 1 1 1h7v2h-7a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1H2v-2h7a1 1 0 0 1 1-1h1v-2H4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1h-7zM4 3h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1m5 4h1V5H9zm0 8h1v-2H9zM5 5v2h2V5zm0 8v2h2v-2z"></path></svg> <span class=md-ellipsis> Examples </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_6 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../api/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"></path></svg> <span class=md-ellipsis> API </span> </a> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_6_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/position/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13.8 5.2C13 5 12.2 5 11.4 5l3.2-2.7 1.4 4c-.7-.5-1.4-.8-2.2-1.1M7 7.1c.6-.6 1.3-1.1 2-1.4l-4.1-.8.7 4.1c.4-.7.8-1.4 1.4-1.9m-1.8 6.7C5 13 5 12.2 5 11.4l-2.7 3.2 4 1.4c-.5-.6-.9-1.4-1.1-2.2M22 19v2H3l5.4-5.5c-1.9-2-1.9-5.1 0-7.1 1.9-1.9 5.1-1.9 7 0l3-3 1.4 1.4L7.7 19z"></path></svg> <span class=md-ellipsis> Solar Position <br> <small>Estimate photovoltaic performance over a time series based on broadband irradiance</small> </span> </a> </li> <li class=md-nav__item> <a href=../../api/power/ class=md-nav__link> <svg role=img viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><title>Spectrum</title><path d="M0 10.2A1.8 1.8 0 001.8 12h1.8a8.4 8.4 0 018.4 8.4v1.8a1.8 1.8 0 001.8 1.8h8.4a1.8 1.8 0 001.8-1.8v-1.8C24 9.133 14.867 0 3.6 0H1.8A1.8 1.8 0 000 1.8v8.4z"></path></svg> <span class=md-ellipsis> Photovoltaic power <br> <small>Estimate photovoltaic performance over a time series based on broadband irradiance</small> </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_7 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../reference/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13.5 4A1.5 1.5 0 0 0 12 5.5 1.5 1.5 0 0 0 13.5 7 1.5 1.5 0 0 0 15 5.5 1.5 1.5 0 0 0 13.5 4m-.36 4.77c-1.19.1-4.44 2.69-4.44 2.69-.2.15-.14.14.02.42.16.27.14.29.33.16.2-.13.53-.34 1.08-.68 2.12-1.36.34 1.78-.57 7.07-.36 2.62 2 1.27 2.61.87.6-.39 2.21-1.5 2.37-1.61.22-.15.06-.27-.11-.52-.12-.17-.24-.05-.24-.05-.65.43-1.84 1.33-2 .76-.19-.57 1.03-4.48 1.7-7.17.11-.64.41-2.04-.75-1.94"></path></svg> <span class=md-ellipsis> Reference </span> </a> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_7_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/comparison_pvgis_v6_vs_v52/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9 14H2v2h7v3l4-4-4-4zm6-1v-3h7V8h-7V5l-4 4z"></path></svg> <span class=md-ellipsis> PVGIS 6 vs 5 </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_7_2 type=checkbox> <label class=md-nav__link for=__nav_7_2 id=__nav_7_2_label tabindex=0> <span class=md-ellipsis> Photovoltaic Production </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_7_2_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_7_2> <span class="md-nav__icon md-icon"></span> Photovoltaic Production </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/solar_position/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13.8 5.2C13 5 12.2 5 11.4 5l3.2-2.7 1.4 4c-.7-.5-1.4-.8-2.2-1.1M7 7.1c.6-.6 1.3-1.1 2-1.4l-4.1-.8.7 4.1c.4-.7.8-1.4 1.4-1.9m-1.8 6.7C5 13 5 12.2 5 11.4l-2.7 3.2 4 1.4c-.5-.6-.9-1.4-1.1-2.2M22 19v2H3l5.4-5.5c-1.9-2-1.9-5.1 0-7.1 1.9-1.9 5.1-1.9 7 0l3-3 1.4 1.4L7.7 19z"></path></svg> <span class=md-ellipsis> Solar Position </span> </a> </li> <li class=md-nav__item> <a href=../../reference/solar_irradiance/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M11 6c2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5 2.24-5 5-5m0-5 2.39 3.42C12.65 4.15 11.84 4 11 4s-1.65.15-2.39.42zM2.34 6l4.16-.35A7.2 7.2 0 0 0 4.94 7.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM19.65 6l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zM23 13h-2c0 2.05-.78 4.1-2.34 5.66A7.96 7.96 0 0 1 13 21v2c2.56 0 5.12-1 7.07-2.93S23 15.56 23 13m-4 0h-2c0 1-.39 2.05-1.17 2.83S14 17 13 17v2a5.989 5.989 0 0 0 6-6"></path></svg> <span class=md-ellipsis> Solar Irradiance </span> </a> </li> <li class=md-nav__item> <a href=../../reference/photovoltaic_performance/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3.33 16H11v-3H4zM13 16h7.67L20 13h-7zm8.11 2H13v4h9zM2 22h9v-4H2.89zm9-14h2v3h-2zm4.76-.79 1.42-1.42 2.12 2.12-1.41 1.42zm-11.05.7 2.12-2.12 1.41 1.42-2.12 2.12zM3 2h3v2H3zm15 0h3v2h-3zm-6 5c2.76 0 5-2.24 5-5H7c0 2.76 2.24 5 5 5"></path></svg> <span class=md-ellipsis> Photovoltaic Performance </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_7_3 type=checkbox> <label class=md-nav__link for=__nav_7_3 id=__nav_7_3_label tabindex=0> <span class=md-ellipsis> Resources </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_7_3_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_7_3> <span class="md-nav__icon md-icon"></span> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/external_tools/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class=md-ellipsis> Tools </span> </a> </li> <li class=md-nav__item> <a href=../../reference/external_resources/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12.3 7.29c.2-.18.44-.29.7-.29.27 0 .5.11.71.29.19.21.29.45.29.71 0 .27-.1.5-.29.71-.21.19-.44.29-.71.29-.26 0-.5-.1-.7-.29-.19-.21-.3-.44-.3-.71 0-.26.11-.5.3-.71m-2.5 4.68s2.17-1.72 2.96-1.79c.74-.06.59.79.52 1.23l-.01.06c-.14.53-.31 1.17-.48 1.78-.38 1.39-.75 2.75-.66 3 .1.34.72-.09 1.17-.39.06-.04.11-.08.16-.11 0 0 .08-.08.16.03.02.03.04.06.06.08.09.14.14.19.02.27l-.04.02c-.22.15-1.16.81-1.54 1.05-.41.27-1.98 1.17-1.74-.58.21-1.23.49-2.29.71-3.12.41-1.5.59-2.18-.33-1.59-.37.22-.59.36-.72.45-.11.08-.12.08-.19-.05l-.03-.06-.05-.08c-.07-.1-.07-.11.03-.2M22 12c0 5.5-4.5 10-10 10S2 17.5 2 12 6.5 2 12 2s10 4.5 10 10m-2 0c0-4.42-3.58-8-8-8s-8 3.58-8 8 3.58 8 8 8 8-3.58 8-8"></path></svg> <span class=md-ellipsis> External sources </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked class="md-nav__toggle md-toggle" id=__nav_8 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15 4v2h3v12h-3v2h5V4M4 4v16h5v-2H6V6h3V4z"></path></svg> <span class=md-ellipsis> Source Code </span> </a> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=true aria-labelledby=__nav_8_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Source Code </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../architecture/ class=md-nav__link> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M0 80c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v16h128V80c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-96c-26.5 0-48-21.5-48-48v-16H192v16c0 7.3-1.7 14.3-4.6 20.5L256 288h80c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-96c-26.5 0-48-21.5-48-48v-96c0-7.3 1.7-14.3 4.6-20.5L128 224H48c-26.5 0-48-21.5-48-48z"></path></svg> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../dependencies/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.5 17c-.14 0-.26 0-.39.04L17.5 13.8c.45-.45.75-1.09.75-1.8a2.5 2.5 0 0 0-2.5-2.5c-.14 0-.25 0-.4.04L13.74 6.3c.47-.46.76-1.09.76-1.8a2.5 2.5 0 0 0-5 0c0 .7.29 1.34.76 1.79L8.65 9.54c-.15-.04-.26-.04-.4-.04a2.5 2.5 0 0 0-2.5 2.5c0 .71.29 1.34.75 1.79l-1.61 3.25C4.76 17 4.64 17 4.5 17a2.5 2.5 0 0 0 0 5A2.5 2.5 0 0 0 7 19.5c0-.7-.29-1.34-.76-1.79l1.62-3.25c.14.04.26.04.39.04s.25 0 .38-.04l1.63 3.25c-.47.45-.76 1.09-.76 1.79a2.5 2.5 0 0 0 5 0A2.5 2.5 0 0 0 12 17c-.13 0-.26 0-.39.04L10 13.8c.45-.45.75-1.09.75-1.8 0-.7-.29-1.33-.75-1.79l1.61-3.25c.13.04.26.04.39.04s.26 0 .39-.04L14 10.21a2.5 2.5 0 0 0 1.75 4.29c.13 0 .25 0 .38-.04l1.63 3.25c-.47.45-.76 1.09-.76 1.79a2.5 2.5 0 0 0 5 0 2.5 2.5 0 0 0-2.5-2.5m-15 3.5c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m8.5-1c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1M7.25 12c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1M11 4.5c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1m3.75 7.5c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1m4.75 8.5c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"></path></svg> <span class=md-ellipsis> Dependencies </span> </a> </li> <li class=md-nav__item> <a href=../pvgis_data_model/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"></path></svg> <span class=md-ellipsis> Data Model </span> </a> </li> <li class=md-nav__item> <a href=../duck_arrays/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m10.315 4.876-4.01-2.024-4.401 2.196 4.118 2.068zm1.838.928 4.205 2.122-4.363 2.19L7.87 8.046zm5.615-2.922 4.32 2.166-3.863 1.94-4.213-2.125zM15.91 1.95 12.021 0 8.174 1.92l4.007 2.02zm-3.04 16.744V24l4.711-2.35-.005-5.31zm4.704-4.206-.005-5.253-4.699 2.336v5.254zm5.655-.984v5.327l-4.018 2.005-.002-5.303zm0-1.863v-5.22l-4.025 2.001.003 5.264zm-12.022-.07L8.033 9.976v6.895s-3.88-8.257-4.24-8.998c-.046-.096-.237-.201-.285-.227A358 358 0 0 0 .773 6.25V18.43l2.82 1.508V13.57s3.84 7.378 3.878 7.458c.04.08.425.858.837 1.132.548.363 2.899 1.776 2.899 1.776z"></path></svg> <span class=md-ellipsis> Duck Arrays </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M7 13v-2h14v2zm0 6v-2h14v2zM7 7V5h14v2zM3 8V5H2V4h2v4zm-1 9v-1h3v4H2v-1h2v-.5H3v-1h1V17zm2.25-7a.75.75 0 0 1 .75.75c0 .2-.08.39-.21.52L3.12 13H5v1H2v-.92L4 11H2v-1z"></path></svg> <span class=md-ellipsis> Algorithms </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M7 13v-2h14v2zm0 6v-2h14v2zM7 7V5h14v2zM3 8V5H2V4h2v4zm-1 9v-1h3v4H2v-1h2v-.5H3v-1h1V17zm2.25-7a.75.75 0 0 1 .75.75c0 .2-.08.39-.21.52L3.12 13H5v1H2v-.92L4 11H2v-1z"></path></svg> <span class=md-ellipsis> Algorithms </span> </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>algorithms </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hargreaves.solar_declination> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_declination </span> </a> <nav aria-label=solar_declination class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hargreaves.solar_declination.calculate_solar_declination_hargreaves> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_declination_hargreaves </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.jenco> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>jenco </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.milne1921> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>milne1921 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>noaa </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.parameter_models> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>parameter_models </span> </a> <nav aria-label=parameter_models class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.parameter_models.AngleInRadiansOutputUnitsModel> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>AngleInRadiansOutputUnitsModel </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.function_models> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>function_models </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.fractional_year> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>fractional_year </span> </a> <nav aria-label=fractional_year class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.fractional_year.calculate_fractional_year_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_fractional_year_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.equation_of_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>equation_of_time </span> </a> <nav aria-label=equation_of_time class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.equation_of_time.calculate_equation_of_time_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_equation_of_time_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.time_offset> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>time_offset </span> </a> <nav aria-label=time_offset class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.time_offset.calculate_time_offset_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_time_offset_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_time </span> </a> <nav aria-label=solar_time class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_time.calculate_true_solar_time_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_true_solar_time_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.local_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>local_time </span> </a> <nav aria-label=local_time class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.local_time.calculate_local_solar_time_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_local_solar_time_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_hour_angle> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_hour_angle </span> </a> <nav aria-label=solar_hour_angle class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_hour_angle.calculate_solar_hour_angle_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_hour_angle_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.event_hour_angle> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>event_hour_angle </span> </a> <nav aria-label=event_hour_angle class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.event_hour_angle.calculate_event_hour_angle_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_event_hour_angle_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.event_time> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>event_time </span> </a> <nav aria-label=event_time class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_in_minutes> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_event_time_in_minutes </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_event_time_series_noaa </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.event_time.match_event_times_to_timestamps> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>match_event_times_to_timestamps </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.events> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>events </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_declination> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_declination </span> </a> <nav aria-label=solar_declination class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_declination.calculate_solar_declination_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_declination_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_zenith> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_zenith </span> </a> <nav aria-label=solar_zenith class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_zenith.adjust_solar_zenith_for_atmospheric_refraction_time_series> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>adjust_solar_zenith_for_atmospheric_refraction_time_series </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_zenith.atmospheric_refraction_adjustment> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>atmospheric_refraction_adjustment </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_zenith.calculate_solar_zenith_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_zenith_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_altitude> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_altitude </span> </a> <nav aria-label=solar_altitude class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_altitude.calculate_solar_altitude_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_altitude_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_azimuth> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>solar_azimuth </span> </a> <nav aria-label=solar_azimuth class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.noaa.solar_azimuth.calculate_solar_azimuth_series_noaa> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>calculate_solar_azimuth_series_noaa </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#pvgisprototype.algorithms.hofierka> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>hofierka </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../api/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"></path></svg> <span class=md-ellipsis> API </span> </a> </li> <li class=md-nav__item> <a href=../cli/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 19v-3h8v3zm-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5z"></path></svg> <span class=md-ellipsis> CLI </span> </a> </li> <li class=md-nav__item> <a href=../web_api/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 .039c-6.627 0-12 5.354-12 11.96-.001 6.606 5.372 11.963 12 11.962S24.001 18.605 24 12 18.627.039 12 .039m-.829 5.415h7.55l-7.58 5.329h5.182L5.28 18.543Q8.226 12 11.171 5.455"></path></svg> <span class=md-ellipsis> Web API </span> </a> </li> <li class=md-nav__item> <a href=../logger/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"></path></svg> <span class=md-ellipsis> Logger </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_9 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../development/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M22 9V7h-2V5a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-2h2v-2h-2v-2h2v-2h-2V9zm-4 10H4V5h14zM6 13h5v4H6zm6-6h4v3h-4zM6 7h5v5H6zm6 4h4v6h-4z"></path></svg> <span class=md-ellipsis> Development </span> </a> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_9_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../development/gantt/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M2 5h8V2h2v20h-2v-4H6v-3h4v-2H4v-3h6V8H2zm12 0h3v3h-3zm0 5h5v3h-5zm0 5h8v3h-8z"></path></svg> <span class=md-ellipsis> Gantt </span> </a> </li> <li class=md-nav__item> <a href=../../development/roadmap_and_progress/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M16.5 11 13 7.5l1.4-1.4 2.1 2.1L20.7 4l1.4 1.4zM11 7H2v2h9zm10 6.4L19.6 12 17 14.6 14.4 12 13 13.4l2.6 2.6-2.6 2.6 1.4 1.4 2.6-2.6 2.6 2.6 1.4-1.4-2.6-2.6zM11 15H2v2h9z"></path></svg> <span class=md-ellipsis> Roadmap </span> </a> </li> <li class=md-nav__item> <a href=../../development/conventions/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 0C5.382 0 0 5.382 0 12s5.382 12 12 12 12-5.382 12-12S18.618 0 12 0m0 1.6c5.753 0 10.4 4.647 10.4 10.4S17.753 22.4 12 22.4 1.6 17.753 1.6 12 6.247 1.6 12 1.6"></path></svg> <span class=md-ellipsis> Conventions </span> </a> </li> <li class=md-nav__item> <a href=../../development/optimisation/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m13.13 22.19-1.63-3.83c1.57-.58 3.04-1.36 4.4-2.27zM5.64 12.5l-3.83-1.63 6.1-2.77C7 9.46 6.22 10.93 5.64 12.5M21.61 2.39S16.66.269 11 5.93c-2.19 2.19-3.5 4.6-4.35 6.71-.28.75-.09 1.57.46 2.13l2.13 2.12c.55.56 1.37.74 2.12.46A19.1 19.1 0 0 0 18.07 13c5.66-5.66 3.54-10.61 3.54-10.61m-7.07 7.07c-.78-.78-.78-2.05 0-2.83s2.05-.78 2.83 0c.77.78.78 2.05 0 2.83s-2.05.78-2.83 0m-5.66 7.07-1.41-1.41zM6.24 22l3.64-3.64c-.34-.09-.67-.24-.97-.45L4.83 22zM2 22h1.41l4.77-4.76-1.42-1.41L2 20.59zm0-2.83 4.09-4.08c-.21-.3-.36-.62-.45-.97L2 17.76z"></path></svg> <span class=md-ellipsis> Optimisation </span> </a> </li> <li class=md-nav__item> <a href=../../development/profiling/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M21.7 18.6v-1l1.1-.8c.1-.1.2-.2.1-.3l-1-1.7c0-.1-.2-.1-.3-.1l-1.2.5c-.3-.2-.6-.4-.9-.5l-.2-1.3c0-.1-.1-.2-.2-.2h-2c-.2 0-.3.1-.3.2l-.2 1.3c-.3.2-.5.3-.8.5l-1.2-.5c-.1 0-.2 0-.3.1l-1 1.7c0 .1 0 .2.1.3l1.1.8v1l-1.1.8c-.1.1-.2.2-.1.3l1 1.7c.1.1.2.1.3.1l1.2-.5c.2.2.5.4.8.5l.2 1.3c.1.1.2.2.3.2h2c.1 0 .2-.1.2-.2l.2-1.3c.3-.2.5-.3.8-.5l1.2.4c.1 0 .2 0 .3-.1l1-1.7c.1-.1.1-.2 0-.2zm-3.7.9c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5 1.5.7 1.5 1.5-.7 1.5-1.5 1.5M11 18c0-3.9 3.1-7 7-7 2 0 3.7.8 5 2.1V4c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h9.3c-.8-1.1-1.3-2.5-1.3-4M3 4h18v3H3z"></path></svg> <span class=md-ellipsis> Profiling <br> <small>Profiling of PVGIS</small> </span> </a> </li> <li class=md-nav__item> <a href=../../development/contribution_guidelines/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M17 13h-4v4h-2v-4H7v-2h4V7h2v4h4m2-8H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2"></path></svg> <span class=md-ellipsis> Contribution Guidelines </span> </a> </li> <li class=md-nav__item> <a href=../../development/adding_new_features/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 4c1.11 0 2 .89 2 2v12c0 1.11-.89 2-2 2H4c-1.11 0-2-.89-2-2V6c0-1.11.89-2 2-2zM8.5 15V9H7.25v3.5L4.75 9H3.5v6h1.25v-3.5L7.3 15zm5-4.74V9h-4v6h4v-1.25H11v-1.11h2.5v-1.26H11v-1.12zm7 3.74V9h-1.25v4.5h-1.12V10h-1.25v3.5h-1.13V9H14.5v5a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1"></path></svg> <span class=md-ellipsis> New Feature? </span> </a> </li> <li class=md-nav__item> <a href=../../development/pytest/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M2.615 0v.887h3.84V0zm5.022 0v.887h3.842V0zm4.957 0v.887h3.841V0zm4.935 0v.887h3.842V0zM2.447 1.895a.935.935 0 0 0-.935.935c0 .517.418.938.935.938h19.106c.517 0 .935-.42.935-.938a.935.935 0 0 0-.935-.936zm.168 2.847V24h3.84V4.742zm5.022 0v15.801h3.842v-15.8zm4.957 0v10.549h3.85V4.742zm4.935 0v6.494h3.842V4.742z"></path></svg> <span class=md-ellipsis> Pytest </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../includes/tags/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M5.5 7A1.5 1.5 0 0 1 4 5.5 1.5 1.5 0 0 1 5.5 4 1.5 1.5 0 0 1 7 5.5 1.5 1.5 0 0 1 5.5 7m15.91 4.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.11 0-2 .89-2 2v7c0 .55.22 1.05.59 1.41l8.99 9c.37.36.87.59 1.42.59s1.05-.23 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.56-.23-1.06-.59-1.42"></path></svg> <span class=md-ellipsis> Tags </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <nav class=md-tags> <a class="md-tag md-tag-icon" href=../../includes/tags/#tag:algorithms>Algorithms</a> <a class="md-tag md-tag-icon" href=../../includes/tags/#tag:reference>Reference</a> </nav> <a class="md-content__button md-icon" href=https://code.europa.eu/pvgis/pvgis.git/edit/mkdocs/docs/source_code/algorithms.md rel=edit title="Edit this page"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg> </a> <a class="md-content__button md-icon" href=https://code.europa.eu/pvgis/pvgis.git/raw/mkdocs/docs/source_code/algorithms.md title="View source of this page"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg> </a> <div><p>PVGIS features an algorithmic repository, independent from the core API, the <abbr title="Command Line Interface">CLI</abbr> and the Web API components.</p> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">algorithms</span> <a class=headerlink href=#pvgisprototype.algorithms title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title=pvgisprototype.algorithms.hargreaves>hargreaves</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hofierka title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">hofierka</span> (<code>pvgisprototype.algorithms.hofierka</code>)'>hofierka</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.jenco title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">jenco</span> (<code>pvgisprototype.algorithms.jenco</code>)'>jenco</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.milne1921 title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">milne1921</span> (<code>pvgisprototype.algorithms.milne1921</code>)'>milne1921</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">noaa</span> (<code>pvgisprototype.algorithms.noaa</code>)'>noaa</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=pvgisprototype.algorithms.pvlib>pvlib</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=pvgisprototype.algorithms.skyfield>skyfield</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=pvgisprototype.algorithms.usno>usno</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> </div> </div> </div><!-- ::: pvgisprototype.algorithms.ashrae/ --> <!-- ::: pvgisprototype.algorithms.desoto/ --> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.hargreaves.solar_declination> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_declination</span> <a class=headerlink href=#pvgisprototype.algorithms.hargreaves.solar_declination title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.hargreaves.solar_declination.calculate_solar_declination_hargreaves title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_declination_hargreaves</span> (<code>pvgisprototype.algorithms.hargreaves.solar_declination.calculate_solar_declination_hargreaves</code>)'>calculate_solar_declination_hargreaves</a></code></td> <td> <div class=doc-md-description> <p>Approximate the solar declination based on the Hargreaves formula.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.hargreaves.solar_declination.calculate_solar_declination_hargreaves> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_declination_hargreaves</span> <a class=headerlink href=#pvgisprototype.algorithms.hargreaves.solar_declination.calculate_solar_declination_hargreaves title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_declination_hargreaves</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamp</span><span class=p>:</span> <span class=n><span title=pandas.Timestamp>Timestamp</span></span> <span class=o>=</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functools.html#functools.partial title="<code>functools.partial</code>">partial</a></span><span class=p>(</span><span class=n><span title=pandas.Timestamp.now>now</span></span><span class=p>(</span><span class=n><span title=pandas.Timestamp.now(tz)>tz</span></span><span class=o>=</span><span class=n><span title=pvgisprototype.constants.TIMEZONE_UTC>TIMEZONE_UTC</span></span><span class=p>)),</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarDeclination>SolarDeclination</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Approximate the solar declination based on the Hargreaves formula.</p> <div class=codehilite><pre><span></span><code>             360                       360            
</code></pre></div> <p> = 23.45  sin   284 + n + 0.4  sin   (n - 100) 365  365 </p> <details class=note open> <summary>Notes</summary> <ul> <li> <p>365.25: The number 365.25 represents the average number of days in a year. This value is used to scale the orbital position of the Earth.</p> </li> <li> <p>284: The number 284 represents a constant term added to the day of the year. It adjusts the calculation to align with the Earth's position during the winter solstice, which usually occurs around December 21<sup>st</sup> (approximately 284 days into the year).</p> </li> <li> <p>0.4: The number 0.4 is a constant that determines the amplitude of the seasonal variation. It is multiplied by the second sine term to modulate the seasonal change in the solar declination.</p> </li> <li> <p>100: The number 100 represents an offset to the day of the year. It is subtracted from the original day of the year before calculating the second sine term. This offset helps adjust the timing of the seasonal variation and is usually chosen to align with the summer solstice, which typically occurs around June 21<sup>st</sup>.</p> </li> </ul> </details> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/hargreaves/solar_declination.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarDeclinationHargreavesInputModel</span><span class=p>)</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_declination_hargreaves</span><span class=p>(</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>    <span class=n>timestamp</span><span class=p>:</span> <span class=n>Timestamp</span> <span class=o>=</span> <span class=n>partial</span><span class=p>(</span><span class=n>Timestamp</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>tz</span><span class=o>=</span><span class=n>TIMEZONE_UTC</span><span class=p>)),</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarDeclination</span><span class=p>:</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=sd>"""Approximate the solar declination based on the Hargreaves formula.</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a><span class=sd>                     360                       360            </span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a><span class=sd>     = 23.45  sin   284 + n + 0.4  sin   (n - 100)</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a><span class=sd>                     365                       365            </span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a><span class=sd>    - 365.25: The number 365.25 represents the average number of days in a</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a><span class=sd>    year. This value is used to scale the orbital position of the Earth.</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a><span class=sd>    - 284: The number 284 represents a constant term added to the day of the</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a><span class=sd>    year. It adjusts the calculation to align with the Earth's position</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a><span class=sd>    during the winter solstice, which usually occurs around December 21st</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a><span class=sd>    (approximately 284 days into the year).</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a><span class=sd>    - 0.4: The number 0.4 is a constant that determines the amplitude of the</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a><span class=sd>    seasonal variation. It is multiplied by the second sine term to</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a><span class=sd>    modulate the seasonal change in the solar declination.</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a><span class=sd>    - 100: The number 100 represents an offset to the day of the year. It is</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a><span class=sd>    subtracted from the original day of the year before calculating the</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a><span class=sd>    second sine term. This offset helps adjust the timing of the seasonal</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a><span class=sd>    variation and is usually chosen to align with the summer solstice,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a><span class=sd>    which typically occurs around June 21st.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>    <span class=n>days_in_year</span> <span class=o>=</span> <span class=n>get_days_in_year</span><span class=p>(</span><span class=n>timestamp</span><span class=o>.</span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>    <span class=n>day_of_year</span> <span class=o>=</span> <span class=n>timestamp</span><span class=o>.</span><span class=n>timetuple</span><span class=p>()</span><span class=o>.</span><span class=n>tm_yday</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>    <span class=n>declination_value_in_degrees</span> <span class=o>=</span> <span class=mf>23.45</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>        <span class=n>radians</span><span class=p>(</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>            <span class=mi>360</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>            <span class=o>/</span> <span class=n>days_in_year</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>            <span class=o>*</span> <span class=p>(</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>                <span class=mi>284</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>                <span class=o>+</span> <span class=n>day_of_year</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>                <span class=o>+</span> <span class=mf>0.4</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span><span class=n>radians</span><span class=p>(</span><span class=mi>360</span> <span class=o>/</span> <span class=n>days_in_year</span> <span class=o>*</span> <span class=p>(</span><span class=n>day_of_year</span> <span class=o>-</span> <span class=mi>100</span><span class=p>)))</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>    <span class=n>solar_declination</span> <span class=o>=</span> <span class=n>SolarDeclination</span><span class=p>(</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>declination_value_in_degrees</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>DEGREES</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=s2>"Hargreaves"</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"Hargreaves"</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos="81 "></span></a>    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos="82 "></span></a>        <span class=ow>not</span> <span class=n>isfinite</span><span class=p>(</span><span class=n>solar_declination</span><span class=o>.</span><span class=n>degrees</span><span class=p>)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos="83 "></span></a>        <span class=ow>or</span> <span class=ow>not</span> <span class=n>solar_declination</span><span class=o>.</span><span class=n>min_degrees</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos="84 "></span></a>        <span class=o>&lt;=</span> <span class=n>solar_declination</span><span class=o>.</span><span class=n>degrees</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos="85 "></span></a>        <span class=o>&lt;=</span> <span class=n>solar_declination</span><span class=o>.</span><span class=n>max_degrees</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos="86 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos="87 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos="88 "></span></a>            <span class=sa>f</span><span class=s2>"The calculated solar declination angle </span><span class=si>{</span><span class=n>solar_declination</span><span class=o>.</span><span class=n>degrees</span><span class=si>}</span><span class=s2> is out of the expected range</span><span class=se>\</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos="89 "></span></a><span class=s2>            [</span><span class=si>{</span><span class=n>solar_declination</span><span class=o>.</span><span class=n>min_degrees</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>solar_declination</span><span class=o>.</span><span class=n>max_degrees</span><span class=si>}</span><span class=s2>] degrees"</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos="90 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos="91 "></span></a>    <span class=k>return</span> <span class=n>solar_declination</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.jenco> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">jenco</span> <a class=headerlink href=#pvgisprototype.algorithms.jenco title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title=pvgisprototype.algorithms.jenco.solar_altitude>solar_altitude</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=pvgisprototype.algorithms.jenco.solar_azimuth>solar_azimuth</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=pvgisprototype.algorithms.jenco.solar_declination>solar_declination</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=pvgisprototype.algorithms.jenco.solar_incidence>solar_incidence</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> </div> </div> </div><!-- ::: pvgisprototype.algorithms.martin_ruiz/ --> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.milne1921> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">milne1921</span> <a class=headerlink href=#pvgisprototype.algorithms.milne1921 title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title=pvgisprototype.algorithms.milne1921.solar_time>solar_time</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.equation_of_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">equation_of_time</span> (<code>pvgisprototype.algorithms.noaa.equation_of_time</code>)'>equation_of_time</a></code></td> <td> <div class=doc-md-description> <p>The Equation of Time based on the General Solar Position Calculations provided</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.event_hour_angle title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">event_hour_angle</span> (<code>pvgisprototype.algorithms.noaa.event_hour_angle</code>)'>event_hour_angle</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.event_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">event_time</span> (<code>pvgisprototype.algorithms.noaa.event_time</code>)'>event_time</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.events title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">events</span> (<code>pvgisprototype.algorithms.noaa.events</code>)'>events</a></code></td> <td> <div class=doc-md-description> <p>This module contains days within the year that have some solar significance.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.fractional_year title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">fractional_year</span> (<code>pvgisprototype.algorithms.noaa.fractional_year</code>)'>fractional_year</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.local_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">local_time</span> (<code>pvgisprototype.algorithms.noaa.local_time</code>)'>local_time</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.parameter_models title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">parameter_models</span> (<code>pvgisprototype.algorithms.noaa.parameter_models</code>)'>parameter_models</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_altitude title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_altitude</span> (<code>pvgisprototype.algorithms.noaa.solar_altitude</code>)'>solar_altitude</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_azimuth title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_azimuth</span> (<code>pvgisprototype.algorithms.noaa.solar_azimuth</code>)'>solar_azimuth</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_declination title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_declination</span> (<code>pvgisprototype.algorithms.noaa.solar_declination</code>)'>solar_declination</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_hour_angle title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_hour_angle</span> (<code>pvgisprototype.algorithms.noaa.solar_hour_angle</code>)'>solar_hour_angle</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_time title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_time</span> (<code>pvgisprototype.algorithms.noaa.solar_time</code>)'>solar_time</a></code></td> <td> <div class=doc-md-description> <p>The true solar time based on NOAA's General Solar Position Calculations.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_zenith title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">solar_zenith</span> (<code>pvgisprototype.algorithms.noaa.solar_zenith</code>)'>solar_zenith</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.time_offset title='<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">time_offset</span> (<code>pvgisprototype.algorithms.noaa.time_offset</code>)'>time_offset</a></code></td> <td> <div class=doc-md-description> <p>The time offset based on NOAA's General Solar Position Calculations.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.parameter_models> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">parameter_models</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.parameter_models title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Classes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.parameter_models.AngleInRadiansOutputUnitsModel title='<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">AngleInRadiansOutputUnitsModel</span> (<code>pvgisprototype.algorithms.noaa.parameter_models.AngleInRadiansOutputUnitsModel</code>)'>AngleInRadiansOutputUnitsModel</a></code></td> <td> <div class=doc-md-description> <p>The angle in radians output units argument is passed along with the</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.parameter_models.AngleInRadiansOutputUnitsModel> <code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">AngleInRadiansOutputUnitsModel</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.parameter_models.AngleInRadiansOutputUnitsModel title="Permanent link"></a></h2> <div class="doc doc-contents"> <p class="doc doc-class-bases"> Bases: <code><span title=pydantic.BaseModel>BaseModel</span></code></p> <p>The angle in radians output units argument is passed along with the returned value. This is not a real test. Hopefully, and however, it helps for clarity and understanding of what the function should return.</p> <div class="doc doc-children"> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.function_models> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">function_models</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.function_models title="Permanent link"></a></h1> <div class="doc doc-contents first"> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.fractional_year> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">fractional_year</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.fractional_year title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.fractional_year.calculate_fractional_year_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_fractional_year_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.fractional_year.calculate_fractional_year_series_noaa</code>)'>calculate_fractional_year_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the fractional year for a time series.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.fractional_year.calculate_fractional_year_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_fractional_year_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.fractional_year.calculate_fractional_year_series_noaa title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_fractional_year_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.FractionalYear>FractionalYear</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the fractional year for a time series.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>A Pandas DatetimeIndex representing the timestamps.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The data type for the calculations (the default is 'float32').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The backend used for calculations (the default is 'NUMPY').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.FractionalYear>FractionalYear</span></code> </td> <td> <div class=doc-md-description> <p>A FractionalYear object containing the calculated fractional year series.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/exceptions.html#ValueError>ValueError</a></code> </td> <td> <div class=doc-md-description> <p>If any calculated fractional year value is outside the expected range.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>timestamps</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=n>start</span><span class=o>=</span><span class=s1>'2020-01-01'</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>'2020-12-31'</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>'D'</span><span class=p>)</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fractional_year_series</span> <span class=o>=</span> <span class=n>calculate_fractional_year_series_noaa</span><span class=p>(</span><span class=n>timestamps</span><span class=p>)</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>fractional_year_series</span><span class=p>)</span>
</span></code></pre></div> <details class=note open> <summary>Notes</summary> <p>The function calculates the fractional year considering leap years and converts the timestamps into fractional values considering their position within the year.</p> </details> <details class=see-also open> <summary>See also</summary> <p>The default data type (<code>dtype</code>) and backend (<code>array_backend</code>) for arrays are set in <code>constants.py</code> via the global variables <code>DATA_TYPE_DEFAULT</code> and <code>ARRAY_BACKEND_DEFAULT</code>.</p> </details> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/fractional_year.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateFractionalYearTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_fractional_year_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>FractionalYear</span><span class=p>:</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=w>    </span><span class=sd>"""Calculate the fractional year for a time series.</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>        A Pandas DatetimeIndex representing the timestamps.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>        The data type for the calculations (the default is 'float32').</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>        The backend used for calculations (the default is 'NUMPY').</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    verbose: int</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>        Verbosity level</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    log: int</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>        Log level</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    FractionalYear</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        A FractionalYear object containing the calculated fractional year</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        series.</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    Raises</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    ------</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    ValueError</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>        If any calculated fractional year value is outside the expected range.</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    &gt;&gt;&gt; timestamps = pd.date_range(start='2020-01-01', end='2020-12-31', freq='D')</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    &gt;&gt;&gt; fractional_year_series = calculate_fractional_year_series_noaa(timestamps)</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    &gt;&gt;&gt; print(fractional_year_series)</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    The function calculates the fractional year considering leap years and</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    converts the timestamps into fractional values considering their position</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    within the year.</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    See also</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    The default data type (`dtype`) and backend (`array_backend`) for arrays</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    are set in `constants.py` via the global variables `DATA_TYPE_DEFAULT` and</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    `ARRAY_BACKEND_DEFAULT`.</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=n>days_of_year</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>dayofyear</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=n>hours</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>hour</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=n>days_in_years</span> <span class=o>=</span> <span class=n>get_days_in_years</span><span class=p>(</span><span class=n>timestamps</span><span class=o>.</span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=n>array_parameters</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=s2>"shape"</span><span class=p>:</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=s2>"dtype"</span><span class=p>:</span> <span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=s2>"init_method"</span><span class=p>:</span> <span class=s2>"zeros"</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=s2>"backend"</span><span class=p>:</span> <span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=p>}</span>  <span class=c1># Borrow shape from timestamps</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=n>fractional_year_series</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span><span class=o>**</span><span class=n>array_parameters</span><span class=p>)</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>fractional_year_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>/</span> <span class=n>days_in_years</span> <span class=o>*</span> <span class=p>(</span><span class=n>days_of_year</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>hours</span> <span class=o>-</span> <span class=mi>12</span><span class=p>)</span> <span class=o>/</span> <span class=mi>24</span><span class=p>),</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=c1># Is this "restriction" correct ?</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=n>fractional_year_series</span><span class=p>[</span><span class=n>fractional_year_series</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>            <span class=p>(</span><span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span> <span class=o>&lt;=</span> <span class=n>fractional_year_series</span><span class=p>)</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>fractional_year_series</span> <span class=o>&lt;=</span> <span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=p>):</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>            <span class=n>index_of_out_of_range_values</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>                <span class=p>(</span><span class=n>fractional_year_series</span> <span class=o>&lt;</span> <span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>                <span class=o>|</span> <span class=p>(</span><span class=n>fractional_year_series</span> <span class=o>&gt;</span> <span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>            <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>fractional_year_series</span><span class=p>[</span><span class=n>index_of_out_of_range_values</span><span class=p>]</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>            <span class=c1># Report values in "human readable" degrees</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>                <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>                <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>FractionalYear</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=si>}</span><span class=s2>] radians"</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>                <span class=sa>f</span><span class=s2>" in [code]fractional_year_series[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>fractional_year_series</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=k>return</span> <span class=n>FractionalYear</span><span class=p>(</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>fractional_year_series</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.equation_of_time> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">equation_of_time</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.equation_of_time title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p>The Equation of Time based on the General Solar Position Calculations provided by the NOAA Global Monitoring Division.</p> <p>See also: <a href=https://unpkg.com/solar-calculator@0.1.0/index.js>https://unpkg.com/solar-calculator@0.1.0/index.js</a></p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.equation_of_time.calculate_equation_of_time_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_equation_of_time_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.equation_of_time.calculate_equation_of_time_series_noaa</code>)'>calculate_equation_of_time_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the Equation of Time for a time series in minutes.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.equation_of_time.calculate_equation_of_time_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_equation_of_time_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.equation_of_time.calculate_equation_of_time_series_noaa title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_equation_of_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.EquationOfTime>EquationOfTime</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the Equation of Time for a time series in minutes.</p> <p>The Equation of Time is the difference between the apparent solar time and the mean solar time.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>equation_of_time_series</code></td> <td> <code><span title=numeric>numeric</span></code> </td> <td> <div class=doc-md-description> <p>Difference in time between solar time and mean solar time in minutes.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/equation_of_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateEquationOfTimeTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_equation_of_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>EquationOfTime</span><span class=p>:</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=w>    </span><span class=sd>"""Calculate the Equation of Time for a time series in minutes.</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    The Equation of Time is the difference between the apparent solar time and</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    the mean solar time.</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    equation_of_time_series : numeric</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        Difference in time between solar time and mean solar time in minutes.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>    <span class=n>fractional_year_series</span> <span class=o>=</span> <span class=n>calculate_fractional_year_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=n>equation_of_time_series</span> <span class=o>=</span> <span class=mf>229.18</span> <span class=o>*</span> <span class=p>(</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=mf>0.000075</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=o>+</span> <span class=mf>0.001868</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>        <span class=o>-</span> <span class=mf>0.032077</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=o>-</span> <span class=mf>0.014615</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=o>-</span> <span class=mf>0.040849</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>            <span class=p>(</span><span class=n>EquationOfTime</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span> <span class=o>&lt;=</span> <span class=n>equation_of_time_series</span><span class=p>)</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>equation_of_time_series</span> <span class=o>&lt;=</span> <span class=n>EquationOfTime</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=p>):</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>                <span class=s2>"The equation of time must be within the range [{EquationOfTime().min_minutes}, {EquationOfTime().max_minutes()}] minutes for all timestamps."</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>equation_of_time_series</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=k>return</span> <span class=n>EquationOfTime</span><span class=p>(</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>equation_of_time_series</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>MINUTES</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>position_algorithm</span><span class=o>=</span><span class=n>fractional_year_series</span><span class=o>.</span><span class=n>position_algorithm</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=n>timing_algorithm</span><span class=o>=</span><span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.time_offset> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">time_offset</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.time_offset title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p>The time offset based on NOAA's General Solar Position Calculations.</p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.time_offset.calculate_time_offset_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_time_offset_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.time_offset.calculate_time_offset_series_noaa</code>)'>calculate_time_offset_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the variation of the local solar time within a</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.time_offset.calculate_time_offset_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_time_offset_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.time_offset.calculate_time_offset_series_noaa title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_time_offset_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.algorithms.noaa.time_offset.ZONEINFO_UTC>ZONEINFO_UTC</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.TimeOffset>TimeOffset</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the variation of the local solar time within a given timezone for a time series.</p> <p>Calculate the variation of the local solar time, also referred to as <em>time offset</em>, within a timezone for NOAA's General Solar Position Calculations [0]_.</p> <p>The time offset (in minutes) incorporates the Equation of Time and accounts for the variation of the Local Solar Time (LST) within a given timezone due to the longitude variations within the time zone.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><span title=pvgisprototype.Longitude>Longitude</span></code> </td> <td> <div class=doc-md-description> <p>The longitude for calculation in radians (note: differs from the original equation which expects degrees).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>The timestamp to calculate the offset for</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> <p>The timezone</p> </div> </td> <td> <code><span title=pvgisprototype.algorithms.noaa.time_offset.ZONEINFO_UTC>ZONEINFO_UTC</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The data type for the calculations (the default is 'float32').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The backend used for calculations (the default is 'NUMPY').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>TimeOffset</code></td> <td> <code><span title=pvgisprototype.TimeOffset>TimeOffset</span></code> </td> <td> <div class=doc-md-description> <p>The time offset for a single or a series of timestamps.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The equation given in NOAA's General Solar Position Calculations [0]_ is</p> <div class=codehilite><pre><span></span><code><span class=n>time_offset</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>eqtime</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>4</span><span class=o>*</span><span class=n>longitude</span><span class=w> </span><span class=err></span><span class=w> </span><span class=mi>60</span><span class=o>*</span><span class=n>timezone</span>

<span class=n>where</span><span class=w> </span><span class=p>(</span><span class=n>variable</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=ow>and</span><span class=w> </span><span class=n>units</span><span class=p>):</span>
<span class=o>-</span><span class=w> </span><span class=n>time_offset</span><span class=p>,</span><span class=w> </span><span class=n>minutes</span>
<span class=o>-</span><span class=w> </span><span class=n>longitude</span><span class=p>,</span><span class=w> </span><span class=n>degrees</span>
<span class=o>-</span><span class=w> </span><span class=n>timezone</span><span class=p>,</span><span class=w> </span><span class=n>hours</span>
<span class=o>-</span><span class=w> </span><span class=n>eqtime</span><span class=p>,</span><span class=w> </span><span class=n>minutes</span>
</code></pre></div> </details> <details class=see-also open> <summary>See also</summary> <p>pysolar</p> <div class=codehilite><pre><span></span><code>In pysolar the true solar time is calculated as follows :

<span class=s>```</span>
(math.tm_hour(when) * 60 + math.tm_min(when) + 4 * longitude_deg + equation_of_time(math.tm_yday(when)))
<span class=s>```</span>

in which equation the time offset is the last part.

<span class=s>```</span>
4 * longitude_deg + equation_of_time(math.tm_yday(when)))
<span class=s>```</span>
</code></pre></div> <p>Another reference</p> <div class=codehilite><pre><span></span><code>TC = 4 <span class=gs>* (Longitude - LSTM) + EoT</span>

<span class=gs>where:</span>

<span class=gs>- TC        : Time Correction Factor, minutes</span>
<span class=gs>- Longitude : Geographical Longitude, degrees</span>
<span class=gs>- LSTM      : Local Standard Time Meridian, degrees *</span> hours
<span class=k>-</span> EoT       : Equation of Time

    where:
    <span class=k>-</span> <span class=sb>`LSTM = 15 degrees * TUTC`</span>

        where:
        <span class=k>-</span> TUTC = LT - UTC, hours

            where:
            <span class=k>-</span> TUTC : difference of LT from UTC in hours
            <span class=k>-</span> LT    : Local Time
            <span class=k>-</span> UTC   : Universal Coordinated Time

    <span class=k>-</span> The factor 4 (minutes) comes from the fact that the Earth
      rotates 1 every 4 minutes.

    Examples:

        Mount Olympus is UTC + 2, hence LSTM = 15 * 2 = 30 deg. East
</code></pre></div> <p>The time offset in minutes ranges in</p> <div class=codehilite><pre><span></span><code>[ -720 (Longitude) - 720 (Up to -12 TimeZones) - 20 (Equation of Time) = -1460,
  +720 (Longitude) + 840 (Up to +14 TimeZones) + 20 (Equation of Time) = 1580 ]
</code></pre></div> <p>The valid ranges of the components that contribute to the time offset are:</p> <ul> <li> <p>Geographical longitude ranges from west to east in [-180, 180] degrees. A day is approximately 1440 minutes, hence converting the degrees to minutes, the longitude ranges in [-720, 720] minutes.</p> </li> <li> <p>The timezone offset from the Coordinated Universal Time (UTC), considering time zones that are offset by unusual amounts of time from UTC, ranges from west of UTC to east of UTC in [-12, 14] hours or [-720, 840] minutes.</p> </li> <li> <p>The Equation of Time accounts for the variations in the Earth's orbital speed and axial tilt. It varies throughout the year, but is typically within the range of about -20 minutes to +20 minutes.</p> </li> </ul> </details> <details class=references open> <summary>References</summary> <p>.. [0] <a href=https://gml.noaa.gov/grad/solcalc/solareqns.PDF>https://gml.noaa.gov/grad/solcalc/solareqns.PDF</a></p> </details> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/time_offset.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateTimeOffsetTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_time_offset_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>=</span> <span class=n>ZONEINFO_UTC</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>TimeOffset</span><span class=p>:</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=w>    </span><span class=sd>"""Calculate the variation of the local solar time within a</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    given timezone for a time series.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    Calculate the variation of the local solar time, also referred to as _time</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    offset_, within a timezone for NOAA's General Solar Position Calculations</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    [0]_.</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    The time offset (in minutes) incorporates the Equation of Time and</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    accounts for the variation of the Local Solar Time (LST) within a given</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    timezone due to the longitude variations within the time zone.</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    longitude: float</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>        The longitude for calculation in radians (note: differs from the original</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        equation which expects degrees).</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    timestamps: DatetimeIndex</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>        The timestamp to calculate the offset for</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    timezone: ZoneInfo, optional</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>        The timezone</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>        The data type for the calculations (the default is 'float32').</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>        The backend used for calculations (the default is 'NUMPY').</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    verbose: int, optional</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>        Verbosity level</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>    log: int, optional</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>        Log level</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    TimeOffset:</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        The time offset for a single or a series of timestamps.</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>    The equation given in NOAA's General Solar Position Calculations [0]_ is</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>        time_offset = eqtime + 4*longitude  60*timezone</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>        where (variable name and units):</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>        - time_offset, minutes</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>        - longitude, degrees</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>        - timezone, hours</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>        - eqtime, minutes</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>    See also</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    pysolar</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>        In pysolar the true solar time is calculated as follows :</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>        (math.tm_hour(when) * 60 + math.tm_min(when) + 4 * longitude_deg + equation_of_time(math.tm_yday(when)))</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>        in which equation the time offset is the last part.</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>        4 * longitude_deg + equation_of_time(math.tm_yday(when)))</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>    Another reference</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>        TC = 4 * (Longitude - LSTM) + EoT</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>        where:</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>        - TC        : Time Correction Factor, minutes</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>        - Longitude : Geographical Longitude, degrees</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>        - LSTM      : Local Standard Time Meridian, degrees * hours</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>        - EoT       : Equation of Time</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=sd>            where:</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=sd>            - `LSTM = 15 degrees * TUTC`</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=sd>                where:</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a><span class=sd>                - TUTC = LT - UTC, hours</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a><span class=sd>                    where:</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a><span class=sd>                    - TUTC : difference of LT from UTC in hours</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=sd>                    - LT    : Local Time</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a><span class=sd>                    - UTC   : Universal Coordinated Time</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a><span class=sd>            - The factor 4 (minutes) comes from the fact that the Earth</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=sd>              rotates 1 every 4 minutes.</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>            Examples:</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>                Mount Olympus is UTC + 2, hence LSTM = 15 * 2 = 30 deg. East</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=sd>    The time offset in minutes ranges in</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=sd>        [ -720 (Longitude) - 720 (Up to -12 TimeZones) - 20 (Equation of Time) = -1460,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a><span class=sd>          +720 (Longitude) + 840 (Up to +14 TimeZones) + 20 (Equation of Time) = 1580 ]</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=sd>    The valid ranges of the components that contribute to the time offset are:</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a><span class=sd>    - Geographical longitude ranges from west to east in [-180, 180] degrees.</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a><span class=sd>      A day is approximately 1440 minutes, hence converting the degrees to</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=sd>      minutes, the longitude ranges in [-720, 720] minutes.</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a><span class=sd>    - The timezone offset from the Coordinated Universal Time (UTC),</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=sd>      considering time zones that are offset by unusual amounts of time from</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a><span class=sd>      UTC, ranges  from west of UTC to east of UTC in [-12, 14] hours or [-720,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a><span class=sd>      840] minutes.</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a><span class=sd>    - The Equation of Time accounts for the variations in the Earth's orbital</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>      speed and axial tilt. It varies throughout the year, but is typically</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>      within the range of about -20 minutes to +20 minutes.</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>    .. [0] https://gml.noaa.gov/grad/solcalc/solareqns.PDF</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=n>local_standard_time_meridian_minutes_series</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># in UTC the offest is 0</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>    <span class=k>if</span> <span class=n>timezone</span> <span class=ow>and</span> <span class=n>timezone</span> <span class=o>!=</span> <span class=n>ZONEINFO_UTC</span><span class=p>:</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=c1># We need the .tz attribute to compare with the user-requested timezone !</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>tz</span><span class=p>:</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>            <span class=n>timestamps</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>tz_localize</span><span class=p>(</span><span class=n>timezone</span><span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=c1># Explain why this is necessary !-------------- Further Optimisation ?</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=n>unique_timezone_offsets_in_minutes</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>            <span class=n>stamp</span><span class=o>.</span><span class=n>tzinfo</span><span class=p>:</span> <span class=n>stamp</span><span class=o>.</span><span class=n>tzinfo</span><span class=o>.</span><span class=n>utcoffset</span><span class=p>(</span><span class=n>stamp</span><span class=p>)</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>/</span> <span class=mi>60</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>            <span class=k>for</span> <span class=n>stamp</span> <span class=ow>in</span> <span class=n>timestamps</span> <span class=k>if</span> <span class=n>stamp</span><span class=o>.</span><span class=n>tzinfo</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=p>}</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=n>local_standard_time_meridian_minutes_series</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>            <span class=p>[</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>                <span class=n>unique_timezone_offsets_in_minutes</span><span class=p>[</span><span class=n>stamp</span><span class=o>.</span><span class=n>tzinfo</span><span class=p>]</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>                <span class=k>for</span> <span class=n>stamp</span> <span class=ow>in</span> <span class=n>timestamps</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>                <span class=k>if</span> <span class=n>stamp</span><span class=o>.</span><span class=n>tzinfo</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>            <span class=p>],</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>            <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>        <span class=c1># # ------------------------------------------- Further Optimisation ?</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>    <span class=n>equation_of_time_series</span> <span class=o>=</span> <span class=n>calculate_equation_of_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>    <span class=n>time_offset_series_in_minutes</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>        <span class=n>longitude</span><span class=o>.</span><span class=n>as_minutes</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>        <span class=o>-</span> <span class=n>local_standard_time_meridian_minutes_series</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>        <span class=o>+</span> <span class=n>equation_of_time_series</span><span class=o>.</span><span class=n>minutes</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>numpy</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>            <span class=p>(</span><span class=n>TimeOffset</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span> <span class=o>&lt;=</span> <span class=n>time_offset_series_in_minutes</span><span class=p>)</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>time_offset_series_in_minutes</span> <span class=o>&lt;=</span> <span class=n>TimeOffset</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=p>)</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>        <span class=p>):</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>            <span class=n>index_of_out_of_range_values</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>                <span class=p>(</span><span class=n>time_offset_series_in_minutes</span> <span class=o>&lt;</span> <span class=n>TimeOffset</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span><span class=p>)</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>                <span class=o>|</span> <span class=p>(</span><span class=n>time_offset_series_in_minutes</span> <span class=o>&gt;</span> <span class=n>TimeOffset</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=p>)</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>            <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>time_offset_series_in_minutes</span><span class=p>[</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>                <span class=n>index_of_out_of_range_values</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>            <span class=p>]</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>                <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>                <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>TimeOffset</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>TimeOffset</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=si>}</span><span class=s2>] minutes"</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>                <span class=sa>f</span><span class=s2>" in [code]time_offset_series_in_minutes[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>time_offset_series_in_minutes</span><span class=p>,</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>    <span class=k>return</span> <span class=n>TimeOffset</span><span class=p>(</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>time_offset_series_in_minutes</span><span class=p>,</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>MINUTES</span><span class=p>,</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=s2>"NOAA"</span><span class=p>,</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=s2>"NOAA"</span><span class=p>,</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_time> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_time</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_time title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p>The true solar time based on NOAA's General Solar Position Calculations.</p> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_time.calculate_true_solar_time_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_true_solar_time_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.solar_time.calculate_true_solar_time_series_noaa</code>)'>calculate_true_solar_time_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the true solar time at a specific geographic locations for a</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_time.calculate_true_solar_time_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_true_solar_time_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_time.calculate_true_solar_time_series_noaa title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_true_solar_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.TrueSolarTime>TrueSolarTime</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the true solar time at a specific geographic locations for a time series.</p> <p>Calculate the true solar time at a specific geographic locations for a series of timestamps based on NOAA's General Solar Position Calculations [0]_.</p> <p>The true solar time is the sum of the mean solar time and the equation of time. CONFIRM!?</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>The timestamp to calculate offset for</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> <p>The timezone for calculation</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The data type for the calculations (the default is 'float32').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The backend used for calculations (the default is 'NUMPY').</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.TrueSolarTime>TrueSolarTime</span></code> </td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The true solar time is the sum of the time offset and the true solar time in minutes.</p> <div class=codehilite><pre><span></span><code>time_offset = eqtime + 4*longitude  60*timezone
</code></pre></div> </details> <details class=see-also open> <summary>See also</summary> <p>pysolar</p> <p>In pysolar the true solar time is calculated as follows :</p> <div class=codehilite><pre><span></span><code><span class=s>```</span>
(math.tm_hour(when) * 60 + math.tm_min(when) + 4 * longitude_deg + equation_of_time(math.tm_yday(when)))
<span class=s>```</span>

in which equation the last part is the time offset

<span class=s>```</span>
4 * longitude_deg + equation_of_time(math.tm_yday(when)))
<span class=s>```</span>
</code></pre></div> <p>Additional notes:</p> <p>From NOAA's General Solar Position Calculations</p> <div class=codehilite><pre><span></span><code><span class=s>"Next, the true solar time is calculated in the following two</span>
<span class=s>equations. First the time offset is found, in minutes, and then the</span>
<span class=s>true solar time, in minutes."</span>

<span class=n>time_offset</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>eqtime</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>4</span><span class=o>*</span><span class=n>longitude</span><span class=w> </span><span class=err></span><span class=w> </span><span class=mi>60</span><span class=o>*</span><span class=n>timezone</span>

<span class=n>where</span><span class=w> </span><span class=p>:</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>eqtime</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=n>minutes</span><span class=p>,</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>longitude</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=n>degrees</span><span class=w> </span><span class=p>(</span><span class=n>positive</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>east</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>Prime</span>
<span class=w>      </span><span class=n>Meridian</span><span class=p>),</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>timezone</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=n>hours</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=n>UTC</span><span class=w> </span><span class=p>(</span><span class=n>U</span><span class=o>.</span><span class=n>S</span><span class=o>.</span><span class=w> </span><span class=n>Mountain</span><span class=w> </span><span class=n>Standard</span><span class=w> </span><span class=n>Time</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err></span><span class=mi>7</span>
<span class=w>      </span><span class=n>hours</span><span class=p>)</span><span class=o>.</span>

<span class=n>tst</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>hr</span><span class=o>*</span><span class=mi>60</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>mn</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>sc</span><span class=o>/</span><span class=mi>60</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>time_offset</span>

<span class=n>where</span><span class=w> </span><span class=p>:</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>hr</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>hour</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>23</span><span class=p>),</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>mn</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>minute</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>59</span><span class=p>),</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>sc</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>second</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>59</span><span class=p>)</span><span class=o>.</span>
</code></pre></div> </details> <details class=references open> <summary>References</summary> <p>.. [0] <a href=https://gml.noaa.gov/grad/solcalc/solareqns.PDF>https://gml.noaa.gov/grad/solcalc/solareqns.PDF</a></p> </details> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateTrueSolarTimeTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_true_solar_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>TrueSolarTime</span><span class=p>:</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=w>    </span><span class=sd>"""Calculate the true solar time at a specific geographic locations for a</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    time series.</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    Calculate the true solar time at a specific geographic locations for a</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    series of timestamps based on NOAA's General Solar Position Calculations</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    [0]_.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    The true solar time is the sum of the mean solar time and the equation of</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    time.  CONFIRM!?</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    timestamps: DatetimeIndex, optional</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>        The timestamp to calculate offset for</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    timezone: str, optional</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        The timezone for calculation</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        The data type for the calculations (the default is 'float32').</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>        The backend used for calculations (the default is 'NUMPY').</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    verbose: int</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>        Verbosity level</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    log: int</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>        Log level</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    TrueSolarTime</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>    The true solar time is the sum of the time offset and the true solar time</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    in minutes.</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>        time_offset = eqtime + 4*longitude  60*timezone</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    See also</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    pysolar</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    In pysolar the true solar time is calculated as follows :</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>        (math.tm_hour(when) * 60 + math.tm_min(when) + 4 * longitude_deg + equation_of_time(math.tm_yday(when)))</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>        in which equation the last part is the time offset</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>        4 * longitude_deg + equation_of_time(math.tm_yday(when)))</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>        ```</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    Additional notes:</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>    From NOAA's General Solar Position Calculations</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>        "Next, the true solar time is calculated in the following two</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>        equations. First the time offset is found, in minutes, and then the</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>        true solar time, in minutes."</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>        time_offset = eqtime + 4*longitude  60*timezone</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>        where :</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>            - eqtime is in minutes,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>            - longitude is in degrees (positive to the east of the Prime</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>              Meridian),</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>            - timezone is in hours from UTC (U.S. Mountain Standard Time = 7</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>              hours).</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>        tst = hr*60 + mn + sc/60 + time_offset</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>        where :</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>            - hr is the hour (0 - 23),</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>            - mn is the minute (0 - 59),</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>            - sc is the second (0 - 59).</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=sd>    .. [0] https://gml.noaa.gov/grad/solcalc/solareqns.PDF</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>    <span class=n>time_offset_series</span> <span class=o>=</span> <span class=n>calculate_time_offset_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=n>true_solar_time_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>        <span class=n>timestamps</span> <span class=o>-</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>normalize</span><span class=p>()</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>    <span class=p>)</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>+</span> <span class=n>time_offset_series</span><span class=o>.</span><span class=n>value</span> <span class=o>*</span> <span class=mi>60</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>    <span class=c1># array_parameters = {</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>    <span class=c1>#     "shape": true_solar_time_series.shape,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=c1>#     "dtype": dtype,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=c1>#     "init_method": "zeros",</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>    <span class=c1>#     "backend": array_backend,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>    <span class=c1># }</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>    <span class=c1># true_solar_time_series_in_minutes = create_array(**array_parameters)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>    <span class=n>true_solar_time_series_in_minutes</span> <span class=o>=</span> <span class=n>mod</span><span class=p>(</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=p>(</span><span class=n>true_solar_time_series</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>dtype</span><span class=p>)</span> <span class=o>/</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>1440</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>            <span class=p>(</span><span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span> <span class=o>&lt;=</span> <span class=n>true_solar_time_series_in_minutes</span><span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>true_solar_time_series_in_minutes</span> <span class=o>&lt;=</span> <span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=p>)</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>():</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>            <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>true_solar_time_series_in_minutes</span><span class=p>[</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>                <span class=o>~</span><span class=p>(</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>                    <span class=p>(</span><span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span> <span class=o>&lt;=</span> <span class=n>true_solar_time_series_in_minutes</span><span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>                    <span class=o>&amp;</span> <span class=p>(</span><span class=n>true_solar_time_series_in_minutes</span> <span class=o>&lt;=</span> <span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=p>)</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>            <span class=p>]</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>                <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>                <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>min_minutes</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>TrueSolarTime</span><span class=p>()</span><span class=o>.</span><span class=n>max_minutes</span><span class=si>}</span><span class=s2>] minutes"</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>                <span class=sa>f</span><span class=s2>" in [code]true_solar_time_series_in_minutes[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>true_solar_time_series_in_minutes</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>    <span class=k>return</span> <span class=n>TrueSolarTime</span><span class=p>(</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>array</span><span class=p>(</span><span class=n>true_solar_time_series_in_minutes</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>),</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>MINUTES</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>        <span class=n>timing_algorithm</span><span class=o>=</span><span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.local_time> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">local_time</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.local_time title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.local_time.calculate_local_solar_time_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_local_solar_time_noaa</span> (<code>pvgisprototype.algorithms.noaa.local_time.calculate_local_solar_time_noaa</code>)'>calculate_local_solar_time_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the Local Solar Time (LST) based on the sun's position.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.local_time.calculate_local_solar_time_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_local_solar_time_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.local_time.calculate_local_solar_time_noaa title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_local_solar_time_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>event</span><span class=p>:</span> <span class=n><span title=pvgisprototype.api.position.models.SolarEvent>SolarEvent</span></span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n><span title=pvgisprototype.api.position.models.SolarEvent.noon>noon</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>unrefracted_solar_zenith</span><span class=p>:</span> <span class=n><span title=pvgisprototype.UnrefractedSolarZenith>UnrefractedSolarZenith</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT>UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the Local Solar Time (LST) based on the sun's position.</p> <p>This function computes the local solar time for a series of timestamps, considering solar noon and corrections for the Equation of Time (ET) and longitude. Local solar time reflects the actual position of the sun in the sky, which may differ from local standard time.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><span title=pvgisprototype.Longitude>Longitude</span></code> </td> <td> <div class=doc-md-description> <p>Longitude of the location in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><span title=pvgisprototype.Latitude>Latitude</span></code> </td> <td> <div class=doc-md-description> <p>Latitude of the location in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>Timestamps for which to calculate the local solar time.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> <p>Timezone information for the location.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unrefracted_solar_zenith</code> </td> <td> <code><span title=pvgisprototype.UnrefractedSolarZenith>UnrefractedSolarZenith</span></code> </td> <td> <div class=doc-md-description> <p>The zenith of the sun, adjusted for atmospheric refraction. Defaults to 1.5853349194640094 radians, which corresponds to 90.833 degrees. This is the zenith at sunrise or sunset, adjusted for the approximate correction for atmospheric refraction at those times, and the size of the solar disk.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT>UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Data type for the output (default is DATA_TYPE_DEFAULT).</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Backend for array operations (default is ARRAY_BACKEND_DEFAULT).</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level for debugging (default is VERBOSE_LEVEL_DEFAULT).</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Logging level (default is LOG_LEVEL_DEFAULT).</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>A series of local solar times corresponding to the input timestamps.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <div class=codehilite><pre><span></span><code>In solar energy calculations, the Apparent Solar Time (AST) is based on the
</code></pre></div> <p>apparent angular motion of the sun across the sky, expressing the time of day. The moment when the sun crosses the meridian of the observer is known as local solar noon. This does not usually coincide with 12:00 PM on the clock.</p> <p>Local Solar Time (LST) is calculated based on the Apparent Solar Time (AST), which is determined by the sun's position. The general equation for converting between Local Solar Time (LST) and Apparent Solar Time (AST) is:</p> <div class=codehilite><pre><span></span><code>AST = LST + ET  4 * (SL - LL) - DS
</code></pre></div> <p>Where: - AST: Apparent Solar Time - LST: Local Standard Time - ET: Equation of Time - SL: Standard Longitude for the time zone - LL: Local Longitude - DS: Daylight Saving Time adjustment. Working with UTC, DS is removed from the equation.</p> <p>Thus, the LST is given by :</p> <div class=codehilite><pre><span></span><code>LST = AST - ET  4 * (SL - LL)
</code></pre></div> <p>For noon, AST = 12 thus :</p> <div class=codehilite><pre><span></span><code>LST = 12 - ET  4 * (SL - LL)
</code></pre></div> <p>Definitions:</p> <ul> <li><strong>Local Solar Time (LST)</strong>: Time based on the sun's position at a specific location.</li> <li><strong>Apparent Solar Time (AST)</strong>: Time measured by the sun's position, specifically at solar noon.</li> <li><strong>Equation of Time (ET)</strong>: Difference between apparent solar time and mean solar time.</li> <li><strong>Standard Longitude</strong>: Longitude that defines the center of a time zone.</li> <li><strong>Local Longitude</strong>: Specific longitude of a location, used for corrections.</li> <li><strong>Daylight Saving Time (DS)</strong>: Adjustment of the clock to extend evening daylight.</li> </ul> <p>This function is useful for solar energy calculations and other applications where the actual solar time is relevant.</p> </details> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/local_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateLocalSolarTimeNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_local_solar_time_noaa</span><span class=p>(</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>event</span><span class=p>:</span> <span class=n>SolarEvent</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=n>SolarEvent</span><span class=o>.</span><span class=n>noon</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>unrefracted_solar_zenith</span><span class=p>:</span> <span class=n>UnrefractedSolarZenith</span> <span class=o>=</span> <span class=n>UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=c1># adjust_for_atmospheric_refraction: bool = False,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DatetimeIndex</span><span class=p>:</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>    Calculate the Local Solar Time (LST) based on the sun's position.</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    This function computes the local solar time for a series of timestamps,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    considering solar noon and corrections for the Equation of Time (ET) </span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    and longitude. Local solar time reflects the actual position of the sun </span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>    in the sky, which may differ from local standard time.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    longitude : Longitude</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>        Longitude of the location in radians.</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    latitude : Latitude</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>        Latitude of the location in radians.</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        Timestamps for which to calculate the local solar time.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>    timezone : ZoneInfo</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>        Timezone information for the location.</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    unrefracted_solar_zenith : UnrefractedSolarZenith, optional</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>        The zenith of the sun, adjusted for atmospheric refraction. Defaults to</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>        1.5853349194640094 radians, which corresponds to 90.833 degrees. This</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>        is the zenith at sunrise or sunset, adjusted for the approximate</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        correction for atmospheric refraction at those times, and the size of</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        the solar disk.</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    # adjust_for_atmospheric_refraction : bool, optional</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    #     Whether to apply atmospheric refraction corrections (default is False).</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>        Data type for the output (default is DATA_TYPE_DEFAULT).</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>        Backend for array operations (default is ARRAY_BACKEND_DEFAULT).</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>        Verbosity level for debugging (default is VERBOSE_LEVEL_DEFAULT).</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>        Logging level (default is LOG_LEVEL_DEFAULT).</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    DatetimeIndex</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>        A series of local solar times corresponding to the input timestamps.</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>        In solar energy calculations, the Apparent Solar Time (AST) is based on the</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    apparent angular motion of the sun across the sky, expressing the time of day.</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    The moment when the sun crosses the meridian of the observer is known as </span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    local solar noon. This does not usually coincide with 12:00 PM on the clock.</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    Local Solar Time (LST) is calculated based on the Apparent Solar Time (AST),</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    which is determined by the sun's position. The general equation for converting </span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    between Local Solar Time (LST) and Apparent Solar Time (AST) is:</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>        AST = LST + ET  4 * (SL - LL) - DS</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>    Where:</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>    - AST: Apparent Solar Time</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>    - LST: Local Standard Time</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    - ET: Equation of Time</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>    - SL: Standard Longitude for the time zone</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>    - LL: Local Longitude</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>    - DS: Daylight Saving Time adjustment. Working with UTC, DS is removed from the equation.</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    Thus, the LST is given by :</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>        LST = AST - ET  4 * (SL - LL)</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>    For noon, AST = 12 thus :</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>        LST = 12 - ET  4 * (SL - LL)</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    Definitions:</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>    - **Local Solar Time (LST)**: Time based on the sun's position at a specific location.</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>    - **Apparent Solar Time (AST)**: Time measured by the sun's position, specifically at solar noon.</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>    - **Equation of Time (ET)**: Difference between apparent solar time and mean solar time.</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    - **Standard Longitude**: Longitude that defines the center of a time zone.</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>    - **Local Longitude**: Specific longitude of a location, used for corrections.</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>    - **Daylight Saving Time (DS)**: Adjustment of the clock to extend evening daylight.</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>    This function is useful for solar energy calculations and other applications</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>    where the actual solar time is relevant.</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=c1># Calculate solar noon for the given timestamps</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=n>solar_noon_series</span> <span class=o>=</span> <span class=n>calculate_solar_event_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>event</span><span class=o>=</span><span class=n>event</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=n>unrefracted_solar_zenith</span><span class=o>=</span><span class=n>unrefracted_solar_zenith</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=c1># adjust_for_atmospheric_refraction=adjust_for_atmospheric_refraction,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=c1># Calculate the time difference from solar noon</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>    <span class=n>local_solar_time_delta</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=n>timestamps</span> <span class=o>&lt;</span> <span class=n>solar_noon_series</span><span class=p>,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=n>timestamps</span> <span class=o>-</span> <span class=p>(</span><span class=n>solar_noon_series</span> <span class=o>-</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>1</span><span class=p>)),</span>  <span class=c1># Previous solar noon</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=n>timestamps</span> <span class=o>-</span> <span class=n>solar_noon_series</span><span class=p>,</span>  <span class=c1># Current solar noon</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=c1># Convert time difference to seconds and add to timestamps</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=n>total_seconds</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>local_solar_time_delta</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>())</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>    <span class=n>local_solar_time_series</span> <span class=o>=</span> <span class=n>timestamps</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>seconds</span><span class=o>=</span><span class=n>total_seconds</span><span class=p>)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=k>return</span> <span class=n>local_solar_time_series</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_hour_angle> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_hour_angle</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_hour_angle title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_hour_angle.calculate_solar_hour_angle_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_hour_angle_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.solar_hour_angle.calculate_solar_hour_angle_series_noaa</code>)'>calculate_solar_hour_angle_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar hour angle for a time series.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_hour_angle.calculate_solar_hour_angle_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_hour_angle_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_hour_angle.calculate_solar_hour_angle_series_noaa title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarHourAngle>SolarHourAngle</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar hour angle for a time series.</p> <p>The solar hour angle calculation converts the local solar time (LST) into the number of degrees which the sun moves across the sky. In other words, it reflects the Earth's rotation and indicates the time of the day relative to the position of the Sun. It bases on the longitude and timestamp and by definition, the solar hour angle is :</p> <ul> <li>0 at solar noon</li> <li>negative in the morning</li> <li>positive in the afternoon.</li> </ul> <p>Since the Earth rotates 15 per hour (or pi / 12 in radians), each hour away from solar noon corresponds to an angular motion of the sun in the sky of 15. Practically, the calculation converts a timestamp into a solar time.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>Returns</code> </td> <td> </td> <td> <div class=doc-md-description> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>In the "original" equation, the solar hour angle is measured in degrees.</p> <div class=codehilite><pre><span></span><code><span class=sb>`hour_angle = true_solar_time / 4 - 180`</span>

which is the same as

<span class=sb>`hour_angle = true_solar_time * 0.25 - 180`</span>
</code></pre></div> <p>In the present implementation, we calculate the solar hour angle directly in radians. A full circle corresponds to 360 degrees or 2 radians. With 1440 minutes in a day, the angular change per minute is calculated as 2 radians divided by 1440 minutes. This results in approximately 0.004363323129985824 radians per minute.</p> <p>To find the solar hour angle, we first calculate the time difference from solar noon (by subtracting the true solar time in minutes from 720). We then multiply this difference by the angular change per minute (0.004363323129985824) to convert the time difference into radians. This approach (accurately?) represents the solar hour angle as an angular measurement in radians, reflecting the Earth's rotation and the position of the sun in the sky relative to a given location on Earth.</p> <p>In NREL's SPA ... , equation 32:</p> <div class=codehilite><pre><span></span><code><span class=nx></span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx></span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx></span><span class=w> </span><span class=err></span><span class=w> </span><span class=nx></span>

<span class=nx>Where</span><span class=w> </span><span class=p>:</span>
<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=nx></span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>observer</span><span class=w> </span><span class=nx>geographical</span><span class=w> </span><span class=nx>longitude</span><span class=p>,</span><span class=w> </span><span class=nx>positive</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=nx>negative</span>
<span class=w>      </span><span class=k>for</span><span class=w> </span><span class=nx>east</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=nx>west</span><span class=w> </span><span class=nx>of</span><span class=w> </span><span class=nx>Greenwich</span><span class=p>,</span><span class=w> </span><span class=nx>respectively</span><span class=p>.</span>

<span class=nx>Limit</span><span class=w> </span><span class=nx></span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>range</span><span class=w> </span><span class=nx>from</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=mi>360</span><span class=w> </span><span class=nx>degrees</span><span class=w> </span><span class=nx>using</span><span class=w> </span><span class=nx>step</span><span class=w> </span><span class="m m-Double">3.2.6</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=nx>note</span><span class=w> </span><span class=nx>that</span><span class=w> </span><span class=nx>it</span>
<span class=k>is</span><span class=w> </span><span class=nx>measured</span><span class=w> </span><span class=nx>westward</span><span class=w> </span><span class=nx>from</span><span class=w> </span><span class=nx>south</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=nx>this</span><span class=w> </span><span class=nx>algorithm</span><span class=p>.</span>

<span class=nx>Step</span><span class=w> </span><span class="m m-Double">3.2.6</span><span class=w> </span><span class=p>:</span>

<span class=w>    </span><span class=nx>Limit</span><span class=w> </span><span class=nx>L</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>range</span><span class=w> </span><span class=nx>from</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=mi>360</span><span class=w> </span><span class=nx>degrees</span><span class=p>.</span><span class=w> </span><span class=nx>That</span><span class=w> </span><span class=nx>can</span><span class=w> </span><span class=nx>be</span>
<span class=w>    </span><span class=nx>accomplished</span><span class=w> </span><span class=nx>by</span><span class=w> </span><span class=nx>dividing</span><span class=w> </span><span class=nx>L</span><span class=w> </span><span class=nx>by</span><span class=w> </span><span class=mi>360</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=nx>recording</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>decimal</span>
<span class=w>    </span><span class=nx>fraction</span><span class=w> </span><span class=nx>of</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>division</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nx>F</span><span class=p>.</span><span class=w> </span><span class=nx>If</span><span class=w> </span><span class=nx>L</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=nx>positive</span><span class=p>,</span><span class=w> </span><span class=k>then</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>limited</span><span class=w> </span><span class=nx>L</span>
<span class=w>    </span><span class=p>=</span><span class=w> </span><span class=mi>360</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=nx>F</span><span class=p>.</span><span class=w> </span><span class=nx>If</span><span class=w> </span><span class=nx>L</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=nx>negative</span><span class=p>,</span><span class=w> </span><span class=k>then</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>limited</span><span class=w> </span><span class=nx>L</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>360</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>360</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=nx>F</span><span class=p>.</span>
</code></pre></div> </details> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_hour_angle.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarHourAngleTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>validate_output</span><span class=p>:</span><span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarHourAngle</span><span class=p>:</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar hour angle for a time series.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    The solar hour angle calculation converts the local solar time (LST) into</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    the number of degrees which the sun moves across the sky. In other words,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    it reflects the Earth's rotation and indicates the time of the day relative</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    to the position of the Sun. It bases on the longitude and timestamp and by</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    definition, the solar hour angle is :</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>      - 0 at solar noon</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>      - negative in the morning</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>      - positive in the afternoon.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    Since the Earth rotates 15 per hour (or pi / 12 in radians), each hour</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    away from solar noon corresponds to an angular motion of the sun in the sky</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    of 15. Practically, the calculation converts a timestamp into a solar</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    time.</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    In the "original" equation, the solar hour angle is measured in degrees.</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>        `hour_angle = true_solar_time / 4 - 180`</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>        which is the same as</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>        `hour_angle = true_solar_time * 0.25 - 180`</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    In the present implementation, we calculate the solar hour angle directly</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>    in radians. A full circle corresponds to 360 degrees or 2 radians. With</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    1440 minutes in a day, the angular change per minute is calculated as 2</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    radians divided by 1440 minutes. This results in approximately</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    0.004363323129985824 radians per minute.</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    To find the solar hour angle, we first calculate the time difference from</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>    solar noon (by subtracting the true solar time in minutes from 720). We</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    then multiply this difference by the angular change per minute</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>    (0.004363323129985824) to convert the time difference into radians. This</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    approach (accurately?) represents the solar hour angle as an angular</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>    measurement in radians, reflecting the Earth's rotation and the position of</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    the sun in the sky relative to a given location on Earth.</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    In NREL's SPA ... , equation 32:</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=sd>         =  +   </span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>        Where :</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>            -  the observer geographical longitude, positive or negative</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>              for east or west of Greenwich, respectively.</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>        Limit  to the range from 0 to 360 degrees using step 3.2.6 and note that it</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=sd>        is measured westward from south in this algorithm.</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>        Step 3.2.6 :</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>            Limit L to the range from 0 to 360 degrees. That can be</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>            accomplished by dividing L by 360 and recording the decimal</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>            fraction of the division as F. If L is positive, then the limited L</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>            = 360 * F. If L is negative, then the limited L = 360 - 360 * F.</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>    <span class=n>true_solar_time_series</span> <span class=o>=</span> <span class=n>calculate_true_solar_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=p>(</span><span class=n>true_solar_time_series</span><span class=o>.</span><span class=n>minutes</span> <span class=o>-</span> <span class=mf>720.0</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>/</span> <span class=mf>720.0</span><span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=c1># solar_hour_angle_series = np.where(</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=c1>#         # true_solar_time_series.minutes &lt; 0,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=c1>#         solar_hour_angle_series &lt; 0,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>    <span class=c1>#         solar_hour_angle_series + pi,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>    <span class=c1>#         solar_hour_angle_series - pi,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>    <span class=c1>#         )</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>            <span class=p>(</span><span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span> <span class=o>&lt;=</span> <span class=n>solar_hour_angle_series</span><span class=p>)</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>solar_hour_angle_series</span> <span class=o>&lt;=</span> <span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=p>):</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>            <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>solar_hour_angle_series</span><span class=p>[</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>                <span class=o>~</span><span class=p>(</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>                    <span class=p>(</span><span class=o>-</span><span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span> <span class=o>&lt;=</span> <span class=n>solar_hour_angle_series</span><span class=p>)</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>                    <span class=o>&amp;</span> <span class=p>(</span><span class=n>solar_hour_angle_series</span> <span class=o>&lt;=</span> <span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>            <span class=p>]</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>                <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>                <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>min_degrees</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarHourAngle</span><span class=p>()</span><span class=o>.</span><span class=n>max_degrees</span><span class=si>}</span><span class=s2>] degrees"</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>                <span class=sa>f</span><span class=s2>" in [code]solar_hour_angle_series[/code] : </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>out_of_range_values</span><span class=p>)</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>    <span class=k>return</span> <span class=n>SolarHourAngle</span><span class=p>(</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>true_solar_time_series</span><span class=o>.</span><span class=n>timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.event_hour_angle> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">event_hour_angle</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.event_hour_angle title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.event_hour_angle.calculate_event_hour_angle_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_event_hour_angle_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.event_hour_angle.calculate_event_hour_angle_series_noaa</code>)'>calculate_event_hour_angle_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculates the event hour angle using the NOAA method.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.event_hour_angle.calculate_event_hour_angle_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_event_hour_angle_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.event_hour_angle.calculate_event_hour_angle_series_noaa title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_event_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>unrefracted_solar_zenith</span><span class=p>:</span> <span class=n><span title=pvgisprototype.UnrefractedSolarZenith>UnrefractedSolarZenith</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.EventHourAngle>EventHourAngle</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculates the event hour angle using the NOAA method.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><span title=pvgisprototype.Latitude>Latitude</span></code> </td> <td> <div class=doc-md-description> <p>The geographic latitude for which to calculate the event hour angle.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamp</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/datetime.html#module-datetime>datetime</a></code> </td> <td> <div class=doc-md-description> <p>The date and time for which to calculate the event hour angle.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unrefracted_solar_zenith</code> </td> <td> <code><span title=pvgisprototype.UnrefractedSolarZenith>UnrefractedSolarZenith</span></code> </td> <td> <div class=doc-md-description> <p>The zenith of the sun, adjusted for atmospheric refraction. Defaults to 1.5853349194640094 radians, which corresponds to 90.833 degrees. This is the zenith at sunrise or sunset, adjusted for the approximate correction for atmospheric refraction at those times, and the size of the solar disk.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>angle_units</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The unit in which the angles are input. Defaults to 'radians'.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.EventHourAngle>EventHourAngle</span></code> </td> <td> <div class=doc-md-description> <p>PVGIS native data structure carrying the calculated event hour angle along with relevant metadata.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The function implements NOAA calculations for the solar declination and the event hour angle. The solar declination is calculated first in radians, followed by the event hour angle in radians.</p> <p>Commented out: If the output units are 'degrees', the function will convert the calculated event hour angle from radians to degrees.</p> </details> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/event_hour_angle.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateEventHourAngleTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_event_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>unrefracted_solar_zenith</span><span class=p>:</span> <span class=n>UnrefractedSolarZenith</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>EventHourAngle</span><span class=p>:</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>    Calculates the event hour angle using the NOAA method.</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    latitude : Latitude</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>        The geographic latitude for which to calculate the event hour angle.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    timestamp : datetime</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>        The date and time for which to calculate the event hour angle.</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    unrefracted_solar_zenith : UnrefractedSolarZenith, optional</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>        The zenith of the sun, adjusted for atmospheric refraction. Defaults to</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>        1.5853349194640094 radians, which corresponds to 90.833 degrees. This</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>        is the zenith at sunrise or sunset, adjusted for the approximate</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        correction for atmospheric refraction at those times, and the size of</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>        the solar disk.</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    angle_units : str, optional</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>        The unit in which the angles are input. Defaults to 'radians'.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>    EventHourAngle</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>        PVGIS native data structure carrying the calculated event hour angle</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>        along with relevant metadata.</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>    The function implements NOAA calculations for the solar declination and</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>    the event hour angle. The solar declination is calculated first in radians,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>    followed by the event hour angle in radians.</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    Commented out: If the output units are 'degrees', the function</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    will convert the calculated event hour angle from radians to degrees.</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>calculate_solar_declination_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=p>)</span>  <span class=c1># radians</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=n>cosine_event_hour_angle_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>unrefracted_solar_zenith</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=p>)</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>tan</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>tan</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=n>event_hour_angle_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arccos</span><span class=p>(</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>cosine_event_hour_angle_series</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=p>)</span>  <span class=c1># radians</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>event_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>    <span class=k>return</span> <span class=n>EventHourAngle</span><span class=p>(</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>event_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=n>timing_algorithm</span><span class=o>=</span><span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.event_time> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">event_time</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.event_time title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_in_minutes title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_event_time_in_minutes</span> (<code>pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_in_minutes</code>)'>calculate_solar_event_time_in_minutes</a></code></td> <td> <div class=doc-md-description> <p>Calculate the event time in minutes based on the event type.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_event_time_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_series_noaa</code>)'>calculate_solar_event_time_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the time of solar events like sunrise, noon, or sunset.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.event_time.match_event_times_to_timestamps title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">match_event_times_to_timestamps</span> (<code>pvgisprototype.algorithms.noaa.event_time.match_event_times_to_timestamps</code>)'>match_event_times_to_timestamps</a></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_in_minutes> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_event_time_in_minutes</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_in_minutes title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_event_time_in_minutes</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>event_hour_angle</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>equation_of_time</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone_offset_hours_utc</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>event_type</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the event time in minutes based on the event type.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><span title=pvgisprototype.Longitude>Longitude</span></code> </td> <td> <div class=doc-md-description> <p>The longitude in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>event_hour_angle</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The event hour angle in minutes.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>equation_of_time</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The equation of time in minutes.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone_offset_hours_utc</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The timezone offset in hours.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>event_type</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>The type of solar event ('sunrise', 'noon', 'sunset').</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>The calculated event time in minutes.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/event_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_event_time_in_minutes</span><span class=p>(</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>event_hour_angle</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>equation_of_time</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>    <span class=n>timezone_offset_hours_utc</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=n>event_type</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    Calculate the event time in minutes based on the event type.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>    longitude : Longitude</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>        The longitude in radians.</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    event_hour_angle : float</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>        The event hour angle in minutes.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>    equation_of_time : float</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>        The equation of time in minutes.</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    timezone_offset_hours_utc : float</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>        The timezone offset in hours.</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    event_type : str</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>        The type of solar event ('sunrise', 'noon', 'sunset').</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>    float</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        The calculated event time in minutes.</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=c1># Calculate the base time</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=n>base</span> <span class=o>=</span> <span class=mi>720</span> <span class=o>-</span> <span class=n>equation_of_time</span><span class=o>.</span><span class=n>minutes</span> <span class=o>+</span> <span class=n>timezone_offset_hours_utc</span> <span class=o>*</span> <span class=mi>60</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>    <span class=n>longitude_minutes</span> <span class=o>=</span> <span class=n>longitude</span><span class=o>.</span><span class=n>as_minutes</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=n>event_hour_angle_minutes</span> <span class=o>=</span> <span class=n>event_hour_angle</span><span class=o>.</span><span class=n>as_minutes</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>    <span class=c1># Define event calculations</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>    <span class=n>event_calculations</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>astronomical_twilight</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>+</span> <span class=n>event_hour_angle_minutes</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=mi>18</span><span class=p>),</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>nautical_twilight</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>+</span> <span class=n>event_hour_angle_minutes</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=mi>12</span><span class=p>),</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>civil_twilight</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>+</span> <span class=n>event_hour_angle_minutes</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=mi>6</span><span class=p>),</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>sunrise</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>+</span> <span class=n>event_hour_angle_minutes</span><span class=p>),</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>noon</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>base</span> <span class=o>-</span> <span class=n>longitude_minutes</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>sunset</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>-</span> <span class=n>event_hour_angle_minutes</span><span class=p>),</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=n>SolarEvent</span><span class=o>.</span><span class=n>daylength</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=k>lambda</span><span class=p>:</span> <span class=p>(</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>            <span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>-</span> <span class=n>event_hour_angle_minutes</span><span class=p>)</span> <span class=o>-</span> 
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>            <span class=p>(</span><span class=n>base</span> <span class=o>-</span> <span class=p>(</span><span class=n>longitude_minutes</span> <span class=o>+</span> <span class=n>event_hour_angle_minutes</span><span class=p>))</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=p>),</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=c1># Calculate and return the event time</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=k>if</span> <span class=n>event_type</span> <span class=ow>in</span> <span class=n>event_calculations</span><span class=p>:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=k>return</span> <span class=n>event_calculations</span><span class=p>[</span><span class=n>event_type</span><span class=p>]()</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=c1># raise ValueError(f"Unknown event type: {event_type}")</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>                <span class=sa>f</span><span class=s2>"Calculation for the </span><span class=si>{</span><span class=n>event_type</span><span class=si>}</span><span class=s2> yet not implemented!"</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>                <span class=n>alt</span><span class=o>=</span> <span class=sa>f</span><span class=s2>"Calculation for the [code]</span><span class=si>{</span><span class=n>event_type</span><span class=si>}</span><span class=s2>[/code] yet [bold]not implemented[/bold]!"</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=k>return</span> <span class=n>NaT</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_event_time_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.event_time.calculate_solar_event_time_series_noaa title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_event_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>event</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.List title="<code>typing.List</code>">List</a></span><span class=p>[</span><span class=n><span title=pvgisprototype.api.position.models.SolarEvent>SolarEvent</span></span> <span class=o>|</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>],</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>unrefracted_solar_zenith</span><span class=p>:</span> <span class=n><span title=pvgisprototype.UnrefractedSolarZenith>UnrefractedSolarZenith</span></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT>UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.EventTime>EventTime</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the time of solar events like sunrise, noon, or sunset.</p> <p>For sunrise and sunset, the zenith is set to 90.833 degrees (the approximate correction for atmospheric refraction and the size of the solar disk).</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><span title=pvgisprototype.Latitude>Latitude</span></code> </td> <td> <div class=doc-md-description> <p>The latitude in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><span title=pvgisprototype.Longitude>Longitude</span></code> </td> <td> <div class=doc-md-description> <p>The longitude in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>The date to calculate the event for.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> <p>The timezone information.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unrefracted_solar_zenith</code> </td> <td> <code><span title=pvgisprototype.UnrefractedSolarZenith>UnrefractedSolarZenith</span></code> </td> <td> <div class=doc-md-description> <p>The zenith of the sun, adjusted for atmospheric refraction. Defaults to 1.5853349194640094 radians, which corresponds to 90.833 degrees. This is the zenith at sunrise or sunset, adjusted for the approximate correction for atmospheric refraction at those times, and the size of the solar disk.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT>UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>event</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/typing.html#typing.List title="<code>typing.List</code>">List</a>[<span title=Optional>Optional</span>[<span title=pvgisprototype.api.position.models.SolarEvent>SolarEvent</span>]]</code> </td> <td> <div class=doc-md-description> <p>A list of solar events to calculate the hour angle for, i.e. 'noon', 'sunrise', or 'sunset'.</p> </div> </td> <td> <code>[None]</code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Data type for calculations. Default is DATA_TYPE_DEFAULT.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Backend for array operations. Default is ARRAY_BACKEND_DEFAULT.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level for logging. Default is VERBOSE_LEVEL_DEFAULT.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level for logging. Default is LOG_LEVEL_DEFAULT.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.EventTime>EventTime</span></code> </td> <td> <div class=doc-md-description> <p>The calculated times of the requested solar events as a DatetimeIndex.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <ul> <li>All angles are in radians.</li> <li>The calculation <code>(1440 / (2 * pi)) * value_in_radians</code> maps a 'value in radians' from a range of [0, 2 * pi] which is a full circle to a range of [0, 1440] which is a full day in minutes.</li> </ul> </details> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/event_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateEventTimeTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_event_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>    <span class=n>event</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>SolarEvent</span> <span class=o>|</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>],</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>    <span class=n>unrefracted_solar_zenith</span><span class=p>:</span> <span class=n>UnrefractedSolarZenith</span> <span class=o>=</span> <span class=n>UNREFRACTED_SOLAR_ZENITH_ANGLE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>    <span class=c1># adjust_for_atmospheric_refraction: bool = False,</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>EventTime</span><span class=p>:</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a><span class=w>    </span><span class=sd>"""Calculate the time of solar events like sunrise, noon, or sunset.</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=sd>    For sunrise and sunset, the zenith is set to 90.833 degrees (the</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a><span class=sd>    approximate correction for atmospheric refraction and the size of the solar</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a><span class=sd>    disk).</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>    latitude : Latitude</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=sd>        The latitude in radians.</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a><span class=sd>    longitude : Longitude</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a><span class=sd>        The longitude in radians.</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=sd>        The date to calculate the event for.</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=sd>    timezone : ZoneInfo</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a><span class=sd>        The timezone information.</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>    unrefracted_solar_zenith : UnrefractedSolarZenith, optional</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=sd>        The zenith of the sun, adjusted for atmospheric refraction. Defaults to</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>        1.5853349194640094 radians, which corresponds to 90.833 degrees. This</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>        is the zenith at sunrise or sunset, adjusted for the approximate</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a><span class=sd>        correction for atmospheric refraction at those times, and the size of</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a><span class=sd>        the solar disk.</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=sd>    event : List[Optional[SolarEvent]], optional</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a><span class=sd>        A list of solar events to calculate the hour angle for, i.e. 'noon', 'sunrise', or 'sunset'.</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a><span class=sd>        Data type for calculations. Default is DATA_TYPE_DEFAULT.</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a><span class=sd>        Backend for array operations. Default is ARRAY_BACKEND_DEFAULT.</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a><span class=sd>        Verbosity level for logging. Default is VERBOSE_LEVEL_DEFAULT.</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a><span class=sd>        Log level for logging. Default is LOG_LEVEL_DEFAULT.</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a><span class=sd>    EventTime</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a><span class=sd>        The calculated times of the requested solar events as a DatetimeIndex.</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a><span class=sd>    - All angles are in radians.</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=sd>    - The calculation `(1440 / (2 * pi)) * value_in_radians` maps a 'value in</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a><span class=sd>      radians' from a range of [0, 2 * pi] which is a full circle to a range of</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a><span class=sd>      [0, 1440] which is a full day in minutes.</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>    <span class=k>if</span> <span class=n>event</span> <span class=o>==</span> <span class=p>[</span><span class=n>SolarEvent</span><span class=o>.</span><span class=n>none</span><span class=p>]:</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>        <span class=k>return</span> <span class=n>EventTime</span><span class=p>(</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>            <span class=n>value</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>            <span class=n>event</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>    <span class=c1># Create an array of NaTs based on unique days from timestamps</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>    <span class=n>unique_days</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>normalize</span><span class=p>()</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>    <span class=n>event_hour_angle_series</span> <span class=o>=</span> <span class=n>calculate_event_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>unique_days</span><span class=p>,</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>        <span class=n>unrefracted_solar_zenith</span><span class=o>=</span><span class=n>unrefracted_solar_zenith</span><span class=p>,</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>    <span class=n>equation_of_time_series</span> <span class=o>=</span> <span class=n>calculate_equation_of_time_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>unique_days</span><span class=p>,</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>    <span class=n>timezone_offset_timedelta</span> <span class=o>=</span> <span class=n>timezone</span><span class=o>.</span><span class=n>utcoffset</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>    <span class=n>timezone_offset_hours_utc</span> <span class=o>=</span> <span class=n>timezone_offset_timedelta</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>/</span> <span class=mi>3600</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>    <span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.api.position.models</span><span class=w> </span><span class=kn>import</span> <span class=n>select_models</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>    <span class=n>requested_solar_events</span> <span class=o>=</span> <span class=n>select_models</span><span class=p>(</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>        <span class=n>SolarEvent</span><span class=p>,</span> <span class=n>event</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>    <span class=p>)</span>  <span class=c1># Using a callback fails!</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>    <span class=c1># Vectorized calculation of event times</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>    <span class=n>solar_events_time_series_in_minutes</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>        <span class=n>solar_event</span><span class=p>:</span> <span class=n>calculate_solar_event_time_in_minutes</span><span class=p>(</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>            <span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>            <span class=n>event_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>            <span class=n>equation_of_time_series</span><span class=p>,</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>            <span class=n>timezone_offset_hours_utc</span><span class=p>,</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>            <span class=n>solar_event</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>        <span class=k>for</span> <span class=n>solar_event</span> <span class=ow>in</span> <span class=n>requested_solar_events</span> <span class=k>if</span> <span class=n>solar_event</span> <span class=ow>in</span> <span class=n>SolarEvent</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>    <span class=p>}</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>    <span class=n>solar_event_series</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>    <span class=k>for</span> <span class=n>solar_event</span> <span class=ow>in</span> <span class=n>requested_solar_events</span><span class=p>:</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>        <span class=c1># Check if the event has calculated times</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>        <span class=k>if</span> <span class=n>solar_event</span> <span class=ow>in</span> <span class=n>solar_events_time_series_in_minutes</span><span class=p>:</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>            <span class=c1># Get the event times in minutes</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>            <span class=n>solar_event_series</span><span class=p>[</span><span class=n>solar_event</span><span class=p>]</span> <span class=o>=</span> <span class=n>DatetimeIndex</span><span class=p>(</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>                <span class=p>[</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>                    <span class=n>Timestamp</span><span class=p>(</span><span class=n>ts</span><span class=o>.</span><span class=n>date</span><span class=p>())</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>minutes</span><span class=o>=</span><span class=nb>float</span><span class=p>(</span><span class=n>et</span><span class=p>))</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>                    <span class=k>for</span> <span class=n>ts</span><span class=p>,</span> <span class=n>et</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>                        <span class=n>unique_days</span><span class=p>,</span> <span class=n>solar_events_time_series_in_minutes</span><span class=p>[</span><span class=n>solar_event</span><span class=p>]</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>                    <span class=p>)</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>                <span class=p>]</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Event </span><span class=si>{</span><span class=n>event</span><span class=si>}</span><span class=s2> not found in event_time_series_in_minutes."</span><span class=p>)</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>    <span class=n>event_types</span><span class=p>,</span> <span class=n>event_timestamps</span> <span class=o>=</span> <span class=n>match_event_times_to_timestamps</span><span class=p>(</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>            <span class=n>solar_event_series</span><span class=o>=</span><span class=n>solar_event_series</span><span class=p>,</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>            <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>            <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_event_series</span><span class=p>,</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>    <span class=k>return</span> <span class=n>EventTime</span><span class=p>(</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>event_timestamps</span><span class=p>,</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>        <span class=n>event_type</span><span class=o>=</span><span class=n>event_types</span><span class=p>,</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>        <span class=n>hour_angle</span><span class=o>=</span><span class=n>event_hour_angle_series</span><span class=p>,</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>        <span class=n>equation_of_time</span><span class=o>=</span><span class=n>equation_of_time_series</span><span class=p>,</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.event_time.match_event_times_to_timestamps> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">match_event_times_to_timestamps</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.event_time.match_event_times_to_timestamps title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>match_event_times_to_timestamps</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>solar_event_series</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#dict>dict</a></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=p>)</span>
</span></code></pre></div> <div class="doc doc-contents"> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/event_time.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>match_event_times_to_timestamps</span><span class=p>(</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>solar_event_series</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=p>):</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=n>frequency_string</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>freqstr</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=c1># Define matching threshold dynamically based on inferred frequency</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=k>if</span> <span class=s1>'W-'</span> <span class=ow>in</span> <span class=nb>str</span><span class=p>(</span><span class=n>frequency_string</span><span class=p>):</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>            <span class=n>frequency_string</span> <span class=o>=</span> <span class=s1>'1'</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>frequency_string</span><span class=p>)</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>'-'</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># 'W'</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>            <span class=n>frequency_string</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>freq</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=n>frequency_threshold</span> <span class=o>=</span> <span class=n>Timedelta</span><span class=p>(</span><span class=n>frequency_string</span><span class=p>)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>    <span class=k>except</span><span class=p>:</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>"Unable to infer frequency from timestamps."</span><span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>    <span class=n>event_timestamps</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>full</span><span class=p>(</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>            <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>            <span class=n>fill_value</span><span class=o>=</span><span class=n>numpy</span><span class=o>.</span><span class=n>datetime64</span><span class=p>(</span><span class=s1>'NaT'</span><span class=p>),</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>            <span class=n>dtype</span><span class=o>=</span><span class=s1>'datetime64[ns]'</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>    <span class=n>event_types</span> <span class=o>=</span> <span class=n>create_array</span><span class=p>(</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s2>"object"</span><span class=p>,</span> <span class=n>init_method</span><span class=o>=</span><span class=s2>"empty"</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>array_backend</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>    <span class=n>naive_timestamps</span> <span class=o>=</span> <span class=n>timestamps</span><span class=o>.</span><span class=n>tz_localize</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>    <span class=k>for</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>event_times</span> <span class=ow>in</span> <span class=n>solar_event_series</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=c1># Find indices of closest matching timestamps</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>event_indexer</span> <span class=o>=</span> <span class=n>naive_timestamps</span><span class=o>.</span><span class=n>get_indexer</span><span class=p>(</span><span class=n>event_times</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=s1>'nearest'</span><span class=p>)</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=c1># However, assign event times to indices only if within the frequency threshold</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>event_time</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>event_indexer</span><span class=p>,</span> <span class=n>event_times</span><span class=p>):</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>            <span class=k>if</span> <span class=n>idx</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>:</span>  <span class=c1># Valid index</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>                <span class=n>closest_timestamp</span> <span class=o>=</span> <span class=n>naive_timestamps</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>                <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>event_time</span> <span class=o>-</span> <span class=n>closest_timestamp</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=n>frequency_threshold</span><span class=p>:</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>                    <span class=n>event_timestamps</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>event_time</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>                    <span class=n>event_types</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>event_type</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>    <span class=k>return</span> <span class=n>event_types</span><span class=p>,</span> <span class=n>event_timestamps</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.events> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">events</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.events title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p>This module contains days within the year that have some solar significance.</p> <p>The <code>SIGNIFICANT_DAYS</code> list includes key dates such as solstices, equinoxes, and points of perihelion and aphelion, among others. These dates are significant in understanding the Earth's orbit around the Sun and its effects on solar irradiance.</p> <p>Each date is represented as a tuple, where the first element is the day of the year, and the second element is an event or description.</p> <p>Constants: SIGNIFICANT_DAYS (list): A list of tuples representing significant dates. Each tuple contains a day of the year and a description of the significant event on that day. Source : Significant Days of the Year, <a href=https://andrewmarsh.com/articles/2019/significant-dates/ >https://andrewmarsh.com/articles/2019/significant-dates/</a></p> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_declination> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_declination</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_declination title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_declination.calculate_solar_declination_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_declination_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.solar_declination.calculate_solar_declination_series_noaa</code>)'>calculate_solar_declination_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar declination for a time series.</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_declination.calculate_solar_declination_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_declination_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_declination.calculate_solar_declination_series_noaa title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_declination_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarDeclination>SolarDeclination</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar declination for a time series.</p> <details class=note open> <summary>Notes</summary> <p>From NOAA's .. Excel sheet:</p> <p>sine_solar_declination = ASIN( SIN(RADIANS(R2))*SIN(RADIANS(P2)) )</p> <p>where:</p> <p>P2 = M2-0.00569-0.00478*SIN(RADIANS(125.04-1934.136*G2))</p> <div class=codehilite><pre><span></span><code><span class=n>where</span><span class=o>:</span>

<span class=n>M2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Geom</span><span class=w> </span><span class=n>Mean</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>Sun</span><span class=w> </span><span class=o>(</span><span class=n>deg</span><span class=o>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>Geom</span><span class=w> </span><span class=n>Mean</span><span class=w> </span><span class=n>Anom</span><span class=w> </span><span class=n>Sun</span><span class=w> </span><span class=o>(</span><span class=n>deg</span><span class=o>)</span>
</code></pre></div> <p>R2 = Q2 + 0.00256 * COS(RADIANS(125.04 - 1934.136*G2))</p> <div class=codehilite><pre><span></span><code>where :
</code></pre></div> <p>Q2 = Mean Obliq Ecliptic (deg)</p> </details> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_declination.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarDeclinationTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_declination_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>    <span class=n>validate_output</span><span class=p>:</span><span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarDeclination</span><span class=p>:</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar declination for a time series.</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>    From NOAA's .. Excel sheet:</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>    sine_solar_declination</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>    = ASIN(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>        SIN(RADIANS(R2))*SIN(RADIANS(P2))</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>    )</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>    where:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>    P2 = M2-0.00569-0.00478*SIN(RADIANS(125.04-1934.136*G2))</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>        where:</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>        M2 = Geom Mean Long Sun (deg) + Geom Mean Anom Sun (deg)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>    R2 = Q2 + 0.00256 * COS(RADIANS(125.04 - 1934.136*G2))</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>        where :</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>       Q2 = Mean Obliq Ecliptic (deg)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=n>fractional_year_series</span> <span class=o>=</span> <span class=n>calculate_fractional_year_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=mf>0.006918</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=o>-</span> <span class=mf>0.399912</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>        <span class=o>+</span> <span class=mf>0.070257</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>        <span class=o>-</span> <span class=mf>0.006758</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=o>+</span> <span class=mf>0.000907</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=o>-</span> <span class=mf>0.002697</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>        <span class=o>+</span> <span class=mf>0.00148</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=n>fractional_year_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=n>out_of_range</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>    <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range_x</span><span class=p>(</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>            <span class=n>series</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>            <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>            <span class=n>data_model</span><span class=o>=</span><span class=n>SolarDeclination</span><span class=p>(),</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>    <span class=k>return</span> <span class=n>SolarDeclination</span><span class=p>(</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span> <span class=k>if</span> <span class=n>out_of_range</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span> <span class=k>if</span> <span class=n>out_of_range</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>fractional_year_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_zenith> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_zenith</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_zenith title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_zenith.adjust_solar_zenith_for_atmospheric_refraction_time_series title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">adjust_solar_zenith_for_atmospheric_refraction_time_series</span> (<code>pvgisprototype.algorithms.noaa.solar_zenith.adjust_solar_zenith_for_atmospheric_refraction_time_series</code>)'>adjust_solar_zenith_for_atmospheric_refraction_time_series</a></code></td> <td> <div class=doc-md-description> <p>Adjust solar zenith for atmospheric refraction for a time series of solar zenith angles</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_zenith.atmospheric_refraction_adjustment title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">atmospheric_refraction_adjustment</span> (<code>pvgisprototype.algorithms.noaa.solar_zenith.atmospheric_refraction_adjustment</code>)'>atmospheric_refraction_adjustment</a></code></td> <td> <div class=doc-md-description> <p>Vectorized calculation of atmospheric refraction adjustment for different solar altitudes.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_zenith.calculate_solar_zenith_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_zenith_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.solar_zenith.calculate_solar_zenith_series_noaa</code>)'>calculate_solar_zenith_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar zenith angle for a location over a time series</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_zenith.adjust_solar_zenith_for_atmospheric_refraction_time_series> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">adjust_solar_zenith_for_atmospheric_refraction_time_series</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_zenith.adjust_solar_zenith_for_atmospheric_refraction_time_series title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>adjust_solar_zenith_for_atmospheric_refraction_time_series</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>solar_zenith_series</span><span class=p>:</span> <span class=n><span title=pvgisprototype.SolarZenith>SolarZenith</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarZenith>SolarZenith</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Adjust solar zenith for atmospheric refraction for a time series of solar zenith angles</p> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_zenith.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>AdjustSolarZenithForAtmosphericRefractionTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>adjust_solar_zenith_for_atmospheric_refraction_time_series</span><span class=p>(</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=n>solar_zenith_series</span><span class=p>:</span> <span class=n>SolarZenith</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=n>validate_output</span><span class=p>:</span><span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarZenith</span><span class=p>:</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=w>    </span><span class=sd>"""Adjust solar zenith for atmospheric refraction for a time series of solar zenith angles"""</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=c1># Mask</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>solar_altitude_series_array</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=mi>90</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span> <span class=o>-</span> <span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=p>)</span>  <span class=c1># in radians</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=c1># Adjust using vectorized operations</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=n>adjustment</span> <span class=o>=</span> <span class=n>atmospheric_refraction_adjustment</span><span class=p>(</span><span class=n>solar_altitude_series_array</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=n>adjusted_solar_zenith_series_array</span> <span class=o>=</span> <span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>-</span> <span class=n>adjustment</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>    <span class=c1># Validate</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=w>    </span><span class=sd>'''</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>    if not np.all(np.isfinite(adjusted_solar_zenith_series_array)) or not np.all(</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>        (SolarZenith().min_radians &lt;= adjusted_solar_zenith_series_array)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>        &amp; (adjusted_solar_zenith_series_array &lt;= SolarZenith().max_radians)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    ):</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>        raise ValueError(</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>            f"The `adjusted_solar_zenith` should be a finite number ranging in [{SolarZenith().min_radians}, {SolarZenith().max_radians}] radians"</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>        )</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    '''</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>    <span class=k>return</span> <span class=n>SolarZenith</span><span class=p>(</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>adjusted_solar_zenith_series_array</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>adjusted_for_atmospheric_refraction</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>  <span class=c1># This is what this function does !</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_zenith.atmospheric_refraction_adjustment> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">atmospheric_refraction_adjustment</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_zenith.atmospheric_refraction_adjustment title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>atmospheric_refraction_adjustment</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>solar_altitude</span><span class=p>:</span> <span class=n><span title=numpy.ndarray>ndarray</span></span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=s2>"float64"</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=numpy.ndarray>ndarray</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Vectorized calculation of atmospheric refraction adjustment for different solar altitudes. Applies different formulas based on the solar altitude angle.</p> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_zenith.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>atmospheric_refraction_adjustment</span><span class=p>(</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>    <span class=n>solar_altitude</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>"float64"</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a><span class=sd>    Vectorized calculation of atmospheric refraction adjustment for different solar altitudes.</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a><span class=sd>    Applies different formulas based on the solar altitude angle.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>    <span class=n>tangent_solar_altitude</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>tan</span><span class=p>(</span><span class=n>solar_altitude</span><span class=p>)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>    <span class=c1># Conditions</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>    <span class=n>mask_high</span> <span class=o>=</span> <span class=n>solar_altitude</span> <span class=o>&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>    <span class=n>mask_near</span> <span class=o>=</span> <span class=p>(</span><span class=n>solar_altitude</span> <span class=o>&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=o>-</span><span class=mf>0.575</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>))</span> <span class=o>&amp;</span> <span class=o>~</span><span class=n>mask_high</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>    <span class=n>mask_below</span> <span class=o>=</span> <span class=n>solar_altitude</span> <span class=o>&lt;=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=o>-</span><span class=mf>0.575</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>    <span class=c1># High solar altitude adjustment</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>    <span class=n>adjustment_high</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>        <span class=mf>58.1</span> <span class=o>/</span> <span class=n>tangent_solar_altitude</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>        <span class=o>-</span> <span class=mf>0.07</span> <span class=o>/</span> <span class=p>(</span><span class=n>tangent_solar_altitude</span><span class=o>**</span><span class=mi>3</span><span class=p>)</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>        <span class=o>+</span> <span class=mf>0.000086</span> <span class=o>/</span> <span class=p>(</span><span class=n>tangent_solar_altitude</span><span class=o>**</span><span class=mi>5</span><span class=p>)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>    <span class=p>)</span> <span class=o>/</span> <span class=mi>3600</span>  <span class=c1># 1 degree / 3600 seconds</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>    <span class=c1># Near horizon adjustment</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>    <span class=n>solar_altitude_deg</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>solar_altitude</span><span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>    <span class=n>adjustment_near</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>        <span class=mi>1735</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>        <span class=o>+</span> <span class=n>solar_altitude_deg</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos="81 "></span></a>        <span class=o>*</span> <span class=p>(</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos="82 "></span></a>            <span class=o>-</span><span class=mf>518.2</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos="83 "></span></a>            <span class=o>+</span> <span class=n>solar_altitude_deg</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos="84 "></span></a>            <span class=o>*</span> <span class=p>(</span><span class=mf>103.4</span> <span class=o>+</span> <span class=n>solar_altitude_deg</span> <span class=o>*</span> <span class=p>(</span><span class=o>-</span><span class=mf>12.79</span> <span class=o>+</span> <span class=n>solar_altitude_deg</span> <span class=o>*</span> <span class=mf>0.711</span><span class=p>))</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos="85 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos="86 "></span></a>    <span class=p>)</span> <span class=o>/</span> <span class=mi>3600</span>  <span class=c1># 1 degree / 3600 seconds</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos="87 "></span></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos="88 "></span></a>    <span class=c1># Below horizon adjustment</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos="89 "></span></a>    <span class=n>adjustment_below</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mf>20.774</span> <span class=o>/</span> <span class=n>tangent_solar_altitude</span><span class=p>)</span> <span class=o>/</span> <span class=mi>3600</span>  <span class=c1># 1 degree / 3600 seconds</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos="90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos="91 "></span></a>    <span class=c1># Initialize adjustment array</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos="92 "></span></a>    <span class=n>adjustment</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>solar_altitude</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos="93 "></span></a>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos="94 "></span></a>    <span class=c1># Apply adjustments based on conditions</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos="95 "></span></a>    <span class=n>adjustment</span><span class=p>[</span><span class=n>mask_high</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>adjustment_high</span><span class=p>[</span><span class=n>mask_high</span><span class=p>])</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos="96 "></span></a>    <span class=n>adjustment</span><span class=p>[</span><span class=n>mask_near</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>adjustment_near</span><span class=p>[</span><span class=n>mask_near</span><span class=p>])</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos="97 "></span></a>    <span class=n>adjustment</span><span class=p>[</span><span class=n>mask_below</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>adjustment_below</span><span class=p>[</span><span class=n>mask_below</span><span class=p>])</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos="98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos="99 "></span></a>    <span class=k>return</span> <span class=n>adjustment</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_zenith.calculate_solar_zenith_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_zenith_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_zenith.calculate_solar_zenith_series_noaa title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_zenith_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarZenith>SolarZenith</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar zenith angle for a location over a time series</p> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_zenith.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarZenithTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_zenith_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=c1># solar_hour_angle_series: SolarHourAngle,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarZenith</span><span class=p>:</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar zenith angle for a location over a time series"""</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>calculate_solar_declination_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=n>calculate_solar_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>    <span class=n>cosine_solar_zenith</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>        <span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>    <span class=p>)</span> <span class=o>+</span> <span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>    <span class=n>solar_zenith_series</span> <span class=o>=</span> <span class=n>SolarZenith</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>arccos</span><span class=p>(</span><span class=n>cosine_solar_zenith</span><span class=p>),</span>  <span class=c1># Important !</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>    <span class=k>if</span> <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=n>solar_zenith_series</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>            <span class=n>adjust_solar_zenith_for_atmospheric_refraction_time_series</span><span class=p>(</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>                <span class=n>solar_zenith_series</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>isfinite</span><span class=p>(</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span><span class=p>))</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>            <span class=p>(</span><span class=n>SolarZenith</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span> <span class=o>&lt;=</span> <span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>            <span class=o>&amp;</span> <span class=p>(</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&lt;=</span> <span class=n>SolarZenith</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=p>):</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>                <span class=sa>f</span><span class=s2>"Solar zenith values should be finite numbers and range in [</span><span class=si>{</span><span class=n>SolarZenith</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarZenith</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=si>}</span><span class=s2>] radians"</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>    <span class=k>return</span> <span class=n>solar_zenith_series</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_altitude> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_altitude</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_altitude title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_altitude.calculate_solar_altitude_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_altitude_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.solar_altitude.calculate_solar_altitude_series_noaa</code>)'>calculate_solar_altitude_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar altitude angle for a location over a time series</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_altitude.calculate_solar_altitude_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_altitude_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_altitude.calculate_solar_altitude_series_noaa title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_altitude_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarAltitude>SolarAltitude</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar altitude angle for a location over a time series</p> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_altitude.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarAltitudeTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_altitude_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarAltitude</span><span class=p>:</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar altitude angle for a location over a time series"""</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>    <span class=n>solar_zenith_series</span> <span class=o>=</span> <span class=n>calculate_solar_zenith_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>        <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>    <span class=n>solar_altitude_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>    <span class=n>out_of_range</span><span class=p>,</span> <span class=n>out_of_range_index</span> <span class=o>=</span> <span class=n>identify_values_out_of_range_x</span><span class=p>(</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>        <span class=n>series</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>        <span class=n>shape</span><span class=o>=</span><span class=n>timestamps</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>        <span class=n>data_model</span><span class=o>=</span><span class=n>SolarAltitude</span><span class=p>(),</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos="81 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos="82 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos="83 "></span></a>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos="84 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos="85 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos="86 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos="87 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos="88 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos="89 "></span></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos="90 "></span></a>    <span class=k>return</span> <span class=n>SolarAltitude</span><span class=p>(</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos="91 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_altitude_series</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos="92 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos="93 "></span></a>        <span class=n>out_of_range</span><span class=o>=</span><span class=n>out_of_range</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos="94 "></span></a>        <span class=n>out_of_range_index</span><span class=o>=</span><span class=n>out_of_range_index</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos="95 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>solar_positioning_algorithm</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos="96 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>solar_timing_algorithm</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos="97 "></span></a>        <span class=n>adjusted_for_atmospheric_refraction</span><span class=o>=</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>adjusted_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos="98 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_azimuth> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">solar_azimuth</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_azimuth title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Functions:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#pvgisprototype.algorithms.noaa.solar_azimuth.calculate_solar_azimuth_series_noaa title='<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_solar_azimuth_series_noaa</span> (<code>pvgisprototype.algorithms.noaa.solar_azimuth.calculate_solar_azimuth_series_noaa</code>)'>calculate_solar_azimuth_series_noaa</a></code></td> <td> <div class=doc-md-description> <p>Calculate the solar azimuth angle () for a time series at a specific</p> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id=pvgisprototype.algorithms.noaa.solar_azimuth.calculate_solar_azimuth_series_noaa> <code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">calculate_solar_azimuth_series_noaa</span> <a class=headerlink href=#pvgisprototype.algorithms.noaa.solar_azimuth.calculate_solar_azimuth_series_noaa title="Permanent link"></a></h2> <div class="language-python doc-signature highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nf>calculate_solar_azimuth_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Longitude>Longitude</span></span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n><span title=pvgisprototype.Latitude>Latitude</span></span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n><span title=pandas.DatetimeIndex>DatetimeIndex</span></span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>dtype</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>verbose</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>log</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>validate_output</span><span class=p>:</span> <span class=n><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></span> <span class=o>=</span> <span class=n><span title=pvgisprototype.constants.VALIDATE_OUTPUT_DEFAULT>VALIDATE_OUTPUT_DEFAULT</span></span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></span>
</span></code></pre></div> <div class="doc doc-contents"> <p>Calculate the solar azimuth angle () for a time series at a specific geographic latitude and longitude.</p> <p>Calculate the solar azimuth angle () for a time series at a specific geographic latitude and longitude, by default correcting the solar zenith angle for atmospheric refraction, as described in the following steps:</p> <div class=codehilite><pre><span></span><code><span class=mf>1.</span><span class=w> </span><span class=n>Calculate</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>solar</span><span class=w> </span><span class=n>declination</span><span class=p>,</span><span class=w> </span><span class=n>solar</span><span class=w> </span><span class=n>hour</span><span class=w> </span><span class=n>angle</span><span class=p>,</span><span class=w> </span><span class=ow>and</span><span class=w> </span><span class=n>solar</span><span class=w> </span><span class=n>zenith</span>
<span class=n>using</span><span class=w> </span><span class=n>NOAA</span><span class=err>'</span><span class=n>s</span><span class=w> </span><span class=n>General</span><span class=w> </span><span class=n>Solar</span><span class=w> </span><span class=nb>Pos</span><span class=n>ition</span><span class=w> </span><span class=n>Calculations</span><span class=mf>.</span>

<span class=mf>2.</span><span class=w> </span><span class=n>Calculate</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>solar</span><span class=w> </span><span class=n>azimuth</span><span class=w> </span><span class=n>angle</span><span class=w> </span><span class=n>using</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>equation</span><span class=w> </span><span class=n>reported</span><span class=w> </span><span class=n>in</span>
<span class=n>Wikipedia</span><span class=err>'</span><span class=n>s</span><span class=w> </span><span class=n>article</span><span class=w> </span><span class=s>"Solar azimuth angle"</span><span class=w> </span><span class=n>adjusting</span><span class=w> </span><span class=kr>for</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>time</span><span class=w> </span><span class=n>of</span>
<span class=n>day</span><span class=w> </span><span class=o>--</span><span class=w> </span><span class=n>see</span><span class=w> </span><span class=n>also</span><span class=w> </span><span class=ow>Not</span><span class=n>es</span><span class=w> </span><span class=p>:</span>

<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>Morning</span><span class=w> </span><span class=p>(</span><span class=n>solar</span><span class=w> </span><span class=n>hour</span><span class=w> </span><span class=n>angle</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mf>0</span><span class=p>):</span><span class=w> </span><span class=n>azimuth</span><span class=w> </span><span class=n>derived</span><span class=w> </span><span class=n>directly</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=n>the</span>
<span class=w>      </span><span class=n>arccosine</span><span class=w> </span><span class=n>function</span><span class=mf>.</span>

<span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>Afternoon</span><span class=w> </span><span class=p>(</span><span class=n>solar</span><span class=w> </span><span class=n>hour</span><span class=w> </span><span class=n>angle</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>0</span><span class=p>):</span><span class=w> </span><span class=n>azimuth</span><span class=w> </span><span class=n>adjusted</span><span class=w> </span><span class=kr>to</span><span class=w> </span><span class=n>range</span><span class=w> </span><span class=n>in</span>
<span class=w>      </span><span class=err>[</span><span class=mf>180</span><span class=err></span><span class=p>,</span><span class=w> </span><span class=mf>360</span><span class=err>]</span><span class=w> </span><span class=n>by</span><span class=w> </span><span class=n>subtracting</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=mf>360</span><span class=err></span><span class=mf>.</span>
</code></pre></div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>longitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Longitude of the location in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>latitude</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#float>float</a></code> </td> <td> <div class=doc-md-description> <p>Latitude of the location in radians.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=pandas.DatetimeIndex>DatetimeIndex</span></code> </td> <td> <div class=doc-md-description> <p>Times for which the solar azimuth will be calculated.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>timezone</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo title="<code>zoneinfo.ZoneInfo</code>">ZoneInfo</a></code> </td> <td> <div class=doc-md-description> <p>Timezone of the location.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>adjust_for_atmospheric_refraction</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </td> <td> <div class=doc-md-description> <p>Whether to correct the solar zenith angle for atmospheric refraction.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>dtype</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Data type for the calculations.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.DATA_TYPE_DEFAULT>DATA_TYPE_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>array_backend</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </td> <td> <div class=doc-md-description> <p>Backend array library to use.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.ARRAY_BACKEND_DEFAULT>ARRAY_BACKEND_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>verbose</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Verbosity level of the function.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.VERBOSE_LEVEL_DEFAULT>VERBOSE_LEVEL_DEFAULT</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a></code> </td> <td> <div class=doc-md-description> <p>Log level for the function.</p> </div> </td> <td> <code><span title=pvgisprototype.constants.LOG_LEVEL_DEFAULT>LOG_LEVEL_DEFAULT</span></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pvgisprototype.SolarAzimuth>SolarAzimuth</span></code> </td> <td> <div class=doc-md-description> <p>A custom data class that hold a NumPy NDArray of calculated solar azimuth angles in radians, a method to convert the angles to degrees and other metadata.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>From .. Excel sheet :</p> <p>=IF(AC2&gt;0, MOD( DEGREES(ACOS(((SIN(RADIANS(<span class=arithmatex>\(B\)</span>3))*COS(RADIANS(AD2)))-SIN(RADIANS(T2)))/(COS(RADIANS(<span class=arithmatex>\(B\)</span>3))*SIN(RADIANS(AD2)))))+180, 360), MOD( 540-DEGREES(ACOS(((SIN(RADIANS(<span class=arithmatex>\(B\)</span>3))*COS(RADIANS(AD2)))-SIN(RADIANS(T2)))/(COS(RADIANS(<span class=arithmatex>\(B\)</span>3))*SIN(RADIANS(AD2))))), 360) )</p> <p>numerator = (sin(latitude.radians) * cos(solar_zenith.radians)) - sin(solar_declination.radians) denominator = (cos(latitude.radians) * sin(solar_zenith.radians)) cosine_solar_azimuth = numerator / denominator</p> <p>if solar_hour_angle &gt; 0: (pi + arccos(cosine_solar_azimuth)) % 2*pi</p> <p>else: (3*pi - arccos(cosine_solar_azimuth)) % 2*pi</p> <p>Two important notes on the calculation of the solar azimuth angle :</p> <ul> <li> <p>The equation implemented here follows upon the relevant Wikipedia article for the "Solar azimuth angle" [1]_.</p> </li> <li> <p>The angle derived fom the arccosine function requires an adjustment to correctly represent both morning and afternoon solar azimuth angles.</p> </li> <li> <p>The equation given in NOAA's General Solar Position Calculations [0]_ is</p> <div class=codehilite><pre><span></span><code>             sin(latitude) * cos(solar_zenith) - sin(solar_declination)
</code></pre></div> <p>cos(180 - ) = - ---------------------------------------------------------- cos(latitude) * sin(solar_zenith)</p> <p>or after converting cos(180 - ) to - cos() :</p> <div class=codehilite><pre><span></span><code>         sin(latitude) * cos(solar_zenith) - sin(solar_declination)
</code></pre></div> <ul> <li>cos() = - ------------------------------------------------------------ cos(latitude) * sin(solar_zenith)</li> </ul> <p>or :</p> <div class=codehilite><pre><span></span><code>     sin(latitude) * cos(solar_zenith) - sin(solar_declination)
</code></pre></div> <p>cos() = ---------------------------------------------------------- cos(latitude) * sin(solar_zenith)</p> <p>and finally :</p> <div class=codehilite><pre><span></span><code>          sin(latitude) * cos(solar_zenith) - sin(solar_declination)
</code></pre></div> <p> = arccos( -------------------------------------------------------------- ) cos(latitude) * sin(solar_zenith)</p> <p>where  is the wanted solar azimuth angle.</p> <p>However, comparing this equation with the <em>almost identical</em> equation reported in Wikipedia's relevant article and subsection titled "Conventional Trigonometric Formulas" [1]_, there seems to be a difference of a minus sign :</p> <div class=codehilite><pre><span></span><code>         sin(declination) - cos(zenith) * sin(latitude)
</code></pre></div> <p>s = arccos( ---------------------------------------------- ) sin(zenith) * cos(latitude)</p> <p>where s is the wanted solar azimuth angle.</p> <p>A cross-comparison of the solar azimuth angle derived by the equation reported in Wikipedia's article [1]_ and the libraries pvlib [2]<em>, Skyfield [3]</em> and suncalc [4]_, show a high agreement across all of them.</p> </li> <li> <p>Adjusting the solar azimuth based on the time of day</p> <p>Given that arccosine ranges in [0, ] or else in [0, 180], the raw calculated solar azimuth angle will likewise range in [0, ]. This necessitates an adjustment based on the time of day.</p> <ul> <li> <p>Morning (solar hour angle &lt; 0): the azimuth angle is correctly derived directly from the arccosine function representing angles from the North clockwise to the South [0, 180].</p> </li> <li> <p>Afternoon (solar hour angle &gt; 0): the azimuth angle needs to be adjusted in order to correctly represent angles going further from the South to the West [180, 360]. This is achieved by subtracting the azimuth from 360.</p> </li> </ul> </li> </ul> </details> <details class=references open> <summary>References</summary> <p>.. [0] <a href=https://gml.noaa.gov/grad/solcalc/solareqns.PDF>https://gml.noaa.gov/grad/solcalc/solareqns.PDF</a></p> <p>.. [1] <a href=https://en.wikipedia.org/wiki/Solar_azimuth_angle#Conventional_Trigonometric_Formulas>https://en.wikipedia.org/wiki/Solar_azimuth_angle#Conventional_Trigonometric_Formulas</a></p> <p>.. [2] <a href=https://github.com/pvlib/pvlib-python>https://github.com/pvlib/pvlib-python</a></p> <p>.. [3] <a href=https://github.com/skyfielders/python-skyfield/ >https://github.com/skyfielders/python-skyfield/</a></p> <p>.. [4] <a href=https://github.com/kylebarron/suncalc-py>https://github.com/kylebarron/suncalc-py</a></p> </details> <p><span class=doc-section-title>Examples:</span></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>math</span><span class=w> </span><span class=kn>import</span> <span class=n>radians</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.api.datetime.datetimeindex</span><span class=w> </span><span class=kn>import</span> <span class=n>generate_datetime_series</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>timestamps</span> <span class=o>=</span> <span class=n>generate_datetime_series</span><span class=p>(</span><span class=n>start_time</span><span class=o>=</span><span class=s1>'2010-01-27'</span><span class=p>,</span> <span class=n>end_time</span><span class=o>=</span><span class=s1>'2010-01-28'</span><span class=p>)</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>zoneinfo</span><span class=w> </span><span class=kn>import</span> <span class=n>ZoneInfo</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pvgisprototype.api.position.azimuth</span><span class=w> </span><span class=kn>import</span> <span class=n>calculate_solar_azimuth_series_noaa</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>calculate_solar_azimuth_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=gp>... </span><span class=n>longitude</span><span class=o>=</span><span class=n>radians</span><span class=p>(</span><span class=mf>8.628</span><span class=p>),</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=gp>... </span><span class=n>latitude</span><span class=o>=</span><span class=n>radians</span><span class=p>(</span><span class=mf>45.812</span><span class=p>),</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=gp>... </span><span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=gp>... </span><span class=n>timezone</span><span class=o>=</span><span class=n>ZoneInfo</span><span class=p>(</span><span class=s2>"UTC"</span><span class=p>),</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a><span class=gp>... </span><span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>solar_azimuth_series</span><span class=p>)</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a><span class=go>solar_timing_algorithm='NOAA' solar_positioning_algorithm='NOAA' min_degrees=0 min_radians=0 data_source=None equation=None algorithm=None unit='radians' value=array([0.20324755, 0.68162394, 1.0347457 , 1.2956891 , 1.5057368 ,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a><span class=go>       1.6915469 , 1.8700204 , 2.0612502 , 2.250216  , 2.466558  ,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a><span class=go>       2.7086406 , 2.9751859 , 3.2346225 , 3.50884   , 3.757659  ,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a><span class=go>       3.9807858 , 4.1786404 , 4.3685203 , 4.547683  , 4.73073   ,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a><span class=go>       4.933111  , 5.178298  , 5.503539  , 5.949113  , 0.19983101],</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a><span class=go>      dtype=float32) symbol='' description='Solar azimuth angle data for a location and period in time' label=None title='Solar Azimuth' supertitle='Solar Irradiance' shortname='Azimuth' name='Solar Azimuth' max_radians=6.283185307179586 max_degrees=360 definition='Solar azimuth angle' origin='North'</span>
</span></code></pre></div> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>solar_azimuth_series</span><span class=o>.</span><span class=n>degrees</span><span class=p>)</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=go>[ 11.6452265  39.054173   59.286556   74.23751    86.27236    96.918495</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=go> 107.14427   118.10093   128.92787   141.32335   155.19366   170.46559</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=go> 185.3302    201.04172   215.29799   228.08221   239.41844   250.29776</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=go> 260.56302   271.05084   282.64642   296.6946    315.32956   340.85904</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=go>  11.449472 ]</span>
</span></code></pre></div> <details class=quote> <summary>Source code in <code>pvgisprototype/algorithms/noaa/solar_azimuth.py</code></summary> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=nd>@log_function_call</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=nd>@custom_cached</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=nd>@validate_with_pydantic</span><span class=p>(</span><span class=n>CalculateSolarAzimuthTimeSeriesNOAAInput</span><span class=p>)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_solar_azimuth_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=n>longitude</span><span class=p>:</span> <span class=n>Longitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=n>latitude</span><span class=p>:</span> <span class=n>Latitude</span><span class=p>,</span>  <span class=c1># radians</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>    <span class=n>timestamps</span><span class=p>:</span> <span class=n>DatetimeIndex</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=n>timezone</span><span class=p>:</span> <span class=n>ZoneInfo</span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>    <span class=n>adjust_for_atmospheric_refraction</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>DATA_TYPE_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=n>array_backend</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>ARRAY_BACKEND_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>VERBOSE_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>    <span class=n>log</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>LOG_LEVEL_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>    <span class=n>validate_output</span><span class=p>:</span><span class=nb>bool</span> <span class=o>=</span> <span class=n>VALIDATE_OUTPUT_DEFAULT</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>SolarAzimuth</span><span class=p>:</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=w>    </span><span class=sd>"""Calculate the solar azimuth angle () for a time series at a specific</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>    geographic latitude and longitude.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>    Calculate the solar azimuth angle () for a time series at a specific</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>    geographic latitude and longitude, by default correcting the solar zenith</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>    angle for atmospheric refraction, as described in the following steps:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>        1. Calculate the solar declination, solar hour angle, and solar zenith</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>        using NOAA's General Solar Position Calculations.</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>        2. Calculate the solar azimuth angle using the equation reported in</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>        Wikipedia's article "Solar azimuth angle" adjusting for the time of</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        day -- see also Notes :</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>            - Morning (solar hour angle &lt; 0): azimuth derived directly from the</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>              arccosine function.</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>            - Afternoon (solar hour angle &gt; 0): azimuth adjusted to range in</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>              [180, 360] by subtracting it from 360.</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    Parameters</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>    longitude : float</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>        Longitude of the location in radians.</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>    latitude : float</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>        Latitude of the location in radians.</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>    timestamps : DatetimeIndex</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>        Times for which the solar azimuth will be calculated.</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>    timezone : ZoneInfo</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>        Timezone of the location.</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    adjust_for_atmospheric_refraction : bool, optional</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>        Whether to correct the solar zenith angle for atmospheric refraction.</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    dtype : str, optional</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>        Data type for the calculations.</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    array_backend : str, optional</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=sd>        Backend array library to use.</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    verbose : int, optional</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=sd>        Verbosity level of the function.</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=sd>    log : int, optional</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=sd>        Log level for the function.</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=sd>    Returns</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=sd>    -------</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a><span class=sd>    SolarAzimuth</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a><span class=sd>        A custom data class that hold a NumPy NDArray of calculated solar</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=sd>        azimuth angles in radians, a method to convert the angles to degrees</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a><span class=sd>        and other metadata.</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=sd>    Notes</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=sd>    -----</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    From .. Excel sheet :</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>    =IF(AC2&gt;0,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=sd>        MOD(</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>            DEGREES(ACOS(((SIN(RADIANS($B$3))*COS(RADIANS(AD2)))-SIN(RADIANS(T2)))/(COS(RADIANS($B$3))*SIN(RADIANS(AD2)))))+180,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>        360),</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>        MOD(</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=sd>            540-DEGREES(ACOS(((SIN(RADIANS($B$3))*COS(RADIANS(AD2)))-SIN(RADIANS(T2)))/(COS(RADIANS($B$3))*SIN(RADIANS(AD2))))),</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>        360)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=sd>    )</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>    numerator = (sin(latitude.radians) * cos(solar_zenith.radians)) - sin(solar_declination.radians)</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>    denominator = (cos(latitude.radians) * sin(solar_zenith.radians))</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>    cosine_solar_azimuth = numerator / denominator</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>    if solar_hour_angle &gt; 0:</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>        (pi + arccos(cosine_solar_azimuth)) % 2*pi</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a><span class=sd>    else:</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>        (3*pi - arccos(cosine_solar_azimuth)) % 2*pi</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=sd>    Two important notes on the calculation of the solar azimuth angle :</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=sd>    - The equation implemented here follows upon the relevant Wikipedia article</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=sd>      for the "Solar azimuth angle" [1]_.</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a><span class=sd>    - The angle derived fom the arccosine function requires an adjustment to</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=sd>    correctly represent both morning and afternoon solar azimuth angles.</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a><span class=sd>    1. The equation given in NOAA's General Solar Position Calculations [0]_ is</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=sd>                         sin(latitude) * cos(solar_zenith) - sin(solar_declination)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a><span class=sd>        cos(180 - ) = - ----------------------------------------------------------</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=sd>                                  cos(latitude) * sin(solar_zenith)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=sd>        or after converting cos(180 - ) to - cos() :</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=sd>                     sin(latitude) * cos(solar_zenith) - sin(solar_declination)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>        - cos() = - ------------------------------------------------------------</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a><span class=sd>                                cos(latitude) * sin(solar_zenith)</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=sd>        or :</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=sd>                 sin(latitude) * cos(solar_zenith) - sin(solar_declination)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=sd>        cos() = ----------------------------------------------------------</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a><span class=sd>                             cos(latitude) * sin(solar_zenith)</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=sd>        and finally :</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a><span class=sd>                      sin(latitude) * cos(solar_zenith) - sin(solar_declination)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=sd>         = arccos( -------------------------------------------------------------- )</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a><span class=sd>                                  cos(latitude) * sin(solar_zenith)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a><span class=sd>        where  is the wanted solar azimuth angle.</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=sd>        However, comparing this equation with the _almost identical_ equation</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a><span class=sd>        reported in Wikipedia's relevant article and subsection titled</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a><span class=sd>        "Conventional Trigonometric Formulas" [1]_, there seems to be a</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a><span class=sd>        difference of a minus sign :</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=sd>                     sin(declination) - cos(zenith) * sin(latitude)</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=sd>        s = arccos( ---------------------------------------------- )</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a><span class=sd>                             sin(zenith) * cos(latitude)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>        where s is the wanted solar azimuth angle.</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>        A cross-comparison of the solar azimuth angle derived by the equation</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>        reported in Wikipedia's article [1]_ and the libraries pvlib [2]_,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a><span class=sd>        Skyfield [3]_ and suncalc [4]_, show a high agreement</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a><span class=sd>        across all of them.</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>    2. Adjusting the solar azimuth based on the time of day</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a><span class=sd>        Given that arccosine ranges in [0, ] or else in [0, 180], the raw</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a><span class=sd>        calculated solar azimuth angle will likewise range in [0, ]. This</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>        necessitates an adjustment based on the time of day.</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>        - Morning (solar hour angle &lt; 0): the azimuth angle is correctly</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a><span class=sd>          derived directly from the arccosine function representing angles from</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a><span class=sd>          the North clockwise to the South [0, 180].</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a><span class=sd>        - Afternoon (solar hour angle &gt; 0): the azimuth angle needs to be</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a><span class=sd>          adjusted in order to correctly represent angles going further from</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a><span class=sd>          the South to the West [180, 360]. This is achieved by subtracting</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a><span class=sd>          the azimuth from 360.</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=sd>    References</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a><span class=sd>    ----------</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=sd>    .. [0] https://gml.noaa.gov/grad/solcalc/solareqns.PDF</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a><span class=sd>    .. [1] https://en.wikipedia.org/wiki/Solar_azimuth_angle#Conventional_Trigonometric_Formulas</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a><span class=sd>    .. [2] https://github.com/pvlib/pvlib-python</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a><span class=sd>    .. [3] https://github.com/skyfielders/python-skyfield/</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a><span class=sd>    .. [4] https://github.com/kylebarron/suncalc-py</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a><span class=sd>    Examples</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a><span class=sd>    --------</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a><span class=sd>    &gt;&gt;&gt; from math import radians</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.api.datetime.datetimeindex import generate_datetime_series</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a><span class=sd>    &gt;&gt;&gt; timestamps = generate_datetime_series(start_time='2010-01-27', end_time='2010-01-28')</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a><span class=sd>    &gt;&gt;&gt; from zoneinfo import ZoneInfo</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a><span class=sd>    &gt;&gt;&gt; from pvgisprototype.api.position.azimuth import calculate_solar_azimuth_series_noaa</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a><span class=sd>    &gt;&gt;&gt; solar_azimuth_series = calculate_solar_azimuth_series_noaa(</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a><span class=sd>    ... longitude=radians(8.628),</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a><span class=sd>    ... latitude=radians(45.812),</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a><span class=sd>    ... timestamps=timestamps,</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a><span class=sd>    ... timezone=ZoneInfo("UTC"),</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a><span class=sd>    ... adjust_for_atmospheric_refraction=True</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a><span class=sd>    ... )</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a><span class=sd>    &gt;&gt;&gt; print(solar_azimuth_series)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a><span class=sd>    solar_timing_algorithm='NOAA' solar_positioning_algorithm='NOAA' min_degrees=0 min_radians=0 data_source=None equation=None algorithm=None unit='radians' value=array([0.20324755, 0.68162394, 1.0347457 , 1.2956891 , 1.5057368 ,</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a><span class=sd>           1.6915469 , 1.8700204 , 2.0612502 , 2.250216  , 2.466558  ,</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a><span class=sd>           2.7086406 , 2.9751859 , 3.2346225 , 3.50884   , 3.757659  ,</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a><span class=sd>           3.9807858 , 4.1786404 , 4.3685203 , 4.547683  , 4.73073   ,</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a><span class=sd>           4.933111  , 5.178298  , 5.503539  , 5.949113  , 0.19983101],</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a><span class=sd>          dtype=float32) symbol='\U000f19a5' description='Solar azimuth angle data for a location and period in time' label=None title='Solar Azimuth' supertitle='Solar Irradiance' shortname='Azimuth' name='Solar Azimuth' max_radians=6.283185307179586 max_degrees=360 definition='Solar azimuth angle' origin='North'</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a><span class=sd>    &gt;&gt;&gt; print(solar_azimuth_series.degrees)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a><span class=sd>    [ 11.6452265  39.054173   59.286556   74.23751    86.27236    96.918495</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a><span class=sd>     107.14427   118.10093   128.92787   141.32335   155.19366   170.46559</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a><span class=sd>     185.3302    201.04172   215.29799   228.08221   239.41844   250.29776</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a><span class=sd>     260.56302   271.05084   282.64642   296.6946    315.32956   340.85904</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a><span class=sd>      11.449472 ]</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>    <span class=n>solar_declination_series</span> <span class=o>=</span> <span class=n>calculate_solar_declination_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>    <span class=n>solar_hour_angle_series</span> <span class=o>=</span> <span class=n>calculate_solar_hour_angle_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>    <span class=n>solar_zenith_series</span> <span class=o>=</span> <span class=n>calculate_solar_zenith_series_noaa</span><span class=p>(</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>        <span class=n>longitude</span><span class=o>=</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>        <span class=n>latitude</span><span class=o>=</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>        <span class=n>timestamps</span><span class=o>=</span><span class=n>timestamps</span><span class=p>,</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>        <span class=n>timezone</span><span class=o>=</span><span class=n>timezone</span><span class=p>,</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>        <span class=n>adjust_for_atmospheric_refraction</span><span class=o>=</span><span class=n>adjust_for_atmospheric_refraction</span><span class=p>,</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span><span class=p>,</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>        <span class=n>array_backend</span><span class=o>=</span><span class=n>array_backend</span><span class=p>,</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>        <span class=n>verbose</span><span class=o>=</span><span class=n>verbose</span><span class=p>,</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>        <span class=n>log</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>        <span class=n>validate_output</span><span class=o>=</span><span class=n>validate_output</span><span class=p>,</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>    <span class=n>numerator_series</span> <span class=o>=</span> <span class=n>sin</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>        <span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>    <span class=p>)</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_declination_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>    <span class=n>denominator_series</span> <span class=o>=</span> <span class=n>cos</span><span class=p>(</span><span class=n>latitude</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>solar_zenith_series</span><span class=o>.</span><span class=n>radians</span><span class=p>)</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>    <span class=n>cosine_solar_azimuth_series</span> <span class=o>=</span> <span class=n>numerator_series</span> <span class=o>/</span> <span class=n>denominator_series</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arccos</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>cosine_solar_azimuth_series</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>    <span class=n>solar_azimuth_series</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>        <span class=n>solar_hour_angle_series</span><span class=o>.</span><span class=n>radians</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span>  <span class=c1># afternoon hours !</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>mod</span><span class=p>((</span><span class=n>pi</span> <span class=o>+</span> <span class=n>solar_azimuth_series</span><span class=p>),</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>),</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>        <span class=n>np</span><span class=o>.</span><span class=n>mod</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=n>pi</span> <span class=o>-</span> <span class=n>solar_azimuth_series</span><span class=p>,</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>),</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>    <span class=k>if</span> <span class=n>validate_output</span><span class=p>:</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a>        <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a>            <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&lt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a>            <span class=o>|</span> <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&gt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>        <span class=p>)</span><span class=o>.</span><span class=n>any</span><span class=p>():</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a>            <span class=n>out_of_range_values</span> <span class=o>=</span> <span class=n>solar_azimuth_series</span><span class=p>[</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>                <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&lt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=p>)</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a>                <span class=o>|</span> <span class=p>(</span><span class=n>solar_azimuth_series</span> <span class=o>&gt;</span> <span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=p>)</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>            <span class=p>]</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a>            <span class=c1># raise ValueError(# ?</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a>                <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>WARNING_OUT_OF_RANGE_VALUES</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>                <span class=sa>f</span><span class=s2>"[</span><span class=si>{</span><span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>min_radians</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>SolarAzimuth</span><span class=p>()</span><span class=o>.</span><span class=n>max_radians</span><span class=si>}</span><span class=s2>] radians"</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>                <span class=sa>f</span><span class=s2>" in [code]solar_azimuth_series[/code] : </span><span class=si>{</span><span class=n>out_of_range_values</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>    <span class=k>if</span> <span class=n>verbose</span> <span class=o>&gt;</span> <span class=n>DEBUG_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>:</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>        <span class=n>debug</span><span class=p>(</span><span class=nb>locals</span><span class=p>())</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a>    <span class=n>log_data_fingerprint</span><span class=p>(</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a>        <span class=n>data</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>        <span class=n>log_level</span><span class=o>=</span><span class=n>log</span><span class=p>,</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a>        <span class=n>hash_after_this_verbosity_level</span><span class=o>=</span><span class=n>HASH_AFTER_THIS_VERBOSITY_LEVEL</span><span class=p>,</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a>    <span class=p>)</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a>    <span class=k>return</span> <span class=n>SolarAzimuth</span><span class=p>(</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a>        <span class=n>value</span><span class=o>=</span><span class=n>solar_azimuth_series</span><span class=p>,</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>        <span class=n>unit</span><span class=o>=</span><span class=n>RADIANS</span><span class=p>,</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a>        <span class=n>solar_positioning_algorithm</span><span class=o>=</span><span class=n>SolarPositionModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a>        <span class=n>solar_timing_algorithm</span><span class=o>=</span><span class=n>SolarTimeModel</span><span class=o>.</span><span class=n>noaa</span><span class=p>,</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a>        <span class=n>origin</span><span class=o>=</span><span class=s2>"North"</span><span class=p>,</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div><!-- ::: pvgisprototype.algorithms.pvgis/ --> <div class="doc doc-object doc-module"> <h1 class="doc doc-heading" id=pvgisprototype.algorithms.hofierka> <code class="doc-symbol doc-symbol-heading doc-symbol-module"></code> <span class="doc doc-object-name doc-module-name">hofierka</span> <a class=headerlink href=#pvgisprototype.algorithms.hofierka title="Permanent link"></a></h1> <div class="doc doc-contents first"> <p><span class=doc-section-title>Modules:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title=pvgisprototype.algorithms.hofierka.power>power</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=pvgisprototype.algorithms.hofierka.read>read</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> </div> </div> </div><!-- ::: pvgisprototype.algorithms.pvlib/ --> <!-- ::: pvgisprototype.algorithms.pyephem/ --> <!-- ::: pvgisprototype.algorithms.pysolar/ --> <!-- ::: pvgisprototype.algorithms.references/ --> <!-- ::: pvgisprototype.algorithms.sapm/ --> <!-- ::: pvgisprototype.algorithms.skyfield/ --> <!-- ::: pvgisprototype.algorithms.standard/ --> <!-- ::: pvgisprototype.algorithms.suncalc/ --> <!-- ::: pvgisprototype.algorithms.usno/ --></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="September 27, 2025 12:48:52 UTC"><span class=timeago datetime=2025-09-27T12:48:52+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="September 27, 2025 12:48:52 UTC">2025-09-27</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="January 20, 2024 21:45:23 UTC"><span class=timeago datetime=2024-01-20T21:45:23+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="January 20, 2024 21:45:23 UTC">2024-01-20</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component=top hidden type=button> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <nav aria-label=Footer class="md-footer__inner md-grid"> <a aria-label="Previous: Duck Arrays" href=../duck_arrays/ class="md-footer__link md-footer__link--prev"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Duck Arrays </div> </div> </a> <a aria-label="Next: API" href=../api/ class="md-footer__link md-footer__link--next"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> API </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright  2025 European Commission. Licensed under the EUPL-1.2 or later </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "header.autohide", "search.highlight", "search.share", "content.tooltips", "content.code.copy", "content.action.view", "content.action.edit", "navigation.top", "navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.indexes", "toc.follow", "toc.integrate", "navigation.footer"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": {"CLI": "cli", "Chunking": "chunking", "Concepts": "concepts", "How-To": "howto", "See-Also": "seealso", "To Do": "todo"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../assets/_markdown_exec_pyodide.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> <script src=../../assets/mkdocs_pagetree_plugin.js></script> <script src=../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../js/termynal.js></script> <script src=../../js/custom.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../js/tablesort.js></script> <script src=../../js/mermaid_config.js></script> <script src=../../js/extra-loader.js></script> <script async src=../../assets/javascripts/badge.js></script> </body> </html>