name: DirectInclinedIrradianceFromExternalData
label: Direct Inclined Irradiance
type: Data Model
description: Direct inclined irradiance model (based on external data)
symbol: ⸾ ⇣ ∡

require:
  - irradiance/template

  # Surface parameters
  - surface/position/attribute/orientation
  - surface/position/attribute/tilt
  - surface/position/attribute/elevation

  # Solar position parameters
  - sun/position/attribute/positioning
  - sun/time/attribute/timing
  - sun/position/attribute/incidence

  #
  - surface/position/attribute/shading
  - sun/position/attribute/altitude
  - sun/position/attribute/refracted_altitude

  # Surface reflectivity : require generic attributes, then override important fields
  - irradiance/attribute/inclined/before_reflectivity/value
  - surface/property/reflectivity_factor
  - irradiance/attribute/reflectivity/loss
  - irradiance/attribute/reflectivity/percentage

  # Solar Irradiance
  - irradiance/attribute/horizontal/direct_from_external_data
  
  # Options
  - options/angle_output_unit

  # Structured output
  - irradiance/direct/output/inclined_from_external_data

sections:

  name:
    description: Name of the Direct Inclined Irradiance data model from external data
    initial: Direct Inclined Irradiance Data from external data

  shortname:
    description: Short name of the Direct Inclined Irradiance data model from external data
    initial: Direct Inclined

  supertitle:
    initial: Direct Inclined Irradiance

  title:
    initial: Direct Inclined Irradiance

  label:
    initial: ⇣ ∡ Direct Inclined Irradiance
  
  description:
    type: str
    initial: Direct inclined irradiance from external data

  symbol:
    initial: ⇣ ∡

  value:
    dependencies: direct_horizontal_irradiance
  
  # solar_azimuth:
  #   type: SolarAzimuth
  #   title: Azimuth 󱦥
  #   description: Solar azimuth
  #   symbol: 󱦥
  #   initial:
  
  unrefracted_solar_zenith:
    type: array
    title: Refracted zen.
    description: Refracted solar zenith
    symbol: 
    initial: null

  # adjust_for_atmospheric_refraction:
  #   type: bool
  #   title: Refraction
  #   description: Flag to apply atmospheric refraction for the calculation of the solar zenith angle
  #   symbol:
  #   initial: False

  adjusted_for_atmospheric_refraction:
    type: bool
    title: Unrefracted ⦧
    description: Adjustment of the solar zenith angle (from which the solar altitude derives) for atmospheric refraction effects 
    symbol: ⦧
    initial: True

  value_before_reflectivity:
    shortname: Direct inclined
    title: Direct ⇣ ∡ ☉
    description: Direct inclined irradiance before reflectivity
    symbol: ⇣ ∡ ☉

  reflectivity_factor:
    title: Direct Reflectivity ⋅⭜ ⇣∡
    description: Surface reflectivity factor for the direct inclined irradiance
    symbol: '⋅⭜ ⇣∡'

  reflectivity:
    title: Direct ⇣ -⭜
    description: Irradiance losses due to surface reflectivity as a function of the angle of incidence in absolute terms of the direct inclined irradiance component
    symbol: '⇣ -⭜'

  reflectivity_percentage:
    title: Direct Reflectivity ⭳-⭜ %
    description: Reflectivity losses due to the angle of incidence in % of the direct inclined irradiance
    symbol: '⭳-⭜ %'

  data_source:
    title: Based on external direct horizontal irradiance
    description: Source of the direct inclined solar radiation data
